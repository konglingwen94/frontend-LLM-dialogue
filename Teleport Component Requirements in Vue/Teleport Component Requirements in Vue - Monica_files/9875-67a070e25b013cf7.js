(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9875],{7091:function(){},54004:function(){},27544:function(e,t,i){"use strict";i.d(t,{L:function(){return s}});var a=i(92235);let o=["width","height","max-width","max-height","min-width","min-height","padding-top","padding-bottom","padding-left","padding-right","border-width","box-sizing","line-height","text-indent","text-align","font-size","font-family","font-weight","font-style","font-variant","letter-spacing","white-space","word-spacing","word-wrap","word-break","position","overflow"];class s{getStyles(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,i=window.getComputedStyle(e),s={};return t.map(t=>{let o=a.m.camelizeKey(t),n=i.getPropertyValue(t);if(["width","height"].includes(t)&&"auto"===n){let t=e.getBoundingClientRect();s[o]="".concat(t[o],"px");return}if(["max-width","max-height","min-width","min-height"].includes(t)){s[o]=this.convertPercentToPx(e,t,n);return}if("border-width"===t){let e=parseFloat(n);if(!isNaN(e)){s.border="".concat(e,"px solid transparent");return}}s[o]=n}),s}getStyle(e,t){return window.getComputedStyle(e).getPropertyValue(t)}getCssText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,i=window.getComputedStyle(e);return t.map(t=>{let a=i.getPropertyValue(t);if(["width","height"].includes(t)&&"auto"===a){let i=e.getBoundingClientRect();return"".concat(t,": ").concat(i[t],"px")}if(["max-width","max-height","min-width","min-height"].includes(t))return"".concat(t,": ").concat(this.convertPercentToPx(e,t,a));if("border-width"===t){let e=parseFloat(a);if(!isNaN(e))return"border: ".concat(e,"px solid transparent")}return"".concat(t,": ").concat(a)}).join(";")}getFontStyles(e){let t=window.getComputedStyle(e);return{fontFamily:t.getPropertyValue("font-family"),fontSize:parseFloat(t.getPropertyValue("font-size")),fontWeight:parseFloat(t.getPropertyValue("font-weight")),lineHeight:parseFloat(t.getPropertyValue("line-height"))}}getContentBox(e){return{width:e.scrollWidth,height:e.scrollHeight}}getScrollbarWidth(e){let t=window.getComputedStyle(e),i=parseFloat(t.getPropertyValue("border-left-width"))||0,a=parseFloat(t.getPropertyValue("border-right-width"))||0;return e.offsetWidth-e.clientWidth-i-a}convertPercentToPx(e,t,i){if(!i.includes("%"))return i;let a=parseFloat(i)/100,o=e.parentElement;if(!o)return"none";let s=window.getComputedStyle(o),n=parseFloat(s.getPropertyValue("width")),r=parseFloat(s.getPropertyValue("height")),l=s.getPropertyValue("box-sizing"),d=parseFloat(s.getPropertyValue("border-width")),c=parseFloat(s.getPropertyValue("padding-left")),h=parseFloat(s.getPropertyValue("padding-right")),g=parseFloat(s.getPropertyValue("padding-top")),p=parseFloat(s.getPropertyValue("padding-bottom")),A=n,m=r;return("border-box"===l&&(A=n-c-h-2*d,m=r-g-p-2*d),t.includes("height"))?"".concat(m*a,"px"):"".concat(A*a,"px")}}},92498:function(e,t,i){"use strict";i.d(t,{$:function(){return c}});var a=i(66084),o=i(52921),s=i(28901),n=i(71528),r=i(34491),l=i(52184),d=i(73047);class c{get translateStyle(){return"translateX(".concat(this.translate.x,"px) translateY(").concat(this.translate.y,"px)")}get cursor(){return this.dragging?"grabbing":"grab"}setEl(e){this.el=e}init(e,t){this.inited||(this.inited=!0,this.el=null!=e?e:this.el,this.options=t,this.globalListenerManager.addDocumentEventListener("mousemove",e=>this.handleMouseMove(e)),this.globalListenerManager.addDocumentEventListener("mouseup",()=>this.handleMouseUp()),this.globalListenerManager.addWindowEventListener("resize",()=>{(null==t?void 0:t.boundary)||(this.boundary={left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight}),this.reposition()}),(null==t?void 0:t.boundary)?this.boundary=t.boundary:this.boundary={left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight})}reposition(){var e,t;if(!this.el)return;let i=this.el.getBoundingClientRect(),a=Math.ceil(i.right),o=Math.ceil(i.bottom),s=Math.ceil(i.left),n=Math.ceil(i.top);a>this.boundary.right?this.translate.x-=a-this.boundary.right:s<this.boundary.left&&(this.translate.x+=Math.abs(this.boundary.left-s)),o>this.boundary.bottom?this.translate.y-=o-this.boundary.bottom:n<this.boundary.top&&(this.translate.y+=Math.abs(n)),null===(t=this.options)||void 0===t||null===(e=t.onUpdated)||void 0===e||e.call(t)}handleMouseDown(e){if(this.dragging||!this.el)return;let t=e.target;if(s.x.getParents(t,'[data-draggable="false"]'))return;e.preventDefault(),this.dragging=!0;let{clientX:i,clientY:a}=e,{left:o,top:n}=this.el.getBoundingClientRect();this.offset={x:i-o,y:a-n},this.prev={x:i,y:a},this.current={x:i,y:a}}handleMouseMove(e){var t,i;if(!this.dragging||!this.el)return;let{left:a,top:o,width:s,height:n}=this.el.getBoundingClientRect(),{clientX:r,clientY:d}=e,{x:c,y:h}=this.translate,g=r-this.current.x,p=d-this.current.y,A=this.boundary.right-s,m=this.boundary.bottom-n,u=(0,l.Z)(a+g,this.boundary.left,A),f=(0,l.Z)(o+p,this.boundary.top,m);this.translate.x=u-a+c,this.translate.y=f-o+h,this.prev=this.current,this.current={x:r,y:d},null===(i=this.options)||void 0===i||null===(t=i.onUpdated)||void 0===t||t.call(i)}handleMouseUp(){this.dragging=!1,this.offset=null,this.prev=null,this.current=null}setDragBoundary(e){this.boundary=e}destroy(){this.globalListenerManager.removeAll(),this.inited=!1,this.dragging=!1,this.translate={x:0,y:0},this.offset={x:0,y:0},this.current={x:0,y:0},this.prev={x:0,y:0},this.el=null}constructor(){(0,a._)(this,"globalListenerManager",new n.M),(0,a._)(this,"inited",!1),(0,a._)(this,"translate",{x:0,y:0}),(0,a._)(this,"dragging",!1),(0,a._)(this,"offset",{x:0,y:0}),(0,a._)(this,"current",{x:0,y:0}),(0,a._)(this,"prev",{x:0,y:0}),(0,a._)(this,"el",null),(0,a._)(this,"options",void 0),(0,a._)(this,"boundary",{left:0,top:0,right:0,bottom:0}),(0,d.rC)(this)}}(0,o.gn)([r.SB],c.prototype,"translate",void 0),(0,o.gn)([r.SB],c.prototype,"dragging",void 0),(0,o.gn)([r.SB],c.prototype,"offset",void 0),(0,o.gn)([r.SB],c.prototype,"current",void 0),(0,o.gn)([r.SB],c.prototype,"prev",void 0),(0,o.gn)([d.Fl],c.prototype,"translateStyle",null),(0,o.gn)([d.Fl],c.prototype,"cursor",null)},12596:function(e,t,i){"use strict";i.d(t,{S:function(){return d}});var a=i(66084),o=i(52921),s=i(71528),n=i(34491),r=i(20978),l=i(73047);class d{get percentData(){return{width:"".concat(this.data.width/window.innerWidth*100,"%"),height:"".concat(this.data.height/window.innerHeight*100,"%"),translateX:"".concat(this.data.translateX/window.innerWidth*100,"%"),translateY:"".concat(this.data.translateY/window.innerHeight*100,"%")}}get cursor(){return"top"===this.resizeDirection||"bottom"===this.resizeDirection?"ns-resize":"left"===this.resizeDirection||"right"===this.resizeDirection?"ew-resize":"topLeft"===this.resizeDirection?"nwse-resize":"topRight"===this.resizeDirection||"bottomLeft"===this.resizeDirection?"nesw-resize":"bottomRight"===this.resizeDirection?"nwse-resize":void 0}init(e){this.options=e,this.data=e.defaultData,this.listenerManager.addDocumentEventListener("mousemove",this.handleMouseMove),this.listenerManager.addDocumentEventListener("mouseup",this.handleMouseUp),this.listenerManager.addDocumentEventListener("mousedown",()=>{this.moved=!1,this.isMouseInRoot=!1,this.isResizing=!1})}dispose(){this.listenerManager.removeAll()}handleWindowResize(){var e,t,i,a;if(!this.options)return;let o=(null===(e=(t=this.options).getMinSize)||void 0===e?void 0:e.call(t))||{width:0,height:0},s=(null===(i=(a=this.options).getMaxSize)||void 0===i?void 0:i.call(a))||{width:window.innerWidth,height:window.innerHeight};this.data.width=Math.min(Math.max(this.data.width,o.width),s.width),this.data.height=Math.min(Math.max(this.data.height,o.height),s.height),this.debouncedOnChange()}updateData(e){this.data={...this.data,...e}}getRoot(){if(!this.root)throw Error("root is null");return this.root}calcCursor(e){var t,i;let{top:a,left:o,width:s,height:n}=this.getRoot().getBoundingClientRect(),{clientX:r,clientY:l}=e,d=this.options.touchArea||10,c=this.options.scrollBarWidth||0,h=l-a<d,g=n-(l-a)<d,p=r-o<d,A=s-(r-o)<d,m=null===(t=(i=this.options).getAllowedDirection)||void 0===t?void 0:t.call(i),u=c>0&&o+s-c<r?null:h&&p?m&&!m.includes("topLeft")?"top":"topLeft":h&&A?m&&!m.includes("topRight")?"top":"topRight":g&&p?m&&!m.includes("bottomLeft")?"bottom":"bottomLeft":g&&A?m&&!m.includes("bottomRight")?"bottom":"bottomRight":h?"top":g?"bottom":p?"left":A?"right":null;(!u||!m||m.includes(u))&&u!==this.resizeDirection&&(this.resizeDirection=u)}calcResizeData(e){var t,i,a,o,s,n;if(!this.resizeDirection)return;e.stopPropagation(),e.preventDefault();let r=(null===(t=(i=this.options).getMinSize)||void 0===t?void 0:t.call(i))||{width:0,height:0},l=(null===(a=(o=this.options).getMaxSize)||void 0===a?void 0:a.call(o))||{width:window.innerWidth,height:window.innerHeight},d=e=>Math.min(Math.max(e,r.height),l.height),c=e=>Math.min(Math.max(e,r.width),l.width),{top:h,left:g,width:p,height:A}=this.getRoot().getBoundingClientRect(),{width:m,height:u,translateX:f,translateY:y}=this.data;if("bottom"===this.resizeDirection){let t=Math.min(e.clientY+8,window.innerHeight);this.data.height=d(t-h)}if("top"===this.resizeDirection){let t=Math.max(e.clientY-8,0);this.data.height=d(A-(t-h)),this.data.translateY=y+u-this.data.height}if("left"===this.resizeDirection){let t=Math.max(e.clientX-8,0);this.data.width=c(p-(t-g)),this.data.translateX=f+m-this.data.width}if("right"===this.resizeDirection){let t=Math.min(e.clientX+8,window.innerWidth);this.data.width=c(t-g)}if("topLeft"===this.resizeDirection){let t=Math.max(e.clientX-8,0),i=Math.max(e.clientY-8,0);this.data.width=c(p-(t-g)),this.data.height=d(A-(i-h)),this.data.translateX=f+m-this.data.width,this.data.translateY=y+u-this.data.height}if("topRight"===this.resizeDirection){let t=Math.min(e.clientX+8,window.innerWidth),i=Math.max(e.clientY-8,0);this.data.width=c(t-g),this.data.height=d(A-(i-h)),this.data.translateY=y+u-this.data.height}if("bottomLeft"===this.resizeDirection){let t=Math.max(e.clientX-8,0),i=Math.min(e.clientY+8,window.innerHeight);this.data.width=c(p-(t-g)),this.data.height=d(i-h),this.data.translateX=f+m-this.data.width}if("bottomRight"===this.resizeDirection){let t=Math.min(e.clientX+8,window.innerWidth),i=Math.min(e.clientY+8,window.innerHeight);this.data.width=c(t-g),this.data.height=d(i-h)}null===(s=(n=this.options).onResized)||void 0===s||s.call(n)}constructor(){(0,a._)(this,"data",void 0),(0,a._)(this,"resizeDirection",null),(0,a._)(this,"isMouseInRoot",!1),(0,a._)(this,"isResizing",!1),(0,a._)(this,"root",null),(0,a._)(this,"options",void 0),(0,a._)(this,"moved",!1),(0,a._)(this,"listenerManager",new s.M),(0,a._)(this,"handleRootMouseDown",e=>{this.moved=!1,e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.isMouseInRoot&&(this.isResizing=!0)}),(0,a._)(this,"handleRootMouseEnter",()=>{this.isMouseInRoot=!0}),(0,a._)(this,"handleRootMouseLeave",()=>{this.isMouseInRoot=!1,this.isResizing||(this.resizeDirection=null)}),(0,a._)(this,"handleMouseUp",()=>{if(this.isResizing){if(this.isResizing=!1,this.moved){var e,t;null===(e=(t=this.options).onChange)||void 0===e||e.call(t,(0,l.ZN)(this.data))}this.moved=!1}}),(0,a._)(this,"handleMouseMove",e=>{!(!this.root||this.options.getIsLock&&this.options.getIsLock())&&(this.moved=!0,this.isResizing?this.calcResizeData(e):this.isMouseInRoot&&this.calcCursor(e))}),(0,a._)(this,"debouncedOnChange",(0,r.Z)(()=>{var e,t;null===(e=(t=this.options).onChange)||void 0===e||e.call(t,(0,l.ZN)(this.data))},100)),(0,l.rC)(this)}}(0,a._)(d,"ALL_DIRECTION",["left","right","top","bottom","topLeft","topRight","bottomLeft","bottomRight"]),(0,o.gn)([n.SB],d.prototype,"data",void 0),(0,o.gn)([n.SB],d.prototype,"resizeDirection",void 0),(0,o.gn)([n.SB],d.prototype,"isMouseInRoot",void 0),(0,o.gn)([n.SB],d.prototype,"isResizing",void 0),(0,o.gn)([l.Fl],d.prototype,"percentData",null),(0,o.gn)([l.Fl],d.prototype,"cursor",null)},74145:function(e,t,i){"use strict";i.d(t,{K:function(){return s}});var a=i(66084);class o{static create(e){return{dispose:e}}get disposed(){return 0===this.disposables.length}dispose(){if(!this.disposed&&!this.disposingElements){for(this.disposingElements=!0;!this.disposed;)try{this.disposables.pop().dispose()}catch(e){console.error(e)}this.disposingElements=!1}}addDispose(e){return Array.isArray(e)?e.map(e=>this.addDispose(e)):this.add(e)}registerDispose(e){if(e===this)throw Error("Cannot register a disposable on itself!");return this.add(e),e}add(e){let t=this.disposables;t.push(e);let i=e.dispose.bind(e),a=o.create(()=>{let i=t.indexOf(e);-1!==i&&t.splice(i,1)});return e.dispose=()=>{a.dispose(),i()},a}constructor(...e){(0,a._)(this,"disposables",[]),(0,a._)(this,"disposingElements",!1),e.forEach(e=>this.addDispose(e))}}(0,a._)(o,"NULL",o.create(()=>{})),(0,a._)(o,"None",Object.freeze({dispose(){}}));class s{get disposed(){return 0===this.disposables.length}dispose(){if(this.disposed||this.disposingElements)return;let e=[];for(this.disposingElements=!0;!this.disposed;)try{let t=this.disposables.pop().dispose();t&&e.push(t)}catch(e){console.error("DisposableCollection.dispose error",e)}return this.disposingElements=!1,Promise.all(e)}push(e){let t=this.disposables;t.push(e);let i=e.dispose.bind(e),a=o.create(()=>{let i=t.indexOf(e);-1!==i&&t.splice(i,1)});return e.dispose=()=>{a.dispose(),i()},a}pushAll(e){return e.map(e=>this.push(e))}constructor(...e){(0,a._)(this,"disposables",[]),(0,a._)(this,"disposingElements",!1),e.forEach(e=>this.push(e))}}},74876:function(e,t,i){"use strict";i.d(t,{b:function(){return s}});var a=i(61268);class o{encode(e){return a.Buffer.from(e).toString("base64")}decode(e){return a.Buffer.from(e,"base64")}}let s=new o},96827:function(e,t,i){"use strict";i.d(t,{D:function(){return s}});var a=i(33344);class o{md5(e){return(0,a.MD5)(e).toString()}}let s=new o},82066:function(e,t,i){"use strict";i.d(t,{W:function(){return l}});var a=i(66084),o=i(60445),s=i(56607),n=i(92235);class r{getPowerUpWebOrigin(){return s.o.isProd?this.POWER_UP_WEB_HOST:s.o.host}getShareToolPageUrl(e){let t=this.getUrlByPath(o.Pg.shareForTool);return t.searchParams.append("id",e),t.toString()}getToolsSquarePageUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getUrlByPath(o.Pg.tools);return Object.entries(e).forEach(e=>{let[i,a]=e;t.searchParams.append(i,a)}),t.toString()}getLandingPage(){let e=new URL(n.m.getWebOrigin());return e.pathname=o.oo.powerup,e.toString()}getToolDetailPage(e,t){return this.getUrlByPath("".concat(o.Pg.tools,"/").concat(e,"-").concat(encodeURIComponent(t.replaceAll(/[-\s]+/g,"_").slice(0,40)))).toString()}getUrlByPath(e){let t=new URL(this.getPowerUpWebOrigin());return t.pathname=s.o.isProd?e.replace(/^\/powerup/,""):e,t}constructor(){(0,a._)(this,"POWER_UP_WEB_HOST","https://powerup.monica.im")}}let l=new r},43939:function(e,t,i){"use strict";i.d(t,{d:function(){return u}});var a=i(71576),o=i(34491),s=i(67061),n=i(56607),r=i(78716),l=i.n(r),d=i(46731),c={drawerTitle:"drawer-title--Mzs8g",drawer:"drawer--GXMmH",visible:"visible--JUSpZ",drawerHeader:"drawer-header--KCdXC",drawerHeaderRight:"drawer-header-right--ic0Jm",drawerClose:"drawer-close--Y2Vlj",drawerBody:"drawer-body--N8Vx1",drawerHorizontal:"drawer-horizontal--IU4dU",drawerCloseArea:"drawer-close-area--wUDam",drawerMask:"drawer-mask--od0gH",desktop:"desktop--GX_pE"},h=i(66084),g=i(52921),p=i(11989),A=i(77233);class m extends o.PN{handleClose(e){e.stopPropagation(),e.preventDefault(),this.props.onDispose()}onViewCreate(){this.keydownHelper.init({handleKeydown:e=>{p.t.isHotkey(e,["esc"])&&this.props.closeWhenEsc&&(this.props.onDispose(),e.preventDefault(),e.stopPropagation())}})}onViewDestroy(){this.keydownHelper.destroy()}constructor(...e){super(...e),(0,h._)(this,"props",void 0),(0,h._)(this,"keydownHelper",new A.T),(0,h._)(this,"someState",!0)}}(0,g.gn)([o.SB],m.prototype,"someState",void 0);let u=o._Y.createComponent("Drawer",m,e=>{let{className:t,bodyClassName:i,title:o,hiddenHeader:r,titleClassName:h,height:g="90%",maxHeight:p=960,visible:A,children:m,zIndex:u,style:f,titleSlot:y,enableHorizontalStyle:v=!1,headerStyle:w,vertical:C,closeIconProps:b}=e.props,S=v&&"horizontal"===s.L.mainWindowMode||n.o.isWeb&&!C;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:l()(c.drawer,{[c.visible]:A,[c.drawerHorizontal]:S,[c.desktop]:n.o.isDesktop},t),style:{...S?{width:"42%",maxWidth:760,minWidth:"min(100%,450px)",height:"100%",maxHeight:"100%"}:{width:"100%",height:g,maxHeight:"min(100%,".concat(p,")")},zIndex:u?u+1:void 0,position:n.o.isWeb?"fixed":"absolute",...f},children:A?(0,a.jsxs)(a.Fragment,{children:[!r&&(0,a.jsxs)("div",{className:c.drawerHeader,style:w,children:[(0,a.jsx)("div",{className:l()(c.drawerTitle,h),children:o}),(0,a.jsxs)("div",{className:c.drawerHeaderRight,children:[y,(0,a.jsx)("span",{className:c.drawerClose,onClick:t=>{e.handleClose(t)},children:(0,a.jsx)(d.J,{size:null==b?void 0:b.size,name:"monicaClose",color:(null==b?void 0:b.color)||"currentColor"})})]})]}),(0,a.jsx)("div",{className:l()(c.drawerBody,i),children:m})]}):null}),A?(0,a.jsx)("div",{className:l()(c.drawerMask,{[c.desktop]:n.o.isDesktop}),style:{zIndex:u,position:n.o.isWeb?"fixed":"absolute"},children:(0,a.jsx)("div",{className:c.drawerCloseArea,onMouseDown:t=>{e.handleClose(t)}})}):null]})})},77313:function(e,t,i){"use strict";i.d(t,{jp:function(){return m},$1:function(){return u}});var a=i(71576),o=i(34491),s=i(46731),n=i(88882),r=i(78716),l=i.n(r),d=i(62499),c=i(80670),h=i(66084),g=i(52921);class p extends o.PN{onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,h._)(this,"props",void 0),(0,h._)(this,"open",!1)}}(0,g.gn)([o.SB],p.prototype,"open",void 0);let A=Array.from({length:216},(e,t)=>t<9?"a0".concat(t+1):"a".concat(t+1)).filter(e=>!["a15","a68","a49","a51","a66"].includes(e)).concat(["earth-2","rockets","upgradeIntelligence","settingYes","interlligentMatch","analyze","linkExtract","dataExtract","listExtract","marketing","tool-analyst","student","tool-entrepreneur"]),m="a11",u=o._Y.createComponent("IconPicker",p,e=>{let{disabled:t,className:i,iconSize:o,placement:n="bottomRight"}=e.props;return(0,a.jsx)(c.J,{placement:n,trigger:"click",open:e.open,onOpen:()=>{e.open=!0},content:(0,a.jsx)(f,{vm:e}),insertTarget:e.props.insertTarget,spacing:45,children:(0,a.jsx)("div",{className:l()("icon-picker--qH8L_",i,{"icon-picker-disabled--PXds4":t}),onClick:e=>{t&&e.stopPropagation()},children:(0,a.jsx)(s.J,{name:e.props.value,size:o||16,color:"currentColor"})})})}),f=(0,d.Pi)(e=>{let{vm:t}=e,{onChange:i,value:o,theme:r,iconListClassName:d}=t.props;return(0,a.jsxs)("div",{className:l()("content--SgVLw",{"theme-loose--lKlIy":"loose"===r}),children:[(0,a.jsxs)("div",{className:"header--W8JC7",children:[n.S.Global.components.IconPicker.icon,(0,a.jsx)("span",{className:"close--x4c74",onClick:()=>{t.open=!1},children:(0,a.jsx)(s.J,{name:"close",size:20,color:"var(--theme-icon-tertiary)"})})]}),(0,a.jsx)("div",{className:l()("icon-list--Uc1Lw",d),children:A.map(e=>(0,a.jsx)("div",{className:l()("icon--Ngw7t",{"icon-active--Mou9O":o===e}),onClick:()=>{null==i||i(e),t.open=!1},children:(0,a.jsx)(s.J,{name:e,size:16,color:"currentColor"})},e))}),t.open&&null]})})},49712:function(e,t,i){"use strict";i.d(t,{u:function(){return x}});var a=i(71576),o=i(34491),s=i(4461),n=i(68104),r=i(46731),l=i(44069),d=i(5857),c=i(25032),h=i(11502),g=i(15851),p=i(77397),A=i(82005),m=i(92235),u=i(78716),f=i.n(u),y={"link-copied-dialog-wrap":"link-copied-dialog-wrap--gmFke",linkCopiedDialogWrap:"link-copied-dialog-wrap--gmFke","link-copied-dialog":"link-copied-dialog--U9acu",linkCopiedDialog:"link-copied-dialog--U9acu",header:"header--YxIeD","close-btn":"close-btn--dwD_t",closeBtn:"close-btn--dwD_t",badge:"badge--dS8KR",main:"main--L2Oko",desc:"desc--v6xwZ","copy-link":"copy-link--ShBSb",copyLink:"copy-link--ShBSb","copy-text":"copy-text--UIWdW",copyText:"copy-text--UIWdW","copy-btn":"copy-btn--OL77Z",copyBtn:"copy-btn--OL77Z",footer:"footer--qRP5W",platforms:"platforms--n9OJt","platform-label":"platform-label--O6yZW",platformLabel:"platform-label--O6yZW","platform-icon":"platform-icon--JIBiy",platformIcon:"platform-icon--JIBiy",platform:"platform--wKYJr",Facebook:"Facebook--CV4lS",facebook:"Facebook--CV4lS",LinkedIn:"LinkedIn--DuFHb",linkedIn:"LinkedIn--DuFHb",Twitter:"Twitter--wTd2Y",twitter:"Twitter--wTd2Y",WhatsApp:"WhatsApp--slG1J",whatsApp:"WhatsApp--slG1J",Telegram:"Telegram--Ui7Y7",telegram:"Telegram--Ui7Y7",Default:"Default--OsR4K",default:"Default--OsR4K",active:"active--hewIc","text-preview":"text-preview--gNAP4",textPreview:"text-preview--gNAP4",preview:"preview--oB6yR","share-btn":"share-btn--Cdei4",shareBtn:"share-btn--Cdei4","share-text":"share-text--wfBP2",shareText:"share-text--wfBP2",content:"content--CGJi_"},v=i(66084),w=i(52921),C={src:"https://assets.monica.im/home-web/_next/static/media/lcFacebook.92278bbd.png",height:81,width:80,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAP1BMVEUqZPdzmPctZfMvaPlMaXEqY/KUsPkqY/QuZ/grZPbb5Py4y/t9n/ddh/UyafcmZf/w9P6wxfumvfrb5f0nY/w9nlx5AAAADnRSTlP0/L22ADb+J6fj/v76+SJv6eMAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA/SURBVHicFcpJEsAgCADBMYJAFtDk/39NeetDI+YRboJFZVYYXu28nnLIucaXbLQxE3qNd93VUXZGET3gUPkBVM8CMM4JqvAAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},b={src:"https://assets.monica.im/home-web/_next/static/media/lcLinkedIn.e8906eb9.png",height:80,width:81,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEUHZMG30u0IZsQGZcRMaXEJZMAIZ8SMt+IIZcQMZb0JZ8YTbMYOb9EMbc6ixehxpdvJ3fKjxujr8vrbcm5SAAAAC3RSTlP4/eTeADal/Lcn8tzUB78AAAAJcEhZcwAACxMAAAsTAQCanBgAAAA9SURBVHicHYtbEoAwCMQWpQVc+tD7H9ahf5lJAg0HvCniSmI8DT1tfzIcN22+QhSsZUSpKZZ+Ylas0c/+A0VAAesHfA82AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},S={src:"https://assets.monica.im/home-web/_next/static/media/lcTelegram.58d50fb5.png",height:81,width:80,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAASFBMVEUbouUlpOIqrvMnpuQjoeAnq/BVt+YmpOEjoeNMaXElpOMkpOEprO4rs/mk2fMjq+4rquo6r+qN0PAUm9xrw+/f8fv///+74vaxv5G4AAAADXRSTlP94rGjNvP79ScAvbHkIwmn9AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAENJREFUeJwVyUkSwCAIBMAxooAGcMny/5+m0teGSk4pi0JOG4gkOAyoNTrKuPz2zShz+bM2/zXfig4qBgQTlBpzI/0AURUCSRUjMPwAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},I={src:"https://assets.monica.im/home-web/_next/static/media/lcTwitter.11ec78e6.png",height:80,width:81,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEUbGxtUVFRAQEBfX19MaXEXFxcaGhoaGhobGxsZGRkcHBwXFxcaGhoXFxdxcXEpKSkgICBV+ZCvAAAADXRSTlP9/fr8ADa59Sfhoa7tk3PIPwAAAAlwSFlzAAALEwAACxMBAJqcGAAAADtJREFUeJw1y0kCwCAIBMF2QcBklP+/NqfUvZjxOMsmkYVwY6u127VI1TnISRjnytnqtw0tIpHqNf7+AUTYAfChYsPeAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},_={src:"https://assets.monica.im/home-web/_next/static/media/lcWhatsApp.9ed9cc3c.png",height:81,width:80,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEUi1GUl02Um1mhg349MaXEh1GQj0GUm12hI2X4m0mUn2Wki4Glo4ZUl1Gc12HF+5aTR1TOuAAAAC3RSTlPjJ6f8APY28/q9thgMq/EAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA8SURBVHicFcbHEcAwDAMwqrpQkvffNhe8ABcFVBwCzhAC5S4zKlbX65r4Y+9N4NKqNi9ysZsr4XkiTvoHPiwB7ZhZ8FUAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},T=i(88882),k=i(73047);class E extends o.PN{get S(){return T.S.Global.components.LinkCopiedDialog}get platforms(){return[{name:"Default",width:0,height:0,url:"",label:this.S.default},{name:"WhatsApp",width:650,height:750,url:"https://wa.me",logo:(0,s.Q)(_)},{name:"Telegram",width:650,height:750,url:"https://t.me/share/url",logo:(0,s.Q)(S)},{name:"Facebook",width:650,height:750,url:"https://www.facebook.com",logo:(0,s.Q)(C)},{name:"Twitter",width:680,height:650,url:"https://twitter.com/compose/tweet",logo:(0,s.Q)(I)},{name:"LinkedIn",width:500,height:720,url:"https://www.linkedin.com",logo:(0,s.Q)(b)}]}onViewCreate(){m.m.copyToClipboard(this.props.shareText.Default)}getCurrentShareCount(){return this.props.shareText[this.activeChannel]}share2SocialMedia(e){let t=this.getCurrentShareCount();m.m.copyToClipboard(t);let i=e.url;"Twitter"===e.name&&(i=m.m.genUrl(e.url,{text:t})),"WhatsApp"===e.name&&(i=m.m.genUrl(e.url,{text:t})),"Telegram"===e.name&&(i=m.m.genUrl(e.url,{url:this.props.shareLink,text:t})),this.createWindow(i,e.width,e.height)}createWindow(e,t,i){let a=window.screen.width/2-t/2,o=window.screen.height/2-i/2,s="width=".concat(t,",height=").concat(i,",top=").concat(o,",left=").concat(a);window.open(e,"_blank",s)}onViewDestroy(){}handleShare(){h.M.createUserBehaviorEvent({eventName:"".concat(this.props.source,"_click"),extData:{page:m.m.underlizeKey(this.activeChannel,!0),button:"send"}});let e=this.platforms.find(e=>e.name===this.activeChannel);e&&"Default"!==this.activeChannel&&this.share2SocialMedia(e)}handleCopyUrl(){this.copiedUrl||(h.M.createUserBehaviorEvent({eventName:"".concat(this.props.source,"_click"),extData:{page:m.m.underlizeKey(this.activeChannel,!0),button:"copy_url"}}),this.copiedUrl=!0,m.m.copyToClipboard(this.props.shareLink),g.M.success(this.S.copied,this.props.insertTarget),setTimeout(()=>{this.copiedUrl=!1},3e3))}handleCopy(){h.M.createUserBehaviorEvent({eventName:"".concat(this.props.source,"_click"),extData:{page:m.m.underlizeKey(this.activeChannel,!0),button:"copy_text"}}),this.platforms.find(e=>e.name===this.activeChannel)&&(m.m.copyToClipboard(this.props.shareText[this.activeChannel]),g.M.success(this.S.copied,this.props.insertTarget))}constructor(...e){super(...e),(0,v._)(this,"props",void 0),(0,v._)(this,"activeChannel","Default"),(0,v._)(this,"copiedUrl",!1)}}(0,w.gn)([o.SB],E.prototype,"activeChannel",void 0),(0,w.gn)([o.SB],E.prototype,"copiedUrl",void 0),(0,w.gn)([k.Fl],E.prototype,"S",null),(0,w.gn)([k.Fl],E.prototype,"platforms",null);let M=o._Y.createComponent("LinkCopiedDialog",E,e=>{let t=e.getCurrentShareCount();return(0,a.jsx)(n.u,{wrapperClassName:y.linkCopiedDialogWrap,className:y.linkCopiedDialog,onDispose:()=>{e.props.onDisposed()},fixed:"dialogRoot"===e.props.insertTarget,closeIconVisible:!1,children:(0,a.jsxs)("main",{className:y.main,children:[(0,a.jsxs)("div",{className:y.header,children:[(0,a.jsx)("div",{className:y.title,children:e.S.title}),(0,a.jsx)("div",{className:y.closeBtn,onClick:()=>{e.props.onDisposed()},children:(0,a.jsx)(r.J,{name:"close",size:20})})]}),(0,a.jsx)("div",{className:y.desc,children:e.S.info}),(0,a.jsxs)("div",{className:y.copyLink,children:[(0,a.jsx)("div",{className:y.copyText,children:(0,a.jsx)(l.x,{text:e.props.shareLink})}),(0,a.jsx)(d.z,{type:"primary",onClick:()=>{e.handleCopyUrl()},className:y.copyBtn,children:e.copiedUrl?e.S.copied:e.S.copy})]}),(0,a.jsxs)("footer",{className:y.footer,children:[(0,a.jsx)("div",{className:y.platforms,children:e.platforms.map(t=>(0,a.jsx)("div",{className:f()(y.platform,y[t.name],{[y.active]:e.activeChannel===t.name}),onClick:()=>{e.activeChannel=t.name},children:"Default"===t.name?(0,a.jsx)("div",{className:y.platformLabel,children:t.label}):(0,a.jsx)(s.E,{className:y.platformIcon,src:t.logo,alt:t.name})},t.name))}),(0,a.jsxs)("div",{className:y.textPreview,onClick:()=>{e.handleCopy()},children:[(0,a.jsxs)("div",{className:y.header,children:[(0,a.jsx)("span",{className:y.preview,children:e.S.textPreview}),"Default"===e.activeChannel?(0,a.jsx)(c.X,{className:y.operationItem,showTooltip:!1,text:t,render:(t,i)=>(0,a.jsxs)(d.z,{className:y.shareBtn,type:"text-primary",onClick:t=>{t.stopPropagation(),h.M.createUserBehaviorEvent({eventName:"".concat(e.props.source,"_click"),extData:{page:"default",button:"copy"}}),g.M.success(e.S.copied,e.props.insertTarget),i()},children:[(0,a.jsx)("span",{children:t?e.S.copied:e.S.copy}),(0,a.jsx)(r.J,{name:t?"checked":"copy",size:14,color:"currentColor"})]})}):(0,a.jsxs)(d.z,{className:y.shareBtn,type:"text-primary",onClick:t=>{t.stopPropagation(),e.handleShare()},children:[(0,a.jsx)("span",{children:e.S.send}),(0,a.jsx)(r.J,{name:"openLink",size:14,color:"currentColor"})]})]}),(0,a.jsx)(p.j,{onViewCreate:()=>{h.M.createUserBehaviorEvent({eventName:"".concat(e.props.source,"_show"),extData:{page:m.m.underlizeKey(e.activeChannel,!0)}})},children:(0,a.jsx)("div",{className:y.shareText,children:t})},e.activeChannel)]})]})]})})}),x=A.t.createOpener(M)},27181:function(e,t,i){"use strict";i.d(t,{Z:function(){return v}});var a=i(71576),o=i(34491),s=i(4461),n=i(82005),r={src:"https://assets.monica.im/home-web/_next/static/media/google.8b5dec0b.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEWQUQD1uw3/AABLhf/lUT01qFToRTlMaXFBjf5DqVJAkb8zrDq2wSD/ORf/lBD/OBU4qFRMie7pRjpKjv+ZlRAeAAAAFHRSTlMBmgIsMp+gAH0u2YKeTJyD6D/p9KGY8N0AAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA6SURBVHicHYtJFoAwDIV+bRMSZ+397+qLbNiAkCgkhvv4/fp1sIh2EvEg2k7MQORt29orSrMs1y7xATztAakg7oJaAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},l=i(92235),d=i(60445),c=i(66952),h=i(68104),g={loginDialog:"login-dialog--zThuo",googleBtn:"google-btn--XmjaA",chromeImg:"chrome-img--RxlP0",or:"or--UFOEw",line:"line--_PV5K",getStartedEmail:"get-started-email--kcYsK"},p=i(66084),A=i(52921),m=i(88882),u=i(73047);class f extends o.PN{get S(){return m.S.Global.components.LoginDialog}onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,p._)(this,"props",void 0),(0,p._)(this,"someState",!0)}}(0,A.gn)([o.SB],f.prototype,"someState",void 0),(0,A.gn)([u.Fl],f.prototype,"S",null);let y=o._Y.createComponent("LoginDialog",f,e=>(0,a.jsxs)(h.u,{onDispose:e.props.onDisposed,className:g.loginDialog,width:410,children:[(0,a.jsx)(c.T,{size:38,showTitle:!0,gap:15,titleSize:24}),(0,a.jsxs)("div",{className:g.googleBtn,onClick:()=>{window.location.href=l.m.genUrl(d.Cl.login,{redirectTo:window.location.href}),e.props.onDisposed()},children:[(0,a.jsx)(s.E,{src:r,className:g.chromeImg,style:{width:24,height:24},alt:""}),(0,a.jsx)("div",{children:e.S.getStarted})]}),(0,a.jsxs)("div",{className:g.or,children:[(0,a.jsx)("div",{className:g.line}),e.S.or,(0,a.jsx)("div",{className:g.line})]}),(0,a.jsxs)("div",{className:g.getStartedEmail,onClick:()=>{window.location.href=l.m.genUrl(d.Cl.login,{redirectTo:window.location.href}),e.props.onDisposed()},children:["\uD83D\uDCEE ",e.S.signUpEmail]})]})),v=n.t.createOpener(y)},66952:function(e,t,i){"use strict";i.d(t,{T:function(){return f}});var a=i(71576),o=i(34491),s=i(56607),n=i(78716),r=i.n(n),l={logo:"logo--UAJo4",textWrap:"text-wrap--H_Kw0",title:"title--DkvTU",featureName:"feature-name--UATBE"},d=i(4461),c=i(93270),h=i(46731),g=i(66084),p=i(52921);class A extends o.PN{onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,g._)(this,"props",void 0),(0,g._)(this,"someState",!0)}}(0,p.gn)([o.SB],A.prototype,"someState",void 0);let m=o._Y.createComponent("LogoIcon",A,e=>{let{scene:t,size:i,className:o,onClick:n}=e.props;return"featureEntry"===t?(0,a.jsx)(h.J,{name:"monica",className:o,size:i,onClick:n}):(0,a.jsx)(d.E,{src:c.Z,className:r()(o),draggable:"false",style:{width:i,height:i,borderRadius:4},alt:s.o.productName,onClick:n})});class u extends o.PN{onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,g._)(this,"props",void 0),(0,g._)(this,"someState",!0)}}(0,p.gn)([o.SB],u.prototype,"someState",void 0);let f=o._Y.createComponent("Logo",u,e=>{let{showTitle:t=!1,size:i,titleSize:o=20,gap:n=16,className:d,titleClassName:c,title:h,featureName:g,scene:p,onClick:A,hideTitle:u=!1}=e.props,f="featureEntry"===p?i||20:i||32;return t?(0,a.jsxs)("div",{className:r()(l.logo,d),style:{gap:n},onClick:A,children:[(0,a.jsx)(m,{size:f}),(0,a.jsxs)("div",{className:l.textWrap,children:[!u&&(0,a.jsx)("span",{className:r()(l.title,c),style:{fontSize:o},children:h||s.o.productName}),!!g&&(0,a.jsx)("span",{className:l.featureName,children:g})]})]}):(0,a.jsx)(m,{className:d,scene:p,size:f,onClick:A})})},28371:function(e,t,i){"use strict";i.d(t,{j:function(){return b}});var a=i(71576),o=i(34491),s=i(4461),n=i(62499),r=i(68104),l=i(5857),d=i(46731),c=i(33381),h=i(82005),g=i(11502),p={src:"https://assets.monica.im/home-web/_next/static/media/resubscribeDialogBanner.6b571690.webp",height:260,width:576,blurDataURL:"data:image/webp;base64,UklGRnQAAABXRUJQVlA4WAoAAAAQAAAABwAAAwAAQUxQSA0AAAABD3D8/4iIMIAR/Y8EAFZQOCBAAAAA0AEAnQEqCAAEAAJAOCWIAnQBFKNTtqAA/vrlUr8vsz/yg3YJ39l9VqtDKEtc0bjx779hpFhQ7R3fn+J8KgAAAA==",blurWidth:8,blurHeight:4},A=i(66084),m=i(52921),u=i(88882),f=i(73047),y=i(47720);class v extends o.PN{get S(){return u.S.Global.components.Paywalls.ResubscribeDialog}get price(){var e;let{trialVersion:t}=null!==(e=c.userController.userVipStatus)&&void 0!==e?e:{};return y.serverConfigController.getPlan("starter"===t?"starter_yearly":"elite_yearly").originPrice}get features(){return[this.S.feature1,this.S.feature2,(0,u.x)(this.S.feature3,{price:this.price}),this.S.feature4]}onViewCreate(){g.M.createUserBehaviorEvent({eventName:"upgrade_popup_show",extData:{detail:"resubscribe_dialog"}})}onViewDestroy(){}constructor(...e){super(...e),(0,A._)(this,"props",void 0),(0,A._)(this,"someState",!0)}}(0,m.gn)([o.SB],v.prototype,"someState",void 0),(0,m.gn)([f.Fl],v.prototype,"S",null),(0,m.gn)([f.Fl],v.prototype,"price",null),(0,m.gn)([f.Fl],v.prototype,"features",null);let w=o._Y.createComponent("ResubscribeDialog",v,e=>(0,a.jsxs)(r.u,{className:"resubscribe-dialog--j7khu",onDispose:e.props.onDisposed,fixed:"dialogRoot"===e.props.insertTarget,width:328,closeOnMaskClick:!1,closeOffset:8,closeOffsetY:8,children:[(0,a.jsx)("div",{className:"title--HKdve",children:e.S.title}),(0,a.jsx)(s.E,{src:p,alt:"",className:"banner--ItHO5"}),(0,a.jsx)(C,{vm:e}),(0,a.jsx)(l.z,{type:"primary",size:"large",className:"button--ZUF7D",loading:c.userController.resubscribeLoading,onClick:async()=>{let t="resubscribe_dialog";g.M.createUserBehaviorEvent({eventName:"upgrade_popup_click",extData:{detail:t}}),await c.userController.resubscribe(t),e.props.onDisposed()},children:e.S.activateForFree})]})),C=(0,n.Pi)(function(e){let{vm:t}=e;return(0,a.jsx)("div",{className:"features--n6Ht2",children:t.features.map(e=>(0,a.jsxs)("div",{className:"feature--fGkuj",children:[(0,a.jsx)("div",{className:"icon--alPZJ",children:(0,a.jsx)(d.J,{name:"circleCheckboxChecked",size:18})}),(0,a.jsx)("div",{className:"feature-text--Mbhxx",children:e})]},e))})}),b=h.t.createOpener(w)},53533:function(e,t,i){"use strict";i.d(t,{A:function(){return x}});var a=i(71576),o=i(34491),s=i(4461),n={src:"https://assets.monica.im/home-web/_next/static/media/unlimitedIcon.e09df21b.webp",height:31,width:63,blurDataURL:"data:image/webp;base64,UklGRn4AAABXRUJQVlA4WAoAAAAQAAAABwAAAwAAQUxQSCEAAAAALcLDMym+xznCRTrb20U228c4LdzeNijmOdHSQDXX51kAVlA4IDYAAACQAQCdASoIAAQAAkA4JagCdLoAA5gA5D/w7efaUFBAWf/nIs9EP2n+4b94H0XXcwD6LHYAAAA=",blurWidth:8,blurHeight:4},r=i(92235),l=i(95782),d=i(92660),c=i(53040),h=i(5857),g=i(82005),p=i(68104),A={seoInstallGuideDialog:"seo-install-guide-dialog--OpUiY",title:"title--qzHIB",getTitle:"get-title--Jyusn",unlimitedIcon:"unlimited-icon--ltiwa",desc:"desc--Juto3",banner:"banner--T0AF0",buttonLink:"button-link--kwHpN",button:"button--MEFtT",pic:"pic--MeI1k"},m=i(66084),u=i(52921),f={src:"https://assets.monica.im/home-web/_next/static/media/bypass.4f14baf1.webp",height:472,width:700,blurDataURL:"data:image/webp;base64,UklGRmYAAABXRUJQVlA4WAoAAAAQAAAABwAABAAAQUxQSA0AAAABD/D+/4iIMIER/Y8IAFZQOCAyAAAAcAEAnQEqCAAFAAJAOCUAAFOfbmAA/vyahxtr080X51/AWoUH6vfa9xPGoyCkWDgAAAA=",blurWidth:8,blurHeight:5},y={src:"https://assets.monica.im/home-web/_next/static/media/chatCompare.de98f526.webp",height:472,width:700,blurDataURL:"data:image/webp;base64,UklGRjwAAABXRUJQVlA4IDAAAACwAQCdASoIAAUAAkA4JYwCdAD0cgOAAP788spq/dkOuwhidHYn/slHompw6BQAAAA=",blurWidth:8,blurHeight:5},v={src:"https://assets.monica.im/home-web/_next/static/media/imageGen.01a5d9a4.webp",height:496,width:725,blurDataURL:"data:image/webp;base64,UklGRo4AAABXRUJQVlA4WAoAAAAQAAAABwAABAAAQUxQSCgAAAABL6CQbQTI3/M+ieU0IiIuGFATAAkDmGD+VqF/LjtE9D820wHc30wDVlA4IEAAAADwAQCdASoIAAUAAkA4JZQCdH8AGBTe9QAA/mbfC6BreIoEjoqGBXoyyJfIGtW3cEiywQ8AWKEov1xJqpICAAAA",blurWidth:8,blurHeight:5},w={src:"https://assets.monica.im/home-web/_next/static/media/mindmap.f5ab86d8.webp",height:472,width:700,blurDataURL:"data:image/webp;base64,UklGRmQAAABXRUJQVlA4WAoAAAAQAAAABwAABAAAQUxQSA0AAAABD/D+/4iIMIER/Y8IAFZQOCAwAAAAsAEAnQEqCAAFAAJAOCWUAAL3gtAIgAD+/Ug6y9z2o86ZBvIALLBwTy2ruIQ9AAAA",blurWidth:8,blurHeight:5},C={src:"https://assets.monica.im/home-web/_next/static/media/paywallsChatPdf.1fd894f6.png",height:472,width:701,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAFVBMVEXr8P34+Pvw9Pvo6ezu7/P//v746ulJ8n9wAAAAAXRSTlP+GuMHfQAAAAlwSFlzAAALEwAACxMBAJqcGAAAACVJREFUeJwVxrERAAAIArFHwP1H9kwV0DygayeAtq0AR9IntjMcB/8AWqAUGtIAAAAASUVORK5CYII=",blurWidth:8,blurHeight:5},b={src:"https://assets.monica.im/home-web/_next/static/media/paywallsPodcast.407a6953.png",height:472,width:701,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAPFBMVEXp5/Px7fvu7/BfZWv////i4e/p4v/y8fbh2P718v5FPjTy8vS2wc3U2eSxtLxTX2i8r6OhmJVmVULU2+klcLBsAAAACXRSTlP+/////////P41HOCJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAALklEQVR4nAXBhQEAIAwDsM4ZLv//SoLioEwvMBClpgOsNuwZomlftR4E6xS5+wMVaQEhRw2rYQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:5},S={src:"https://assets.monica.im/home-web/_next/static/media/videoGen.ce9274f3.webp",height:467,width:701,blurDataURL:"data:image/webp;base64,UklGRoIAAABXRUJQVlA4WAoAAAAQAAAABwAABAAAQUxQSBcAAAABH3D//4iIBYGkzVjH8f5dHiKi/yG/AABWUDggRAAAABACAJ0BKggABQACQDglsAJ0ugADN5SeD2AA/miqO1b+QUyGzSkhV1VnEMPQuM2PupI+3AqwtnFh/Om5XuDN7NmIAAAA",blurWidth:8,blurHeight:5},I={src:"https://assets.monica.im/home-web/_next/static/media/youtubeSummary.2ceecacf.webp",height:472,width:700,blurDataURL:"data:image/webp;base64,UklGRmQAAABXRUJQVlA4WAoAAAAQAAAABwAABAAAQUxQSA0AAAABD/D+/4iIMIER/Y8IAFZQOCAwAAAAsAEAnQEqCAAFAAJAOCWUAuwA9G0boAD+8LOizPs8ybxtJx7+q8hEiZApUJwYcAAA",blurWidth:8,blurHeight:5},_=i(88882),T=i(861),k=i(38172);class E extends o.PN{get guideMode(){return"quota"===this.props.scene&&r.m.getIsMobile()?"app":"extension"}get guideToApp(){return"app"===this.guideMode}get S(){return _.S.Global.components.Paywalls.SeoInstallGuideDialog}get uiData(){let e="",t="",i="";switch(this.props.featureName){case"youtubeSummary":e=this.S.getYoutubeSummary,t=this.S.getYoutubeSummaryDesc,i=(0,s.Q)(I);break;case"imageGenerate":e=this.S.getImageGen,t=this.S.getImageGenDesc,i=(0,s.Q)(v);break;case"mindmap":e=this.S.getMindmap,t=this.S.getMindmapDesc,i=(0,s.Q)(w);break;case"animationGenerate":e=this.S.getVideoGen,t=this.S.getVideoGenDesc,i=(0,s.Q)(S);break;case"bypass":e=this.S.getBypass,t=this.S.getBypassDesc,i=(0,s.Q)(f);break;case"pdfUploadLimit":e=this.S.getChatPdf,t=this.S.getChatPdfDesc,i=(0,s.Q)(C);break;case"aiPodcast":e=this.S.getPodcast,t=this.S.getPodcastDesc,i=(0,s.Q)(b);break;case"bypassExport":e=this.S.bypassExport,t=this.S.bypassExportDesc,i=(0,s.Q)(f);break;case"chatCompare":case"aiMathResolver":e=this.S.chatCompare,t=this.S.chatCompareDesc,i=(0,s.Q)(y)}return{title:e,desc:t,bannerPic:i}}get buttonLink(){return this.guideToApp?this.mobileDownloadUrl[this.props.featureName]||T.n.seoMobileGuideUrl.default:r.m.getExtensionInstallUrl(this.props.source)}onViewCreate(){this.createUserBehaviorEvent("show")}onViewDestroy(){}createUserBehaviorEvent(e){k.W.createUserBehaviorEvent({eventName:"ext_install_guide_dialog_".concat(e),source:this.props.source,extData:{scene:this.props.scene}})}constructor(...e){super(...e),(0,m._)(this,"props",void 0),(0,m._)(this,"mobileDownloadUrl",{youtubeSummary:T.n.seoMobileGuideUrl.youtubeSummary,imageGenerate:T.n.seoMobileGuideUrl.text2pic,animationGenerate:T.n.seoMobileGuideUrl.pic2video,mindmap:T.n.seoMobileGuideUrl.mindmap,bypass:T.n.seoMobileGuideUrl.bypass,pdfUploadLimit:T.n.seoMobileGuideUrl.chatpdf,aiPodcast:T.n.seoMobileGuideUrl.podcast,bypassExport:T.n.seoMobileGuideUrl.bypass,chatCompare:T.n.seoMobileGuideUrl.chatCompare,aiMathResolver:T.n.seoMobileGuideUrl.aiMathResolver}),(0,m._)(this,"someState",!0)}}(0,u.gn)([o.SB],E.prototype,"someState",void 0),(0,u.gn)([o.Fl],E.prototype,"guideMode",null),(0,u.gn)([o.Fl],E.prototype,"guideToApp",null),(0,u.gn)([o.Fl],E.prototype,"S",null),(0,u.gn)([o.Fl],E.prototype,"uiData",null),(0,u.gn)([o.Fl],E.prototype,"buttonLink",null);let M=o._Y.createComponent("SeoInstallGuideDialog",E,e=>{let{insertTarget:t,onDisposed:i,featureName:o}=e.props,{title:g,desc:m,bannerPic:u}=e.uiData;return(0,a.jsxs)(p.u,{fixed:"dialogRoot"===t||"body"===t,onDispose:i,className:A.seoInstallGuideDialog,width:520,closeOffset:r.m.getIsMobile()?8:void 0,children:[(0,a.jsx)("div",{className:A.title,children:e.guideToApp?e.S.appTitle:e.S.dialogTitle}),g&&(0,a.jsxs)("div",{className:A.getTitle,children:["mindmap"===o&&(0,a.jsx)(c.E,{src:(0,s.Q)(n),skeleton:!0,className:A.unlimitedIcon}),g]}),m&&(0,a.jsx)("p",{className:A.desc,children:(0,a.jsx)(l.Z,{S:m,components:{b:e=>(0,a.jsx)("strong",{children:e})}})}),(0,a.jsx)("div",{className:A.banner,children:(0,a.jsx)(c.E,{className:A.pic,skeleton:!0,src:u})}),(0,a.jsx)("a",{href:e.buttonLink,target:"_blank",className:A.buttonLink,onClick:()=>{e.props.source&&localStorage.setItem(d.storageKeys.utm,e.props.source)},rel:"noreferrer",children:(0,a.jsx)(h.z,{color:"primary",size:"large",className:A.button,onClick:()=>{e.createUserBehaviorEvent("click")},children:e.S.installNow})})]})}),x=g.t.createOpener(M,{singleton:!0})},1793:function(e,t,i){"use strict";i.d(t,{F:function(){return v}});var a=i(71576),o=i(34491),s=i(88882),n=i(95782),r=i(78716),l=i.n(r),d=i(62499),c=i(51832),h=i(33381),g=i(26712),p=i(47720),A={subscriptionList:"subscription-list--ByT_K",bordered:"bordered--gTP3I",subscriptionItem:"subscription-item--lbIoo",radio:"radio--fw4BV",radioBox:"radio-box--pVZnU",header:"header--kigCq",nameBox:"name-box--QqrgL",name:"name--lRtl4",trialTip:"trial-tip--RXkYb",discount:"discount--xSDqH",footer:"footer--wqTfK",currentPrice:"current-price--TZUO2",originPrice:"origin-price--ysaKo",black5:"black5--AJ02c",recommend:"recommend--ZSDaC",unit:"unit--bIw8d"},m=i(66084),u=i(52921),f=i(82417);class y extends o.PN{get S(){return s.S.Global.components.Paywalls.UpgradeDialog}onViewCreate(){f.abTestController.experiment.reportRecommendPlanExp()}onViewDestroy(){}constructor(...e){super(...e),(0,m._)(this,"props",void 0),(0,m._)(this,"someState",!0)}}(0,u.gn)([o.SB],y.prototype,"someState",void 0),(0,u.gn)([o.Fl],y.prototype,"S",null);let v=o._Y.createComponent("SubscriptionPrice",y,e=>{let{bordered:t=!0,itemClassName:i,showYearlyDiscount:o,showOriginPrice:s,theme:n}=e.props,r=c.recommendPlanController.activePlan;if(h.userController.isVipUser)return(0,a.jsx)(w,{vm:e,planInfo:c.recommendPlanController.activePlan,bordered:t,showTrial:!0,showFullName:e.props.showFullName,className:i,showYearlyDiscount:o,showOriginPrice:s,theme:n});let d=c.recommendPlanController.allRecommendPlans;return 1===d.length?(0,a.jsx)(w,{vm:e,planInfo:d[0],bordered:t,showTrial:!0,showFullName:e.props.showFullName,className:i,showYearlyDiscount:o,showOriginPrice:s,theme:n}):(0,a.jsx)("div",{className:l()(e.props.className,A.subscriptionList,{[A.bordered]:t}),children:d.map((t,i)=>(0,a.jsx)(w,{vm:e,planInfo:t,radio:!0,checked:r.key===t.key,handleClick:()=>{c.recommendPlanController.setActivePlan(t.key)},showTrial:!0,showFullName:e.props.showFullName,showYearlyDiscount:!0,showOriginPrice:s,theme:n},"".concat(t.key,"_").concat(i)))})}),w=(0,d.Pi)(e=>{let{className:t,vm:i,planInfo:o,bordered:r,radio:d,checked:c,showTrial:m,showFullName:u,showYearlyDiscount:f,handleClick:y,showOriginPrice:v,theme:w}=e,{fullName:C,monthlyDiscountPercent:b,moPrice:S,interval:I,yearlyDiscountPercent:_}=o,T=()=>f?"year"===I&&_?(0,a.jsx)("div",{className:A.discount,children:(0,s.x)(i.S.discount,{discount:_})}):null:b?(0,a.jsx)("div",{className:A.discount,children:(0,s.x)(i.S.discount,{discount:b})}):null,k=o.trialDay||0,E=m&&h.userController.canTrial&&k>0;return(0,a.jsxs)("div",{className:l()(t,A.subscriptionItem,{[A.recommend]:o.isRecommend,[A.bordered]:r,[A.radio]:d,[A.black5]:"black5"===w}),onClick:()=>null==y?void 0:y(),children:[d&&(0,a.jsx)("div",{className:A.radioBox,children:(0,a.jsx)(g.Y,{checked:!!c})}),(0,a.jsxs)("div",{className:A.header,children:[(0,a.jsxs)("div",{className:A.nameBox,children:[(0,a.jsx)("div",{className:A.name,children:u?C:p.serverConfigController.copywritingManager.getPlanIntervalName(o)}),E&&T()]}),E?(0,a.jsx)("div",{className:A.trialTip,children:(0,s.x)(i.S.freeTrial,{day:p.serverConfigController.trialDays})}):T()]}),(0,a.jsxs)("div",{className:A.footer,children:[(0,a.jsx)("div",{className:A.currentPrice,children:(0,a.jsx)(n.Z,{S:i.S.priceMonthly,components:{span:e=>(0,a.jsx)("span",{className:A.unit,children:e})},data:{price:S}})}),v&&o.originMoPrice?(0,a.jsx)("div",{className:A.originPrice,children:(0,a.jsx)(n.Z,{S:i.S.priceMonthly,components:{span:e=>(0,a.jsx)("span",{className:A.unit,children:e})},data:{price:o.originMoPrice}})}):null]})]})})},35850:function(e,t,i){"use strict";i.d(t,{$:function(){return B}});var a=i(71576),o=i(34491),s=i(4461),n=i(53040),r=i(46731),l=i(43939),d=i(68104),c=i(51832),h=i(25449),g=i(82005),p=i(75563),A=i(95782),m=i(56607),u=i(92235),f=i(78716),y=i.n(f),v=i(67061),w=i(40597),C=i(8492),b={logo:"logo--Ts1DN",title:"title--bstuF",upgradeDrawer:"upgrade-drawer--jOVS8",closeBtn:"close-btn--wZqk6",upgradeDrawerBody:"upgrade-drawer-body--bOUvn",body:"body--HMKDo",upgradePlanCard:"upgrade-plan-card--cN6km",upgradeDialog:"upgrade-dialog--e2NIr",dialogWrap:"dialog-wrap--kkKf6",dialogTips:"dialog-tips--FDwAP",promotionText:"promotion-text--JUqFe"},S=i(66084),I=i(52921),_=i(88882),T=i(73047),k=i(33381),E=i(11502);class M extends o.PN{get S(){return _.S.Global.components.Paywalls.UpgradeDialog}get source(){var e;return null!==(e=this.props.source)&&void 0!==e?e:"upgrade_drawer"}get currentTitle(){switch(this.props.type){case"reading":return this.S.titleForReading;case"skills":return this.S.titleForSkills;case"webAccess":return this.S.titleForWebAccess;case"proSearch":return this.S.titleForProSearch;case"artist":return this.S.titleForAiArt;case"pdfTranslation":return this.S.pdfAdvance;case"pdfPagesLimit":return this.S.pdfPagesLimit;case"imageTranslation":return this.S.titleForImageTranslation;case"pdfUploadLimit":return m.o.isChatPDF?this.S.fileUploadLimit:this.S.pdfUploadLimit;case"pdfQueryLimit":return this.S.pdfQueryLimit;case"basicQuery":return this.S.titleForMoreQuery;case"credits":return k.userController.isVipUser?this.S.titleForMoreCredits:this.S.titleForCredits;case"monicaTranslation":return this.S.titleForAiTranslate;case"animationGenerate":return this.S.titleForAnimationGenerate;case"bypass":return this.S.titleForAiBypass;case"aiPodcast":return this.S.titleForAiPodcast;case"batchProcessor":return this.S.titleForBatchProcessor;case"simpleMode":return this.S.titleForSimpleMode;default:return this.S.titleForGpt4}}onBeforeMount(){c.recommendPlanController.initPlanKey()}async onViewCreate(){k.userController.eventEmitter.listenBy(this,"markPaid",()=>{this.props.onDisposed()}),this.createUserBehaviorEvent("show")}onViewDestroy(){k.userController.eventEmitter.stopListenBy(this)}createUserBehaviorEvent(e,t){E.M.createUserBehaviorEvent({eventName:"upgrade_popup_".concat(e),extData:{detail:"upgrade_drawer",type:this.props.type,button:t,...this.props.eventData},source:this.source})}handleClose(){var e,t,i,a;null===(e=(t=this.props).onClose)||void 0===e||e.call(t),null===(i=(a=this.props).onDisposed)||void 0===i||i.call(a)}constructor(...e){super(...e),(0,S._)(this,"props",void 0),(0,S._)(this,"version","elite"),(0,S._)(this,"someState",!1)}}(0,I.gn)([o.SB],M.prototype,"someState",void 0),(0,I.gn)([T.Fl],M.prototype,"S",null),(0,I.gn)([T.Fl],M.prototype,"source",null),(0,I.gn)([T.Fl],M.prototype,"currentTitle",null);let x=o._Y.createComponent("UpgradeDialog",M,e=>{var t,i;let{insertTarget:o}=e.props,{fullName:g}=c.recommendPlanController.activePlan,f=(0,a.jsxs)(a.Fragment,{children:[!(null===(t=h.promotionController.activityConfig)||void 0===t?void 0:t.enable)&&(0,a.jsx)("div",{className:b.logo,children:(0,a.jsx)(n.E,{src:(0,s.Q)(p.Z),alt:"",width:120,height:80})}),(0,a.jsx)("h1",{className:b.title,children:(0,a.jsx)(A.Z,{S:e.currentTitle,components:{br:()=>(0,a.jsx)("br",{}),mark:e=>(0,a.jsx)("mark",{children:e})},data:{plan:g}})})]}),S=(0,a.jsx)("div",{className:y()(b.closeBtn,e.props.closeBtnClassName),onClick:()=>{e.handleClose()},children:(0,a.jsx)(r.J,{name:"sidebarClose",size:16})}),I=m.o.isWeb&&u.m.getIsMobile(),_=I||"mainWindow"===o&&"sidebar"===v.L.mainWindowMode&&window.innerHeight<1580,T=null===(i=h.promotionController.activityConfig)||void 0===i?void 0:i.themeCls;return _?(0,a.jsxs)(l.d,{onDispose:()=>{e.handleClose()},hiddenHeader:!0,maxHeight:I?"90%":"".concat(790,"px"),visible:!0,style:{borderTopRightRadius:20,borderTopLeftRadius:20},className:y()(b.upgradeDrawer,T),bodyClassName:b.upgradeDrawerBody,vertical:I,children:[f,S,(0,a.jsx)(w.h,{className:b.promotionText,theme:"upgradeDialog"}),(0,a.jsx)("div",{className:b.body,children:(0,a.jsx)(C.c,{className:b.upgradePlanCard,...e.props,onUpgradeClick:()=>{e.createUserBehaviorEvent("click","upgrade")},onViewClick:()=>{e.createUserBehaviorEvent("click","view")}})})]}):(0,a.jsxs)(d.u,{wrapperClassName:b.dialogWrap,className:y()(b.upgradeDialog,T,e.props.className),onDispose:()=>{e.handleClose()},width:560,style:e.props.modalStyle,closeIconVisible:!1,closeOnMaskClick:!1,fixed:"dialogRoot"===e.props.insertTarget,getRef:e.props.getRef,children:[f,S,(0,a.jsx)(w.h,{className:b.promotionText,fallback:(0,a.jsx)("p",{className:b.dialogTips,children:e.S.dialogTips}),theme:"upgradeDialog"}),(0,a.jsx)(C.c,{className:b.upgradePlanCard,...e.props,featureStyleMode:"card",onUpgradeClick:()=>{e.createUserBehaviorEvent("click","upgrade")},onViewClick:()=>{e.createUserBehaviorEvent("click","view")}})]})}),B=g.t.createOpener(x,{singleton:!0})},8492:function(e,t,i){"use strict";i.d(t,{c:function(){return $}});var a,o,s=i(71576),n=i(34491),r=i(78716),l=i.n(r),d=i(62499),c=i(5857),h=i(48023),g=i(53040),p=i(51832),A=i(33381),m=i(46731),u=i(1793),f={upgradePlanCard:"upgrade-plan-card--ddml0",cardStyle:"card-style--Kx6hI",features:"features--y64Lu",planCard:"plan-card--ulab0",featureBox:"feature-box--EXQef",maskBox:"mask-box--R7oKb",mask:"mask--ZJ34y",actions:"actions--dBHg6",upgradeBtn:"upgrade-btn--hOtml",viewBtn:"view-btn--NTIqI",feature:"feature--VTlKZ",lt:"lt--B21zV",rt:"rt--WMhRb",featureTitleBox:"feature-title-box--E_N7v",featureTitle:"feature-title--vPpAE",tipBox:"tip-box--Gs58g",featureIcons:"feature-icons--jd6uc",icon:"icon--pQS05",img:"img--dQ4Qy",featureDesc:"feature-desc--I6JJi"},y=i(66084),v=i(52921),w=i(4461),C=i(22046),b=i(60927),S=i(91263),I=i(49881),_=i(69131),T=i(24455),k=i(95269),E=i(13203),M=i(30408),x=i(10023),B=i(4176),D=i(27411),L=i(3415),R=i(19072),U=i(36129),P=i(59847),F=i(71110),O=i(38679),N=i(2180),V=i(54596),Q={src:"https://assets.monica.im/home-web/_next/static/media/deepseekOutline.86f2028f.png",height:27,width:36,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAMAAADJ2y/JAAAALVBMVEVScf9Maf5Na/9Oav5MaXFObf5Mav1Na/5ObP1NaftQafJNa/9Na/1NavxMav0QqWzbAAAAD3RSTlP8OIslAM1mrsJOFKbceuV6W33iAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAMUlEQVR4nAXBiQGAQAgEsVlY4B61/3JNcO5O5UHA7W8R7/BMiUhH1Zh9jxYy7iIi/QMZYQDlibPIvgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:6},z=i(10103),H=i(88882),W=i(92235),G=i(56607),j=i(28213),J=i(72891),K=i(663),q=i(87393),X=i(54560),Z=i(11502);(a=o||(o={}))[a.AdvancedMode=1]="AdvancedMode",a[a.WebAccess=2]="WebAccess",a[a.YoutubeSummary=3]="YoutubeSummary",a[a.CreateEffortlessly=4]="CreateEffortlessly",a[a.AdvancedSkills=5]="AdvancedSkills",a[a.SearchProMode=6]="SearchProMode",a[a.AiArt=7]="AiArt",a[a.PdfTranslation=8]="PdfTranslation",a[a.AiSearch=9]="AiSearch",a[a.PdfUpload=10]="PdfUpload",a[a.ImageTranslation=11]="ImageTranslation",a[a.Credits=12]="Credits",a[a.ChatCtx=13]="ChatCtx",a[a.ChatPdf=14]="ChatPdf",a[a.ImageTool=15]="ImageTool",a[a.AnimationGenerate=16]="AnimationGenerate",a[a.AiCheckerAndBypass=17]="AiCheckerAndBypass",a[a.MultiPlatformExpansion=18]="MultiPlatformExpansion",a[a.CrossPlatformExpansion=19]="CrossPlatformExpansion",a[a.Realtime=20]="Realtime",a[a.AiPodcastGeneration=21]="AiPodcastGeneration",a[a.ImageGenerate=22]="ImageGenerate",a[a.VideoGenerate=23]="VideoGenerate",a[a.RealtimeImageGenerate=24]="RealtimeImageGenerate",a[a.ScenarioImageGenerate=25]="ScenarioImageGenerate",a[a.ImageAllTools=26]="ImageAllTools",a[a.AiChat=27]="AiChat",a[a.Grammarly=28]="Grammarly",a[a.BatchProcessor=29]="BatchProcessor";class Y extends n.PN{get S(){return H.S.Global.components.Paywalls.UpgradeDialog}get features(){let e=p.recommendPlanController.activePlan.credit||0;return[{id:1,icon:"mPlanet",title:this.S.advancedModel,iconColor:"var(--theme-icon-brand)",desc:J.D.benefitText.modelDesc,tip:J.D.benefitText.modelTip,icons:[{type:"img",icon:(0,w.Q)(D.Z)},{type:"img",icon:(0,w.Q)(_.Z)},{type:"img",icon:(0,w.Q)(x.Z)},{type:"img",icon:(0,w.Q)(U.Z)},{type:"img",icon:(0,w.Q)(Q),style:{padding:"5px"}}]},{id:2,icon:"mEarth",title:this.S.webAccess,desc:this.S.webAccessDesc},{id:3,icon:"a92-e5ao0a9a",iconColor:"var(--theme-icon-brand)",title:this.S.youtubeSummary,desc:this.S.youtubeSummaryDesc},{id:4,icon:"mPen",title:this.S.createEffortlessly,desc:this.S.createEffortlesslyDesc},{id:5,icon:"mSkill",title:this.S.advancedSkills,desc:this.S.advancedSkillsDesc},{id:6,icon:"mSearch",title:this.S.searchProMode,desc:this.S.searchProModeDesc},{id:7,icon:"mBrush",title:this.S.aiArt,iconColor:"var(--theme-icon-brand)",desc:J.D.benefitText.aiArtDesc,tip:J.D.benefitText.aiArtTip,icons:[{type:"img",icon:(0,w.Q)(F.Z)},{type:"img",icon:(0,w.Q)(T.Z)},{type:"img",icon:(0,w.Q)(M.Z)},{type:"img",icon:(0,w.Q)(L.Z)},{type:"img",icon:(0,w.Q)(z.Z)}]},{id:8,icon:"fanyi3",iconColor:"var(--theme-icon-brand)",title:this.S.exportFullDocumentTranslation,desc:this.S.exportFullDocumentTranslationDesc},{id:9,icon:"mSearch",title:this.S.aiSearch,desc:this.S.aiSearchDesc},{id:10,icon:"diqiu",iconColor:"var(--theme-icon-brand)",title:this.S.pdfUpload,desc:this.S.pdfUploadDesc},{id:11,icon:"imageTranslation",iconColor:"var(--theme-icon-brand)",title:this.S.smartImageTranslation,desc:this.S.smartImageTranslationDesc},{id:12,icon:"creditsStroke",iconColor:"var(--theme-icon-brand)",title:(0,H.x)(this.S.creditsTitle,{count:e}),desc:(0,H.x)(this.S.creditsDesc,K.m.calcCreditFeatures(e))},{id:13,icon:"mPlanet",iconColor:"var(--theme-icon-brand)",title:this.S.chatCtxTitle,desc:this.S.chatCtxDesc},{id:14,icon:"pdfTool",iconColor:"var(--theme-icon-brand)",title:this.S.chatPdfTitle,desc:this.S.chatPdfDesc},{id:15,icon:"drawBrush",iconColor:"var(--theme-icon-brand)",title:this.S.imageToolTitle,desc:this.S.imageToolDesc},{id:20,icon:"erMessage",iconColor:"var(--theme-icon-brand)",title:H.S.Global.modules.Realtime.title,desc:H.S.Global.modules.Realtime.desc},{id:16,icon:"imageAnimator",iconColor:"var(--theme-icon-brand)",title:this.S.animationGenerate,desc:this.S.aiArtDesc},{id:17,icon:"mPen",iconColor:"var(--theme-icon-brand)",title:this.S.aiCheckerAndBypass,desc:this.S.aiCheckerAndBypassDesc},{id:18,icon:"LineFeatureApplication",iconColor:"var(--theme-icon-brand)",title:this.S.multiPlatformTitle,desc:this.S.multiPlatformDesc,icons:[{type:"img",icon:(0,w.Q)(B.Z)},{type:"img",icon:(0,w.Q)(P.Z)},{type:"img",icon:(0,w.Q)(V.Z)},{type:"img",icon:(0,w.Q)(E.Z)},{type:"img",icon:(0,w.Q)(R.Z)}]},{id:19,icon:"a116",iconColor:"var(--theme-icon-brand)",title:this.S.crossPlatformTitle,desc:this.S.crossPlatformDesc,icons:[{type:"img",icon:"Edge"===W.m.getBrowserName()?(0,w.Q)(k.Z):(0,w.Q)(I.Z)},{type:"img",icon:(0,w.Q)(N.Z)},{type:"img",icon:(0,w.Q)(S.Z),style:q.C.isDark?{filter:"invert(100%)"}:{}},{type:"img",icon:(0,w.Q)(b.Z)},{type:"img",icon:(0,w.Q)(O.Z)}]},{id:21,icon:"podcast",iconColor:"var(--theme-icon-brand)",title:this.S.aiPodcastGeneration,desc:this.S.aiPodcastGenerationDesc},{id:22,icon:"check",iconColor:"var(--theme-icon-brand)",title:this.S.imageGenerateTitle,desc:this.S.imageGenerateDesc},{id:23,icon:"check",iconColor:"var(--theme-icon-brand)",title:this.S.videoGenerateTitle,desc:this.S.videoGenerateDesc},{id:24,icon:"check",iconColor:"var(--theme-icon-brand)",title:this.S.realtimeImageGenerateTitle,desc:this.S.realtimeImageGenerateTitle},{id:25,icon:"check",iconColor:"var(--theme-icon-brand)",title:this.S.scenarioImageGenerateTitle,desc:this.S.scenarioImageGenerateDesc},{id:26,icon:"check",iconColor:"var(--theme-icon-brand)",title:this.S.imageAllToolsTitle,desc:this.S.imageAllToolsTitleDesc},{id:27,icon:"check",iconColor:"var(--theme-icon-brand)",title:this.S.aiChatTitle,desc:this.S.aiChatDesc},{id:28,icon:"grammarUpgrade",iconColor:"var(--theme-icon-brand)",title:this.S.grammarTitle,desc:this.S.grammarDesc,icons:[{type:"img",icon:(0,w.Q)(B.Z)},{type:"img",icon:(0,w.Q)(P.Z)},{type:"img",icon:(0,w.Q)(V.Z)},{type:"img",icon:(0,w.Q)(E.Z)},{type:"img",icon:(0,w.Q)(R.Z)}]},{id:29,icon:"aiSheet",iconColor:"var(--theme-icon-brand)",title:this.S.sheetTitle,desc:this.S.sheetDesc}]}get queryOverLimitFeatures(){return[{id:1,icon:"dialogue",title:this.S.allModelTitle,desc:this.S.allModelDesc},{id:2,icon:"mPlanet",title:this.S.advancedModel,desc:this.S.advancedDesc1},{id:3,icon:"mBrush",title:this.S.imageGenerationTitle,desc:this.S.imageGenerationDesc},{id:4,icon:"mEarth",title:this.S.webAccessTitle,desc:this.S.webAccessDesc}]}get currentFeatureIdList(){let e=[1,7,19,18];if("unsubscribeDialog"===this.props.type)return e.slice(0,3);let t=[];switch(this.props.type){case"reading":t=[3];break;case"skills":t=[5];break;case"webAccess":t=[2];break;case"proSearch":t=[6];break;case"artist":t=[7];break;case"animationGenerate":t=[16];break;case"pdfUploadLimit":t=[10];break;case"pdfTranslation":t=[8];break;case"pdfPagesLimit":case"pdfQueryLimit":t=[10,1,13,8];break;case"imageTranslation":t=[11];break;case"credits":t=[12];break;case"realtime":t=[20];break;case"bypass":t=[17];break;case"grammarly":t=[28];break;case"aiPodcast":t=[21,1,7,19];break;case"imageTool":t=[22,23,24,25,26,27];break;case"batchProcessor":t=[29]}return(0,j.Z)([...t,...e]).slice(0,"imageTool"===this.props.type?6:4)}get currentFeatureList(){return"basicQuery"===this.props.type?this.queryOverLimitFeatures:this.currentFeatureIdList.map(e=>this.features.find(t=>t.id===e))}get source(){var e;return null!==(e=this.props.source)&&void 0!==e?e:"upgrade_drawer"}onViewCreate(){this.updateFeatureMaskStatus(),window.addEventListener("resize",this.updateFeatureMaskStatus)}onViewDestroy(){window.removeEventListener("resize",this.updateFeatureMaskStatus)}subscribe(){let e=p.recommendPlanController.activePlan;if(G.o.isWeb&&W.m.getIsMobile()&&C.S.location.pathname.includes("/image-tools")){Z.M.trackPaymentEvent({source:this.source,extData:{}}),K.m.subscribe({source:this.source,planKey:e.key,orderPageRedirectUrl:C.S.location.href,loadingRefer:this.loadingRefer});return}A.userController.isFreeUser?X.u.gotoCheckoutForSubscribe({source:this.source,planKey:e.key}):X.u.gotoPricingForSubscribe({source:this.source,planKey:e.key,autoPay:!0})}constructor(...e){super(...e),(0,y._)(this,"props",void 0),(0,y._)(this,"featuresNode",null),(0,y._)(this,"isShowFeatureMask",!1),(0,y._)(this,"loadingRefer",{btnLoading:!1,loading:!1}),(0,y._)(this,"updateFeatureMaskStatus",()=>{setTimeout(()=>{if(!this.featuresNode)return;let{scrollHeight:e,scrollTop:t,clientHeight:i}=this.featuresNode,a=e>i&&t+i<e;this.isShowFeatureMask!==a&&(this.isShowFeatureMask=a)},0)})}}(0,v.gn)([n.SB],Y.prototype,"isShowFeatureMask",void 0),(0,v.gn)([n.SB],Y.prototype,"loadingRefer",void 0),(0,v.gn)([n.Fl],Y.prototype,"S",null),(0,v.gn)([n.Fl],Y.prototype,"features",null),(0,v.gn)([n.Fl],Y.prototype,"queryOverLimitFeatures",null),(0,v.gn)([n.Fl],Y.prototype,"currentFeatureIdList",null),(0,v.gn)([n.Fl],Y.prototype,"currentFeatureList",null),(0,v.gn)([n.Fl],Y.prototype,"source",null);let $=n._Y.createComponent("UpgradePlanCard",Y,e=>e.props.justFeatures?(0,s.jsx)(ee,{className:e.props.className,vm:e}):(0,s.jsxs)("div",{className:l()(f.upgradePlanCard,{[f.cardStyle]:"card"===e.props.featureStyleMode},e.props.className),children:[(0,s.jsxs)("div",{className:f.planCard,children:[(0,s.jsxs)("div",{className:f.featureBox,children:[(0,s.jsx)(ee,{vm:e}),(0,s.jsx)("div",{className:f.maskBox,style:{opacity:e.isShowFeatureMask?1:0},children:(0,s.jsx)("div",{className:f.mask})})]}),(0,s.jsx)(u.F,{showFullName:e.props.showFullName})]}),(0,s.jsxs)("div",{className:f.actions,children:[(0,s.jsx)(c.z,{className:f.upgradeBtn,type:"primary",size:"large",animation:"sheen",shape:e.props.btnShape,onClick:async()=>{var t,i,a,o;e.subscribe(),null===(t=(i=e.props).onClick)||void 0===t||t.call(i),null===(a=(o=e.props).onUpgradeClick)||void 0===a||a.call(o)},loading:e.loadingRefer.btnLoading,children:p.recommendPlanController.subscribeBtnText}),e.props.buttonsSlot,(0,s.jsx)(c.z,{type:"text-primary",className:f.viewBtn,onClick:()=>{var t,i;A.userController.upgrade(e.source,void 0,void 0,void 0,!0),null===(t=(i=e.props).onViewClick)||void 0===t||t.call(i)},children:e.S.viewAllPlans})]})]})),ee=(0,d.Pi)(e=>{let{vm:t,className:i}=e;return(0,s.jsx)("div",{className:l()(f.features,i),ref:e=>{t.featuresNode=e},onScroll:t.updateFeatureMaskStatus.bind(t),children:t.currentFeatureList.map((e,t)=>{let i=e.icons||[];return(0,s.jsxs)("div",{className:l()(f.feature),children:[(0,s.jsx)("div",{className:f.lt,style:i.length>0?{marginTop:3}:{},children:(0,s.jsx)(m.J,{name:e.icon,size:22,color:e.iconColor})}),(0,s.jsxs)("div",{className:f.rt,children:[(0,s.jsxs)("div",{className:f.featureTitleBox,children:[(0,s.jsxs)("div",{className:f.featureTitle,children:[(0,s.jsx)("span",{children:e.title}),e.tip&&(0,s.jsx)(h.u,{title:e.tip,showArrow:!0,arrow:!0,children:(0,s.jsx)("div",{className:f.tipBox,children:(0,s.jsx)(m.J,{name:"info-pure",size:16,color:"currentColor"})})})]}),i.length>0&&(0,s.jsx)("div",{className:f.featureIcons,children:i.map(e=>{let{icon:t,type:i,style:a}=e;return(0,s.jsx)("div",{className:f.icon,children:"icon"===i?(0,s.jsx)(m.J,{name:t,color:"currentColor",style:a}):(0,s.jsx)(g.E,{skeleton:!0,src:t,className:f.img,style:a})},t)})})]}),(0,s.jsx)("div",{className:f.featureDesc,children:e.desc})]})]},t)})})})},80670:function(e,t,i){"use strict";i.d(t,{J:function(){return A}});var a=i(71576),o=i(34491),s=i(78716),n=i.n(s),r=i(62499),l=i(75087),d=i(97787),c={monicaPopover:"monica-popover--G5hKa",triggerNode:"trigger-node--wuySh",mask:"mask--IiZ4Y",content:"content--zGI3l",show:"show--W6Fq_",contentAnimate:"content-animate--OwkuG",contentAnimateTop:"content-animate-top--dS40g",contentAnimateBottom:"content-animate-bottom--F0huz"},h=i(66084),g=i(52921);class p extends o.PN{get pos(){let e=this.props.placement||"topRight",t=this.props.spacing||25;if("leftbottom"===e.toLowerCase())return{insetInlineEnd:"100%",bottom:t};let i=e.includes("top"),a=e.includes("left")||e.includes("Left"),o=e.includes("right")||e.includes("Right"),s=!a&&!o;if(e.startsWith("right")&&this.triggerEl&&this.contentEl){let i=e.endsWith("Top"),a=e.endsWith("Bottom"),o=this.triggerEl.getBoundingClientRect();return{top:i?o.top:void 0,bottom:a?o.bottom-this.contentEl.getBoundingClientRect().height:void 0,insetInlineStart:o.width+t}}return{top:i?void 0:t,bottom:i?t:void 0,insetInlineStart:o?0:s?"50%":void 0,insetInlineEnd:a?0:void 0,transform:s?"translateX(-50%)":void 0}}get trigger(){let{trigger:e="hover"}=this.props;return e}onViewCreate(){}onViewDestroy(){}onNodeClick(e){"hover"!==this.trigger&&(e.stopPropagation(),this.isOpen?this.close():this.open())}onNodeMouseEnter(){"click"!==this.trigger&&this.open()}onNodeMouseLeave(){"click"!==this.trigger&&this.close()}open(){var e,t;null===(e=(t=this.props).onOpen)||void 0===e||e.call(t),this.isOpen=!0}close(){var e,t;this.isOpen=!1,null===(e=(t=this.props).onClose)||void 0===e||e.call(t)}constructor(...e){super(...e),(0,h._)(this,"props",void 0),(0,h._)(this,"isOpen",!1),(0,h._)(this,"triggerEl",null),(0,h._)(this,"contentEl",null)}}(0,g.gn)([o.SB],p.prototype,"isOpen",void 0);let A=o._Y.createComponent("Popover",p,e=>((0,l.useEffect)(()=>{if(void 0!==e.props.open&&(e.isOpen=e.props.open,!e.isOpen)){var t,i;null===(t=(i=e.props).onClose)||void 0===t||t.call(i)}},[e.props.open,e]),(0,a.jsxs)("div",{className:n()(c.monicaPopover,e.props.className),onMouseLeave:e.onNodeMouseLeave.bind(e),onMouseDown:e.props.onMouseDown,style:{...e.props.style,width:e.props.fullWidth?"100%":void 0},onClick:t=>{var i,a;return null===(i=(a=e.props).onClick)||void 0===i?void 0:i.call(a,t)},children:[(0,a.jsx)("span",{className:n()(c.triggerNode,e.props.triggerNodeClassName),onClick:e.onNodeClick.bind(e),onMouseEnter:e.onNodeMouseEnter.bind(e),style:{width:e.props.fullWidth?"100%":void 0},ref:t=>e.triggerEl=t,children:e.props.children}),e.isOpen&&"click"===e.props.trigger?(0,a.jsx)("div",{style:{left:0,right:0,top:0,bottom:0},className:c.mask,onMouseDown:e=>{e.stopPropagation()},onClick:()=>{e.close()}}):null,e.props.getPopupContainer?(0,d.createPortal)((0,a.jsx)(m,{vm:e},e.props.contentKey),e.props.getPopupContainer()):(0,a.jsx)(m,{vm:e},e.props.contentKey)]}))),m=(0,r.Pi)(e=>{var t;let{vm:i}=e,o=(null===(t=i.props.placement)||void 0===t?void 0:t.includes("bottom"))||"rightTop"===i.props.placement;return(0,a.jsx)("div",{className:n()(c.content,c.contentAnimate,{[c.show]:i.isOpen,[c.contentAnimateBottom]:o,[c.contentAnimateTop]:!o},i.props.containerClassName),style:{...i.pos,...i.props.positionStyle},ref:e=>i.contentEl=e,onClick:e=>{if(e.stopPropagation(),i.props.closeOnContentClick){var t,a;i.isOpen=!1,null===(t=(a=i.props).onClose)||void 0===t||t.call(a)}},children:i.props.content})})},40597:function(e,t,i){"use strict";i.d(t,{h:function(){return b}});var a=i(71576),o=i(34491),s=i(53040),n=i(95782),r=i(78716),l=i.n(r),d=i(25449),c=i(47720),h=i(41013),g={"promotion-text":"promotion-text--FB350",promotionText:"promotion-text--FB350",bold:"bold--DtFr0","prefix-icon":"prefix-icon--kKV3L",prefixIcon:"prefix-icon--kKV3L","promotion-text-holder":"promotion-text-holder--cUTsA",promotionTextHolder:"promotion-text-holder--cUTsA",countdown:"countdown--EjHdS","upgrade-dialog":"upgrade-dialog--hsWGC",upgradeDialog:"upgrade-dialog--hsWGC",item:"item--cKezG"},p=i(66084),A=i(52921),m=i(4461),u=i(88882),f=i(21320),y=i(33381),v=i(45029),w={src:"https://assets.monica.im/home-web/_next/static/media/giftIcon2.b052e0c6.png",height:64,width:64,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAVFBMVEVMaXH///+sn7qUiKCQgZpEKkYnDj77/P719vvl4OX////1+PW5sb7h3OTDuMr///8wEzL/5a//57FoPTTf09D537T///+CVzxbRmlNL1/vvXycbl5c4sMnAAAAGHRSTlMACPPt/v78KjiRHVPQydoU/vmu/rrCSfyGS/j0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQUlEQVR4nB3LSRaAIAzA0DC0BSecRb3/PX2Y9Q+AFVoux5BPRxrqLBIzY1W5tpCw6VZ9d6D30T9r053ZcvwfJOMDRuIB9WTSpmYAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8};class C extends o.PN{get S(){return u.S.Global.components.Promotion.PromotionText}get trialEndTime(){var e,t;return(null===(e=y.userController.userInfo)||void 0===e?void 0:e.createdAt)?f.L.add(new Date(null===(t=y.userController.userInfo)||void 0===t?void 0:t.createdAt).getTime(),15,"minute").valueOf():""}get shouldShowTrialCountdown(){return y.userController.isFreeUser&&y.userController.isLogin&&d.promotionController.canTrial}get actUiConfig(){return d.promotionController.hitBackToSchool?{icon:(0,m.Q)(w),text:this.S.backToSchool}:d.promotionController.hitNewComer?d.promotionController.isAffDiscount?{text:this.S.newUserWithAff}:{text:this.S.newUser}:null}onViewCreate(){this.initCountdown()}onViewDestroy(){}async initCountdown(){var e;if(y.userController.isFreeUser){if(await d.promotionController.loadActivityConfig(),null===(e=d.promotionController.activityConfig)||void 0===e?void 0:e.enable){this.countdownMode="promotion";return}this.props.showTrial&&this.shouldShowTrialCountdown&&this.trialEndTime&&(this.countdownController.init(this.trialEndTime,{useMillisecond:!0}),this.countdownMode="trial")}}constructor(...e){super(...e),(0,p._)(this,"props",void 0),(0,p._)(this,"countdownController",new v.H),(0,p._)(this,"countdownMode",null)}}(0,A.gn)([o.SB],C.prototype,"countdownMode",void 0),(0,A.gn)([o.Fl],C.prototype,"S",null),(0,A.gn)([o.Fl],C.prototype,"trialEndTime",null),(0,A.gn)([o.Fl],C.prototype,"shouldShowTrialCountdown",null),(0,A.gn)([o.Fl],C.prototype,"actUiConfig",null);let b=o._Y.createComponent("PromotionText",C,e=>{let t=e.props.fallback||(e.props.holder?(0,a.jsx)("div",{className:l()(g.promotionTextHolder,e.props.holderCls)}):null),i=l()(g.promotionText,e.props.className,e.props.theme&&g[e.props.theme]);if("promotion"===e.countdownMode){let o=d.promotionController.countdownController;return(null==o?void 0:o.countdown)&&e.actUiConfig?(0,a.jsxs)("div",{className:i,children:[!!e.actUiConfig.icon&&(0,a.jsx)(s.E,{className:g.prefixIcon,src:e.actUiConfig.icon,skeleton:!0}),(0,a.jsx)(n.Z,{S:e.actUiConfig.text,components:{strong:e=>(0,a.jsx)("span",{className:g.bold,children:e}),affUser:()=>d.promotionController.isAffDiscount?(0,a.jsx)("span",{className:g.bold,children:d.promotionController.affUserName}):null,countdown:()=>(0,a.jsx)(h._,{className:l()(e.props.countdownCls,g.countdown),itemCls:g.item,countdownController:o,persistHour:!0})}})]}):t}return"trial"===e.countdownMode&&e.props.showTrial&&e.countdownController.countdown?(0,a.jsx)("div",{className:i,children:(0,a.jsx)(n.Z,{S:e.S.freeTrial,data:{day:c.serverConfigController.trialDays},components:{strong:e=>(0,a.jsx)("span",{className:g.bold,children:e}),countdown:()=>(0,a.jsx)(h._,{className:l()(e.props.countdownCls,g.countdown),itemCls:g.item,countdownController:e.countdownController})}})}):t})},26712:function(e,t,i){"use strict";i.d(t,{Y:function(){return c}});var a=i(71576),o=i(34491),s=i(78716),n=i.n(s),r=i(66084),l=i(52921);class d extends o.PN{onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,r._)(this,"props",void 0),(0,r._)(this,"someState",!0)}}(0,l.gn)([o.SB],d.prototype,"someState",void 0);let c=o._Y.createComponent("Radio",d,e=>{let{children:t,checked:i,disabled:o,onClick:s,labelClassName:r,className:l,size:d}=e.props;return(0,a.jsxs)("div",{className:n()("radio--Ps3k7",l,{"checked--GsSch":i,"disabled--J6AsH":o,"small--w3mO6":"small"===d}),onClick:()=>{o||null==s||s()},children:[(0,a.jsx)("div",{className:"radio-icon--dDx7L",children:(0,a.jsx)("div",{className:"radio-icon-inner--veH02"})}),(0,a.jsx)("div",{className:n()("label--IY3qB",r),children:t})]})})},44069:function(e,t,i){"use strict";i.d(t,{x:function(){return g}});var a=i(71576),o=i(34491),s=i(78716),n=i.n(s),r=i(48023),l=i(66084),d=i(52921),c=i(88882);class h extends o.PN{get S(){return c.S.Global.components.Text}measure(){if(!this.textEl)return;let{scrollWidth:e,clientWidth:t,scrollHeight:i,clientHeight:a}=this.textEl;e>t||i>a?this.isOverflow=!0:this.isOverflow=!1}onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,l._)(this,"props",void 0),(0,l._)(this,"someState",!0),(0,l._)(this,"isOverflow",!1),(0,l._)(this,"expanded",!1),(0,l._)(this,"textEl",null),(0,l._)(this,"whenReady",null)}}(0,d.gn)([o.SB],h.prototype,"someState",void 0),(0,d.gn)([o.SB],h.prototype,"isOverflow",void 0),(0,d.gn)([o.SB],h.prototype,"expanded",void 0),(0,d.gn)([o.SB],h.prototype,"textEl",void 0),(0,d.gn)([o.Fl],h.prototype,"S",null);let g=o._Y.createComponent("Text",h,e=>{let{clamp:t=1,text:i,showTooltip:o=!0,className:s}=e.props,l=(0,a.jsx)("span",{style:{WebkitLineClamp:e.expanded?"unset":"".concat(t),display:"-webkit-box"},className:n()("text--a7TdP",s),onMouseEnter:()=>{e.measure()},ref:t=>{t&&(e.textEl=t)},children:i});return o?(0,a.jsx)(r.u,{placement:"top",title:e.isOverflow?i:"",children:l}):l})},54493:function(e,t,i){"use strict";i.d(t,{g:function(){return A}});var a=i(71576),o=i(34491),s=i(82003),n=i(78716),r=i.n(n),l=i(70151),d=i(46731),c={textareaWrapper:"textarea-wrapper--L2DA7",resizer:"resizer--I3Jaw",textarea:"textarea--JX_6f",textareaPrimary:"textarea-primary--OH3BL",textareaBlue:"textarea-blue--hdlgA",textareaError:"textarea-error--m19wz"},h=i(66084);class g extends o.PN{onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,h._)(this,"props",void 0),(0,h._)(this,"textareaRef",null)}}let{TextArea:p}=s.default,A=o._Y.createComponent("Textarea",g,e=>{let{className:t,disabled:i,getTextAreaRef:o,spellCheck:s=!0,onFocusChange:n,type:h="primary",resize:g=!1,wrapperClassName:A="",onChange:m,...u}=e.props;return g?(0,a.jsxs)("div",{className:r()(c.textareaWrapper,A),children:[(0,a.jsx)(p,{ref:e=>{e&&(null==o||o(e))},spellCheck:s,className:r()(c.textarea,t,{[c.textareaPrimary]:"primary"===h,[c.textareaBlue]:"blue"===h,[c.textareaError]:"error"===h}),onFocus:()=>{null==n||n(!0)},onBlur:()=>{null==n||n(!1)},disabled:i,onCompositionStart:e=>{var t;null===(t=u.onCompositionStart)||void 0===t||t.call(u,e)},onCompositionEnd:e=>{var t;null===(t=u.onCompositionEnd)||void 0===t||t.call(u,e)},onChange:e=>{null==m||m(e)},...u}),(0,a.jsx)(d.J,{name:"monicaResizer",color:"currentColor",size:12,className:c.resizer})]}):(0,a.jsx)(p,{ref:t=>{t&&(null==o||o(t),e.textareaRef=t)},spellCheck:s,className:r()(c.textarea,t,{[c.textareaPrimary]:"primary"===h,[c.textareaBlue]:"blue"===h,[c.textareaError]:"error"===h}),onFocus:()=>{null==n||n(!0)},onBlur:()=>{null==n||n(!1)},disabled:i,onCompositionStart:e=>{var t;null===(t=u.onCompositionStart)||void 0===t||t.call(u,e)},onCompositionEnd:e=>{var t;null===(t=u.onCompositionEnd)||void 0===t||t.call(u,e)},onChange:e=>{null==m||m(e)},...u,onKeyDown:t=>{var i,a,o,s,n,r,d,c,h,g,p,A,m;if((0,l.ZP)("pageUp")(t)){t.preventDefault();let i=(null===(o=e.textareaRef)||void 0===o?void 0:null===(a=o.resizableTextArea)||void 0===a?void 0:a.textArea.clientHeight)||100;null===(d=e.textareaRef)||void 0===d||null===(r=d.resizableTextArea)||void 0===r||r.textArea.scrollTo({top:(null===(n=e.textareaRef)||void 0===n?void 0:null===(s=n.resizableTextArea)||void 0===s?void 0:s.textArea.scrollTop)-i,behavior:"smooth"})}else if((0,l.ZP)("pageDown")(t)){t.preventDefault();let i=(null===(h=e.textareaRef)||void 0===h?void 0:null===(c=h.resizableTextArea)||void 0===c?void 0:c.textArea.clientHeight)||100;null===(m=e.textareaRef)||void 0===m||null===(A=m.resizableTextArea)||void 0===A||A.textArea.scrollTo({top:(null===(p=e.textareaRef)||void 0===p?void 0:null===(g=p.resizableTextArea)||void 0===g?void 0:g.textArea.scrollTop)+i,behavior:"smooth"})}null===(i=u.onKeyDown)||void 0===i||i.call(u,t)}})})},25032:function(e,t,i){"use strict";let a;i.d(t,{X:function(){return d}});var o=i(71576),s=i(88882),n=i(92235),r=i(75087),l=i(48023);let d=e=>{let{render:t,text:i,className:d,doubleClick:c,showTooltip:h=!0,getRef:g,onCopy:p}=e,[A,m]=(0,r.useState)(!1),u=s.S.Global.components.WithCopied,f=async()=>{(c||!A)&&(c&&A?(m(!1),setTimeout(()=>{m(!0)},200),clearTimeout(a)):m(!0),n.m.getIsMobile()?n.m.copyToClipboardForMobile(i):n.m.copyToClipboard(i),null==p||p(),a=setTimeout(()=>{m(!1)},2500))};return null==g||g({copy:f}),(0,o.jsx)(l.u,{title:h?A?u.copied:u.copy:"",children:(0,o.jsx)("span",{className:d,children:t(A,()=>{f()})})})}},36307:function(e,t,i){"use strict";i.d(t,{a:function(){return d}});var a=i(71576),o=i(58812),s=i(34491),n=i(66084);class r extends s.PN{constructor(...e){super(...e),(0,n._)(this,"props",void 0)}}var l=JSON.parse('{"fill":"none","content":"\\n<g clip-path=\\"url(#clip0_884_14596)\\">\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M7.99994 1.9334C4.64942 1.9334 1.93328 4.64954 1.93328 8.00006C1.93328 11.3506 4.64942 14.0667 7.99994 14.0667C11.3505 14.0667 14.0666 11.3506 14.0666 8.00006C14.0666 4.64954 11.3505 1.9334 7.99994 1.9334ZM0.733276 8.00006C0.733276 3.9868 3.98667 0.733398 7.99994 0.733398C12.0132 0.733398 15.2666 3.9868 15.2666 8.00006C15.2666 12.0133 12.0132 15.2667 7.99994 15.2667C3.98667 15.2667 0.733276 12.0133 0.733276 8.00006ZM7.99994 4.7334C8.33131 4.7334 8.59994 5.00203 8.59994 5.3334V7.40007H10.6666C10.998 7.40007 11.2666 7.66869 11.2666 8.00006C11.2666 8.33144 10.998 8.60006 10.6666 8.60006H8.59994V10.6667C8.59994 10.9981 8.33131 11.2667 7.99994 11.2667C7.66857 11.2667 7.39994 10.9981 7.39994 10.6667V8.60006H5.33328C5.00191 8.60006 4.73328 8.33144 4.73328 8.00006C4.73328 7.66869 5.00191 7.40007 5.33328 7.40007H7.39994V5.3334C7.39994 5.00203 7.66857 4.7334 7.99994 4.7334Z\\" fill=\\"#522BD6\\"/>\\n</g>\\n<defs>\\n<clipPath id=\\"clip0_884_14596\\">\\n<rect width=\\"16\\" height=\\"16\\" fill=\\"white\\"/>\\n</clipPath>\\n</defs>\\n\\n","viewBox":"0 0 16 16"}');let d=s._Y.createComponent("AddCircleIcon",r,e=>(0,a.jsx)(o.s,{...e.props,name:"AddCircleIcon",iconData:l}))},42124:function(e,t,i){"use strict";i.d(t,{k:function(){return d}});var a=i(71576),o=i(58812),s=i(34491),n=i(66084);class r extends s.PN{constructor(...e){super(...e),(0,n._)(this,"props",void 0)}}var l=JSON.parse('{"fill":"none","content":"\\n<path d=\\"M9.16669 15H12.9167C14.9878 15 16.6667 13.3211 16.6667 11.25C16.6667 9.17893 14.9878 7.5 12.9167 7.5H4.16669\\" stroke=\\"#222226\\" stroke-width=\\"1.25\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\"/>\\n<path d=\\"M5.83331 5L3.92257 6.91074C3.64479 7.18852 3.5059 7.32741 3.5059 7.5C3.5059 7.67259 3.64479 7.81148 3.92257 8.08926L5.83331 10\\" stroke=\\"#222226\\" stroke-width=\\"1.25\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\"/>\\n\\n","viewBox":"0 0 20 20"}');let d=s._Y.createComponent("BackwardIcon",r,e=>(0,a.jsx)(o.s,{...e.props,name:"BackwardIcon",iconData:l}))},8042:function(e,t,i){"use strict";i.d(t,{a:function(){return d}});var a=i(71576),o=i(58812),s=i(34491),n=i(66084);class r extends s.PN{constructor(...e){super(...e),(0,n._)(this,"props",void 0)}}var l=JSON.parse('{"fill":"none","content":"\\n<path d=\\"M8 3.875C8.34518 3.875 8.625 4.15482 8.625 4.5V9.25C8.625 9.59518 8.34518 9.875 8 9.875C7.65482 9.875 7.375 9.59518 7.375 9.25V4.5C7.375 4.15482 7.65482 3.875 8 3.875Z\\" fill=\\"#868692\\"/>\\n<path d=\\"M8.75 11.4062C8.75 11.8377 8.40022 12.1875 7.96875 12.1875C7.53728 12.1875 7.1875 11.8377 7.1875 11.4062C7.1875 10.9748 7.53728 10.625 7.96875 10.625C8.40022 10.625 8.75 10.9748 8.75 11.4062Z\\" fill=\\"#868692\\"/>\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M1.375 8C1.375 4.34111 4.34111 1.375 8 1.375C11.6589 1.375 14.625 4.34111 14.625 8C14.625 11.6589 11.6589 14.625 8 14.625C4.34111 14.625 1.375 11.6589 1.375 8ZM8 2.625C5.03147 2.625 2.625 5.03147 2.625 8C2.625 10.9685 5.03147 13.375 8 13.375C10.9685 13.375 13.375 10.9685 13.375 8C13.375 5.03147 10.9685 2.625 8 2.625Z\\" fill=\\"#868692\\"/>\\n</svg>\\n","viewBox":"0 0 16 16"}');let d=s._Y.createComponent("WarningIcon",r,e=>(0,a.jsx)(o.s,{...e.props,name:"WarningIcon",iconData:l}))},39160:function(e,t,i){"use strict";i.d(t,{HO:function(){return a},SB:function(){return s},uZ:function(){return o}});let a="m-",o={GRAMMAR:{UNDERLINE:"#f2b24c",BACKGROUND:"rgba(242,179,77,0.4)",EMPHASIZE:"rgba(241,179,76,0.1)",TITLE:"#D2A013"},STYLE:{UNDERLINE:"#D2CBFF",BACKGROUND:"rgba(210,203,255,0.6)",EMPHASIZE:"rgba(210,203,255,0.1)",TITLE:"#5C4CFF"},SPELLING:{UNDERLINE:"#EB5757",BACKGROUND:"rgba(235,88,88,0.4)",EMPHASIZE:"rgba(239,88,88,0.1)",TITLE:"#F91A47"},SYNONYMS:{UNDERLINE:"#0042d7"}},s="".concat(a,"mirror-clone-node")},12875:function(e,t,i){"use strict";i.d(t,{i:function(){return u}});var a=i(66084),o=i(52921),s=i(34491),n=i(24900),r=i(91433),l=i(10043),d=i(92235),c=i(82270),h=i(51018),g=i(20978),p=i(73047),A=i(90180),m=i(18245);class u{get gpt4Enabled(){return"quickAction"===this.providerType?A.A.quickActionGpt4Enabled:A.A.composeGpt4Enabled}get activeOutput(){return this.outputList.find(e=>e.id===this.activeId)||null}get activeOutputIndex(){return this.outputList.findIndex(e=>e.id===this.activeId)||0}get prevBtnDisabled(){var e;return(null===(e=this.outputList[0])||void 0===e?void 0:e.id)===this.activeId}get nextBtnDisabled(){var e;return(null===(e=this.outputList[this.outputList.length-1])||void 0===e?void 0:e.id)===this.activeId}handlePrevClick(){if(this.prevBtnDisabled)return;let e=this.outputList.findIndex(e=>e.id===this.activeId);e>0&&(this.activeId=this.outputList[e-1].id)}handleNextClick(){if(this.nextBtnDisabled)return;let e=this.outputList.findIndex(e=>e.id===this.activeId);e<this.outputList.length-1&&(this.activeId=this.outputList[e+1].id)}stop(e){let t=this.outputList.find(t=>t.id===e);t&&(t.taskId&&(n.Tn.cancelTask(t.taskId,this.providerType),t.taskId=void 0),t.loading=!1)}stopAll(){this.outputList.forEach(e=>{this.stop(e.id)})}clear(){this.stopAll(),this.outputList=[],this.activeId=null}async generateOutput(e,t,i,a){var o;let s=i?i.outputId:d.m.genId();if(e.useModel=null!==(o=e.useModel)&&void 0!==o?o:this.gpt4Enabled?r.f2:r.Q7,i){let t=this.getOutput(i.outputId);t&&(this.stop(i.outputId),t.error=void 0,t.loading=!0,t.content="",t.useModel=e.useModel)}else{let t={id:s,content:"",useModel:e.useModel};e.actionId&&(t.actionId=e.actionId),this.outputList.push(t)}this.activeId=s;let{isEnough:g,handleCreditsNotEnough:p}=m.K.checkCredits({module:this.gpt4Enabled?"genius_bot":"basic_query",source:t});if(!g){p(),this.updateOutput(s,{error:c.Eg.quotaExceeded});return}this.updateOutput(s,{loading:!0}),this.scrollToBottom();let A=(t,i,a)=>{let o=this.getOutput(s);if(o&&(i&&(o.loading=!1,this.scrollToBottom()),a&&(a===c.Eg.quotaExceeded&&p(),o.error=a),t)){if(o.content+=t.text,(0,l._z)(e.systemKey)){let e=h.c.parsePartialJson(o.content);Object.assign(o,e)}this.scrollToBottom()}};if("compose"===this.providerType&&a){let{taskId:t}=await n.Tn.composeReply(e,A);this.updateOutput(s,{taskId:t})}if("compose"===this.providerType&&!a){let{taskId:t}=await n.Tn.compose(e,A);this.updateOutput(s,{taskId:t})}if("quickAction"===this.providerType){let{taskId:t}=await n.Tn.triggerSelectionQuickAction(e,A);this.updateOutput(s,{taskId:t})}if("apps"===this.providerType){let{taskId:t}=await n.Tn.runApp(e,A);this.updateOutput(s,{taskId:t})}}getOutput(e){return this.outputList.find(t=>t.id===e)||null}updateOutput(e,t){let i=this.getOutput(e);i&&Object.assign(i,t)}constructor(e){(0,a._)(this,"options",void 0),(0,a._)(this,"outputList",void 0),(0,a._)(this,"activeId",void 0),(0,a._)(this,"providerType",void 0),(0,a._)(this,"insertTarget",void 0),(0,a._)(this,"getScrollContainer",void 0),(0,a._)(this,"scrollToBottom",void 0),this.options=e,this.outputList=[],this.activeId=null,this.scrollToBottom=(0,g.Z)(()=>{var e,t,i,a;[null===(i=this.activeOutput)||void 0===i?void 0:null===(t=i.textareaRef)||void 0===t?void 0:null===(e=t.resizableTextArea)||void 0===e?void 0:e.textArea,null===(a=this.getScrollContainer)||void 0===a?void 0:a.call(this)].forEach(e=>{e&&(e.scrollTop=e.scrollHeight)})},30,{maxWait:100,trailing:!0}),(0,p.rC)(this),this.providerType=e.providerType,this.insertTarget=e.insertTarget,this.getScrollContainer=e.getScrollContainer}}(0,o.gn)([s.SB],u.prototype,"outputList",void 0),(0,o.gn)([s.SB],u.prototype,"activeId",void 0),(0,o.gn)([p.Fl],u.prototype,"gpt4Enabled",null),(0,o.gn)([p.Fl],u.prototype,"activeOutput",null),(0,o.gn)([p.Fl],u.prototype,"activeOutputIndex",null),(0,o.gn)([p.Fl],u.prototype,"prevBtnDisabled",null),(0,o.gn)([p.Fl],u.prototype,"nextBtnDisabled",null)},91390:function(e,t,i){"use strict";i.d(t,{n:function(){return p}});var a=i(66084),o=i(52921),s=i(34491),n=i(92660),r=i(73047),l=i(92020),d=i(45029),c=i(18245),h=i(33381);class g{get countdownEnable(){return this.countdownController.enable}get restSecond(){var e,t;return parseInt(null!==(t=null===(e=this.countdownController.countdown)||void 0===e?void 0:e.second)&&void 0!==t?t:"0")}setViews(e){this.views=e}async checkoutHighTrafficDialogEnable(e){if(!h.userController.userInfo||h.userController.isVipUser)return!1;if(this.countdownEnable)return this.open(e),!0;let t=await l.ll.get("highTrafficDialogShowedRecord"),i=null==t?void 0:t[h.userController.userInfo.uid],{finallyUsed:a,planTotal:o}=c.K.getUsageInfo("basic_query");if(c.K.checkQuotaIsUnlimited(o))return!1;if(a>=30){if(!i&&.5>Math.random())return this.randomData(),this.initCountdown(Date.now()),this.updateRecords({showedDate:new Date().toLocaleDateString(),showedCount:0,showedTime:Date.now(),shouldWaitingSeconds:this.waitSecond,waitUserCount:this.waitUserCount}),this.open(e),!0;if(i){let t=new Date().toLocaleDateString(),{showedDate:a,showedCount:o,showedTime:s,shouldWaitingSeconds:r}=i;if(a===t&&o<3){if(Date.now()-s>5*n.EB&&.5>Math.random())return this.randomData(),this.initCountdown(Date.now()),this.updateRecords(i),this.open(e),!0;let t=(1e3*r+s-Date.now())/1e3;if(t>0)return this.waitSecond=i.shouldWaitingSeconds,this.waitUserCount=i.waitUserCount,this.initCountdown(s),this.open(e),!0;t<=0&&(this.waitSecond=0,this.initCountdown(0))}if(a!==t&&.5>Math.random())return this.randomData(),this.initCountdown(Date.now()),this.updateRecords({showedDate:new Date().toLocaleDateString(),showedCount:0,showedTime:Date.now(),shouldWaitingSeconds:this.waitSecond,waitUserCount:this.waitUserCount}),this.open(e),!0}}return!1}async updateRecords(e){let t=await l.ll.get("highTrafficDialogShowedRecord"),i=new Date().toLocaleDateString(),a=i===e.showedDate;l.ll.set("highTrafficDialogShowedRecord",{...t,[h.userController.userInfo.uid]:{...e,showedDate:i,showedCount:a?e.showedCount+1:1,showedTime:Date.now(),shouldWaitingSeconds:this.waitSecond,waitUserCount:this.waitUserCount}})}randomData(){let e=Math.floor(16*Math.random())+5;this.waitSecond=e,this.waitUserCount=100*e}initCountdown(e){if(0===e){this.countdownController.init(0);return}this.endTime=e+1e3*this.waitSecond,this.countdownController.init(this.endTime)}open(e){var t;null===(t=this.views)||void 0===t||t.openHighTrafficDialog({insertTarget:e||"mainWindow"})}constructor(){(0,a._)(this,"countdownController",new d.H),(0,a._)(this,"views",null),(0,a._)(this,"waitUserCount",0),(0,a._)(this,"endTime",null),(0,a._)(this,"waitSecond",0),(0,r.rC)(this)}}(0,o.gn)([s.SB],g.prototype,"waitUserCount",void 0),(0,o.gn)([s.SB],g.prototype,"endTime",void 0),(0,o.gn)([s.SB],g.prototype,"waitSecond",void 0),(0,o.gn)([r.Fl],g.prototype,"countdownEnable",null),(0,o.gn)([r.Fl],g.prototype,"restSecond",null);let p=new g},90122:function(e,t,i){"use strict";i.d(t,{P:function(){return r}});var a=i(66084),o=i(52921),s=i(34491),n=i(73047);class r{setTabItems(e){this.tabItems=e}setActiveTabKey(e){var t,i;this.activeTabKey!==e&&(this.activeTabKey=e,null===(t=(i=this.options).onTabChange)||void 0===t||t.call(i,e))}disableTransition(e){this.noTransition=e}setWrapperEl(e){this.wrapperEl=e}calcTabsPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isResizeTrigger:t=!1}=e;if(!this.wrapperEl)return;let i=this.tabItems.findIndex(e=>e.key===this.activeTabKey);if(-1===i)return;let a=this.wrapperEl.querySelector("div:nth-of-type(".concat(i+1,")"));a&&null!==a.offsetParent&&(this.wrapperEl.setAttribute("style","--active-tab-left: ".concat(a.offsetLeft,"px; --active-tab-width: ").concat(a.offsetWidth,"px; --active-tab-animation-duration: ").concat(this.isFirstRender||t?0:.2,"s;")),this.isFirstRender=!1)}constructor(e){var t;(0,a._)(this,"options",void 0),(0,a._)(this,"wrapperEl",void 0),(0,a._)(this,"tabItems",void 0),(0,a._)(this,"activeTabKey",void 0),(0,a._)(this,"noTransition",void 0),(0,a._)(this,"onTabChange",void 0),(0,a._)(this,"isFirstRender",void 0),this.options=e,this.wrapperEl=null,this.noTransition=!1,this.isFirstRender=!0,this.tabItems=e.tabItems,this.activeTabKey=e.defaultActiveTabKey,this.noTransition=null!==(t=e.defaultNoTransition)&&void 0!==t&&t,this.onTabChange=e.onTabChange,(0,n.rC)(this)}}(0,o.gn)([s.SB],r.prototype,"wrapperEl",void 0),(0,o.gn)([s.SB],r.prototype,"tabItems",void 0),(0,o.gn)([s.SB],r.prototype,"activeTabKey",void 0),(0,o.gn)([s.SB],r.prototype,"noTransition",void 0),(0,o.gn)([s.SB],r.prototype,"onTabChange",void 0)},44015:function(e,t,i){"use strict";i.d(t,{$:function(){return es}});var a=i(66084),o=i(52921),s=i(34491),n=i(28901),r=i(92235),l=i(88882),d=i(20978),c=i(73047),h=i(92849),g=i(24900);let p="monica-simplify-original",A="monica-simplify-content",m="monica-simplify-inject-style-el";class u{constructor(){(0,a._)(this,"running",!1),(0,a._)(this,"simplifyTaskMap",new WeakSet),(0,a._)(this,"outViewObservers",new Set),(0,a._)(this,"simplifyTaskQueue",[]),(0,a._)(this,"maxConcurrency",10),(0,a._)(this,"currentConcurrency",0),(0,a._)(this,"waitConcurrency",null),(0,a._)(this,"releaseConcurrency",()=>{}),(0,a._)(this,"add",e=>{this.simplifyTaskMap.has(e.element)||(this.simplifyTaskQueue.push(e),this.simplifyTaskMap.add(e.element),this.start())}),(0,a._)(this,"clear",()=>{this.simplifyTaskQueue.forEach(e=>{var t;null===(t=e.observer)||void 0===t||t.disconnect(),this.simplifyTaskMap.delete(e.element)}),this.outViewObservers.forEach(e=>{e.disconnect()}),this.simplifyTaskQueue=[],this.outViewObservers.clear(),this.running=!1}),(0,a._)(this,"start",async()=>{if(this.running)return;this.running=!0;let e=this.simplifyTaskQueue.shift();if(!e){this.running=!1;return}if(this.simplifyTaskMap.delete(e.element),e.observer&&this.outViewObservers.delete(e.observer),this.waitConcurrency&&await this.waitConcurrency,await n.x.checkElIsInViewport(e.element))this.currentConcurrency++,this.currentConcurrency===this.maxConcurrency&&(this.waitConcurrency=new Promise(e=>{this.releaseConcurrency=e})),e.executeTask().catch(e=>{console.warn(e)}).finally(()=>{this.currentConcurrency--,this.releaseConcurrency(),this.waitConcurrency=null});else{let t=new IntersectionObserver(t=>{let[{isIntersecting:i}]=t;if(i){var a;this.add(e),null===(a=e.observer)||void 0===a||a.disconnect()}});t.observe(e.element),e.observer=t,this.outViewObservers.add(t)}this.running=!1,this.start()})}}let f=new u;class y{getParagraphs(){return Array.from(document.querySelectorAll("p")).filter(e=>{var t;return!this.simplifiedParagraphs.has(e)&&!this.simplifyingParagraphs.has(e)&&e.tagName!==A.toUpperCase()&&e.tagName!==p.toUpperCase()&&n.x.checkVisibility(e)&&!!(null===(t=e.textContent)||void 0===t?void 0:t.trim().length)}).map(e=>({el:e,id:r.m.genId()}))}constructor(){var e=this;(0,a._)(this,"enabled",!1),(0,a._)(this,"simplifiedParagraphs",new Set),(0,a._)(this,"simplifyingParagraphs",new Set),(0,a._)(this,"paragraphCache",new Map),(0,a._)(this,"listenerDisposers",[]),(0,a._)(this,"mutationObserver",null),(0,a._)(this,"start",()=>{this.enabled=!0,this.simplify(),this.mutationObserver=new MutationObserver(e=>{e.some(e=>"childList"===e.type&&Array.from(e.addedNodes).some(e=>e.nodeType===Node.ELEMENT_NODE))&&this.simplify()}),this.mutationObserver.observe(document.body,{subtree:!0,childList:!0})}),(0,a._)(this,"reset",()=>{var e;this.enabled=!1,this.removeCSS(),this.simplifiedParagraphs.forEach(e=>{let t=e.querySelector(p);t&&(e.innerHTML=t.innerHTML),e.style.position="",e.style.height="",e.style.overflow=""}),this.listenerDisposers.forEach(e=>e()),this.listenerDisposers=[],this.simplifiedParagraphs.clear(),this.simplifyingParagraphs.clear(),null===(e=this.mutationObserver)||void 0===e||e.disconnect(),this.mutationObserver=null,f.clear()}),(0,a._)(this,"simplify",(0,d.Z)(async()=>{for(let e of(this.injectCSS(),this.getParagraphs())){if(this.simplifyingParagraphs.add(e.el),e.el.style.animation="colorChange 1s ease-in-out infinite",this.paragraphCache.has(e.el)){this.transformP(e,this.paragraphCache.get(e.el));continue}f.add({element:e.el,executeTask:async()=>{let{data:{actionOutput:t}}=await g.Tn.simplifyParagraph({data:{input:e.el.textContent||""},locale:l.a.locale,taskUid:e.id,language:h.translateHelper.pageLang||"en",taskType:"quick_action:simplify"});this.transformP(e,t)}})}},300,{leading:!0,trailing:!0})),(0,a._)(this,"isBlockElement",e=>!!e&&"inline"!==window.getComputedStyle(e).display),(0,a._)(this,"findBottomBlockElements",function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t&&t.nodeType===Node.ELEMENT_NODE&&(e.isBlockElement(t)&&(0===t.children.length||!Array.from(t.children).some(t=>e.isBlockElement(t)))?i.push(t):Array.from(t.children).forEach(t=>{e.findBottomBlockElements(t,i)})),i}),(0,a._)(this,"injectCSS",()=>{if(document.querySelector("#".concat(m)))return;let e=document.createElement("style");e.id=m,e.textContent="\n        @keyframes tracking-in-contract {\n          0% {\n            letter-spacing: 1em;\n            opacity: 0;\n          }\n          40% {\n            opacity: 0.6;\n          }\n          100% {\n            letter-spacing: normal;\n            opacity: 1;\n          }\n        }\n\n        @keyframes colorChange {\n          0% { color: #A15AFB; }\n          50% { color: #FF6778; }\n          100% { color: #A15AFB; }\n        }\n\n        ".concat(A," {\n          animation: tracking-in-contract 0.4s cubic-bezier(0.215, 0.610, 0.355, 1.000);\n        }\n      "),document.head.appendChild(e)}),(0,a._)(this,"removeCSS",()=>{let e=document.querySelector("#".concat(m));null==e||e.remove()}),(0,a._)(this,"transformP",(e,t)=>{if(e.el.style.animation="",this.simplifiedParagraphs.add(e.el),this.simplifyingParagraphs.delete(e.el),!t||(this.paragraphCache.set(e.el,t),!this.enabled||e.el.textContent===t))return;let i=document.createElement(p);i.innerHTML=e.el.innerHTML,i.style.width="100%",i.style.height="100%",i.style.transition="opacity 0.3s, filter 0.3s",i.style.visibility="visible";let a=document.createElement(A);a.textContent=t,a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.opacity="0",a.style.width="100%",a.style.transition="opacity 0.3s",e.el.innerHTML="",e.el.appendChild(i),e.el.appendChild(a),"static"===getComputedStyle(e.el).position&&(e.el.style.position="relative"),i.style.opacity="0.2",i.style.filter="blur(3px)",a.style.opacity="1",a.style.visibility="visible";let o=()=>{i.style.opacity="1",i.style.filter="",a.style.visibility="hidden"},s=()=>{i.style.opacity="0.2",i.style.filter="blur(3px)",a.style.opacity="1",a.style.visibility="visible"};e.el.addEventListener("mouseover",o),e.el.addEventListener("mouseout",s),this.listenerDisposers.push(()=>{e.el.removeEventListener("mouseover",o),e.el.removeEventListener("mouseout",s)})}),(0,c.rC)(this)}}(0,o.gn)([s.SB],y.prototype,"enabled",void 0);let v=new y;var w=i(33381),C=i(90180),b=i(19613),S=i(37949),I=i(34889),_=i(18245),T=i(15851),k=i(13942),E=i(1396),M=i(44469),x=i(11502),B=i(92020),D=i(91433),L=i(17092),R=i.n(L),U=i(90107),P=i(76469),F=i(2490);let O=["SCRIPT","STYLE","NOSCRIPT","IFRAME","OBJECT","EMBED","MONICA-TRANSLATE-WRAPPER","MONICA-TRANSLATE","SVG"];class N{parseDom(e){let t=function(e){let t=e.cloneNode(!1);return!function e(t,i){if(O.includes(t.nodeName.toLocaleUpperCase()))return;let a=t.cloneNode(!1);for(let o of(i.appendChild(a),t.childNodes))e(o,a)}(e,t),t}(e),i=this.fetchImages(e);return{nodeContent:t.outerHTML||"",fullText:e.innerText,images:i,meta:{title:document.title||"",url:document.location.href}}}parsePage(){let e=document.cloneNode(!0),t=new F.Readability(e).parse(),i=this.fetchImages(document.body);return{nodeContent:(null==t?void 0:t.content)||"",fullText:document.body.innerText,images:i,meta:{title:document.title||"",url:document.location.href}}}fetchImages(e){let t=[...e.querySelectorAll("img")];return(t=(t=t.filter(e=>e.width>100&&e.height>20&&n.x.checkVisibility(e))).slice(0,5)).map(e=>({alt:e.alt,src:e.src,originSrc:""}))}}let V=new N;var Q=i(82066),z=i(56607),H=i(52825),W=i(71528),G=i(21157),j=i(90539),J=i(78148);let K=[{name:"youtube",regex:/^(www.)?youtube.com/,sidebarContainerQuery:["#secondary.style-scope.ytd-watch-flexy"],appendContainerQuery:[],getVideoNode:()=>document.querySelector("video.html5-main-video"),getVideoTitle(){var e,t,i;return(null===(e=document.querySelector(".style-scope.ytd-watch-metadata#title"))||void 0===e?void 0:e.innerText)||(null!==(i=null===(t=document.querySelector("title"))||void 0===t?void 0:t.textContent)&&void 0!==i?i:"")},async getVideoInformation(){let e={title:this.getVideoTitle(),link:window.location.href},t="",i=[],a=r.m.getQueryFromUrl("v",e.link);if(a){let{langList:o,detail:s}=await q(a);e.videoDetails=s,o.length&&(t=o[0].language,(i=await X(o[0].link)).length&&(e.transcript={language:t,list:i}));let n=await fetch(e.link).then(e=>e.text());e.isNotSupport=/"playabilityStatus"\s*:\s*\{\s*"status"\s*:\s*"UNPLAYABLE"/.test(n)}return e.videoId=a||"",e},async getCommentNode(){let e=0,t=async()=>document.querySelector("#placeholder-area")||((window.scrollTo(0,400),e<5)?(e++,await r.m.delay(500),await t()):null),i=await t();return new Promise(e=>{i?(i.click(),setTimeout(()=>{e(document.querySelector("#contenteditable-root"))},50)):e(null)})},watchRouteChange(e){let t="",i=setInterval(()=>{let i=r.m.getQueryFromUrl("v",window.location.href);window.location.href!==t&&i&&(e(),t=window.location.href)},1e3);return()=>{clearInterval(i)}}}];async function q(e){let t=await fetch("https://www.youtube.com/watch?v=".concat(e)).then(e=>e.text()),i={},a=/var ytInitialPlayerResponse = ({[\s\S]*});var meta = document\.createElement\('meta'\);/.exec(t);if(a){var o;i=(null===(o=JSON.parse(a[1]))||void 0===o?void 0:o.videoDetails)||{}}let s=t.split('"captions":');if(s.length<2)return{langList:[],detail:i};let n=JSON.parse(s[1].split(',"videoDetails')[0].replace("\n","")).playerCaptionsTracklistRenderer.captionTracks,r=Array.from(n).map(e=>e.name.simpleText),l="English";return r.sort(function(e,t){return e.includes(l)?-1:t.includes(l)?1:0}),r.sort(function(e,t){return e===l?-1:t===l?1:0}),{detail:i,langList:Array.from(r).map(e=>{var t,i;let a=null!==(i=null===(t=n.find(t=>t.name.simpleText===e))||void 0===t?void 0:t.baseUrl)&&void 0!==i?i:"";return{language:e,link:a}})}}let X=async e=>{let t=await fetch(e).then(e=>e.text());return Array.from(new DOMParser().parseFromString(t,"text/xml").getElementsByTagName("text")).map(e=>{var t,i,a;return{start:parseFloat(null!==(t=e.getAttribute("start"))&&void 0!==t?t:"0"),dur:parseFloat(null!==(i=e.getAttribute("dur"))&&void 0!==i?i:"0"),text:null!==(a=e.textContent)&&void 0!==a?a:""}})};var Z=i(10759),Y=i(39936),$=i(58351),ee=i(44795),et=i(36976),ei=i(47720);let ea={left:-9999,top:-9999,width:0,height:0};class eo extends P.v{isActiveSystemTool(e){var t;return"monica_trans"===e?"translated"===h.translateHelper.renderType:"simplify_article"===e?v.enabled:this.popoverOpenToolId===e||(null===(t=this.activeCustomTool)||void 0===t?void 0:t.uid)===e}setViews(e){this.views=e}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.originSearch=t,this.outputManager=e,this.addListeners(),this.initChat()}get baseModelList(){return ei.serverConfigController.getStaticConfig("monicaModelList")||[]}get siteSourceList(){return ei.serverConfigController.getStaticConfig("siteMatchConfigList")||[]}get allSiteMatchList(){return ei.serverConfigController.getStaticConfig("smartActionUrl")||[]}showSystemToolNotice(e,t,i){this.systemToolNotice={uid:e,node:t,arrow:i}}hideSystemToolNotice(){this.systemToolNotice=null}findMatchSiteInfo(){let e={site:null,path:null};return this.siteList.find(t=>{if((0,Z.Hb)({websiteMatchingStrategy:"rule_based",siteMatch:[{urlMatchType:"wildcard",urlMatchInfo:{urlInWildcard:t.url}}]},this.siteList)){e.site=t;let{paths:i=[]}=t,a=i.find(e=>(0,Z.Hb)({websiteMatchingStrategy:"rule_based",siteMatch:[{urlMatchType:"wildcard",urlMatchInfo:{urlInWildcard:e.path}}]},this.siteList));return a&&(e.path=a),!0}return!1}),e}get matchSiteInfo(){return this.findMatchSiteInfo()}get hasRecommendToolInCurrentSite(){let e=document.location.href,t=this.siteList;return!!this.allTools.filter(i=>(0,Z.ju)({siteMatch:i.websiteMatchingInfos||[],websiteMatchingStrategy:i.websiteMatchingStrategy},e,t)).length}get replyData(){return this.replyDataMap[this.currentTaskId]}get collectionToolsMap(){let e=this.fixedCollectionTools.filter(e=>(0,Z.Hb)({docType:e.docType,siteMatch:e.websiteMatchingInfos||[],websiteMatchingStrategy:e.websiteMatchingStrategy},this.siteList)).map(e=>({...e,pin:e.pin}));return(e=>{let t=[],i=[],a=e.filter(e=>{var a;if(this.fixedCollectionTools.some(t=>t.uid===e.uid))return t.push(e),!1;let{isPublic:o,isShared:s,deleted:n,favoriteOrigin:r,userId:l}=e,d=l===(null===(a=w.userController.userInfo)||void 0===a?void 0:a.id);if(e.isMyTool=d,n)return i.push(e),!1;if(d)return!0;if("community"===r){if(!o)return e.isDelist=!0,i.push(e),!1}else if("share"===r&&!o&&!s)return e.isCancelShare=!0,i.push(e),!1;return!0});return{fixedCollectionTools:t,allTools:a,disableCollectionTools:i}})(this.showCurrentSiteOnly?[...e,...this.collectionToolListInCurrentSite]:[...e,...this.collectionToolListWithPin])}get collectionToolListWithPin(){return this.collectionToolList.map(e=>({...e,pin:e.pin||this.pinTools.includes(e.uid)}))}get collectionToolListInCurrentSite(){let e=this.collectionToolList.filter(e=>(0,Z.Hb)({docType:e.docType,siteMatch:e.websiteMatchingInfos||[],websiteMatchingStrategy:e.websiteMatchingStrategy},this.siteList)).map(e=>({...e,pin:e.pin||this.pinTools.includes(e.uid)}));return(0,U.Z)(e,"uid")}get S(){return l.S.Global.components.ActionTool}get siteList(){return this.siteSourceList.map(e=>({label:e.label,id:e.id,url:e.url,paths:(e.paths||[]).map(e=>({id:e.id,label:e.label,path:e.path}))}))}get botItems(){return this.botInfo?[this.botInfo]:[]}get chatBotController(){return this.botInfo?this.botInfo.controller:null}get sortSystemTools(){let e=Array(this.pinSyStemTools.length).fill(void 0),t=[];return this.systemTools.forEach(i=>{let a=this.pinSyStemTools.findIndex(e=>e===i.uid);-1!==a?e[a]=i:t.push(i)}),[...e=e.filter(e=>!!e),...t]}get systemTools(){let e="chatWithPage"===this.readingPageDefaultAction,t=r.m.isPdfDoc(document)?this.S.summarize:C.A.withShortcutLabel(this.S.summarize,"reading");return[{uid:"summary_page",icon:e?"xiaoxi-e132hp4n":"sidebarRead",pin:this.pinSyStemTools.includes("summary_page"),name:e?this.S.ReadingSetting.chatWithPage:t,description:"",websiteMatchingStrategy:"all",toolBelong:G.J.ToolBelong.system,isActive:this.isActiveSystemTool("summary_page")},{uid:"monica_trans",icon:"monicaTrans",pin:this.pinSyStemTools.includes("monica_trans"),name:this.S.translate,description:"",websiteMatchingStrategy:"all",toolBelong:G.J.ToolBelong.system,isActive:this.isActiveSystemTool("monica_trans")},{uid:"screen_recognition",icon:"sRecognition",name:this.S.screenshotRecognize,description:"",pin:this.pinSyStemTools.includes("screen_recognition"),websiteMatchingStrategy:"all",toolBelong:G.J.ToolBelong.system,isActive:this.isActiveSystemTool("screen_recognition")},{uid:"screenshot",icon:"sidebarScreenshot",pin:this.pinSyStemTools.includes("screenshot"),name:C.A.withShortcutLabel(this.S.screenshot,"takeScreenshot"),description:"",websiteMatchingStrategy:"all",toolBelong:G.J.ToolBelong.system,isActive:this.isActiveSystemTool("screenshot")},{uid:"clip_page",icon:"clipPage",pin:this.pinSyStemTools.includes("clip_page"),name:this.S.clipPage,description:"",websiteMatchingStrategy:"all",toolBelong:G.J.ToolBelong.system,isActive:this.isActiveSystemTool("clip_page")},{uid:"recommend_site",icon:"recommendSite",pin:this.pinSyStemTools.includes("recommend_site"),name:this.S.recommendSite,description:"",websiteMatchingStrategy:"all",toolBelong:G.J.ToolBelong.system,isActive:this.isActiveSystemTool("recommend_site")},{uid:"simplify_article",icon:v.enabled?"file-attachment-04":"simplifyArticle",pin:this.pinSyStemTools.includes("simplify_article"),name:this.S.simplifyArticle,description:"",websiteMatchingStrategy:"all",toolBelong:G.J.ToolBelong.system,isActive:this.isActiveSystemTool("simplify_article")},{uid:"ai_podcast",icon:"podcast",pin:this.pinSyStemTools.includes("ai_podcast"),name:this.S.aiPodcast,description:"",websiteMatchingStrategy:"all",toolBelong:G.J.ToolBelong.system,isActive:this.isActiveSystemTool("ai_podcast")}]}get systemRunInAllTools(){return this.systemTools.filter(e=>"all"===e.websiteMatchingStrategy)}get systemRunInCurrentSiteTools(){return this.sortSystemTools.filter(e=>(0,Z.Hb)({docType:e.docType,siteMatch:e.websiteMatchingInfos,websiteMatchingStrategy:e.websiteMatchingStrategy},this.siteList))}get recommendWithCollectInfoTools(){return this.recommendInCurrentTools.map(e=>({...e,isCollect:this.collectionToolList.some(t=>t.uid===e.uid)}))}get offset(){return{x:0,y:0}}get botList(){let e=this.baseModelList.filter(e=>e.capabilities.includes("tools")).map(e=>({label:e.name,key:e.key,value:e.key,logoUrl:e.iconUrl}));return[{label:this.S.defaultModel,key:"default",value:"default",icon:"defaultmodel",logoUrl:""},...e]}get isOverMaxPin(){return this.systemRunInCurrentSiteTools.filter(e=>e.pin).length+this.collectionToolsMap.allTools.filter(e=>e.pin).length>=10}get activeToolCanShare(){var e,t;return this.activeCustomTool&&!this.activeCustomTool.deleted&&((null===(e=this.activeCustomTool)||void 0===e?void 0:e.isPublic)||(null===(t=this.activeCustomTool)||void 0===t?void 0:t.isShared))}get showShareBanner(){return this.shareToolId&&this.shareData&&this.activeCustomTool&&this.activeCustomTool.uid===this.shareData.metaData.uid}getSiteItem(e){if(!e)return null;let t=this.siteList.find(t=>t.id===e.siteId);return t?{...t,paths:t.paths.filter(t=>e.pathIds.includes(t.id))}:null}autoTriggerToolAction(e){let t=(window.innerHeight||document.documentElement.clientHeight)-b.w.sidebarEntryBtn.bottomPercent*window.innerHeight,i=window.innerWidth||document.documentElement.clientWidth;this.triggerToolAction(e,{left:S.w.isSidebarEntryBtnRenderLeft?50:i-450,top:t}),j.DN.removeRunToolData(e.uid)}toggleShowCurrentSiteOnly(){j.DN.makeShowCurrentSiteOnly(!this.showCurrentSiteOnly)}async autoTriggerToolHistoryAction(e,t,i,a){var o,s;let n=a;if(!n){let e=(window.innerHeight||document.documentElement.clientHeight)-b.w.sidebarEntryBtn.bottomPercent*window.innerHeight,t=window.innerWidth||document.documentElement.clientWidth;n={left:S.w.isSidebarEntryBtnRenderLeft?50:t-450,top:e}}this.activeToolIsReadonly=!0;let r=t[0];this.currentTaskId=r.taskId;let l=!1,d=[];t.forEach(e=>{this.replyDataMap[e.taskId]={...e.replyData}}),this.activeCustomTool=e,this.activeCustomTool.deleted=!0,null===(o=r.replyData.extraData.otherReply)||void 0===o||o.forEach(e=>{this.parseArtifacts(e,r.taskId,l,!0,d,{setFlag:()=>{l=!1}})}),null===(s=this.outputManager)||void 0===s||s.showOutput(n,this.offset,this.botList,"default");let c={...await j.DN.getLatestToolInfo(e.uid,i),i18nData:e.i18nData};this.activeCustomTool=c,this.activeCustomTool.deleted=c.deleted}autoTriggerShareToolAction(e,t,i){var a,o,s;let n=(window.innerHeight||document.documentElement.clientHeight)-b.w.sidebarEntryBtn.bottomPercent*window.innerHeight,r=window.innerWidth||document.documentElement.clientWidth;this.activeCustomTool=e;let l={left:S.w.isSidebarEntryBtnRenderLeft?50:r-450,top:n},{type:d}=e,c={sitePayload:i.sitePayload,userMsg:i.userMsg,model:i.model};if(this.askQuestionDataCache.set(e.uid,c),d===G.J.ToolType.artifact){this.triggerAskQuestion(l);return}let h=null===(a=t.extraData)||void 0===a?void 0:a.taskId;this.currentTaskId=h,null===(o=this.outputManager)||void 0===o||o.showOutput(l,this.offset,this.botList,"default");let g=!1,p=[];this.replyDataMap[h]={...t,fromShare:!0},null===(s=t.extraData.otherReply)||void 0===s||s.forEach(e=>{this.parseArtifacts(e,h,g,!0,p,{setFlag:()=>{g=!1}})})}triggerToolAction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{left:0,top:0},i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,{toolBelong:o}=e;switch(this.popoverOpenToolId="",o){case G.J.ToolBelong.system:this.emit("triggerSystemActionTool",{uid:e.uid,from:i,payload:null==a?void 0:a.payload});return;case G.J.ToolBelong.user:default:this.triggerUserToolAction(e,t,i,a)}}triggerUserToolAction(e,t,i,a){let{type:o,uid:s}=e;if(this.activeCustomTool){var n;let e=null===(n=this.activeCustomTool)||void 0===n?void 0:n.uid;if(this.destroyActiveTool(),s===e)return}if(this.activeCustomTool=e,this.activeFrom=i,a&&(this.runExtra=a),o===G.J.ToolType.artifact){this.triggerAskQuestion(t);return}if(o===G.J.ToolType.standard){let{contentExtractionMethod:i}=e;if(i===G.J.CollectionRangeType.selected){this.previewToolId!==e.uid&&(this.hideSideBarBtn=!0),this.initSelectTool(t);return}let{enableExtra:a}=this.activeCustomTool.standardActionConfiguration||{};if(this.initSitePayload(i),a){this.triggerInput(t);return}this.triggerAskQuestion(t)}}setCreateSuccessNotice(e){this.showActionNotice=e}initSitePayload(e){let t;let i=async()=>(await R()(this.selectNode,{useCORS:!0,allowTaint:!0})).toDataURL("image/png",1),a=async()=>this.videoInfoLoadPromise?(await this.videoInfoLoadPromise,this.videoInfo):null;e===G.J.CollectionRangeType.selected?(t=V.parseDom(this.selectNode),"image"===this.selectType?t.imagesPromise=Promise.all([i().then(e=>I.Gi.quickUploadRemoteFileToS3({module:"chat_bot",link:e}).then(e=>({src:e,alt:"",originSrc:""})))]):t.images=[]):e===G.J.CollectionRangeType.all&&((t=V.parsePage()).images=[],t.loadVideoInfo=a()),this.sitePayload=t}triggerSelectSubmit(e,t){if(this.activeCustomTool&&this.selectNode){let{type:i,contentExtractionMethod:a}=this.activeCustomTool;if(i===G.J.ToolType.standard){let{enableExtra:i}=this.activeCustomTool.standardActionConfiguration||{};if(this.selectType=t,i){this.triggerInput(e),this.destroySelectTool(),this.initSitePayload(a);return}this.initSitePayload(a),this.triggerAskQuestion(e),this.destroySelectTool();return}i===G.J.ToolType.artifact&&this.triggerAskQuestion(e)}this.destroySelectTool()}getShareText(e,t){return{Default:(0,l.x)(this.S.message,{name:e,link:t}),WhatsApp:(0,l.x)(this.S.msgForWhatsApp,{name:e,link:t}),Telegram:(0,l.x)(this.S.msgForTelegram,{name:e,link:t}),Facebook:(0,l.x)(this.S.msgForFb,{name:e,link:t}),Twitter:(0,l.x)(this.S.msgForTw,{name:e,link:t}),LinkedIn:(0,l.x)(this.S.msgForLinkIn,{name:e,link:t})}}getShareLink(e){return Q.W.getShareToolPageUrl(e)}cancelExtraInfo(){this.destroyActiveTool()}triggerExtraInfoSubmit(e,t){this.triggerAskQuestion(e,{inputFormValue:t})}triggerAskQuestion(e,t){var i,a,o;if(!this.activeCustomTool)return;let{type:s}=this.activeCustomTool;if(s===G.J.ToolType.artifact){this.showArtifact(e);return}if(!(null===(i=this.activeCustomTool.standardActionConfiguration)||void 0===i?void 0:i.promptTemplate))return;let{inputFormValue:n}=t||{},r=null===(a=this.activeCustomTool.standardActionConfiguration)||void 0===a?void 0:a.model;(w.userController.isFreeUser||!r)&&(r="default");let{isEnough:l,handleCreditsNotEnough:d}=_.K.checkCredits({source:"smart_action_reconmmend_model",module:"default"===r?"basic_query":"genius_bot",reportExtData:{source:"dynamic_action"}});if(!l){d();return}null===(o=this.outputManager)||void 0===o||o.showOutput(e,this.offset,this.botList,r),this.askQuestion({sitePayload:this.sitePayload,userMsg:n||{},model:r})}freezeSelect(){this.freezeSelected=!0}unFreezeSelect(){this.freezeSelected=!1}async updateTool(e){try{let t=this.isMatchAllSite(e),i=await j.DN.updateTool({...e,matchAllSite:t});return this.getToolSquareList({useCache:!1}),i}catch(e){T.M.error(r.m.formatErrorMsg(e))}}async createTool(e){let t=e;if(!t.uid){let i=r.m.genId();t={...e,uid:i}}this.myToolList.unshift(t),this.collectionToolList.unshift(t);try{let e=this.isMatchAllSite(t);await j.DN.createTool({...t,matchAllSite:e})}catch(e){this.myToolList=this.myToolList.filter(e=>e.uid!==t.uid),T.M.error(r.m.formatErrorMsg(e),"pageExtraDialogRoot")}return t}async togglePinTool(e,t){await j.DN.togglePinTool(e,t)}async togglePinSystemTool(e,t){await j.DN.togglePinSystemTool(e,t)}async addCollectionTool(e,t,i){try{await j.DN.addCollectionTool(e,t),null==i||i()}catch(e){T.M.error(r.m.formatErrorMsg(e),"pageExtraDialogRoot")}}async removeCollectionTool(e){try{await j.DN.removeCollectionTool(e.uid)}catch(e){T.M.error(r.m.formatErrorMsg(e),"pageExtraDialogRoot")}}syncRunToolData(e){k.P.sendMessageToExt({event:"syncRunToolData",payload:{toolData:e}})}async insertToolBefore(e,t){let i,a=[...this.collectionToolList];if(a=a.filter(t=>t.uid!==e||(i=t,!1)),!i)return;let o=a.findIndex(e=>e.uid===t);a.splice(o,0,i),this.collectionToolList=a,await j.DN.saveSortCollectionToolList(a,{originUid:e,targetUid:t,action:"move_before"})}async insertToolAfter(e,t){let i,a=[...this.collectionToolList];if(a=a.filter(t=>t.uid!==e||(i=t,!1)),!i)return;let o=a.findIndex(e=>e.uid===t);a.splice(o+1,0,i),this.collectionToolList=a,await j.DN.saveSortCollectionToolList(a,{originUid:e,targetUid:t,action:"move_after"})}async fetchAllSkills(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.allSkills.length&&!e)return;let t=(await j.DN.getSkillList()).map(e=>({label:e.skillName,description:e.description,key:e.uid,value:e.uid}));this.allSkills=t}ensureCurrentLocaleExist(e,t){let i=Object.values(e).find(e=>{let{locale:t}=e;return t===l.a.locale});if(i)t&&(i.name+=t);else{let a=e.en||Object.values(e)[0];i={locale:l.a.locale,name:a.name||"",description:a.description||"",extraData:a.extraData||{}},t&&(i.name+=t),e[l.a.locale]=i}return e}async checkFavoriteListExpired(){let e=await j.DN.get("favoriteListUpdateTime");e?Date.now()-e>this.favoriteListExpiredTime&&j.DN.fetchCollectionToolList():j.DN.fetchCollectionToolList()}async fetchCollectionToolList(){if(this.collectionToolList.length){j.DN.fetchCollectionToolList();return}await j.DN.fetchCollectionToolList()}async fetchMyToolList(){let e=await j.DN.fetchMyToolList();this.myToolList=e||[]}async fetchRecommendToolInCurrentPage(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"collection_first";if(e||!this.recommendInCurrentTools.length){let e=await j.DN.fetchToolInCurrentPage(document.location.href,this.siteList,t);this.recommendInCurrentTools=e}return this.recommendInCurrentTools}async deleteTool(e){await j.DN.deleteTool(e.uid);let t=this.collectionToolList.findIndex(t=>t.uid===e.uid);-1!==t&&this.collectionToolList.splice(t,1);let i=this.myToolList.findIndex(t=>t.uid===e.uid);-1!==i&&this.myToolList.splice(i,1);let a=this.toolSquareList.findIndex(t=>t.uid===e.uid);return -1!==a&&this.toolSquareList.splice(a,1),this.fetchCollectionToolList(),!0}handleCloseAction(){this.destroyActiveTool()}destroyActiveTool(){var e;this.activeToolHistoryCacheMap={},this.activeCustomTool=null,this.runExtra=null,this.activeFrom=void 0,null===(e=this.outputManager)||void 0===e||e.hide(),this.destroySelectTool(),this.setPointerEvents(this.selectNode),this.selectNode=null,this.sitePayload=void 0,this.selectType=null,this.replyDataMap={},this.activeToolIsReadonly=!1}destroySelectTool(){this.unFreezeSelect(),this.selectListeners.removeAll(),this.removeHoverNode(),this.selectActive=!1,this.hideSideBarBtn=!1}getExtraParamFieldLocale(e,t){var i;let a=Object.values(e).find(e=>e.locale===l.a.locale);return a||(a=e.en||Object.values(e)[0]),(null==a?void 0:null===(i=a.extraData)||void 0===i?void 0:i[t])||""}getLocaleV2(e,t){if(!e)return"";if("string"==typeof e)return e;let i=Object.values(e).find(e=>e.locale===l.a.locale);return i||(i=e.en||Object.values(e)[0]),(null==i?void 0:i[t])||""}async getToolSquareList(e){await j.DN.getSquareList({limit:999,offset:0},e)}refreshOutput(e){if(!this.activeCustomTool)return;let{uid:t}=this.activeCustomTool,i=this.askQuestionDataCache.get(t);if(!i)return;let{model:a}=i,o=e||a,{isEnough:s,handleCreditsNotEnough:n}=_.K.checkCredits({source:"smart_action_reconmmend_model",module:"default"===o?"basic_query":"genius_bot",reportExtData:{source:"dynamic_action"}});if(!s){n();return}return this.askQuestion(i,o),!0}async saveHistory(e){if(!this.activeCustomTool)return;let t=this.replyDataMap[e];if(!t)return;let i=this.activeToolHistoryCacheMap[this.activeCustomTool.uid],a={...t};if(!a.extraData)return;let{sitePayload:o,question:s,...n}=a.extraData;a.extraData=n,i?i.result={replyData:a,taskId:e}:(i={historyUid:r.m.genId(),origin:this.activeCustomTool.isCommunity?"community":this.activeCustomTool.favoriteOrigin||"share",result:{replyData:a,taskId:e},saUid:this.activeCustomTool.uid,toolData:this.activeCustomTool,url:window.location.href},this.activeToolHistoryCacheMap[this.activeCustomTool.uid]=i),await j.DN.createHistory(i)}stopTask(e){let t=this.replyDataMap[e];(null==t?void 0:t.extraData)&&(t.extraData.loading=!1,t.extraData.finished=!0,this.saveHistory(e)),this.stopTaskMap[e]=!0}async openPage(e,t){let i;i="string"==typeof e?e:r.m.setUrlParams({...t},e.exampleSite),window.open(i,"_blank");let a=!0,o=()=>{s.destroy(),clearTimeout(n),a=!1},s=M.T3.on("onActiveTabChange",async e=>{let{tabId:i}=e;a&&j.DN.saveQueryPayload(i,t),o()}),n=setTimeout(()=>{s.destroy()},1e4)}async viewExampleToolInExt(e){this.openPage(e,{monicaRunToolId:e.uid}),j.DN.syncRunToolData((0,c.ZN)(e))}async viewExampleTool(e){if(!e.exampleSite)return;let t=await k.P.getIsExtInstalled();z.o.isExtension||t?(z.o.isExtension?j.DN.syncRunToolData((0,c.ZN)(e)):this.syncRunToolData((0,c.ZN)(e)),this.openPage(e,{monicaRunToolId:e.uid})):window.open(e.exampleSite,"_blank")}updateToolItem(e){let t=this.collectionToolList.findIndex(t=>t.uid===e.uid);-1!==t&&(this.collectionToolList[t]=e);let i=this.myToolList.findIndex(t=>t.uid===e.uid);-1!==i&&(this.myToolList[i]=e)}async shareTool(e,t,i,a){try{let t=r.m.genShortId(),o=this.getShareLink(t),s=this.getShareText(this.getLocaleV2(e.i18nData,"name"),o);this.views.openLinkCopiedDialog({insertTarget:a||"pageExtraDialogRoot",source:"actionTool",shareLink:o,shareText:s}),await j.DN.shareTool({uid:t,saUid:e.uid,origin:e.isCommunity?"community":e.favoriteOrigin||"share",execResult:i})}catch(e){T.M.error(r.m.formatErrorMsg(e))}this.sendEvent("smart_action_click",{button:"share",toolId:e.uid,...t})}async getCategoryList(){await j.DN.loadCategories({useCache:!0,autoUpdate:!0})}getDomainFromWildcardUrl(e){let t=e.replace(/^(https?:\/\/)?(www\.)?/,""),i=(t=(t=t.split(/[/?#]/)[0]).replace(/^[\*\.]+|[\*\.]+$/g,"")).split(".");if(1===i.length)return i[0];for(let e=i.length-2;e>=0;e--){let t=i[e].replace(/\*/g,"");if(t)return t}return t}sendEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{source:i,...a}=t;x.M.createUserBehaviorEvent({eventName:e,source:i,extData:a})}async fetchArtifactDemos(){if(this.artifactDemos.length)return this.artifactDemos;let e=await j.DN.fetchArtifactDemos(),t=await Promise.all(e.map(e=>(async()=>await (await fetch(e)).json())()));return this.artifactDemos=t,t}getSiteDesc(e){var t,i,a,o,s;let n="",r=null===(i=e.find(e=>"specific"===e.urlMatchType))||void 0===i?void 0:null===(t=i.urlMatchInfo)||void 0===t?void 0:t.site;r&&(n=(null===(s=this.getSiteItem(r))||void 0===s?void 0:s.label)||"");let d=null===(o=e.find(e=>"wildcard"===e.urlMatchType))||void 0===o?void 0:null===(a=o.urlMatchInfo)||void 0===a?void 0:a.urlInWildcard;return(d&&(n=this.getDomainFromWildcardUrl(d)),e.find(e=>"regexp"===e.urlMatchType)&&(n=this.S.ToolSquare.ToolItem.matchSite),e.length>1)?(0,l.x)(this.S.ToolSquare.ToolItem.applicableToSites,{num:e.length}):(0,l.x)(this.S.ToolSquare.ToolItem.applicableTo,{site:n})}async runHistoryTool(e,t,i){this.deleteQuery("monicaHistoryToolId");let a=await (t?Promise.resolve(t):j.DN.getHistory(e));if(a&&a.result.length){this.autoTriggerToolHistoryAction(a.toolData,a.result,a.origin||"share",i);return}}getAllSite(e){let t=e.flatMap(e=>{var t,i,a;if("specific"===e.urlMatchType){let i=this.getSiteItem(null===(t=e.urlMatchInfo)||void 0===t?void 0:t.site);if(i)return"".concat(null==i?void 0:i.label,": ").concat(null==i?void 0:i.paths.map(e=>e.label).join(", "))}return"wildcard"===e.urlMatchType?"".concat(null===(i=e.urlMatchInfo)||void 0===i?void 0:i.urlInWildcard):"regexp"===e.urlMatchType?"".concat(null===(a=e.urlMatchInfo)||void 0===a?void 0:a.urlInRegExp):[]});return t.length>10?[...t.slice(0,10),(0,l.x)(this.S.ToolSquare.ToolItem.moreWebsite,{count:t.length})].join("\n"):t.join("\n")}async fetchMoreHistoryList(){let{hasMore:e,list:t}=await j.DN.fetchMoreHistoryList(this.histories.length),i=t.filter(e=>!this.histories.find(t=>t.historyUid===e.historyUid));this.histories.push(...i),this.hasMoreHistory=e}showArtifact(e){var t,i,a,o,s,n,r,l;let d=null===(i=this.activeCustomTool)||void 0===i?void 0:null===(t=i.artifactConfiguration)||void 0===t?void 0:t.data,c=null===(o=this.activeCustomTool)||void 0===o?void 0:null===(a=o.artifactConfiguration)||void 0===a?void 0:a.size;if(!d)return;let h=(null===(s=this.previewTool)||void 0===s?void 0:s.uid)===(null===(n=this.activeCustomTool)||void 0===n?void 0:n.uid),g=this.activeFrom,p={artifactData:d,disableSetting:!0,defaultPosition:{translateX:e.left,translateY:e.top,width:null!==(r=null==c?void 0:c.width)&&void 0!==r?r:520,height:null!==(l=null==c?void 0:c.height)&&void 0!==l?l:560},onClose:()=>{this.destroyActiveTool()},onBack:this.activeFrom?()=>{"toolCard"===g&&(this.popoverOpenToolId="playground"),this.destroyActiveTool()}:void 0,onShare:this.activeToolCanShare&&!h?e=>{this.shareTool(this.activeCustomTool,{page:"result",position:"result"},{originPageInfo:{url:window.location.href,title:document.title},artifactData:e},"dialogRoot")}:void 0,...h?{}:{isFavorited:!!this.collectionToolList.some(e=>e.uid===this.activeCustomTool.uid),onFavoriteChange:e=>{if(e)this.removeCollectionTool(this.activeCustomTool);else{var t,i;this.addCollectionTool(this.activeCustomTool,(null===(t=this.activeCustomTool)||void 0===t?void 0:t.favoriteOrigin)||"share"),T.M.success(this.S.favoritedSuccess,"pageExtraDialogRoot"),this.sendEvent("smart_action_click",{page:"result",button:"favorite",toolId:null===(i=this.activeCustomTool)||void 0===i?void 0:i.uid})}}}};this.collectToolWhenShould(),et.H.show({...p,forceUseDefaultPosition:!0})}async askQuestion(e,t){let i;let{sitePayload:a,userMsg:o,model:s}=e,n=t||s,{uid:d,standardActionConfiguration:c,contentExtractionMethod:h}=this.activeCustomTool;this.askQuestionDataCache.set(d,e);let{useUserLanguage:p,enableArtifact:A,enableExtra:m,promptTemplate:u,skills:f}=c,y=Object.keys(H.sC).find(e=>H.sC[e].locale===l.a.locale),v=H.sC[y],w="task:".concat(r.m.genId());this.stopTaskMap[w]=!1,this.replyDataMap[w]={type:"text",content:"",questionId:null,renderInStreaming:!1,extraData:{loading:!0,finished:!1,taskId:w,question:"",sitePayload:a,userMsg:o,model:n,loadingImage:!1},sources:[]},this.currentTaskId=w;let C=this.replyDataMap[w],b={...a};if(null==b?void 0:b.imagesPromise){C.extraData.loadingImage=!0;let e=await b.imagesPromise;b.images=e.filter(e=>!!e),C.extraData.loadingImage=!1}let S=!0,I=[];delete b.imagesPromise,delete b.loadVideoInfo;let _=this.selectType||("all"===h?"site":void 0);if(_&&Object.keys(b).length){var T,k;let e=(null==a?void 0:a.loadVideoInfo)?await a.loadVideoInfo:void 0;i={...b,type:_,infoForVideo:(null==e?void 0:e.transcript)?{transcript:e.transcript,lengthSeconds:(null===(T=e.videoDetails)||void 0===T?void 0:T.lengthSeconds)?Number(null===(k=e.videoDetails)||void 0===k?void 0:k.lengthSeconds):void 0}:void 0}}let E={taskId:w,input:(null==a?void 0:a.fullText)||"",userMsg:o,locale:l.a.locale,saUid:d,aiRespLanguage:v.localeName,model:n,sitePayload:i,toolData:{enableExtra:m,model:n,promptTemplate:u,skills:f,useUserLanguage:p,enableArtifact:A}};if(this.requestDataMap[E.taskId]=E,this.stopTaskMap[w]){C.extraData.loading=!1;return}let M=[],x={type:"text",content:"",questionId:null},B=()=>{C.extraData.otherReply=[...M,x],C.content=C.extraData.otherReply.map(e=>e.content).join("")};this.collectToolWhenShould(),await g.Tn.genCustomAction(E,e=>{var t;if((e.text||e.error||e.finished)&&(C.extraData.loading=!1),(e.error||e.finished)&&(C.extraData.finished=!0,this.saveHistory(w)),e.error){x.type="error",x.content=e.error,B();return}this.stopTaskMap[w]||(e.partialStart&&(C.extraData.loading=!0,M.push(x),x={type:"text",content:"",questionId:null}),(null===(t=e.extraFlags)||void 0===t?void 0:t.question)&&(C.extraData.question=e.extraFlags.question),x.agentStatus||(x.agentStatus=[]),e.agentStatus&&x.agentStatus.push(e.agentStatus),e.sources&&(x.sources=e.sources),e.text&&(x.content+=e.text,this.parseArtifacts(x,w,S,e.finished,I,{setFlag:()=>{S=!1}})),B())})}collectToolWhenShould(){if(this.runExtra){var e;let{shouldAutoFavorite:t,origin:i,uid:a}=this.runExtra;a===(null===(e=this.activeCustomTool)||void 0===e?void 0:e.uid)&&t&&this.addCollectionTool(this.activeCustomTool,i)}}triggerInput(e){var t;null===(t=this.outputManager)||void 0===t||t.showInput(e,this.offset)}calculateSelectionPosition(){if(!this.selectNode||!this.activeCustomTool)return;let e=this.selectNode.getBoundingClientRect(),t=getComputedStyle(this.selectNode,"::after"),i=getComputedStyle(this.selectNode,"::before"),a=Math.max(e.width,parseInt(t.width)||0,parseInt(i.width)||0),o=Math.max(e.height,parseInt(t.height)||0,parseInt(i.height)||0);this.rectInfo={left:e.left,top:e.top,width:a,height:o}}removeHoverNode(){this.rectInfo=ea}setPointerEvents(e,t){e&&(e.style.pointerEvents=t||"")}hoverNode(e){this.setPointerEvents(e,"none"),this.selectNode!==e&&(this.selectNode=e,this.calculateSelectionPosition())}async getSearchPayload(){if(!this.originSearch)return await M.T3.getSelfTabId().then(e=>j.DN.getAll().then(t=>{if(t.tabQueryPayload){let i=t.tabQueryPayload["".concat(e)];if(i)return j.DN.clearQueryPayload(e),{previewToolId:i.monicaPreviewToolId,runToolId:i.monicaRunToolId,shareToolId:i.monicaShareId,runToolSource:i.monicaRunToolSource,historyToolId:i.monicaHistoryToolId}}return{previewToolId:"",runToolId:"",shareToolId:"",runToolSource:"",historyToolId:""}}));let e=new URLSearchParams(this.originSearch),t=e.get("monicaPreviewToolId"),i=e.get("monicaRunToolId");return{previewToolId:t,runToolId:i,shareToolId:e.get("monicaShareId"),runToolSource:e.get("monicaRunToolSource"),historyToolId:e.get("monicaHistoryToolId")}}async runShareTool(e){var t,i,a;let o=await j.DN.fetchShareResult(e);if(this.shareToolId=e,this.shareData=o,!(null===(t=o.execResult)||void 0===t?void 0:t.replyData)||!o.execResult.inputPayload){this.autoTriggerToolAction(o.metaData),this.deleteQuery("monicaShareId");return}this.autoTriggerShareToolAction(o.metaData,null===(i=o.execResult)||void 0===i?void 0:i.replyData,null===(a=o.execResult)||void 0===a?void 0:a.inputPayload),this.deleteQuery("monicaShareId")}deleteQuery(e){let t=new URL(window.location.href);t.searchParams.delete(e),history.replaceState(null,"",t)}async addListeners(){let{previewToolId:e,runToolId:t,shareToolId:i,runToolSource:a,historyToolId:o}=await this.getSearchPayload(),s=!1;if(e){j.DN.addPreviewTools(e),window.addEventListener("beforeunload",()=>{j.DN.removePreviewTools(e)}),this.previewToolId=e,this.showPreviewGuide=!0,j.DN.on("previewToolDataSync",t=>{let i=t[e];i&&(this.previewTool=i)});let t=(0,c.U5)(()=>(0,c.ZN)(this.previewTool),e=>{e&&j.DN.updatePreviewToolData(e)});j.DN.on("exitPreview",i=>{e===i&&(this.deleteQuery("monicaPreviewToolId"),this.previewTool=null,this.previewToolId="",t())})}t&&!i&&(j.DN.on("runToolDataSync",e=>{let i=e[t];i&&!s&&(this.autoTriggerToolAction(i),s=!0)}),"powerup_center"===a&&j.DN.getCommunityToolInfo(t).then(e=>{e.saData&&!s&&(this.autoTriggerToolAction(e.saData),s=!0)})),i&&this.runShareTool(i),o&&this.runHistoryTool(o),j.DN.getAll().then(i=>{var a;if(this.collectionToolList=i.collectionToolList||[],this.myToolList=i.myToolList||[],this.pinTools=i.pinTools||[],this.pinSyStemTools=i.pinSyStemTools,this.actionGuideShowed=i.actionGuideShowed,this.categoryList=i.actionCategories||[],this.showCurrentSiteOnly=i.showCurrentSiteOnly,this.toolSquareList=i.toolSquareList||[],i.firstPageHistoryList){let{list:e,total:t}=i.firstPageHistoryList;this.histories=e||[],this.historyTotal=t||0}if((null===(a=i.allTools)||void 0===a?void 0:a.payload)&&(this.allTools=i.allTools.payload),e){let t=i.syncToolData[e];t&&(this.previewTool=t)}if(t){let e=i.runToolData[t];e&&!s&&(this.autoTriggerToolAction(e),s=!0)}}),B.ll.on("localeChange",()=>{this.fetchAllSkills(!0),this.getToolSquareList()}),B.ll.getAll().then(e=>{this.pageReadingAutoShow=e.pageReadingAutoShow,this.readingPageDefaultAction=e.readingPageDefaultAction,this.aiPodcastAutoShow=e.aiPodcastAutoShow}),B.ll.on("configChange",e=>{void 0!==e.pageReadingAutoShow&&(this.pageReadingAutoShow=e.pageReadingAutoShow),void 0!==e.readingPageDefaultAction&&(this.readingPageDefaultAction=e.readingPageDefaultAction),void 0!==e.aiPodcastAutoShow&&(this.aiPodcastAutoShow=e.aiPodcastAutoShow)}),j.DN.on("actionGuideShowedChange",e=>{this.actionGuideShowed=e}),j.DN.on("collectionToolListChange",e=>{this.collectionToolList=e||[]}),j.DN.on("myToolListChange",e=>{this.myToolList=e||[]}),j.DN.on("pinToolsChange",e=>{this.pinTools=e}),j.DN.on("pinSystemToolsChange",e=>{this.pinSyStemTools=e}),j.DN.on("allToolsChange",e=>{this.allTools=(null==e?void 0:e.payload)||[]}),j.DN.on("actionCategoriesChange",e=>{this.categoryList=e||[]}),j.DN.on("toolSquareListChange",e=>{this.toolSquareList=e||[]}),j.DN.on("showCurrentSiteOnlyChange",e=>{this.showCurrentSiteOnly=e}),j.DN.on("firstPageHistoryListChange",e=>{if(!e)return;let{list:t,total:i}=e;this.histories=t,this.historyTotal=i,this.hasMoreHistory=!0}),this.initVideoInfoListener()}initVideoInfoListener(){var e;let t,i=K.find(e=>e.regex.test(window.location.host));if(!i)return;let a=1,o=async()=>{let e=a+=1;this.videoInfoLoadPromise=(async()=>{let t=await i.getVideoInformation();e===a&&(this.videoInfo=t)})()};o(),e=e=>{if(e){o();return}this.videoInfoLoadPromise=Promise.resolve(void 0),this.videoInfo=null},t="",setInterval(()=>{let i=r.m.getQueryFromUrl("v",window.location.href);window.location.href!==t&&(e(!!i),t=window.location.href)},1e3)}initSelectTool(e){this.selectActive=!0,this.mouseX=e.left,this.mouseY=e.top,this.selectListeners.addDocumentEventListener("mouseleave",()=>{this.freezeSelected||(this.removeHoverNode(),this.mouseX=-9999,this.mouseY=-9999)}),this.selectListeners.addWindowEventListener("mousemove",e=>{if(this.freezeSelected)return;let t=e.clientX,i=e.clientY;this.mouseX=t,this.mouseY=i,this.getTargetNode({x:t,y:i}).then(e=>{e&&this.hoverNode(e)})}),this.selectListeners.addWindowEventListener("wheel",()=>{this.calculateSelectionPosition()}),this.selectListeners.addWindowEventListener("resize",()=>{this.calculateSelectionPosition()}),this.selectListeners.addWindowEventListener("scroll",()=>{this.calculateSelectionPosition()})}initChat(){this.botInfo=E.Mp.getBotItemById(D.Z9.monica)}isMatchAllSite(e){let{websiteMatchingStrategy:t}=e;if("all"===t)return!0;let{websiteMatchingInfos:i=[]}=e;return this.allSiteMatchList.every(e=>(0,Z.ju)({websiteMatchingStrategy:t,siteMatch:i||[]},e,this.siteList))}constructor(){super(),(0,a._)(this,"favoriteListExpiredTime",1728e6),(0,a._)(this,"mouseX",-9999),(0,a._)(this,"mouseY",0),(0,a._)(this,"selectActive",!1),(0,a._)(this,"replyDataMap",{}),(0,a._)(this,"currentTaskId",""),(0,a._)(this,"runToolInCommunity",!1),(0,a._)(this,"myToolList",[]),(0,a._)(this,"collectionToolList",[]),(0,a._)(this,"recommendInCurrentTools",[]),(0,a._)(this,"pinTools",[]),(0,a._)(this,"pinSyStemTools",[]),(0,a._)(this,"allSkills",[]),(0,a._)(this,"selectNode",null),(0,a._)(this,"pageReadingAutoShow",!0),(0,a._)(this,"aiPodcastAutoShow",!0),(0,a._)(this,"readingPageDefaultAction","summaryPage"),(0,a._)(this,"toolSquareList",[]),(0,a._)(this,"rectInfo",ea),(0,a._)(this,"allTools",[]),(0,a._)(this,"botInfo",null),(0,a._)(this,"activeCustomTool",null),(0,a._)(this,"activeToolIsReadonly",!1),(0,a._)(this,"runExtra",null),(0,a._)(this,"activeFrom",void 0),(0,a._)(this,"activeSystemTool",{}),(0,a._)(this,"freezeSelected",!1),(0,a._)(this,"outputLoading",!1),(0,a._)(this,"popoverOpenToolId",""),(0,a._)(this,"previewToolId",""),(0,a._)(this,"showPreviewGuide",!1),(0,a._)(this,"showActionNotice",!1),(0,a._)(this,"previewTool",null),(0,a._)(this,"runTool",null),(0,a._)(this,"artifactDemos",[]),(0,a._)(this,"showCurrentSiteOnly",!1),(0,a._)(this,"histories",[]),(0,a._)(this,"hasMoreHistory",!0),(0,a._)(this,"historyTotal",0),(0,a._)(this,"fixedCollectionTools",[{uid:"pdf_convert",icon:"pdfConvert",name:this.S.pdfConvert,description:"",websiteMatchingStrategy:G.J.SiteType.designated,docType:G.J.DocType.pdf,toolBelong:G.J.ToolBelong.system,pin:!0}]),(0,a._)(this,"shareToolId",void 0),(0,a._)(this,"shareData",void 0),(0,a._)(this,"actionGuideShowed",!0),(0,a._)(this,"hideSideBarBtn",!1),(0,a._)(this,"categoryList",[]),(0,a._)(this,"systemToolNotice",null),(0,a._)(this,"videoInfoLoadPromise",null),(0,a._)(this,"videoInfo",null),(0,a._)(this,"podcastOnboardingVisible",!1),(0,a._)(this,"podcastSettingOpen",!1),(0,a._)(this,"readingPageSettingOpen",!1),(0,a._)(this,"requestDataMap",{}),(0,a._)(this,"selectBoxEl",void 0),(0,a._)(this,"views",void 0),(0,a._)(this,"selectListeners",new W.M),(0,a._)(this,"fetchNodeFlag",0),(0,a._)(this,"originSearch",""),(0,a._)(this,"stopTaskMap",{}),(0,a._)(this,"askQuestionDataCache",new Map),(0,a._)(this,"outputManager",null),(0,a._)(this,"selectType",null),(0,a._)(this,"sitePayload",void 0),(0,a._)(this,"activeToolHistoryCacheMap",{}),(0,a._)(this,"parseArtifacts",(e,t,i,a,o,s)=>{let{setFlag:n}=s,r=Y.C.parseArtifactContent(e.content);if(r&&r.length>0){if(e.artifacts=r,this.currentTaskId!==t)return;let s=r[r.length-1];if(s.data.content){var l,d,c,h;if(i){let{position:e,draggableController:t,resizableController:i}=J.liteWindowController.actionToolManager.actionOutputManager,a=t.translate||{x:0,y:0},o=i.data||{translateX:0,translateY:0},r=e.left+a.x+o.translateX;null===(l=this.chatBotController)||void 0===l||l.artifactManager.artifactDataManager.updateDefaultPosition({translateX:Math.max(r-800-19,0),translateY:19,width:800,height:window.innerHeight-38}),null===(d=this.chatBotController)||void 0===d||d.artifactManager.show({artifactData:s,convId:"",replyId:"",disableOpen:!C.A.artifactAutoOpenDialog||$.y.shouldRenderRawContent(s.data.type),enableQuickFix:!1,isShareMode:!!this.showShareBanner}),n()}else s.streaming&&(null===(c=this.chatBotController)||void 0===c||c.artifactManager.artifactDataManager.setArtifactData($.y.chatArtifactData2ServerArtifactData({artifact:s.data,conversationId:"",replyId:""})));(a||!1===s.streaming)&&(null===(h=this.chatBotController)||void 0===h||h.artifactManager.artifactDataManager.markAsSteamFinished())}a&&r.forEach(e=>{e.streaming=!1}),r&&r.forEach(e=>{let t=e.data.id;if(!o.includes(t)&&!e.streaming){var i,a;let s=(null===(i=this.chatBotController)||void 0===i?void 0:i.artifactManager.mergedArtifactsVersionMap[t])||[];null===(a=this.chatBotController)||void 0===a||a.artifactManager.createSyncArtifactTask([{artifactData:e.data,conversationId:"",itemId:"",version:s.length}]),o.push(t)}})}}),(0,a._)(this,"getTargetNode",async e=>{let{x:t,y:i}=e,a=this.fetchNodeFlag+=1;if(this.setPointerEvents(this.selectBoxEl,"none"),this.setPointerEvents(this.selectNode),a!==this.fetchNodeFlag)return;let o=document.elementFromPoint(t,i);if(this.setPointerEvents(this.selectBoxEl),o)return"monica-content-root"===o.id?void 0:o.nodeType===Node.TEXT_NODE?o.parentElement:o}),(0,a._)(this,"clipPage",(0,ee.c)({name:"clipPage",channels:["extensionSidePanel","extensionContent"],handler:async()=>{(await E.Mp.beforeContinueInChat()).readingSummary({waitToMemoSaved:!0})}})),(0,a._)(this,"readingSummary",(0,ee.c)({name:"readingSummary",channels:["extensionSidePanel","extensionContent"],handler:async()=>{(await E.Mp.beforeContinueInChat()).readingSummary({showSidePanel:!0,behaviorEvent:{eventName:"reading_summary_btn_click",source:"sidebar_entry"}})}})),(0,c.rC)(this)}}(0,o.gn)([s.SB],eo.prototype,"mouseX",void 0),(0,o.gn)([s.SB],eo.prototype,"mouseY",void 0),(0,o.gn)([s.SB],eo.prototype,"selectActive",void 0),(0,o.gn)([s.SB],eo.prototype,"replyDataMap",void 0),(0,o.gn)([s.SB],eo.prototype,"currentTaskId",void 0),(0,o.gn)([s.SB],eo.prototype,"runToolInCommunity",void 0),(0,o.gn)([s.SB],eo.prototype,"myToolList",void 0),(0,o.gn)([s.SB],eo.prototype,"collectionToolList",void 0),(0,o.gn)([s.SB],eo.prototype,"recommendInCurrentTools",void 0),(0,o.gn)([s.SB],eo.prototype,"pinTools",void 0),(0,o.gn)([s.SB],eo.prototype,"pinSyStemTools",void 0),(0,o.gn)([s.SB],eo.prototype,"allSkills",void 0),(0,o.gn)([s.SB],eo.prototype,"selectNode",void 0),(0,o.gn)([s.SB],eo.prototype,"pageReadingAutoShow",void 0),(0,o.gn)([s.SB],eo.prototype,"aiPodcastAutoShow",void 0),(0,o.gn)([s.SB],eo.prototype,"readingPageDefaultAction",void 0),(0,o.gn)([s.SB],eo.prototype,"toolSquareList",void 0),(0,o.gn)([s.SB],eo.prototype,"rectInfo",void 0),(0,o.gn)([s.SB],eo.prototype,"allTools",void 0),(0,o.gn)([s.SB],eo.prototype,"botInfo",void 0),(0,o.gn)([s.SB],eo.prototype,"activeCustomTool",void 0),(0,o.gn)([s.SB],eo.prototype,"activeToolIsReadonly",void 0),(0,o.gn)([s.SB],eo.prototype,"runExtra",void 0),(0,o.gn)([s.SB],eo.prototype,"activeFrom",void 0),(0,o.gn)([s.SB],eo.prototype,"activeSystemTool",void 0),(0,o.gn)([s.SB],eo.prototype,"freezeSelected",void 0),(0,o.gn)([s.SB],eo.prototype,"outputLoading",void 0),(0,o.gn)([s.SB],eo.prototype,"popoverOpenToolId",void 0),(0,o.gn)([s.SB],eo.prototype,"previewToolId",void 0),(0,o.gn)([s.SB],eo.prototype,"showPreviewGuide",void 0),(0,o.gn)([s.SB],eo.prototype,"showActionNotice",void 0),(0,o.gn)([s.SB],eo.prototype,"previewTool",void 0),(0,o.gn)([s.SB],eo.prototype,"runTool",void 0),(0,o.gn)([s.SB],eo.prototype,"artifactDemos",void 0),(0,o.gn)([s.SB],eo.prototype,"showCurrentSiteOnly",void 0),(0,o.gn)([s.SB],eo.prototype,"histories",void 0),(0,o.gn)([s.SB],eo.prototype,"hasMoreHistory",void 0),(0,o.gn)([s.SB],eo.prototype,"historyTotal",void 0),(0,o.gn)([s.SB],eo.prototype,"fixedCollectionTools",void 0),(0,o.gn)([s.SB],eo.prototype,"shareToolId",void 0),(0,o.gn)([s.SB],eo.prototype,"shareData",void 0),(0,o.gn)([s.SB],eo.prototype,"actionGuideShowed",void 0),(0,o.gn)([s.SB],eo.prototype,"hideSideBarBtn",void 0),(0,o.gn)([s.SB],eo.prototype,"categoryList",void 0),(0,o.gn)([s.SB],eo.prototype,"systemToolNotice",void 0),(0,o.gn)([s.SB],eo.prototype,"videoInfoLoadPromise",void 0),(0,o.gn)([s.SB],eo.prototype,"videoInfo",void 0),(0,o.gn)([s.SB],eo.prototype,"podcastOnboardingVisible",void 0),(0,o.gn)([s.SB],eo.prototype,"podcastSettingOpen",void 0),(0,o.gn)([s.SB],eo.prototype,"readingPageSettingOpen",void 0),(0,o.gn)([s.Fl],eo.prototype,"baseModelList",null),(0,o.gn)([s.Fl],eo.prototype,"siteSourceList",null),(0,o.gn)([s.Fl],eo.prototype,"allSiteMatchList",null),(0,o.gn)([s.Fl],eo.prototype,"matchSiteInfo",null),(0,o.gn)([s.Fl],eo.prototype,"hasRecommendToolInCurrentSite",null),(0,o.gn)([s.Fl],eo.prototype,"replyData",null),(0,o.gn)([s.Fl],eo.prototype,"collectionToolsMap",null),(0,o.gn)([s.Fl],eo.prototype,"collectionToolListWithPin",null),(0,o.gn)([s.Fl],eo.prototype,"collectionToolListInCurrentSite",null),(0,o.gn)([s.Fl],eo.prototype,"S",null),(0,o.gn)([s.Fl],eo.prototype,"siteList",null),(0,o.gn)([s.Fl],eo.prototype,"botItems",null),(0,o.gn)([s.Fl],eo.prototype,"chatBotController",null),(0,o.gn)([s.Fl],eo.prototype,"sortSystemTools",null),(0,o.gn)([s.Fl],eo.prototype,"systemTools",null),(0,o.gn)([s.Fl],eo.prototype,"systemRunInAllTools",null),(0,o.gn)([s.Fl],eo.prototype,"systemRunInCurrentSiteTools",null),(0,o.gn)([s.Fl],eo.prototype,"recommendWithCollectInfoTools",null),(0,o.gn)([s.Fl],eo.prototype,"offset",null),(0,o.gn)([s.Fl],eo.prototype,"botList",null),(0,o.gn)([s.Fl],eo.prototype,"isOverMaxPin",null),(0,o.gn)([s.Fl],eo.prototype,"activeToolCanShare",null),(0,o.gn)([s.Fl],eo.prototype,"showShareBanner",null);let es=new eo},18508:function(e,t,i){"use strict";i.d(t,{Y:function(){return M},o:function(){return x}});var a=i(66084),o=i(52921),s=i(34491),n=i(22046),r=i(15065),l=i(91433),d=i(73361),c=i(11502),h=i(88575),g=i(88882),p=i(92235),A=i(76469),m=i(73047),u=i(25902),f=i(79854),y=i(90180),v=i(18245),w=i(37949),C=i(38172),b=i(56607),S=i(65324),I=i(54237),_=i.n(I);let T=h.c.getLogger("Agent");class k{async connect(){this.close(),this.remainAttempts=this.maxAttempts;let{taskId:e,botId:t}=this.options,i=await C.W.getToken(),a=_()(b.o.isProd?"https://agent.monica.im/":"https://agent.butterfly-effect.dev",{query:p.m.underlize({rid:e,token:i,botId:t,clientVersion:S.Cb.getVersion(),clientType:b.o.platform,productName:b.o.productName}),path:"/socket.io",transports:["websocket"],timeout:3e3,reconnection:!1});a.on("message",e=>{if(e)try{let t=JSON.parse(e);Array.isArray(t)?t.forEach((e,i)=>{let a=p.m.camelize(e),o=t[i+1]?p.m.camelize(t[i+1]):void 0;this.options.handleOutput(a,o)}):this.options.handleOutput(p.m.camelize(t)),T.log("get msg",t)}catch(t){T.error("SearchAgentSocketIo on msg error",t,e)}}),a.on("connect",()=>{this.options.handleConnect()}),a.on("disconnect",e=>{this.reconnect(e),T.log("SearchAgentSocketIo disconnect",e)}),a.on("connect_error",e=>{this.reconnect(e),T.log("SearchAgentSocketIo io connect_error",e)}),this.socket=a}async sendMsg(e){try{var t,i,a;this.socket||await this.connect(),e.rid=this.options.taskId,e.locale=g.a.locale,e.respondLang=y.A.finalGlobalRespondLanguage,e.modelType=null===(t=(i=this.options).getModelType)||void 0===t?void 0:t.call(i);let o=p.m.underlize(e);null===(a=this.socket)||void 0===a||a.emit("message",JSON.stringify(o))}catch(t){T.error("SearchAgentSocketIo sendMsg error",t,e)}}close(){var e;null===(e=this.socket)||void 0===e||e.close(),this.socket=null,this.retryTimer&&clearTimeout(this.retryTimer)}reconnect(e){if(this.remainAttempts--,this.remainAttempts<=0){var t,i;null===(t=(i=this.options).onError)||void 0===t||t.call(i,p.m.formatMonicaSdkError(e))}else{let e=1e3*Math.max(this.maxAttempts-this.remainAttempts,1);this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=setTimeout(()=>{var e;null===(e=this.socket)||void 0===e||e.connect()},e)}}constructor(e){(0,a._)(this,"socket",null),(0,a._)(this,"options",void 0),(0,a._)(this,"maxAttempts",5),(0,a._)(this,"remainAttempts",0),(0,a._)(this,"retryTimer",null),this.options=e}}let E=h.c.getLogger("Agent");class M{}class x extends f.Q{get S(){return g.S.Agent.agentController}get gpt4Enabled(){return!!this.mustUseGpt4||y.A.gpt4Enabled}get inputTextContent(){return this.inputValue.trim()}get showLoading(){return"paused"!==this.taskStatus&&"ended"!==this.taskStatus&&!this.isLastMsgRunning}get lastMsg(){for(let e=this.messageList.length-1;e>=0;e--){let t=this.messageList[e];if("stage"!==t.type||!t.data.hidden)return t}return null}get isLastMsgRunning(){let e=this.lastMsg;return!!e&&("client_action"===e.type&&"ask"===e.data.action||!e.finished)}get shouldHideInput(){if(this.sharePageParams)return!0;let e=this.lastMsg;return!!e&&"client_action"===e.type&&"ask"===e.data.action}get allSearchResults(){return this.messageGroups.flatMap(e=>e.sources)}get usageModule(){return this.gpt4Enabled?"genius_bot":this.botData.usageModule}get isSearchAgent(){return this.botData.botId===l.tW.searchAgent}get messageGroups(){let e=[],t=-1;return this.messageList.forEach((i,a)=>{if("user_question"===i.type)e.push({question:i.data,sources:[],relatedQuestions:[],searchImageResults:[],searchVideoResults:[],autoSearchImageResults:[],autoSearchVideoResults:[],keywords:[],messages:[],answer:null,expanded:i.expanded,completedSteps:0,setExpanded:e=>{i.expanded=e}}),t++;else{if("stage"===i.type){if(e[t].sources.push(...i.data.searchResults||[]),!i.data.hidden&&"create"===i.action&&e[t].completedSteps++,"agentReadyForAnswer"===i.data.stageKey){var o,s;i.data.sources&&(e[t].sources=i.data.sources),e[t].autoSearchImageResults.push(...(null===(o=i.data.media)||void 0===o?void 0:o.images)||[]),e[t].autoSearchVideoResults.push(...(null===(s=i.data.media)||void 0===s?void 0:s.videos)||[]),this.sortVideoResults(e[t].autoSearchVideoResults)}"agentSearch"===i.data.stageKey&&e[t].keywords.push(...i.data.tags||[])}if("command_result"===i.type&&(e[t].relatedQuestions.push(...i.data.results.questions||[]),e[t].searchImageResults.push(...i.data.results.images||[]),e[t].searchVideoResults.push(...i.data.results.videos||[]),this.sortVideoResults(e[t].searchVideoResults)),"text"===i.type){e[t].answer={item:i,originIndex:a};return}}e[t].messages.push({item:i,originIndex:a})}),e}get recommendQuestions(){return[this.S.recommendQuestion1,this.S.recommendQuestion2,this.S.recommendQuestion3,this.S.recommendQuestion4,this.S.recommendQuestion5]}get botName(){return this.isSearchAgent?"Search Agent":this.botData.botId===l.tW.writingAgent?"Writing Agent":this.botData.botId===l.tW.autoAgent?"Auto Agent":this.botData.botId}async init(){this.botData.botId===l.tW.writingAgent&&(this.mustUseGpt4=!0)}destroy(){this.clearTaskData()}setDetectedInsertIframe(){this.hasDetectedInsertIframe=!0}setDetectInsertIframeResult(e){this.isSupportInsertIframe=e}resetOnLogout(){this.newTask()}updateUsageInfo(){d.gM.updateUsageInfos(["genius_bot","basic_query"])}focusPrimaryInput(){this.eventEmitter.emit("focusPrimaryInput")}setViewData(e){this.viewData=e,"default"===this.viewData.status&&this.focusPrimaryInput()}setInputValue(e){this.inputValue=e}newTask(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"newChat";this.clearTaskData(),"newChat"===e&&this.isSearchAgent?this.newChat=!0:this.setViewData({status:"default"}),setTimeout(()=>{this.focusPrimaryInput()})}clearTaskData(){var e;null===(e=this.socketIo)||void 0===e||e.close(),this.taskStatus="ended",this.taskId="",this.messageList=[],this.stopTaskLoading=!1,this.unlockAutoScroll(),this.setInputValue(""),this.loadTaskLoading=!1,this.inited=!1,this.newChat=!1}async ask(e){var t;let{question:i,source:a,id:o=p.m.genId()}=e,{isEnough:s,handleCreditsNotEnough:n}=v.K.checkCredits({module:this.usageModule,source:a});if(!s){n();return}0!==i.length&&(this.setViewData({status:"main"}),this.taskStatus="running",this.newChat=!1,this.inited||(this.clearTaskData(),this.taskStatus="running",await this.createTask(o)),this.unlockAutoScroll(),this.messageList.push({type:"user_question",data:i,id:p.m.genId(),finished:!0,action:"create",expanded:!0}),null===(t=this.socketIo)||void 0===t||t.sendMsg({input:i,type:this.inited?"input":"init"}),this.setInputValue(""),this.scrollToBottom(!0),this.inited||(this.inited=!0))}async loadTask(e){if(this.taskId!==e){this.clearTaskData(),this.setViewData({status:"main"}),this.loadTaskLoading=!0;try{let t=await u.G.taskMessageList({taskId:e});await this.loadMessageList(t,e),w.w.saveChatPageParams()}catch(e){E.error(e),this.loadTaskLoading=!1,this.setViewData({status:"default"})}}}async loadMessageList(e,t){let{task:i,messageList:a}=e;this.taskStatus=i.status,this.publicShare=i.publicShare;for(let e=0;e<a.length;e++){let t=a[e],i=e===a.length-1;t.isFeedback?this.handleFeedbackOutput({data:t.data,type:"feedback"},i):this.messageList.push({type:"user_question",id:p.m.genId(),data:t.data.input,action:"create",finished:!0,expanded:!1})}t&&await this.createTask(t),this.loadTaskLoading=!1,this.scrollToBottom(),this.inited=!0}stop(){var e;this.unlockAutoScroll(),this.scrollToBottom(),this.stopTaskLoading=!0,null===(e=this.socketIo)||void 0===e||e.sendMsg({type:"cancel"}),this.focusPrimaryInput()}continue(){var e;null===(e=this.socketIo)||void 0===e||e.sendMsg({type:"continue"})}setScrollableContainer(e){this.scrollableContainer=e}getScrollableContainer(){return this.scrollableContainer}lockAutoScroll(){this.scrollLock=!0}unlockAutoScroll(){this.scrollLock=!1}checkIsSystemScroll(){return this.isSystemScroll}transformAnswer(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.allSearchResults;return e.replaceAll(/\[([\^\d,\s]+)\]/g,(e,a)=>{let o="";return a.split(",").forEach(e=>{if(!e)return;let a=Number.parseInt(e.replace("^","").trim());if(isNaN(a))return;let s=i.find(e=>e.idx===a);if(s){if(t){o+=" [".concat(s.title,"](").concat(s.url,")");return}o+=" [".concat(this.agentSourceMarker,"](").concat(a,")")}}),o})}handleClickSource(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.allSearchResults,i=t.find(t=>"".concat(t.idx)===e);i&&(window.open(i.url,"_blank"),this.botData.botId===l.tW.searchAgent&&c.M.createUserBehaviorEvent({eventName:"agent_source_click",extData:{url:i.url}}))}findNextOne(e){for(let t=e+1;t<this.messageList.length;t++){let e=this.messageList[t];if("stage"!==e.type||!e.data.hidden)return e}return null}getBeforeMessages(e){let t=[];for(let i=e-1;i>=0;i--){let e=this.messageList[i];if("user_question"===e.type)break;"stage"===e.type&&e.data.hidden||t.push(e)}return t}updatePublicShare(e){this.publicShare!==e&&(this.publicShare=e,u.G.setShareConfig({taskId:this.taskId,public:e}))}forceScrollToBottom(){if(this.scrollableContainer){let{scrollHeight:e,clientHeight:t}=this.scrollableContainer;this.scrollableContainer.scrollTo({top:e-t})}}setShowScrollBtn(e){this.scrollBtnVisible=e}async createTask(e){this.taskId=e,this.socketIo=new k({taskId:this.taskId,botId:this.botData.botId,handleOutput:async e=>{if(this.handleFeedbackOutput(e),this.handleStatusChangeOutput(e),"feedback"===e.type&&"text"===e.data.type&&e.data.finished){if(this.isSearchAgent){var t;null===(t=this.socketIo)||void 0===t||t.sendMsg({type:"client_command",clientCommand:{callId:"".concat(e.data.id),type:"related_questions"}}),this.messageGroups[this.messageGroups.length-1].setExpanded(!1)}this.updateUsageInfo()}},getModelType:()=>this.gpt4Enabled?"gpt-4":"gpt-35",handleConnect:()=>{}}),await this.socketIo.connect()}handleFeedbackOutput(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];"feedback"===e.type&&(this.doMsgNormalize(e.data),this.tryResolveStage(e.data),this.tryResolveClientCmdResult(e.data),this.tryResolveTextData(e.data),this.tryResolveErrorData(e.data),t&&this.tryResolveClientAction(e.data),this.scrollToBottom())}handleStatusChangeOutput(e){"status_change"===e.type&&(this.stopTaskLoading&&(this.stopTaskLoading=!1),this.taskStatus=e.data.status)}tryResolveStage(e){if("stage"===e.type)try{let{action:t,data:i}=e;if(i.searchResults&&this.updateFavicon(i.searchResults.map(e=>e.url)),"append"===t){let t=this.messageList.find(t=>t.id===e.id);t&&(t.data=this.appendStage(i,t.data),t.finished=e.finished)}else"create"===t&&this.messageList.push({...e,data:i})}catch(t){E.error("agent controller parse stage data error",e)}}tryResolveClientCmdResult(e){if("command_result"===e.type&&e.data.callId){let t=this.messageList.findIndex(t=>"".concat(t.id)===e.data.callId);-1!==t&&this.messageList.splice(t,0,e)}}tryResolveClientAction(e){"client_action"===e.type&&(("client_search"===e.data.action||"search"===e.data.action)&&this.runClientSearch(e.data),"read_screen"===e.data.action&&this.runReadScreen(e.data),"ask"===e.data.action&&this.messageList.push(e))}tryResolveTextData(e){if("text"!==e.type)return;let t=e.action||"create";if("append"===t){let t=this.messageList.find(t=>t.id===e.id);t&&(t.data=t.data+e.data,t.finished=e.finished)}else"create"===t&&this.messageList.push({...e})}tryResolveErrorData(e){"error"===e.type&&"create"===e.action&&("NO_QUOTA"!==e.data.name||this.loadTaskLoading||this.handleQuotaExceed(),this.messageList.push({...e}))}async runClientSearch(e){var t;if(!e.queries){E.error("client search data error");return}let i=e.queries,a=[];for(let e=0;e<i.length;e++){let t=i[e];try{let e=await this.searchWebHelper.doSearch(t);a.push(e)}catch(e){E.log(e)}}u.G.uploadFavicon({faviconList:a.flatMap(e=>e.sites).filter(e=>e.favicon).map(e=>{let t=e.favicon;delete e.favicon;let i=new URL(e.url);return this.iconMap[i.hostname]=t,{base64Data:t,hostname:i.hostname}})}),null===(t=this.socketIo)||void 0===t||t.sendMsg({type:"client_action",skillResult:{data:{results:a},meta:e.meta,missionId:e.missionId,skillName:e.skillName}})}async runReadScreen(e){var t,i;let a=document.title,o=document.body.innerText,s="# ".concat(a,"\n\n").concat(o);null===(i=this.socketIo)||void 0===i||i.sendMsg({type:"client_action",skillResult:{data:{html:null===(t=document.querySelector("html"))||void 0===t?void 0:t.innerHTML,title:a,summary:s,url:window.location.href},meta:e.meta,missionId:e.missionId,skillName:e.skillName}})}async updateFavicon(e){let t=[];for(let i=0;i<e.length;i++){let a=new URL(e[i]).hostname;this.iconMap[a]||t.push(a)}if(t.length>0){let{faviconList:e}=await u.G.getFaviconList({hostnameList:t});e.forEach(e=>{this.iconMap[e.hostname]=e.base64Data})}}scrollToBottom(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=()=>{this.isSystemScroll=!0,setTimeout(()=>{this.isSystemScroll=!1})};t(),this.scrollLock||setTimeout(()=>{if(this.scrollableContainer){let{scrollHeight:i,clientHeight:a}=this.scrollableContainer;t(),this.scrollableContainer.scrollIntoView({behavior:"smooth",block:"end"}),this.scrollableContainer.scrollTo({top:i-a,behavior:e?"smooth":void 0})}},150)}handleQuotaExceed(){let{handleCreditsNotEnough:e}=v.K.checkCredits({module:this.gpt4Enabled?"genius_bot":this.botData.usageModule,source:"agent_quota_exceed"});e()}appendStage(e,t){if("string"==typeof e&&"string"==typeof t)return t+e;let i=e=>"object"==typeof e&&!Array.isArray(e);if(i(e)&&i(t))return Object.keys(e).forEach(i=>{t[i]?"string"==typeof e[i]&&"string"==typeof t[i]?t[i]=t[i]+e[i]:Array.isArray(t[i])&&Array.isArray(e[i])&&t[i].concat(e[i]):t[i]=e[i]}),t;throw Error("append stage error")}doMsgNormalize(e){var t,i;("stage"===e.type||"error"===e.type||"client_action"===e.type||"command_result"===e.type)&&"string"==typeof e.data&&(e.data=p.m.camelize(JSON.parse(e.data))),e.action=null!==(t=e.action)&&void 0!==t?t:"create",e.finished=null!==(i=e.finished)&&void 0!==i?i:"create"===e.action}sortVideoResults(e){e.sort((e,t)=>e.embedHtml&&t.embedHtml?0:e.embedHtml?-1:1),n.S.location.href.startsWith("https:")&&e.sort((e,t)=>e.allowHttpsEmbed&&t.allowHttpsEmbed?0:e.allowHttpsEmbed?-1:1)}constructor(e){super(),(0,a._)(this,"botData",void 0),(0,a._)(this,"agentSourceMarker",void 0),(0,a._)(this,"socketIo",void 0),(0,a._)(this,"eventEmitter",void 0),(0,a._)(this,"agentCrossPlatform",void 0),(0,a._)(this,"viewData",void 0),(0,a._)(this,"inputValue",void 0),(0,a._)(this,"taskId",void 0),(0,a._)(this,"taskStatus",void 0),(0,a._)(this,"inited",void 0),(0,a._)(this,"messageList",void 0),(0,a._)(this,"stopTaskLoading",void 0),(0,a._)(this,"loadTaskLoading",void 0),(0,a._)(this,"iconMap",void 0),(0,a._)(this,"mustUseGpt4",void 0),(0,a._)(this,"publicShare",void 0),(0,a._)(this,"newChat",void 0),(0,a._)(this,"sharePageParams",void 0),(0,a._)(this,"searchPageParams",void 0),(0,a._)(this,"scrollBtnVisible",void 0),(0,a._)(this,"hasDetectedInsertIframe",void 0),(0,a._)(this,"isSupportInsertIframe",void 0),(0,a._)(this,"isSystemScroll",void 0),(0,a._)(this,"scrollLock",void 0),(0,a._)(this,"scrollableContainer",void 0),(0,a._)(this,"searchWebHelper",void 0),this.botData=e,this.agentSourceMarker="#agent_source#",this.socketIo=null,this.eventEmitter=new A.v,this.agentCrossPlatform=null,this.viewData={status:"default"},this.inputValue="",this.taskId="",this.taskStatus="ended",this.inited=!1,this.messageList=[],this.stopTaskLoading=!1,this.loadTaskLoading=!1,this.iconMap={},this.mustUseGpt4=!1,this.publicShare=!1,this.newChat=!1,this.sharePageParams=null,this.searchPageParams=null,this.scrollBtnVisible=!1,this.hasDetectedInsertIframe=!1,this.isSupportInsertIframe=!0,this.isSystemScroll=!1,this.scrollLock=!1,this.scrollableContainer=null,this.searchWebHelper=new r.v(async(e,t)=>await c.M.proxyFetch(e,t),async e=>await c.M.abortProxyFetch(e),(e,t)=>{E.log("".concat(e," search web error"),t)}),(0,m.rC)(this)}}(0,o.gn)([s.SB],x.prototype,"viewData",void 0),(0,o.gn)([s.SB],x.prototype,"inputValue",void 0),(0,o.gn)([s.SB],x.prototype,"taskId",void 0),(0,o.gn)([s.SB],x.prototype,"taskStatus",void 0),(0,o.gn)([s.SB],x.prototype,"inited",void 0),(0,o.gn)([s.SB],x.prototype,"messageList",void 0),(0,o.gn)([s.SB],x.prototype,"stopTaskLoading",void 0),(0,o.gn)([s.SB],x.prototype,"loadTaskLoading",void 0),(0,o.gn)([s.SB],x.prototype,"iconMap",void 0),(0,o.gn)([s.SB],x.prototype,"mustUseGpt4",void 0),(0,o.gn)([s.SB],x.prototype,"publicShare",void 0),(0,o.gn)([s.SB],x.prototype,"newChat",void 0),(0,o.gn)([s.SB],x.prototype,"sharePageParams",void 0),(0,o.gn)([s.SB],x.prototype,"searchPageParams",void 0),(0,o.gn)([s.SB],x.prototype,"scrollBtnVisible",void 0),(0,o.gn)([m.Fl],x.prototype,"S",null),(0,o.gn)([m.Fl],x.prototype,"gpt4Enabled",null),(0,o.gn)([m.Fl],x.prototype,"inputTextContent",null),(0,o.gn)([m.Fl],x.prototype,"showLoading",null),(0,o.gn)([m.Fl],x.prototype,"lastMsg",null),(0,o.gn)([m.Fl],x.prototype,"isLastMsgRunning",null),(0,o.gn)([m.Fl],x.prototype,"shouldHideInput",null),(0,o.gn)([m.Fl],x.prototype,"allSearchResults",null),(0,o.gn)([m.Fl],x.prototype,"usageModule",null),(0,o.gn)([m.Fl],x.prototype,"isSearchAgent",null),(0,o.gn)([m.Fl],x.prototype,"messageGroups",null),(0,o.gn)([m.Fl],x.prototype,"recommendQuestions",null),(0,o.gn)([m.Fl],x.prototype,"botName",null)},76752:function(e,t,i){"use strict";i.d(t,{L:function(){return m}});var a=i(4461),o=i(98775),s=i(93893),n=i(14292),r=i(92235),l=i(82270),d=i(73047),c=i(24900),h=i(70174),g=i(18245),p=i(33381);class A{isHumanizeAction(e){return"humanize"===e.systemKey}isHumanizeTemplate(e){return"humanize"===e.key}getCheckStatus(e){var t;return e?(null!==(t=e.totalResult)&&void 0!==t?t:0)>50?"human":"ai":"checking"}getModelStateList(e){let t=[];if(e){var i,r;t=null!==(r=null===(i=e.resultList)||void 0===i?void 0:i.map(e=>{var t,i;let r;r="Copyleaks"===e.serviceName?(0,a.Q)(o.Z):"GPTZero"===e.serviceName?(0,a.Q)(s.Z):(0,a.Q)(n.Z);let l=null!==(t=e.result)&&void 0!==t?t:0,d="checking";return d=l>=0&&l<=40?"ai":l>40&&l<=60?"maybeHuman":"human",{name:null!==(i=e.serviceName)&&void 0!==i?i:"",status:d,logo:r,score:l}}))&&void 0!==r?r:[]}else t=[{name:"ZeroGPT",logo:(0,a.Q)(n.Z),status:"checking"},{name:"GPTZero",logo:(0,a.Q)(s.Z),status:"checking"},{name:"Copyleaks",logo:(0,a.Q)(n.Z),status:"checking"}];return t.map(e=>({...e,lock:"ZeroGPT"!==e.name&&p.userController.isFreeUser}))}checkAiContentCredits(){let e=p.userController.isFreeUser?"ai_content_detect":"credits",{isEnough:t,handleCreditsNotEnough:i}=g.K.checkCredits({source:e,module:e,featureName:"bypass"});return!!t||(i(),!1)}checkBypass(){let e=p.userController.isFreeUser?"bypass":"credits",{isEnough:t,handleCreditsNotEnough:i}=g.K.checkCredits({source:e,module:e,featureName:"bypass"});return!!t||(i(),!1)}bypass(e,t){return c.Tn.generateHumanize(e,t)}async check(e){let t=await h.v.checkAiContent({taskId:r.m.genId(),content:e,captchaToken:""});if(t===l.Eg.quotaExceeded||t===l.Eg.creditsQuotaExceed)throw t;return t}constructor(){(0,d.rC)(this)}}let m=new A},36976:function(e,t,i){"use strict";i.d(t,{H:function(){return g}});var a=i(66084),o=i(52921),s=i(34491),n=i(12596),r=i(73047),l=i(90180),d=i(44795),c=i(20549);class h{initServiceListener(){c.D.on("onConversationArtifactsMapChange",e=>{let{conversationArtifactsMap:t}=e;this.widgets=this.widgets.map(e=>{let{uid:i,conversationId:a}=e.artifactData;if(a){let o=(t[a]||[]).find(e=>e.uid===i);return{...e,artifactData:o?{...o,content:e.artifactData.content}:e.artifactData}}return e})}),c.D.on("onFavoritedArtifactsChange",e=>{let{list:t}=e;this.widgets=this.widgets.map(e=>{let i=e.artifactData.uid,a=t.find(e=>e.uid===i);return{...e,artifactData:a?{...a,content:e.artifactData.content}:e.artifactData}})})}close(e){this.widgets=this.widgets.filter(t=>{let i=t.widgetId===e;if(i){var a;null===(a=t.onClose)||void 0===a||a.call(t)}return!i})}async fetchContent(e){if(this.contentCache.has(e))return this.contentCache.get(e);let t=JSON.parse(await fetch(e).then(e=>e.text())).content;return this.contentCache.set(e,t),t}closeAll(){this.widgets=[]}bringWidgetToFront(e){let t=this.widgets.find(t=>t.widgetId===e);t&&(t.zIndex=this.getMaxZIndex())}getMaxZIndex(){return 0===this.widgets.length?1:Math.max(...this.widgets.map(e=>e.zIndex))+1}getKey(e){return e.uid||"".concat(e.artifactId).concat(e.chatItemId).concat(e.conversationId)}constructor(){(0,a._)(this,"widgetMinSize",{width:320,height:350}),(0,a._)(this,"widgetDefaultSize",{width:380,height:380}),(0,a._)(this,"widgets",[]),(0,a._)(this,"contentCache",new Map),(0,a._)(this,"show",(0,d.c)({name:"showArtifactWidget",channels:["extensionContent","web"],handler:async e=>{let t=l.A.artifactWidgetsPosition.find(t=>t.id===e.artifactData.uid);if(t&&!e.forceUseDefaultPosition)e.defaultPosition={translateX:t.translateX,translateY:t.translateY,width:t.width,height:t.height};else{let{width:t,height:i}=this.widgetDefaultSize,a=document.documentElement.clientWidth,o=document.documentElement.clientHeight;if(e.defaultPosition){let s=e.defaultPosition.width||t,n=e.defaultPosition.height||i;e.defaultPosition.translateX&&(e.defaultPosition.translateX=Math.min(e.defaultPosition.translateX,a-s-65)),e.defaultPosition.translateY&&(e.defaultPosition.translateY=Math.min(e.defaultPosition.translateY,o-n-85))}else{let s=this.widgets.filter(e=>{var t,i,a;return(null===(t=e.defaultPosition)||void 0===t?void 0:t.translateX)===(null===(i=e.resizableController.data)||void 0===i?void 0:i.translateX)&&e.defaultPosition.translateY===(null===(a=e.resizableController.data)||void 0===a?void 0:a.translateY)}),n=a/2-t/2,r=o/2-i/2;if(s.length>0){let{translateX:e,translateY:t}=s[s.length-1].resizableController.data;n=e+12,r=t+12}e.defaultPosition={translateX:Math.min(n,a-t),translateY:Math.min(r,o-i)}}}let i=this.getKey(e.artifactData),a={...e,widgetId:i,resizableController:new n.S,zIndex:this.getMaxZIndex()};this.widgets.find(e=>i===e.widgetId)?(this.close(i),setTimeout(()=>{this.widgets.push(a)},0)):this.widgets.push(a)}})),(0,r.rC)(this)}}(0,o.gn)([s.SB],h.prototype,"widgets",void 0);let g=new h},10148:function(e,t,i){"use strict";i.d(t,{E:function(){return n}});var a=i(66084),o=i(56607);class s{init(e){this.pinHint=e.pinHint,this.onboarding=e.onboarding,this.invite=e.invite,this.rewardExpireReminder=e.rewardExpireReminder,this.rewardsObtained=e.rewardsObtained,this.monthlyVipResubscribe=e.monthlyVipResubscribe,this.versionUpgrade=e.versionUpgrade,this.inviteBonus=e.inviteBonus,this.inviteNotice=e.inviteNotice,this.vipModelGuide=e.vipModelGuide,this.globalSidebarGuide=e.globalSidebarGuide,this.homeAdController=e.homeAdController,this.newTeamController=e.newTeamController,this.realtimeIntroduceController=e.realtimeIntroduceController,this.autoNewChatController=e.autoNewChatController,this.autoCloseVipFeature=e.autoCloseVipFeature,this.v7UpgradeDialog=e.v7UpgradeDialog,this.imageDisplayDialogController=e.imageDisplayDialogController,this.globalScreenshotGuide=e.globalScreenshotGuide,this.afterSetModelParam=e.afterSetModelParam,this.videoDisplayDialogController=e.videoDisplayDialogController,this.r1Sale=e.r1SaleController}setViews(e){this.invite.setViews(e),this.monthlyVipResubscribe.setViews(e),this.onboarding.setViews(e),this.rewardsObtained.setViews(e),this.rewardExpireReminder.setViews(e),this.versionUpgrade.setViews(e),this.inviteBonus.setViews(e),this.inviteNotice.setViews(e),this.globalSidebarGuide.setViews(e),this.newTeamController.setViews(e),this.imageDisplayDialogController.setViews(e),this.videoDisplayDialogController.setViews(e),this.homeAdController.setViews(e)}async run(){if(document.body.getAttribute(o.o.withMonicaPrefix("is-onboarding")))return;let e=[this.afterSetModelParam,this.v7UpgradeDialog,this.autoNewChatController,this.onboarding,this.vipModelGuide,this.versionUpgrade,this.r1Sale,this.newTeamController,this.pinHint,this.monthlyVipResubscribe,this.inviteBonus,this.inviteNotice,this.globalSidebarGuide,this.realtimeIntroduceController,this.imageDisplayDialogController,this.videoDisplayDialogController,this.autoCloseVipFeature];this.showHomeAd();for(let t=0;t<e.length;t++){let i=e[t];if(await i.shouldShow()){if(i.open(),i.waitUntilClose&&"continue"===await i.waitUntilClose())continue;break}}}async showHomeAd(){await this.homeAdController.shouldShow()&&this.homeAdController.open(),await this.homeAdController.shouldShowNewComer()&&this.homeAdController.open("new_comer"),await this.homeAdController.shouldShowYearlyGuide()&&this.homeAdController.open("yearly_guide")}constructor(){(0,a._)(this,"pinHint",void 0),(0,a._)(this,"onboarding",void 0),(0,a._)(this,"invite",void 0),(0,a._)(this,"rewardExpireReminder",void 0),(0,a._)(this,"rewardsObtained",void 0),(0,a._)(this,"monthlyVipResubscribe",void 0),(0,a._)(this,"versionUpgrade",void 0),(0,a._)(this,"inviteBonus",void 0),(0,a._)(this,"inviteNotice",void 0),(0,a._)(this,"vipModelGuide",void 0),(0,a._)(this,"globalSidebarGuide",void 0),(0,a._)(this,"homeAdController",void 0),(0,a._)(this,"newTeamController",void 0),(0,a._)(this,"realtimeIntroduceController",void 0),(0,a._)(this,"autoNewChatController",void 0),(0,a._)(this,"autoCloseVipFeature",void 0),(0,a._)(this,"r1Sale",void 0),(0,a._)(this,"v7UpgradeDialog",void 0),(0,a._)(this,"imageDisplayDialogController",void 0),(0,a._)(this,"globalScreenshotGuide",void 0),(0,a._)(this,"afterSetModelParam",void 0),(0,a._)(this,"videoDisplayDialogController",void 0)}}let n=new s},90683:function(e,t,i){"use strict";i.d(t,{T:function(){return v}});var a=i(66084),o=i(52921),s=i(71576),n=i(90180),r=i(49795),l=i(33381),d=i(24900),c=i(5857),h=i(11502),g=i(88882),p=i(92347),A=i(56607),m=i(92660),u=i(73047);class f{get S(){return g.S.Global.controllers.botController.ChatContextController}get ctxMode(){return n.A.chatContextMode||p.p5.Auto}get ctxCropMode(){return n.A.chatContextCrop?n.A.chatContextCrop||p.vH.NoLimit:n.A.chatContextLimit?p.vH.CropTo:p.vH.NoLimit}get isCustomCtx(){return this.ctxMode===p.p5.Custom}get ctxTokenLimit(){return A.o.isChatPDF?r.g$.activeMode===r.G$.Turbo?n.A.chatContextLimit||m.GQ.DEFAULT:0:this.ctxMode===p.p5.Custom?n.A.chatContextLimit||m.GQ.DEFAULT:0}get chatTokenLimit(){return l.userController.isFreeUser||this.ctxMode===p.p5.Auto?0:this.ctxCropMode===p.vH.NoLimit?-1:this.ctxTokenLimit}setViews(e){this.views=e}formatToken(e){return"".concat((e/1e3).toFixed(2).replace(/.00$/,""),"K")}getReplyToken(e){var t,i,a;let o=null===(t=e.data.agentStatus)||void 0===t?void 0:t.find(e=>"token"===e.type);return(null==o?void 0:o.metadata)&&null!==(a=null===(i=o.metadata)||void 0===i?void 0:i.token)&&void 0!==a?a:-1}async checkTokenByFileUrl(e,t){if(l.userController.isVipUser)return{status:"continue"};let i=await d.Tn.preCalcPdfToken({fileUrl:e});return this.checkFileToken(i.tokens,t)}async checkTokenByFileInfos(e,t){if(l.userController.isVipUser)return{status:"continue"};let i=e.reduce((e,t)=>e+(t.fileTokens||0),0);return this.checkFileToken(i,t)}async checkFileToken(e,t){return l.userController.isFreeUser&&e>=this.FREE_USER_FILE_TOKEN_LIMIT?this.openUpgradeDialog(t.source,t.upgradeEventName):{status:"continue"}}async openFileContextLimitDialog(e,t){return new Promise(i=>{this.views.openFileContextLimitDialog({insertTarget:"mainWindow",fileToken:e,onContinue:()=>{i({status:"continue"})},onConfirm:()=>{i({status:"continue"})},onClose:()=>{i({status:"abort",msg:this.S.userCancel})},source:t})})}async openUpgradeDialog(e,t){return new Promise(i=>{let a=this.views.openUpgradeDialog({type:"credits",source:e,insertTarget:"dialogRoot",modalStyle:{maxHeight:"90%"},btnShape:"default",buttonsSlot:(0,s.jsx)(c.z,{type:"brand",style:{width:"100%",height:44,minHeight:44},onClick:()=>{i({status:"continue"}),null==a||a.dispose()},children:this.S.smartCrop}),onClose:()=>{i({status:"abort",msg:this.S.userCancel})},onClick(){h.M.createUserBehaviorEvent({eventName:t,source:e,extData:{button:"pay"}})}})})}constructor(){(0,a._)(this,"views",void 0),(0,a._)(this,"FREE_USER_FILE_TOKEN_LIMIT",1e5),(0,a._)(this,"userEvent",new y(this)),(0,u.rC)(this)}}(0,o.gn)([u.Fl],f.prototype,"S",null),(0,o.gn)([u.Fl],f.prototype,"ctxMode",null),(0,o.gn)([u.Fl],f.prototype,"ctxCropMode",null),(0,o.gn)([u.Fl],f.prototype,"isCustomCtx",null),(0,o.gn)([u.Fl],f.prototype,"ctxTokenLimit",null),(0,o.gn)([u.Fl],f.prototype,"chatTokenLimit",null);class y{reportStatus(){h.M.createUserBehaviorEvent({eventName:A.o.isChatPDF?"chatpdf_content_chat_status":"content_chat_status",extData:{type:this.parent.ctxMode,token:this.parent.chatTokenLimit}})}reportLimitCardShow(){h.M.createUserBehaviorEvent({eventName:A.o.isChatPDF?"chatpdf_content_chat_cardshow":"content_chat_cardshow",extData:{type:this.parent.ctxMode}})}reportLimitCardClick(e){h.M.createUserBehaviorEvent({eventName:A.o.isChatPDF?"chatpdf_content_chat_cardclick":"content_chat_cardclick",extData:{type:this.parent.ctxMode,button:e}})}reportFileLimitShow(){h.M.createUserBehaviorEvent({eventName:A.o.isChatPDF?"chatpdf_content_file_show":"content_file_show",extData:{type:this.parent.ctxMode}})}reportFileLimitClick(e){h.M.createUserBehaviorEvent({eventName:A.o.isChatPDF?"chatpdf_content_file_click":"content_file_click",extData:{button:e}})}reportFileLimitEditClick(e){h.M.createUserBehaviorEvent({eventName:A.o.isChatPDF?"chatpdf_content_file_editclick":"content_file_editclick",extData:{button:e}})}reportUpgrade(e){h.M.createUserBehaviorEvent({eventName:"chat_context_limit_upgrade",source:e,extData:{button:"pay"}})}constructor(e){(0,a._)(this,"parent",void 0),(0,a._)(this,"source",void 0),this.parent=e,this.source={get tokenCustom(){return A.o.isChatPDF?"chatpdf_token_custom":"token_custom"},get tokenLimitCard(){return A.o.isChatPDF?"chatpdf_token_chat_over":"token_chat_over"},get tokenFileLimit(){return A.o.isChatPDF?"chatpdf_token_file_over":"token_file_over"},get chatPDFWhatsNewToken(){return"chatpdf_token_whatsnew"}}}}let v=new f},81627:function(e,t,i){"use strict";i.d(t,{B:function(){return c},C:function(){return d}});var a=i(66084),o=i(52921),s=i(34491),n=i(92235),r=i(92660),l=i(73047);let d="_root_";class c{get renderItems(){var e;let t=[],i=this.findNodeById(null===(e=this.rootNode)||void 0===e?void 0:e.itemId);for(;i;){t.push({...i.data});let e=i.children[i.branch];i=e?this.findNodeById(e.itemId):null}return t}initItems(e){this.itemMap={},this.rootNode=null,this.addItems(e),e[0]&&(this.rootNode={itemId:e[0].itemId,parentItemId:e[0].parentItemId})}reset(){this.itemMap={},this.pendingItems=[],this.rootNode=null}loadItems(e){if(0===e.length)return;this.addItems(e),this.tryToClearPendingNodes();let t=this.getStartNode();for(;t;){if(t.data.parentItemId){let e=this.itemMap[t.data.parentItemId];if(e){let i=e.children.findIndex(e=>e.itemId===(null==t?void 0:t.data.itemId));-1!==i&&(e.branch=i),t=e;continue}}break}t?this.rootNode={itemId:t.data.itemId,parentItemId:t.data.parentItemId}:this.rootNode=null}addItems(e){let t={...this.itemMap};e.forEach(e=>{t[e.itemId]?t[e.itemId].data=e:t[e.itemId]=this.createNode(e)});for(let i=0;i<e.length;i++){let a=e[i];a.parentItemId===a.itemId&&(a.parentItemId=void 0);let o=t[a.itemId];if(o&&a.parentItemId&&a.parentItemId!==d){let e=t[a.parentItemId];e?e.children.find(e=>e.itemId===o.data.itemId)||(e.children.push({itemId:o.data.itemId,parentItemId:o.data.parentItemId}),e.branch=e.children.length-1):this.pendingItems.push(a)}}this.itemMap=t}tryToClearPendingNodes(){let e=this.itemMap;this.pendingItems=this.pendingItems.flatMap(t=>{let i=e[t.itemId];if(i&&t.parentItemId&&t.parentItemId!==d){let o=e[t.parentItemId];if(o){let e=0;for(let t=0;t<o.children.length;t++){var a;let s=o.children[t];if(s.itemId===i.data.itemId){e=-1;break}let n=(null===(a=this.itemMap[s.itemId])||void 0===a?void 0:a.data.seq)||0;(i.data.seq||0)>n&&(e=t+1)}return -1!==e&&(o.children.splice(e,0,{itemId:i.data.itemId,parentItemId:i.data.parentItemId}),o.branch=e),[]}return[t]}return[]})}addOrUpdateItem(e){let t=this.findNodeById(e.itemId);t?t.data=e:this.addItems([e])}updateItem(e){let t=this.findNodeById(e.itemId);t&&(t.data=e)}getLastNode(){let e=this.renderItems[this.renderItems.length-1];return this.findNodeById(e.itemId)}findNodeById(e){return e&&this.itemMap[e]||null}removeNodes(e){e.forEach(e=>{delete this.itemMap[e]}),Object.keys(this.itemMap).forEach(t=>{let i=this.itemMap[t],a=i.children.findIndex(t=>e.includes(t.itemId));-1!==a&&(i.children.splice(a,1),i.branch=i.children.length-1)})}initShareChatTree(e,t){let i=this.createFakeFirstItem(t),a=i.itemId;e.forEach(e=>{e.parentItemId=a,a=e.itemId,e.conversationId=t}),this.initItems([i,...e])}createFakeFirstItem(e){return{itemType:"reply",itemId:n.m.genId(),parentItemId:d,conversationId:e,summary:"Welcome!",seq:1,data:{type:"text",content:r.om,parentItemId:d,renderInStreaming:!1}}}getReplyQuestion(e){let t=this.findNodeById(e);if(t){let e=t.data;if("reply"!==e.itemType)throw Error("item is not a reply");let i=e.parentItemId;for(;i;){let e=this.findNodeById(i);if(e){if("question"===e.data.itemType)return e.data;i=e.data.parentItemId}else break}}return null}createNode(e){return{branch:0,data:e,children:[]}}getStartNode(){let e=null,t=Object.keys(this.itemMap);for(let i=0;i<t.length;i++){let a=this.itemMap[t[i]];if(e){let t=e.data.seq,i=a.data.seq;void 0!==t&&void 0!==i&&i>t&&(e=a)}else e=a}return e}constructor(){(0,a._)(this,"itemMap",{}),(0,a._)(this,"rootNode",null),(0,a._)(this,"pendingItems",[]),(0,l.rC)(this)}}(0,o.gn)([s.SB],c.prototype,"itemMap",void 0),(0,o.gn)([s.SB],c.prototype,"rootNode",void 0),(0,o.gn)([s.Fl],c.prototype,"renderItems",null)},95066:function(e,t,i){"use strict";i.d(t,{f:function(){return c}});var a=i(66084),o=i(52921),s=i(34491),n=i(73047),r=i(47701),l=i(11502),d=i(20549);class c{get version(){var e;return this.artifactData?Math.max(null===(e=this.versionList)||void 0===e?void 0:e.findIndex(e=>{var t;return e.chatItemId===(null===(t=this.artifactData)||void 0===t?void 0:t.chatItemId)}),0):0}changeVersion(e){let t=this.version;t="next"===e?Math.min(t+1,this.versionList.length-1):"prev"===e?Math.max(t-1,0):e,this.artifactData=this.versionList[t],l.M.createUserBehaviorEvent({eventName:r.R.UserEvent.VERSION_SWITCH})}async togglePublish(e){var t;let i=this.artifactData,{artifactId:a,uid:o,chatItemId:s,conversationId:n}=i;return!o&&(null===(t=this.opts)||void 0===t?void 0:t.chatBotController)&&await this.opts.chatBotController.artifactManager.waitSyncToServerReady({artifactId:a,conversationId:n,itemId:s}),l.M.createUserBehaviorEvent({eventName:e?r.R.UserEvent.PUBLISH_AND_COPY:r.R.UserEvent.UNPUBLISHED}),await d.D.togglePublishArtifact({conversationId:n,isPublished:e,uid:i.uid}),i.isPublished=e,i}async toggleFavorite(e){var t;let i=this.artifactData,{uid:a,artifactId:o,chatItemId:s,conversationId:n}=i;return!a&&(null===(t=this.opts)||void 0===t?void 0:t.chatBotController)&&await this.opts.chatBotController.artifactManager.waitSyncToServerReady({artifactId:o,conversationId:n,itemId:s}),l.M.createUserBehaviorEvent({eventName:e?r.R.UserEvent.STAR:r.R.UserEvent.UNSTAR,extData:{id:i.uid}}),await d.D.toggleFavoriteArtifact({conversationId:n,isFavorite:e,uid:i.uid}),i.isFavorite=e,i}setVersions(e){this.versionList=e}setArtifactData(e){this.artifactData=e}markAsSteamFinished(){this.isSteaming=!1}markAsSteamStart(){this.isSteaming=!0}updateDefaultPosition(e){this.defaultPosition=e}constructor(e){(0,a._)(this,"opts",void 0),(0,a._)(this,"defaultPosition",void 0),(0,a._)(this,"fromChatResources",void 0),(0,a._)(this,"artifactData",void 0),(0,a._)(this,"versionList",void 0),(0,a._)(this,"isSteaming",void 0),this.opts=e,this.defaultPosition=null,this.fromChatResources=!1,this.artifactData=null,this.versionList=[],this.isSteaming=!0,(0,n.rC)(this)}}(0,o.gn)([s.SB],c.prototype,"artifactData",void 0),(0,o.gn)([s.SB],c.prototype,"versionList",void 0),(0,o.gn)([s.SB],c.prototype,"isSteaming",void 0),(0,o.gn)([n.Fl],c.prototype,"version",null)},11201:function(e,t,i){"use strict";i.d(t,{F:function(){return C}});var a=i(66084),o=i(52921),s=i(34491),n=i(91433),r=i(42857),l=i(73361),d=i(11502),c=i(92235),h=i(56607),g=i(76469),p=i(88882),A=i(73047),m=i(90180),u=i(18245),f=i(15851),y=i(34889),v=i(33381),w=i(79854);class C extends w.Q{get selectedAspectRatio(){var e;return null!==(e=m.A.artistAspectRatio)&&void 0!==e?e:"1:1"}get realImageStrength(){return this.imageStrength/100}get taskParams(){return{width:this.taskOptions.width,height:this.taskOptions.height,style:this.taskOptions.style||"no-style",imageCount:this.taskOptions.imageCount,seed:this.taskOptions.seed||void 0,promptStrength:this.taskOptions.promptStrength||void 0,negativePrompt:this.taskOptions.negativePrompt||void 0}}get showReferenceImage(){return this.botData.botId!==n.vH.dalle3}scrollToBottom(){this.emitter.emit("scrollToBottom")}async init(){if(this.initialized)return;this.initialized=!0;let e=await r.d.getTaskOptions(this.botData.botId);this.taskOptions=e;let t=r.d.on("taskOptionsChange",e=>{let t=e[this.botData.botId];t&&(this.taskOptions=t)});this.taskOptionsListenerDisposer=()=>{t.destroy()}}destroy(){this.taskOptionsListenerDisposer&&this.taskOptionsListenerDisposer()}focusPrimaryInput(){this.emitter.emit("focusPrimaryInput")}resetOnLogout(){}updateUsageInfo(){l.gM.updateUsageInfos([this.botData.usageModule])}async generate(e){if(!v.userController.checkAuthForWeb())return;let{isEnough:t,handleCreditsNotEnough:i}=u.K.checkCredits({module:this.botData.usageModule,source:"image_limit_dialog_click_upgrade"});if(!t){i();return}this.promptContent=e,this.generateManager.start(),this.scrollToBottom();try{let t=this.genTaskId(),i=this.referenceImage?"artist_bot:img_to_img":"artist_bot:text_to_img",a={taskUid:t,taskType:i,data:{prompt:e,param:this.taskParams},botUid:this.botData.botId};this.referenceImage&&(a.data.img=c.m.removeQueryFromUrl(this.referenceImage),a.data.param&&(a.data.param.imageStrength=this.realImageStrength));let{data:o}=await r.d.createGenerateImageTask(a);this.updateProgress("start",null==o?void 0:o.expectedTime),this.loopTaskStatus(t)}catch(e){if(u.K.isQuotaExceedError(e)){i();return}(null==e?void 0:e.message)?this.generateManager.failed(e.message):this.generateManager.failed(e)}}async variations(e,t){if(!v.userController.checkAuthForWeb())return;let{isEnough:i,handleCreditsNotEnough:a}=u.K.checkCredits({module:this.botData.usageModule,source:"image_limit_dialog_click_upgrade"});if(!i){a();return}let o=c.m.removeQueryFromUrl(e);this.promptContent=t.data.prompt,this.generateManager.start(),this.scrollToBottom();try{let e=this.genTaskId(),i={taskUid:e,taskType:"artist_bot:variations",data:{prompt:t.data.prompt,originTaskUid:t.uid,img:o,param:this.taskParams},botUid:this.botData.botId},{data:a}=await r.d.createGenerateImageTask(i);this.updateProgress("start",null==a?void 0:a.expectedTime),this.loopTaskStatus(e)}catch(e){(null==e?void 0:e.message)?this.generateManager.failed(e.message):this.generateManager.failed(e)}d.M.createArtistBehaviorEvent({taskUid:t.uid,imageUrl:o,userAction:"variation"})}async upscale(e,t){if(!v.userController.checkAuthForWeb())return;let{isEnough:i,handleCreditsNotEnough:a}=u.K.checkCredits({module:this.botData.usageModule,source:"image_limit_dialog_click_upgrade"});if(!i){a();return}let o=c.m.removeQueryFromUrl(e);this.promptContent=t.data.prompt,this.generateManager.start(),this.scrollToBottom();try{let e=this.genTaskId(),i={taskUid:e,taskType:"artist_bot:upscale",data:{prompt:t.data.prompt,originTaskUid:t.uid,img:o,param:this.taskParams},botUid:this.botData.botId},{data:a}=await r.d.createUpscaleImageTask(i);this.updateProgress("start",null==a?void 0:a.expectedTime),this.loopTaskStatus(e)}catch(e){(null==e?void 0:e.message)?this.generateManager.failed(e.message):this.generateManager.failed(e)}d.M.createArtistBehaviorEvent({taskUid:t.uid,imageUrl:o,userAction:"upscale"})}async regenerate(e){if(!v.userController.checkAuthForWeb())return;let{isEnough:t,handleCreditsNotEnough:i}=u.K.checkCredits({module:this.botData.usageModule,source:"image_limit_dialog_click_upgrade"});if(!t){i();return}this.promptContent=e.data.prompt,this.generateManager.start(),this.scrollToBottom();try{let t=this.genTaskId(),i={taskUid:t,taskType:e.taskType,data:e.createCmd.data,botUid:this.botData.botId},{data:a}=await r.d.createGenerateImageTask(i);this.updateProgress("start",null==a?void 0:a.expectedTime),this.loopTaskStatus(t)}catch(e){(null==e?void 0:e.message)?this.generateManager.failed(e.message):this.generateManager.failed(e)}}downloadImage(e,t){c.m.downloadFile(e),d.M.createArtistBehaviorEvent({taskUid:t,imageUrl:c.m.removeQueryFromUrl(e),userAction:"download"})}useAsReference(e,t){this.imageStrength=this.defaultImageStrength,this.previewImage=e,this.referenceImage=e,d.M.createArtistBehaviorEvent({taskUid:t,imageUrl:c.m.removeQueryFromUrl(e),userAction:"reference"})}setAspectRatio(e){m.A.setArtistAspectRatio(e)}async getArtistItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"loadMore",t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!this.loading||"loadMore"!==e){t&&("refresh"===e?this.loading=!0:this.loadMoreLoading=!0);try{let t=await r.d.listItems({limit:Math.min(5,Math.round(window.innerHeight/324)+1),offset:this.items.length,botUid:this.botData.botId}),i=t.data.items||[];"refresh"===e?this.items=i:this.items.unshift(...i),this.hasMore=t.data.hastNext}catch(t){this.hasMore=!1,console.error(t),h.o.isWeb||f.M.error(c.m.formatErrorMsg(t)),"refresh"===e&&this.botData.updateViewId()}t&&("refresh"===e?this.loading=!1:this.loadMoreLoading=!1),this.emitter.emit("refreshExamples")}}async deleteItem(e){await r.d.deleteItem(e.uid),this.items=this.items.filter(t=>t.uid!==e.uid)}async uploadImage(e){let t=await c.m.cropImage(e);this.uploadManager.reset();try{let{preSignedUrl:e,objectUrl:i}=await y.Gi.getS3PreSignedModuleUrl({filename:t.name,module:"artist_bot",location:"files"}),a=await y.Gi.uploadFileToS3(e,t,e=>{this.uploadManager.updateProcess(e)});if(200!==a.status)throw"request fail (".concat(a.status,")");this.uploadManager.setPreviewImage(URL.createObjectURL(t)),this.uploadManager.setReferenceImage(i),d.M.createUserBehaviorEvent({eventName:"upload_image_success",extData:{module:"artist"}})}catch(e){console.error(e),f.M.error("Upload image fail, please try again.")}}loopTaskStatus(e){setTimeout(()=>{let t=async()=>{try{let t=await r.d.loopTaskStatus(e,this.botData.getBotInfo());if(!(null==t?void 0:t.data)||"not_found"===t.data.status){this.generateManager.failed();return}let{status:i,object:a,msg:o}=t.data;if("failed"===i||"complete"===i&&a&&1===a.resultCode){this.generateManager.failed(o||void 0);return}if("complete"===i&&a){this.generateManager.stop(),this.items.push(a),this.scrollToBottom();return}}catch(e){(null==e?void 0:e.message)?this.generateManager.failed(e.message):this.generateManager.failed(e);return}setTimeout(()=>{t()},1e3)};t()},3e3)}updateProgress(e,t){this.generateTimer&&(clearTimeout(this.generateTimer),this.generateTimer=null);let i="init"===e?8:100-this.generateProgress;this.generateTimer=setInterval(()=>{let e=Math.round(Math.random()*(this.generateProgress>85?.6:1.5)),t=this.generateProgress+e;if(t>99){this.generateProgress=99,this.generateTimer&&(clearTimeout(this.generateTimer),this.generateTimer=null);return}this.generateProgress=t},Math.round(1e3*(t||("init"===e?1:10))/i))}genTaskId(){return"task:".concat(c.m.genId())}constructor(e){var t;super(),t=this,(0,a._)(this,"botData",void 0),(0,a._)(this,"AspectRatioSettings",void 0),(0,a._)(this,"loading",void 0),(0,a._)(this,"loadMoreLoading",void 0),(0,a._)(this,"items",void 0),(0,a._)(this,"hasMore",void 0),(0,a._)(this,"previewImage",void 0),(0,a._)(this,"referenceImage",void 0),(0,a._)(this,"imageStrength",void 0),(0,a._)(this,"uploadProgress",void 0),(0,a._)(this,"promptContent",void 0),(0,a._)(this,"generating",void 0),(0,a._)(this,"generateProgress",void 0),(0,a._)(this,"generateFailed",void 0),(0,a._)(this,"generateFailedMsg",void 0),(0,a._)(this,"taskOptions",void 0),(0,a._)(this,"emitter",void 0),(0,a._)(this,"defaultImageStrength",void 0),(0,a._)(this,"uploadManager",void 0),(0,a._)(this,"generateManager",void 0),(0,a._)(this,"generateTimer",void 0),(0,a._)(this,"taskOptionsListenerDisposer",void 0),(0,a._)(this,"initialized",void 0),this.botData=e,this.AspectRatioSettings=["1:1","3:2","4:3","16:9"],this.loading=!1,this.loadMoreLoading=!1,this.items=[],this.hasMore=!0,this.previewImage="",this.referenceImage="",this.imageStrength=0,this.uploadProgress=0,this.promptContent="",this.generating=!1,this.generateProgress=0,this.generateFailed=!1,this.generateFailedMsg="",this.emitter=new g.v,this.defaultImageStrength=35,this.uploadManager={reset:()=>{this.previewImage="",this.referenceImage="",this.imageStrength=this.defaultImageStrength,this.uploadProgress=0},updateProcess:e=>{this.uploadProgress=e},setPreviewImage:e=>{this.previewImage=e},setReferenceImage:e=>{this.referenceImage=e}},this.generateManager={setImageStrength:e=>{this.imageStrength=e},start:()=>{this.generating=!0,this.generateFailed=!1,this.updateProgress("init")},stop:()=>{this.generateTimer&&clearTimeout(this.generateTimer),this.generating=!1,this.generateProgress=0},failed:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.S.Global.modules.Bots.Artist.failedToGenerate;t.generateFailedMsg=e,t.generateFailed=!0,t.generateManager.stop()}},this.generateTimer=null,this.taskOptionsListenerDisposer=null,this.initialized=!1,(0,A.rC)(this)}}(0,o.gn)([s.SB],C.prototype,"AspectRatioSettings",void 0),(0,o.gn)([s.SB],C.prototype,"loading",void 0),(0,o.gn)([s.SB],C.prototype,"loadMoreLoading",void 0),(0,o.gn)([s.SB],C.prototype,"items",void 0),(0,o.gn)([s.SB],C.prototype,"hasMore",void 0),(0,o.gn)([s.SB],C.prototype,"previewImage",void 0),(0,o.gn)([s.SB],C.prototype,"referenceImage",void 0),(0,o.gn)([s.SB],C.prototype,"imageStrength",void 0),(0,o.gn)([s.SB],C.prototype,"uploadProgress",void 0),(0,o.gn)([s.SB],C.prototype,"promptContent",void 0),(0,o.gn)([s.SB],C.prototype,"generating",void 0),(0,o.gn)([s.SB],C.prototype,"generateProgress",void 0),(0,o.gn)([s.SB],C.prototype,"generateFailed",void 0),(0,o.gn)([s.SB],C.prototype,"generateFailedMsg",void 0),(0,o.gn)([s.SB],C.prototype,"taskOptions",void 0),(0,o.gn)([A.Fl],C.prototype,"selectedAspectRatio",null),(0,o.gn)([A.Fl],C.prototype,"realImageStrength",null),(0,o.gn)([A.Fl],C.prototype,"taskParams",null),(0,o.gn)([A.Fl],C.prototype,"showReferenceImage",null)},79854:function(e,t,i){"use strict";i.d(t,{Q:function(){return a}});class a{}},46977:function(e,t,i){"use strict";i.d(t,{nu:function(){return u},o3:function(){return f},pW:function(){return y}});var a=i(66084),o=i(52921),s=i(34491),n=i(88882),r=i(92235),l=i(73047),d=i(24900),c=i(38172),h=i(80288),g=i(15851),p=i(34889);let A={"image/jpeg":"jpg","image/png":"png","image/webp":"webp"},m=["png","jpeg","jpg","webp"],u=[".png",".jpeg",".jpg",".webp"];class f{get S(){return n.S.Global.controllers.botController.ChatBotAttachmentManager}get isSingleImage(){return 1===this.fileManagers.length&&this.fileManagers[0].isImage}get supportsMultipleFiles(){return!0}get maxFileLimit(){return this.supportsMultipleFiles?20:1}updateFileMangers(e){this.fileManagers=e}handleSelectFile(e){r.m.selectFile(async t=>{null==e||e(t),this.handleFiles(t)},{multiple:this.supportsMultipleFiles})}async handleFiles(e){if(this.fileManagers.length+e.length>this.maxFileLimit){g.M.error((0,n.x)(this.S.maxFileLimit,{limit:this.maxFileLimit}));return}let t=this.parent.chatBotSkillCard;t.cardType&&!t.supportChatWithFile()&&this.parent.chatBotSkillCard.hideCard(),this.parent.setQuote(null);let i=await this.createFileManagers(e);this.fileManagers.push(...i),this.uploadFileMangers(i),this.parent.focusPrimaryInput()}clearFiles(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.fileManagers.map(t=>{t.clearFile(e)}),this.fileManagers=[]}clearWebPageFile(){var e;let t=this.fileManagers;1===t.length&&(null===(e=t[0].fileInfo)||void 0===e?void 0:e.fileType)==="webpage"&&this.clearFiles()}quoteFiles(e){this.clearFiles(),this.fileManagers=e.map(e=>{let t=new y;return t.updateFileInfo(e),t.setFileStatus("finished"),t})}async quoteImage(e){this.clearFiles();let t=new y,i=new URL(e),a=i.pathname.substring(i.pathname.lastIndexOf("/")+1),o=a.substring(a.lastIndexOf(".")+1);t.updateFileInfo({fileExt:o,fileUrl:e,fileName:a,fileSize:0,source:"quote"}),t.setFileStatus("finished"),this.fileManagers.push(t);let s=await fetch(e),n=(await s.blob()).size;t.updateFileInfo({fileSize:n}),t.createFile(e)}cancelTask(e){let t=this.fileManagers.findIndex(t=>t.id===e);-1!==t&&(this.fileManagers[t].cancelTask(),this.fileManagers.splice(t,1))}isImage(e){return this.imageTypes.includes(e)}clearFile(e){let t=this.fileManagers.findIndex(t=>t.id===e);-1!==t&&(this.fileManagers[t].clearFile(!0),this.fileManagers.splice(t,1))}async createFileManagers(e,t){return await Promise.all(e.map(async(e,i)=>{let a=new y;return null==t||t(a,i),await a.init(e),a}))}createEmptyManagers(e,t){return e.map((e,i)=>{let a=new y;return a.state="finished",a.updateFileInfo(e),null==t||t(a,i),a})}async uploadFileMangers(e){var t;if(!e.length)return;let i=[];this.abortController=new AbortController;try{let t=e.filter(e=>"default"===e.state&&!e.options.uploadByCdnUrl),a=e.filter(e=>"default"===e.state&&e.options.uploadByCdnUrl);if(0===t.length&&0===a.length)return;if(t.length){let e=await p.Gi.getS3PreSignList({filenameList:t.map(e=>e.fileInfo.fileName),module:"chat_bot",location:"files",objId:r.m.genShortId()});await Promise.all(t.map(async(t,a)=>{try{t.state="running",await t.uploadFile(e.preSignUrlList[a]),i=e.cdnUrlList,t.updateFileInfo({fileUrl:e.objectUrlList[a]})}catch(e){t.state="uploadError"}}))}a.length&&await Promise.all(a.map(e=>e.uploadFileByCdnUrl(e.fileInfo.fileUrl)))}catch(t){e.forEach(e=>{("running"===e.state||"default"===e.state)&&(e.state="uploadError")});return}if(null===(t=this.abortController)||void 0===t?void 0:t.signal.aborted)return;let a=e.filter(e=>100===e.uploadProgress);try{await Promise.all([await this.batchCreteLLMFile(a,i),await this.prefetchFile(a)])}catch(e){a.forEach(e=>{"finished"!==e.state&&(e.state="parseError")})}}async batchCreteLLMFile(e,t){var i,a;let o=e.map(e=>{let{fileName:t,fileSize:i,fileUrl:a,fileType:o,fileUid:s}=e.fileInfo;return{fileUid:s,url:"url"===o?a:"",parse:!0,fileName:t,fileSize:i,fileType:o,objectUrl:"url"===o?"":a,embedding:!1}}),{data:s}=await d.Tn.batchCreateLLMFile(o);null===(i=s.items)||void 0===i||i.forEach((i,a)=>{e[a].updateFileInfo({fileUid:i.fileUid,fileUrl:t[a]||e[a].fileInfo.fileUrl})});let n=(null===(a=s.items)||void 0===a?void 0:a.flatMap(e=>e.fileUid||[]))||[],l=async t=>{try{var i,a,o;if(!t.length||(null===(i=this.abortController)||void 0===i?void 0:i.signal.aborted))return;let{data:s}=await d.Tn.batchGetFile(t);if(!(null===(a=s.items)||void 0===a?void 0:a.length)){e.forEach(e=>{if(t.includes(e.fileInfo.fileUid||"")){var i,a;e.state="parseError",null===(i=(a=e.options).onFinished)||void 0===i||i.call(a)}});return}null===(o=s.items)||void 0===o||o.forEach(async i=>{var a,o;let{fileChunks:s,fileTokens:n,fileUid:r,indexState:l,indexDesc:d,errorMessage:c}=i,h=e.find(e=>e.fileInfo.fileUid===r);h&&(h.updateFileInfo({fileUrl:h.fileInfo.fileUrl,fileChunks:s,fileTokens:n}),0!==l&&(1===l||3===l?h.state="finished":2===l?("text_too_long"===d?h.state="textToLongError":"upload_error"===d?h.state="uploadError":"parse_error:InvalidImageSize"===d?h.state="invalidImageSize":h.state="parseError",h.serverErrorMessage=c||null):h.state="parseError",t.splice(t.indexOf(r),1),null===(a=(o=h.options).onFinished)||void 0===a||a.call(o)))}),await r.m.delay(1e3),l(t)}catch(t){e.forEach(e=>{var t,i;e.state="parseError",null===(t=(i=e.options).onFinished)||void 0===t||t.call(i)})}};l(n)}async prefetchFile(e){try{await Promise.all(e.map(async e=>{e.isImage&&e.fileInfo.fileUrl&&await fetch(e.fileInfo.fileUrl)}))}catch(e){console.log(e)}}constructor(e){(0,a._)(this,"parent",void 0),(0,a._)(this,"maxFileSize",void 0),(0,a._)(this,"imageTypes",void 0),(0,a._)(this,"imageMimeType",void 0),(0,a._)(this,"abortController",void 0),(0,a._)(this,"fileManagers",void 0),this.parent=e,this.maxFileSize=20,this.imageTypes=m,this.imageMimeType=Object.keys(A),this.fileManagers=[],(0,l.rC)(this)}}(0,o.gn)([s.SB],f.prototype,"fileManagers",void 0),(0,o.gn)([l.Fl],f.prototype,"S",null),(0,o.gn)([l.Fl],f.prototype,"isSingleImage",null),(0,o.gn)([l.Fl],f.prototype,"supportsMultipleFiles",null),(0,o.gn)([l.Fl],f.prototype,"maxFileLimit",null);class y{get S(){return n.S.Global.controllers.botController.ChatBotAttachmentManager}get isImage(){var e;let t=null===(e=this.fileInfo)||void 0===e?void 0:e.fileExt;return!!t&&this.imageTypes.includes(t)}get isError(){return"default"!==this.state&&"running"!==this.state&&"finished"!==this.state}get isLoading(){return"running"===this.state}get errorMessage(){return this.isError&&this.serverErrorMessage?this.serverErrorMessage:"parseError"===this.state?this.S.parseError:"sizeError"===this.state?(0,n.x)(this.S.sizeError,{size:this.maxFileSize}):"typeError"===this.state?this.S.typeError:"uploadError"===this.state?this.S.uploadError:"textToLongError"===this.state?this.S.textToLongError:""}get progress(){return(this.parseProgress+this.uploadProgress)/2}async init(e){var t,i;if(this.file=e,this.updateFileInfo({fileType:(null===(t=this.fileInfo)||void 0===t?void 0:t.fileType)||this.getFileTypeByFile(e),fileExt:(null===(i=this.fileInfo)||void 0===i?void 0:i.fileExt)||this.getFileTypeByFile(e),fileName:e.name,fileSize:e.size}),this.isImage){try{let t=await this.imageCompress(e);this.file=t}catch(e){this.state="parseError";return}if("png"!==this.fileInfo.fileExt&&"jpeg"!==this.fileInfo.fileExt){let t=await r.m.transformImageType(this.file,"image/jpeg");this.file=new File([t],e.name,{type:"image/jpeg"}),this.updateFileInfo({fileExt:"jpeg"})}r.m.fileToDataUrl(e).then(e=>{var t;(null===(t=this.fileInfo)||void 0===t?void 0:t.fileUrl)||(this.previewUrl=e)})}let{check:a=!0}=this.options||{};if(a){if(this.imageTypes.includes(e.type)){if(!p.Gi.checkMaxSize(e,4)){this.state="sizeError";return}}else if(!p.Gi.checkMaxSize(e,20)){this.state="sizeError";return}}}updateFileInfo(e){this.fileInfo={...this.fileInfo,...e}}setFileStatus(e){this.state=e}async handleFile(){if(!this.file)return!1;this.state="running",this.serverErrorMessage=null;try{let{cdnUrl:e,objectUrl:t,preSignedUrl:i}=await this.getS3PreSignedModuleUrl();if(await this.uploadFile(i),100!==this.uploadProgress)return!1;return this.updateFileInfo({fileUrl:t}),this.createFile(e),!0}catch(i){var e,t;"running"===this.state&&(this.state="uploadError"),console.error(i),null===(e=(t=this.options).onFinished)||void 0===e||e.call(t)}finally{stop()}return!0}retry(){if("uploadError"!==this.state){console.warn("Cannot retry when state is not upload error");return}this.handleFile()}cancelTask(){var e;null===(e=this.uploadCancelToken)||void 0===e||e.cancel(),d.Tn.cancelRequest(this.createFileTaskId),d.Tn.cancelRequest(this.parseFileTaskId),this.clearFile(!0),this.options.onFinished=()=>{},this.loopTimer&&clearTimeout(this.loopTimer)}clearFile(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=null===(e=this.fileInfo)||void 0===e?void 0:e.fileUid;i&&t&&d.Tn.deleteFile({fileUid:i}),this.state="default"}getFileIcon(e){return"pdf"===e?"pdf":"txt"===e?"colorfulTxtOutline":"csv"===e?"colorfulCsv":"excel"===e?"colorfulExcelOutline":"docx"===e?"colorfulDocOutline":"markdown"===e||h.aU.includes(".".concat(e))?"colorfulMarkdownOutline":""}async createFile(e){try{r.m.fakeProgress(5,e=>{this.parseProgress=e}),this.createFileTaskId=r.m.genId();let{fileName:t,fileSize:i,fileUrl:a,fileType:o}=this.fileInfo,{data:s}=await d.Tn.createFile({fileName:t,fileSize:i,objectUrl:a,fileType:o,taskId:this.createFileTaskId,embedding:!1,parse:!0});this.updateFileInfo({fileUid:s.fileUid,fileUrl:e}),this.loopParseFile(this.fileInfo.fileUid)}catch(e){this.setFileStatus("parseError")}}async uploadFile(e){try{this.uploadCancelToken=new p.jI,await p.Gi.uploadFileToS3(e,this.file,e=>{this.uploadProgress=Math.max(e,this.uploadProgress)},this.uploadCancelToken),this.uploadProgress=100}catch(e){var t,i;this.state="uploadError",null===(t=(i=this.options).onFinished)||void 0===t||t.call(i)}}async uploadFileByCdnUrl(e){return new Promise((t,i)=>{this.state="running",p.Gi.downloadAndUploadFile({url:e,fileName:this.fileInfo.fileName||"",module:"chat_bot"},e=>{this.uploadProgress=Math.max(e,this.uploadProgress)},e=>{this.uploadProgress=100,this.updateFileInfo({fileUrl:e.cdnUrl,fileSize:e.size}),t(e)},e=>{this.state="uploadError",i(e)})})}async getS3PreSignedModuleUrl(){let e=await p.Gi.getS3PreSignList({filenameList:[this.file.name],module:"chat_bot",location:"files",objId:r.m.genId()});return{cdnUrl:e.cdnUrlList[0],objectUrl:e.objectUrlList[0],preSignedUrl:e.preSignUrlList[0]}}async loopParseFile(e){let t=async()=>{var i,a,o,s;try{this.loopTimer&&clearTimeout(this.loopTimer),this.parseFileTaskId=r.m.genId();let{data:o}=await d.Tn.getFile({fileUid:e,taskId:this.parseFileTaskId});if(this.updateFileInfo({fileChunks:o.fileChunks,fileTokens:o.fileTokens}),0===o.indexState){this.loopTimer=setTimeout(()=>{t()},1e3);return}1===o.indexState||3===o.indexState?(this.state="finished",this.parseProgress=100):2===o.indexState?this.state="textToLongError":this.state="parseError",this.serverErrorMessage=o.errorMessage||null,null===(i=(a=this.options).onFinished)||void 0===i||i.call(a)}catch(e){this.state="parseError",null===(o=(s=this.options).onFinished)||void 0===o||o.call(s)}};t()}getFileTypeByFile(e){var t;return A[e.type]?A[e.type]:(null===(t=e.name)||void 0===t?void 0:t.includes("."))?e.name.split(".").pop():""}async imageCompress(e){return new Promise((t,i)=>{let a=new Image;a.onload=async()=>{try{let i=a.width,o=a.height;if(c.W.createUserBehaviorEvent({eventName:"chat_image_compress",extData:{originWidth:i,originHeight:o}}),i<=4e3&&o<=4e3){let i=await r.m.transformImageSize(e,1024,1024,.75);t(i)}else if(Math.max(i/o,o/i)>3){let i=await r.m.transformImageSize(e,7998,7998,.75);t(i)}else{let a=2/3,s=await r.m.transformImageSize(e,Math.min(i*a,7998),Math.min(o*a,7998),.75);t(s)}}catch(e){i(e)}},a.onerror=e=>{i(e)},a.src=URL.createObjectURL(e)})}constructor(e){(0,a._)(this,"file",void 0),(0,a._)(this,"id",r.m.genId()),(0,a._)(this,"maxFileSize",20),(0,a._)(this,"imageTypes",m),(0,a._)(this,"imageMimeType",Object.keys(A)),(0,a._)(this,"options",{}),(0,a._)(this,"state","default"),(0,a._)(this,"fileInfo",{useFullText:!0}),(0,a._)(this,"uploadProgress",0),(0,a._)(this,"parseProgress",0),(0,a._)(this,"previewUrl",""),(0,a._)(this,"serverErrorMessage",null),(0,a._)(this,"uploadCancelToken",null),(0,a._)(this,"createFileTaskId",""),(0,a._)(this,"parseFileTaskId",""),(0,a._)(this,"loopTimer",null),(0,l.rC)(this),this.options=e||{}}}(0,o.gn)([s.SB],y.prototype,"state",void 0),(0,o.gn)([s.SB],y.prototype,"fileInfo",void 0),(0,o.gn)([s.SB],y.prototype,"uploadProgress",void 0),(0,o.gn)([s.SB],y.prototype,"parseProgress",void 0),(0,o.gn)([s.SB],y.prototype,"previewUrl",void 0),(0,o.gn)([s.SB],y.prototype,"serverErrorMessage",void 0),(0,o.gn)([l.Fl],y.prototype,"S",null),(0,o.gn)([l.Fl],y.prototype,"isImage",null),(0,o.gn)([l.Fl],y.prototype,"isError",null),(0,o.gn)([l.Fl],y.prototype,"isLoading",null),(0,o.gn)([l.Fl],y.prototype,"errorMessage",null),(0,o.gn)([l.Fl],y.prototype,"progress",null)},45476:function(e,t,i){"use strict";i.d(t,{_:function(){return eH}});var a=i(66084),o=i(52921),s=i(34491),n=i(39936),r=i(58351),l=i(15065),d=i(46756),c=i(24900),h=i(44469),g=i(11502),p=i(91433),A=i(38795),m=i(20549),u=i(95362),f=i(56607),y=i(32004),v=i(88882),w=i(92235),C=i(92660),b=i(82270),S=i(96827),I=i(76469),_=i(58756),T=i(20978),k=i(73047),E=i(919),M=i(99778),x=i(94223),B=i(73361),D=i(18245),L=i(90974),R=i(76752),U=i(38172),P=i(92020),F=i(32930),O=i(44795),N=i(47701),V=i(71576),Q=i(4461),z=i(68104),H=i(53040),W=i(5857),G=i(95782),j=i(82005),J={src:"https://assets.monica.im/home-web/_next/static/media/chatgptFill.21f8dc3b.png",height:60,width:61,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEUAAAACAgIAAAAAAAAFBQVKSkpMaXFycnIAAACAgIACAgJ3d3cNDQ1eXl4YGBgpKSk8PDxSUlJ0XfKjAAAAEXRSTlP5QY/bHP4A/cn+pfj//////hp2IVoAAAAJcEhZcwAAITgAACE4AUWWMWAAAAA8SURBVHicNctbDoAgDATABSnb1ZbH/S9LNPF/Br3dgJeOdoXZQEGNh+J0+GJuGeBTmdxADYoa/uL14b8fQQ8B0sM0qzMAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},K={src:"https://assets.monica.im/home-web/_next/static/media/realtime.f902958b.webp",height:257,width:360,blurDataURL:"data:image/webp;base64,UklGRroAAABXRUJQVlA4WAoAAAAQAAAABwAABQAAQUxQSDEAAAAAABJEDBcXDQAADjXC///IAADW/////8wAAOT///7+wQIA3///eycIHQAmQUMNAQAAAFZQOCBiAAAA8AEAnQEqCAAGAAJAOCWwAnQBHoCo//wAAP7CU/tfvt3r8rz8pe+e1cbB3e+ZWxYnLSu+emlbbdL4K+YUTXtRymmfrSP1KlienfaZ7c9J/eJyPDVEbx7Pe5iZZtfuRSAAAAA=",blurWidth:8,blurHeight:6},q={openRealtimeFirstDialog:"open-realtime-first-dialog--mRALq",header:"header--j7f8J",img:"img--pSePy",title:"title--q8rmI",desc:"desc--V_E7X",chatgpt:"chatgpt--qzdJ0",icon:"icon--x3Ksb",content:"content--h4EFr",text:"text--x5jlv",skillBox:"skill-box--lUjT9",skillItem:"skill-item--avcoF",skillIcon:"skill-icon--nOKUd",skillContent:"skill-content--RDSUr",skillTitle:"skill-title--OWLFd",skillDesc:"skill-desc--s9Cb1",btn:"btn--NWdkf"},X={src:"https://assets.monica.im/home-web/_next/static/media/skill1.9958ba0d.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAIVBMVEVMaXFoQOppQutpQu1oQepqQe5oQOhwTOprQu9pQe1pRO5sOX+pAAAAC3RSTlMAdllmky1ADMCiSzmdQLoAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA2SURBVHicFcvBDQBBCMNABwiw13/BJyRrfgZoxQCoWgX4UIA2hk/0m0oyLq82yNeV9uBU3/sDGFcAwhgUCHsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},Z={src:"https://assets.monica.im/home-web/_next/static/media/skill2.793713bb.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAGFBMVEVpQexpQe1mQehoQOpMaXFnQehrQ/FoQOe4Auq1AAAACHRSTlNWZh+kAIBvOwm03esAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAAsSURBVHicVcunAQAgAASx+8b+I6MQuJhQA7g42xaDnFiAKvXDKfSAI0kxr18StAB9HQIsYAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},Y={src:"https://assets.monica.im/home-web/_next/static/media/skill3.1aab94c7.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAHlBMVEVMaXFrQupoQutoQelqQu5oQelpQu1oQepoP+hpQex2r633AAAACnRSTlMAGFNFwoecaylf+kIslAAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAACxJREFUeJxFi7ENADAMg3ASO/9/3KnthgQAqhJAz8w0yNu9FpXYSX146sV3PxvYAMX9IyyDAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8};class $ extends s.PN{get S(){return v.S.Global.modules.MainWindow.RealtimeFirstDialog}get skillList(){return[{icon:(0,Q.Q)(X),title:this.S.skillTitle1,desc:this.S.skillDesc1},{icon:(0,Q.Q)(Z),title:this.S.skillTitle2,desc:this.S.skillDesc2},{icon:(0,Q.Q)(Y),title:this.S.skillTitle3,desc:this.S.skillDesc3}]}onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,a._)(this,"props",void 0),(0,a._)(this,"someState",!0)}}(0,o.gn)([s.SB],$.prototype,"someState",void 0),(0,o.gn)([s.Fl],$.prototype,"S",null),(0,o.gn)([s.Fl],$.prototype,"skillList",null);let ee=s._Y.createComponent("OpenRealtimeFirstDialog",$,e=>{let t=f.o.isExtension?{position:"absolute",bottom:"0px",right:"48px"}:{};return(0,V.jsxs)(z.u,{className:q.openRealtimeFirstDialog,onDispose:e.props.onDisposed,fixed:"dialogRoot"===e.props.insertTarget,width:390,closeOnMaskClick:!1,style:t,children:[(0,V.jsxs)("div",{className:q.header,children:[(0,V.jsx)(H.E,{className:q.img,src:(0,Q.Q)(K)}),(0,V.jsx)("div",{className:q.title,children:e.S.title}),(0,V.jsx)("div",{className:q.desc,children:(0,V.jsx)(G.Z,{S:e.S.desc,components:{img:e=>(0,V.jsxs)("div",{className:q.chatgpt,children:[(0,V.jsx)(H.E,{className:q.icon,src:(0,Q.Q)(J)}),(0,V.jsx)("div",{className:q.text,children:e})]})}})})]}),(0,V.jsxs)("div",{className:q.content,children:[(0,V.jsx)("div",{className:q.text,children:e.S.content}),(0,V.jsx)("div",{className:q.skillBox,children:e.skillList.map((e,t)=>(0,V.jsxs)("div",{className:q.skillItem,children:[(0,V.jsx)(H.E,{className:q.skillIcon,src:e.icon}),(0,V.jsxs)("div",{className:q.skillContent,children:[(0,V.jsx)("div",{className:q.skillTitle,children:e.title}),(0,V.jsx)("div",{className:q.skillDesc,children:e.desc})]})]},t))}),(0,V.jsx)("a",{className:q.btn,onClick:e=>{e.preventDefault()},children:(0,V.jsx)(W.z,{type:"primary",className:q.getApp,onClick:()=>e.props.handleStart(),children:(0,V.jsx)("span",{children:e.S.btn})})})]})]})}),et=j.t.createOpener(ee,{singleton:!0});var ei=i(36976),ea=i(89322),eo=i(90180),es=i(63243),en=i(91390),er=i(37949),el=i(90230),ed=i(19613),ec=i(38299),eh=i(15851),eg=i(34889),ep=i(33381),eA=i(67061),em=i(90683),eu=i(81627),ef=i(18312),ey=i(95066);class ev{get conversationId(){return this.parent.conversationId}get mergedArtifactsVersionMap(){let e={};for(let t of this.parent.renderItems)if(u.MonicaChatTypeCheckers.isReply(t)&&t.data.artifacts)for(let i of t.data.artifacts){let a=i.data.id,o=e[a]||[],s=this.chatArtifactData2ServerArtifactData({artifact:i.data,conversationId:this.conversationId,replyId:t.itemId}),n=this.artifactsInConversation.find(e=>e.artifactId===i.data.id&&e.chatItemId===t.itemId&&e.conversationId===this.conversationId);o.push({...s,...n}),e[a]=o}return e}initServiceListeners(){this.artifactDataManager=new ey.f({chatBotController:this.parent}),U.W.on("userLogout",()=>{this.close()}),m.D.on("onConversationArtifactsMapChange",e=>{let{conversationArtifactsMap:t}=e;this.artifactsInConversation=t[this.conversationId]||[]}),m.D.on("onFavoritedArtifactsChange",e=>{let{list:t,total:i}=e;this.favoritedArtifacts=t,this.favoritedArtifactsTotal=i}),y.f.getProxy(this).add((0,k.U5)(()=>({mergedArtifactsVersionMap:this.mergedArtifactsVersionMap}),e=>{let{mergedArtifactsVersionMap:t}=e,i=this.artifactDataManager.artifactData;if(i){let e=t[i.artifactId]||[];this.artifactDataManager.setVersions(e);let a=e.find(e=>e.artifactId===i.artifactId&&e.chatItemId===i.chatItemId&&e.conversationId===i.conversationId);a&&this.artifactDataManager.setArtifactData(a)}else this.artifactDataManager.setVersions([])}))}chatArtifactData2ServerArtifactData(e){return r.y.chatArtifactData2ServerArtifactData(e)}serverArtifactData2ChatArtifactData(e){return r.y.serverArtifactData2ChatArtifactData(e)}async show(e){let{convId:t,artifactData:i,replyId:a,isModalMode:o,enableQuickFix:s,isShareMode:n,fromChatResources:r=!1}=e;this.close(),this.artifactDataManager.markAsSteamStart();let l=this.chatArtifactData2ServerArtifactData({artifact:i.data,conversationId:t,replyId:a});if(this.artifactDataManager.setArtifactData(l),!i.streaming){this.artifactDataManager.markAsSteamFinished();let e=this.mergedArtifactsVersionMap[i.data.id]||[],o=e.find(e=>e.artifactId===i.data.id&&e.chatItemId===a&&e.conversationId===t);this.artifactDataManager.setVersions(e),o&&this.artifactDataManager.setArtifactData(o)}e.artifactUid&&this.artifactDataManager.setArtifactData({...this.artifactDataManager.artifactData,uid:e.artifactUid,artifactUid:e.artifactUid}),this.isOpen||e.disableOpen||(this.isOpen=!0,this.artifactDataManager.fromChatResources=r,"horizontal"===eA.L.mainWindowMode?er.w.windowWidth<1300&&(ef.J.isHomeSidebarAutoCollapsed=!0):this.showArtifactPreviewDialog({isModalMode:o,enableQuickFix:s,isShareMode:n}))}showArtifactPreviewDialog(e){this.parent.botData.parent.views.openArtifactPreviewDialog({dataManager:this.artifactDataManager,isPreviewMode:(null==e?void 0:e.isShareMode)||this.parent.isShareMode,privacyDialogProps:this.parent.isShareMode?this.privacyDialogProps:void 0,insertTarget:"dialogRoot",isModalMode:null==e?void 0:e.isModalMode,enableQuickFix:null==e?void 0:e.enableQuickFix,getRef:e=>{this.dialogRef=e},onClose:()=>{this.isOpen=!1}})}close(){var e;this.isOpen=!1,null===(e=this.dialogRef)||void 0===e||e.dispose()}async loadArtifactsInConversation(e){this.artifactsInConversation=[],this.artifactsInConversation=await m.D.getArtifactsInConversation(e),this.trySyncToServer()}async createSyncArtifactTask(e){let t=e.map(e=>{let{artifactData:t,conversationId:i,itemId:a}=e,o=w.m.createReadySource();this.syncArtifactTaskList.push({...e,uploadedReadySource:o});let s="".concat(i,"_").concat(a,"_").concat(t.id,"_").concat(t.name,".json"),n=w.m.createFile(JSON.stringify(t),s,"application/json");return{...e,file:n}}),{objectUrlList:i,preSignUrlList:a}=await eg.Gi.getS3PreSignList({filenameList:t.map(e=>e.file.name),module:"chat_bot",objId:w.m.genShortId()}),o=w.m.createReadySource();m.D.syncToServer({artifacts:t.map((e,t)=>({artifactId:e.artifactData.id,artifactName:e.artifactData.name,artifactType:e.artifactData.type,chatItemId:e.itemId,conversationId:e.conversationId,objectUrl:i[t],versionName:e.version.toString(),generateBy:e.fromEdit?"custom_edit":"ai_gen"}))},e=>{e.forEach(e=>{var t;let{artifactId:i,currentSnapshotUid:a,uid:o}=e;(null===(t=this.artifactDataManager.artifactData)||void 0===t?void 0:t.artifactId)===i&&this.artifactDataManager.setArtifactData({...this.artifactDataManager.artifactData,artifactUid:o,uid:a})}),console.log("sync success"),o.markReady()}),t.forEach(async(e,t)=>{let{file:i,artifactData:s,conversationId:n,itemId:r}=e;await eg.Gi.uploadFileToS3(a[t],i,()=>{}),await o.waitReady();let l=this.syncArtifactTaskList.find(e=>e.conversationId===n&&e.itemId===r&&e.artifactData.id===s.id);l&&l.uploadedReadySource.markReady()})}async initFavoritedArtifacts(e){if(!this.favoritedArtifactsFetched){this.favoritedArtifactsFetched=!0,this.favoritedArtifactsLoading=!0;try{this.favoritedArtifacts=[];let{list:t,total:i}=await m.D.getFavoritedArtifacts({limit:e,offset:0});this.favoritedArtifacts=t,this.favoritedArtifactsTotal=i,this.favoritedArtifactsLoading=!1}catch(e){this.favoritedArtifactsFetched=!1,eh.M.error(w.m.formatErrorMsg(e)),this.favoritedArtifactsLoading=!1}}}getHash(e){return"".concat(e.conversationId,"_").concat(e.itemId,"_").concat(e.artifactId)}async waitSyncToServerReady(e){let t=this.syncArtifactTaskList.find(t=>t.conversationId===e.conversationId&&t.itemId===e.itemId&&t.artifactData.id===e.artifactId);return t?t.uploadedReadySource.waitReady():Promise.resolve()}async sendEditArtifactMessage(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.parent.createReply("".concat(v.S.Global.modules.Artifact.editedPage,"\n").concat(n.C.transformArtifactContent(e)),null===(t=this.parent.lastRenderItem)||void 0===t?void 0:t.itemId,{artifacts:[{data:e,streaming:!1,fromEdit:!0}]});await Promise.all([this.parent.addChatItems([a]),this.trySyncToServer()]),this.artifactDataManager.setArtifactData(r.y.chatArtifactData2ServerArtifactData({artifact:e,conversationId:this.parent.content,replyId:a.itemId})),this.artifactDataManager.markAsSteamFinished(),i&&await this.waitSyncToServerReady({artifactId:e.id,conversationId:this.parent.conversationId,itemId:a.itemId})}async trySyncToServer(){let e=this.parent.renderItems.flatMap(e=>{if(!u.MonicaChatTypeCheckers.isReply(e)||!e.data.artifacts)return[];let t=this.parent.conversationId;return(e.data.artifacts||[]).filter(i=>!this.artifactsInConversation.some(a=>a.conversationId===t&&a.artifactId===i.data.id&&a.chatItemId===e.itemId)).map(i=>({data:i,conversationId:t,itemId:e.itemId}))});0!==e.length&&await this.createSyncArtifactTask(e.map(e=>{let t=(this.mergedArtifactsVersionMap[e.data.data.id]||[]).findIndex(t=>t.chatItemId===e.itemId&&t.artifactId===e.data.data.id);return{artifactData:e.data.data,conversationId:e.conversationId,itemId:e.itemId,fromEdit:e.data.fromEdit,version:-1!==t?t+1:1}}))}constructor(e){(0,a._)(this,"parent",void 0),(0,a._)(this,"artifactDataManager",void 0),(0,a._)(this,"isOpen",void 0),(0,a._)(this,"privacyDialogProps",void 0),(0,a._)(this,"favoritedArtifacts",void 0),(0,a._)(this,"favoritedArtifactsTotal",void 0),(0,a._)(this,"favoritedArtifactsLoading",void 0),(0,a._)(this,"artifactsInConversation",void 0),(0,a._)(this,"favoritedArtifactsFetched",void 0),(0,a._)(this,"syncArtifactTaskList",void 0),(0,a._)(this,"dialogRef",void 0),this.parent=e,this.isOpen=!1,this.privacyDialogProps={visible:!1,onClose:()=>{P.ll.setUiFlag("artifactSharePrivacyDialogShowed",!0),this.privacyDialogProps.visible=!1}},this.favoritedArtifacts=[],this.favoritedArtifactsTotal=0,this.favoritedArtifactsLoading=!1,this.artifactsInConversation=[],this.favoritedArtifactsFetched=!1,this.syncArtifactTaskList=[],(0,k.rC)(this)}}(0,o.gn)([s.SB],ev.prototype,"isOpen",void 0),(0,o.gn)([s.SB],ev.prototype,"privacyDialogProps",void 0),(0,o.gn)([s.SB],ev.prototype,"favoritedArtifacts",void 0),(0,o.gn)([s.SB],ev.prototype,"favoritedArtifactsTotal",void 0),(0,o.gn)([s.SB],ev.prototype,"favoritedArtifactsLoading",void 0),(0,o.gn)([s.SB],ev.prototype,"artifactsInConversation",void 0),(0,o.gn)([k.Fl],ev.prototype,"mergedArtifactsVersionMap",null);var ew=i(79854),eC=i(46977),eb=i(39959),eS=i.n(eb),eI=i(1396);class e_{setMemoAction(e){this.mentionData={type:"memo",id:e,name:this.parent.getActionLabel(e)},e===C.Ln.askMemo&&this.parent.modelAndSource.handleChangeKnowledgeSourceEnabled({enabled:!0,source:"ask_memo",key:this.parent.modelAndSource.knowledgeSourceKeyMap.chatWithMemo}),this.parent.afterSetMemoAction(),this.afterSetMention()}setKnowledgeAction(e){var t,i;let a=e=>{this.mentionData={type:"knowledge",id:e},eI.Mp.getMonicaChatController().modelAndSource.knowledgeKeyFromMention=e,this.parent.afterSetMemoAction(),this.afterSetMention()},o=this.parent.modelAndSource;if(null===(i=o.modelList.find(e=>e.key===o.baseModelKey))||void 0===i?void 0:null===(t=i.capabilities)||void 0===t?void 0:t.includes("tools")){if(!eo.A.gpt4Enabled){let{isEnough:e,handleCreditsNotEnough:t}=D.K.checkCredits({module:"genius_bot",source:"chat_bot_mention"});if(!e){t();return}eo.A.setGpt4Enabled(!0)}a(e)}else this.parent.botData.parent.views.openDisableBaseModelDialog({insertTarget:"mainWindow",onConfirm:async()=>{let{isEnough:t,handleCreditsNotEnough:i}=D.K.checkCredits({module:"genius_bot",source:"chat_bot_mention"});if(!t){i();return}eo.A.gpt4Enabled||eo.A.setGpt4Enabled(!0),eo.A.setBaseModelKey(o.modelKeyMap.gpt4o),a(e)},chatController:this.parent})}deleteMentionAction(){this.mentionData=null,eI.Mp.getMonicaChatController().modelAndSource.knowledgeKeyFromMention=""}setBot(e){this.mentionData={type:"bot",botData:{logoUrl:e.logoUrl,name:e.name,uid:e.uid,useMode:e.useMode}},this.afterSetMention()}afterSetMention(){let{textareaNode:e,textareaCaretPosition:t,textareaCursorIndex:i,content:a}=this.parent,o=i,s=a;t&&a.slice(t.start,t.end+1).startsWith("@")&&(s=a.slice(0,t.start)+a.slice(t.end+1),o=t.start,this.parent.setTextareaCaretPosition(null)),s=s.slice(0,o)+s.slice(o),this.parent.setContent(s),this.parent.chatBotAttachment.fileManagers.length&&this.parent.chatBotAttachment.clearFiles(),e&&setTimeout(()=>{!function(e,t,i){if(e&&(e.focus(),e.setSelectionRange(t,t),null==i?void 0:i.scrollIntoView)){let{top:i,height:a}=eS()(e,t);e.scrollTop=Math.max(0,i+a-e.clientHeight)}}(e,o,{scrollIntoView:!0})},30)}constructor(e){(0,a._)(this,"parent",void 0),(0,a._)(this,"mentionData",void 0),this.parent=e,this.mentionData=null,(0,k.rC)(this)}}(0,o.gn)([s.SB],e_.prototype,"mentionData",void 0);var eT=i(54085);class ek{get styleFormat(){return eT.CJ.map(e=>({name:v.S.Global.modules.Bots.Artist.ArtistSettingDialog[e.key],key:e.model,cover:e.img}))}get writingScene(){let e=v.S.Global.modules.ChatBox.ChatSkill.WritingSkillCard;return{write:e.compose,reply:e.reply,grammar:e.grammar}}showCard(e){this.cardType!==e&&(this.cardType=e,setTimeout(()=>{this.parent.focusPrimaryInput()}))}hideCard(){this.cardType=null,setTimeout(()=>{this.parent.focusPrimaryInput()})}runSkill(e){let{question:t,skillCard:i,reportExtData:a,hideAfterSend:o=!0,fileManagers:s,onSend:n}=e;this.parent.clearIntent(),this.parent.sendQuestionOrAction({actionOrQuestion:t,questionType:i?"skill_card":"text",skillCard:i,reportExtData:a,fileManagers:s,onSend:()=>{null==n||n(),o&&this.hideCard()}})}supportChatWithFile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.cardType;return e&&this.ALLOW_CHAT_WITH_FILE_SKILL.includes(e)}async runSkillWithFile(e,t){let i=this.parent.chatBotAttachment.createEmptyManagers([{fileName:t.name,fileType:t.type,fileUrl:t.url}],e=>{e.state="default",e.uploadProgress=0,e.options={check:!1,uploadByCdnUrl:!0}});return this.runSkill({...e,fileManagers:i})}moveToFirst(e){let t=eo.A.chatSkillIdx||[],i=[];i=-1===t.indexOf(e)?[e].concat(t):[...t].sort((t,i)=>t===e?-1:i===e?1:0),P.ll.setUiFlag("chatSkillIdx",i)}constructor(e){(0,a._)(this,"parent",void 0),(0,a._)(this,"tempSelectedTabs",void 0),(0,a._)(this,"ALLOW_CHAT_WITH_FILE_SKILL",void 0),(0,a._)(this,"source",void 0),(0,a._)(this,"cardType",void 0),(0,a._)(this,"drawSize",void 0),this.parent=e,this.tempSelectedTabs=[],this.ALLOW_CHAT_WITH_FILE_SKILL=["code_interpreter","book_calendar","artifacts","mind_map","mermaid"],this.source="",this.cardType=null,this.drawSize=[{name:"16:9",tip:"1792 x 1024",icon:"rectHorizontal"},{name:"1:1",tip:"1024 x 1024",icon:"rectSquare"},{name:"9:16",tip:"1024 x 1792",icon:"rectVert"}],(0,k.rC)(this)}}(0,o.gn)([s.SB],ek.prototype,"source",void 0),(0,o.gn)([s.SB],ek.prototype,"cardType",void 0),(0,o.gn)([s.SB],ek.prototype,"drawSize",void 0),(0,o.gn)([k.Fl],ek.prototype,"styleFormat",null),(0,o.gn)([k.Fl],ek.prototype,"writingScene",null);class eE{get isDisabled(){return!!this.parent.showHomeView||!!this.parent.forSharePreview}get scrollStyle(){return eo.A.chatScrollStyle}get allowScrollToBottom(){return!this.isDisabled&&!1===this.isAtBottom}get containerStyle(){return this.isDisabled?{}:"toLastQuestion"===this.scrollStyle&&this.containerMinHeight?{minHeight:this.containerMinHeight}:{}}setScrollViewEl(e){e!==this.scrollViewEl&&(this.mutationObserver||(this.mutationObserver=new MutationObserver(()=>{this.handleResize()})),e&&(this.scrollViewEl&&this.mutationObserver.disconnect(),this.scrollViewEl=e,this.mutationObserver.observe(this.scrollViewEl,{childList:!0,subtree:!0,characterData:!0})))}setLastReplyEl(e){this.lastReplyEl=e}setLastQuestionEl(e){this.lastQuestionEl=e}afterAddQuestion(){this.setCanAutoScroll(!0),this.skipStopOnLastReplyTopCheck=!1,this.skipHandleResize=!0,"toLastQuestion"===this.scrollStyle?this.scrollTolNewPage():"stopOnLastReplyTop"===this.scrollStyle?this.scrollToBottom(0,!0):"toBottom"===this.scrollStyle&&this.scrollToBottom(0,!0),setTimeout(()=>{this.skipHandleResize=!1},20)}handleScroll(){if(!this.scrollViewEl||this.skipHandleScroll)return;let{clientHeight:e,scrollHeight:t,scrollTop:i}=this.scrollViewEl;0!==i||this.loadMoreLock||this.parent.handleConversationLoadMore(!0).then(e=>{e&&this.scrollViewEl&&setTimeout(()=>{if(this.scrollViewEl){let e=this.scrollViewEl.scrollHeight;this.loadMoreLock=!0,this.skipHandleScroll=!0,this.scrollViewEl.scrollTop=e-t-60,this.calculateIsAtBottom(),setTimeout(()=>{this.loadMoreLock=!1,this.skipHandleScroll=!1})}},20)}),this.isDisabled||(this.parent.isFinished?(this.setCanAutoScroll(!1),setTimeout(()=>{this.setCanAutoScroll(!1)},100)):i+e>=t-25?this.setCanAutoScroll(!0):this.setCanAutoScroll(!1),this.calculateIsAtBottom())}reset(){this.containerMinHeight=null,this.setCanAutoScroll(!1),this.isAtBottom=null,this.loadMoreLock=!1,this.scrollToBottomWhenResize=!1,this.skipHandleScroll=!1,this.skipStopOnLastReplyTopCheck=!1,this.skipHandleResize=!1}scrollToBottom(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.scrollToBottomWhenResize=!0,setTimeout(()=>{this.doScrollToBottom(t)},20),setTimeout(()=>{this.scrollToBottomWhenResize=!1},e)}async scrollTolNewPage(){if(await w.m.delay(0),!this.scrollViewEl||!this.lastQuestionEl||f.o.isChatPDF&&es.docChatController.isChatViewCollapsed)return;let e=this.scrollViewEl.getBoundingClientRect(),t=parseFloat(getComputedStyle(this.scrollViewEl).paddingTop);this.containerMinHeight=this.lastQuestionEl.offsetTop+e.height-t,this.scrollToBottom(0,!0)}dispose(){var e;this.reset(),null===(e=this.mutationObserver)||void 0===e||e.disconnect()}handleResize(){this.isDisabled||this.skipHandleResize||(this.scrollToBottomWhenResize&&this.scrollToBottom(),this.triggerAutoScroll(),this.calculateIsAtBottom())}triggerAutoScroll(){if(this.scrollViewEl&&this.canAutoScroll){if("stopOnLastReplyTop"===this.scrollStyle&&this.lastReplyEl&&this.canAutoScroll&&!this.skipStopOnLastReplyTopCheck){let e=this.lastReplyEl.getBoundingClientRect(),t=this.scrollViewEl.getBoundingClientRect();if(e.top-t.top<=30){this.setCanAutoScroll(!1),this.skipStopOnLastReplyTopCheck=!0,this.skipHandleScroll=!0,setTimeout(()=>{this.skipHandleScroll=!1},20);return}}this.scrollToBottom(0,!1)}}calculateIsAtBottom(){if(!this.scrollViewEl){this.isAtBottom=null;return}this.scrollViewEl.scrollTop+this.scrollViewEl.clientHeight>=this.scrollViewEl.scrollHeight-300?this.isAtBottom=!0:this.isAtBottom=!1}doScrollToBottom(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.scrollViewEl&&(this.skipHandleScroll=!0,this.scrollViewEl.scrollTo({top:this.scrollViewEl.scrollHeight,behavior:e?"smooth":void 0}),setTimeout(()=>{this.skipHandleScroll=!1,this.calculateIsAtBottom()},e?200:0))}setCanAutoScroll(e){this.canAutoScroll!==e&&(this.canAutoScroll=e)}constructor(e){(0,a._)(this,"parent",void 0),(0,a._)(this,"isAtBottom",void 0),(0,a._)(this,"containerMinHeight",void 0),(0,a._)(this,"scrollViewEl",void 0),(0,a._)(this,"lastReplyEl",void 0),(0,a._)(this,"lastQuestionEl",void 0),(0,a._)(this,"mutationObserver",void 0),(0,a._)(this,"canAutoScroll",void 0),(0,a._)(this,"loadMoreLock",void 0),(0,a._)(this,"scrollToBottomWhenResize",void 0),(0,a._)(this,"skipHandleScroll",void 0),(0,a._)(this,"skipStopOnLastReplyTopCheck",void 0),(0,a._)(this,"skipHandleResize",void 0),this.parent=e,this.isAtBottom=null,this.containerMinHeight=null,this.scrollViewEl=null,this.lastReplyEl=null,this.lastQuestionEl=null,this.mutationObserver=null,this.canAutoScroll=!0,this.loadMoreLock=!1,this.scrollToBottomWhenResize=!1,this.skipHandleScroll=!1,this.skipStopOnLastReplyTopCheck=!1,this.skipHandleResize=!1,(0,k.rC)(this)}}(0,o.gn)([s.SB],eE.prototype,"isAtBottom",void 0),(0,o.gn)([s.SB],eE.prototype,"containerMinHeight",void 0),(0,o.gn)([s.SB],eE.prototype,"scrollViewEl",void 0),(0,o.gn)([k.Fl],eE.prototype,"isDisabled",null),(0,o.gn)([k.Fl],eE.prototype,"scrollStyle",null),(0,o.gn)([k.Fl],eE.prototype,"allowScrollToBottom",null),(0,o.gn)([k.Fl],eE.prototype,"containerStyle",null);var eM=i(48655),ex=i(85132),eB=i(47720);class eD{get skillModelKeyListMap(){let e=eB.serverConfigController.getStaticConfig("skillCardModels")||[];return new Map(e.flatMap(e=>{var t;return e.skillCard&&(null===(t=e.models)||void 0===t?void 0:t.length)?[[e.skillCard,e.models.flatMap(e=>{let t=F.S.getModelItem(e);return t?[t.key]:[]})]]:[]}))}get monicaModelKeyList(){let{basic:e=[],inference:t=[],advance:i=[]}=eB.serverConfigController.getStaticConfig("monicaModelListV3")||{};return f.o.isChatPDF?{basic:e,advance:i,inference:[]}:{basic:e,advance:i,inference:t}}get monicaModelList(){let{basic:e,inference:t,advance:i}=this.monicaModelKeyList;return{basic:e.flatMap(e=>F.S.getModelItem(e)||[]),inference:t.flatMap(e=>F.S.getModelItem(e)||[]),advance:i.flatMap(e=>F.S.getModelItem(e)||[])}}get modelList(){return this.monicaModelList?Object.values(this.monicaModelList).flat(1):[]}get modelListHavingTools(){return this.modelList.filter(e=>{var t;return null===(t=e.capabilities)||void 0===t?void 0:t.includes("tools")})}get knowledgeSourceList(){return eB.serverConfigController.getStaticConfig("monicaKnowledgeSourceList")||[]}get baseModelKey(){let e=this.parent.chatBotSkillCard.cardType;if(e){if(!eo.A.baseModelKey)return this.defaultBaseModelKey;let t=this.skillModelKeyListMap.get(e)||[],i=t.findIndex(e=>e===eo.A.baseModelKey);return -1!==i?t[i]:this.defaultBaseModelKey}return -1!==this.modelList.findIndex(e=>e.key===eo.A.baseModelKey)&&eo.A.baseModelKey||this.defaultBaseModelKey}get baseModelEnabled(){if(F.S.checkIsStandardModel(this.baseModelKey)){var e;return null!==(e=eo.A.basicModelEnabled)&&void 0!==e&&e}let t=this.parent.chatBotSkillCard.cardType;return!!(t&&this.advancedModelSkill.includes(t))||eo.A.gpt4Enabled}get knowledgeSourceKey(){return this.forceChatWithMemoEnabled?this.knowledgeSourceKeyMap.chatWithMemo:this.knowledgeKeyFromMention?this.knowledgeKeyFromMention:"search"===this.parent.chatBotSkillCard.cardType&&ep.userController.isFreeUser?this.defaultKnowledgeSourceKey:eo.A.knowledgeSourceKey||this.defaultKnowledgeSourceKey}get knowledgeSourceEnabled(){if(this.forceChatWithMemoEnabled||this.knowledgeKeyFromMention)return!0;let e=this.parent.chatBotSkillCard.cardType;return e&&!["artifacts","mind_map"].includes(e)?"search"===e:eI.Mp.getMonicaChatController().clientConfig.shouldEnableSkill("web_access")}get currentModelName(){let e=F.S.getModelItem(this.baseModelKey);return(null==e?void 0:e.name)||""}get baseModelListHavingTools(){return this.modelList.filter(e=>{var t;return null===(t=e.capabilities)||void 0===t?void 0:t.includes("tools")})}get chatWithMemoEnabled(){return!!this.forceChatWithMemoEnabled||this.knowledgeSourceKey===this.knowledgeSourceKeyMap.chatWithMemo&&this.knowledgeSourceEnabled}initModelList(){this.modelListInited||(this.modelListInited=!0,eM.Cc.manualUpdateStaticConfig([ex.$.monicaModelListV3,ex.$.customBotModelListV2,ex.$.allModelList,ex.$.skillCardModels],!0))}async handleChangeBaseModelEnabled(e){var t,i;this.forceChatWithMemoEnabled=!1,this.knowledgeKeyFromMention="";let{enabled:a,source:o,skipQuotaCheck:s}=e,n=e.key||this.baseModelKey;if(this.baseModelKey===n&&this.baseModelEnabled===a)return;let r=F.S.getModelItem(n),l=F.S.checkIsStandardModel(n),{isEnough:d,handleCreditsNotEnough:c}=D.K.checkCredits({module:null==r?void 0:r.usageModule,source:o}),h=s||em.T.isCustomCtx;if(a&&!h&&!d){c();return}let g=async()=>{let e=[eo.A.setBaseModelKey(n)];return l?(e.push(eo.A.setBasicModelEnabled(a)),a&&e.push(eo.A.setGpt4Enabled(!1))):(e.push(eo.A.setGpt4Enabled(a)),a&&e.push(eo.A.setBasicModelEnabled(!1))),Promise.all(e)},p=null!==(i=null===(t=this.modelList.find(e=>e.key===n))||void 0===t?void 0:t.capabilities)&&void 0!==i?i:[];a&&this.knowledgeSourceEnabled&&!p.includes("tools")?this.parent.botData.parent.views.openDisableKnowledgeSourceDialog({insertTarget:"mainWindow",onConfirm:()=>{g(),eI.Mp.getMonicaChatController().clientConfig.toggleSkill("web_access",!1,!0,!s)},chatController:this.parent}):await g()}handleChangeKnowledgeSourceEnabled(e){let{enabled:t,source:i}=e,a=e.key||this.knowledgeSourceKey;if(this.knowledgeSourceEnabled===t&&this.knowledgeSourceKey===a)return;if(a===this.knowledgeSourceKeyMap.chatWithMemo){eo.A.setKnowledgeSourceKey(a),eI.Mp.getMonicaChatController().clientConfig.toggleSkill("web_access",t,!0,!1);return}let o=!1;if(t){let{isEnough:e,handleCreditsNotEnough:t}=D.K.checkCredits({source:i,module:"web_search"});if(!e){t();return}o=!0}let s=this.checkModelSupportTools(this.baseModelKey);t&&this.baseModelEnabled&&!s?this.parent.botData.parent.views.openDisableBaseModelDialog({insertTarget:"mainWindow",onConfirm:()=>{eo.A.setKnowledgeSourceKey(a),eI.Mp.getMonicaChatController().clientConfig.toggleSkill("web_access",t,!0,!o),eo.A.setBaseModelKey(this.modelKeyMap.gpt4o),eo.A.gpt4Enabled||eo.A.setGpt4Enabled(!0)},chatController:this.parent}):(eo.A.setKnowledgeSourceKey(a),eI.Mp.getMonicaChatController().clientConfig.toggleSkill("web_access",t,!0,!o));let n=this.parent.chatBotMention.mentionData;t||(null==n?void 0:n.type)!=="knowledge"||n.id!==a||this.parent.chatBotMention.deleteMentionAction()}checkModelSupportSkill(e,t){return(this.skillModelKeyListMap.get(t)||[]).includes(e)}checkModelSupportTools(e){var t;let i=F.S.getModelItem(e);return null==i?void 0:null===(t=i.capabilities)||void 0===t?void 0:t.includes("tools")}checkIsAdvancedModel(e){let t=F.S.getModelItem(e);return(null==t?void 0:t.usageModule)==="genius_bot"||(null==t?void 0:t.usageModule)==="credits"}constructor(e){(0,a._)(this,"parent",void 0),(0,a._)(this,"knowledgeSourceKeyMap",void 0),(0,a._)(this,"modelKeyMap",void 0),(0,a._)(this,"iconMap",void 0),(0,a._)(this,"chatInputExpanded",void 0),(0,a._)(this,"forceChatWithMemoEnabled",void 0),(0,a._)(this,"knowledgeKeyFromMention",void 0),(0,a._)(this,"defaultBaseModelKey",void 0),(0,a._)(this,"defaultKnowledgeSourceKey",void 0),(0,a._)(this,"advancedModelSkill",void 0),(0,a._)(this,"modelListInited",void 0),this.parent=e,this.knowledgeSourceKeyMap={chatWithMemo:"my_memo",web:"web"},this.modelKeyMap={gpt4o:"gpt_4o",claudeSonnet:"claude_3.5_sonnet",o1Mini:"openai_o_1_mini",o1preview:"openai_o_1",geminiFlash:"gemini_1_5_flash_8b",deepseekR1:"deepseek_reasoner"},this.iconMap={web:"source-web",news:"source-news",academic:"source-academic",developer:"source-developer",my_memo:"saveMemo"},this.chatInputExpanded=!1,this.forceChatWithMemoEnabled=!1,this.knowledgeKeyFromMention="",this.defaultBaseModelKey="gpt_4o",this.defaultKnowledgeSourceKey="web",this.advancedModelSkill=["code_interpreter","draw"],this.modelListInited=!1,(0,k.rC)(this)}}(0,o.gn)([s.SB],eD.prototype,"chatInputExpanded",void 0),(0,o.gn)([s.SB],eD.prototype,"forceChatWithMemoEnabled",void 0),(0,o.gn)([s.SB],eD.prototype,"knowledgeKeyFromMention",void 0),(0,o.gn)([s.Fl],eD.prototype,"skillModelKeyListMap",null),(0,o.gn)([s.Fl],eD.prototype,"monicaModelKeyList",null),(0,o.gn)([s.Fl],eD.prototype,"monicaModelList",null),(0,o.gn)([s.Fl],eD.prototype,"modelList",null),(0,o.gn)([s.Fl],eD.prototype,"modelListHavingTools",null),(0,o.gn)([s.Fl],eD.prototype,"knowledgeSourceList",null),(0,o.gn)([s.Fl],eD.prototype,"baseModelKey",null),(0,o.gn)([s.Fl],eD.prototype,"baseModelEnabled",null),(0,o.gn)([s.Fl],eD.prototype,"knowledgeSourceKey",null),(0,o.gn)([s.Fl],eD.prototype,"knowledgeSourceEnabled",null),(0,o.gn)([s.Fl],eD.prototype,"currentModelName",null),(0,o.gn)([s.Fl],eD.prototype,"baseModelListHavingTools",null),(0,o.gn)([s.Fl],eD.prototype,"chatWithMemoEnabled",null);var eL=i(21320);class eR{get hasNewMemorySuggestion(){if(!eo.A.memorySuggestionLastViewedAt)return!1;let e=(this.memorySuggestionList||[]).reduce((e,t)=>Math.max(e,t.createdAt?eL.L.getTimestamp(t.createdAt):0),0);return!!e&&!!this.enableAutoLearnForChat&&e>eo.A.memorySuggestionLastViewedAt}get recommendedSkills(){var e;return(null===(e=eB.serverConfigController.getStaticConfig("skillConfigList"))||void 0===e?void 0:e.map(e=>({...e,uid:e.uid,description:e.description||"",skillName:e.skillName||""})))||[]}get enableAutoLearnForChat(){let e=this.sysSkills.find(e=>"memory"===e.uid);return ep.userController.isVipUser&&((null==e?void 0:e.enable)||(null==e?void 0:e.forceEnable)||!1)}get enablePersonalizedMemory(){let e=this.sysSkills.find(e=>"use_custom_memory"===e.uid);return ep.userController.isVipUser&&((null==e?void 0:e.enable)||(null==e?void 0:e.forceEnable)||!1)}getSkillConfig(e){let t=v.S.Global.modules.ChatBox.ChatSkills,i=this.parent,a=()=>{let{handleCreditsNotEnough:e,isEnough:t}=D.K.checkCredits({source:"skill_quick_reply",module:"genius_bot"});return!!t||(e(),!1)},o={icon:"earthBrand",key:"webAccess",iconSize:16,get name(){return t.webAccess},get enabled(){return e.shouldEnable("web_access")},onChange:t=>{e.toggleSkill("web_access",t)},tips:{content:t.webAccessContent,quickReplyList:[t.webAccessQuickReply.example1,t.webAccessQuickReply.example2,t.webAccessQuickReply.example3],onQuickReplyClick:async t=>(e.toggleSkill("web_access",!0),!!this.sysSkills.some(e=>"web_access"===e.uid&&e.enable)&&(this.parent.sendQuestionOrAction({actionOrQuestion:t}),!0))}},s={icon:"learnFromChat",key:"memory",get disabled(){return!i.isPreviewMode&&!eo.A.gpt4Enabled},get name(){return t.memory},get enabled(){return e.shouldEnable("memory")},beta:!0,onChange:t=>{e.toggleSkill("memory",t)},tips:{content:t.memoryContent,description:t.memoryDesc}},n={icon:"drawPicture",key:"drawPicture",get disabled(){return!i.isPreviewMode&&!eo.A.gpt4Enabled},get name(){return t.drawImages},get enabled(){return e.shouldEnable("draw_image")},onChange:t=>{e.toggleSkill("draw_image",t)},tips:{content:t.drawPictureContent,quickReplyList:[t.drawPictureQuickReply.example1,t.drawPictureQuickReply.example2,t.drawPictureQuickReply.example3],onQuickReplyClick:t=>{let i=a();return i&&(eo.A.setGpt4Enabled(!0),e.toggleSkill("draw_image",!0),this.parent.sendQuestionOrAction({actionOrQuestion:t})),i}}},r={icon:"taskReminder",key:"taskReminder",get disabled(){return!i.isPreviewMode&&!eo.A.gpt4Enabled},get name(){return t.bookCalendar},get enabled(){return e.shouldEnable("book_calendar")},onChange:t=>{e.toggleSkill("book_calendar",t)},tips:{content:t.taskReminderContent,quickReplyList:[t.bookCalendarQuickReply.example1,t.bookCalendarQuickReply.example2,t.bookCalendarQuickReply.example3],onQuickReplyClick:async t=>{let i=a();return i&&(eo.A.setGpt4Enabled(!0),e.toggleSkill("book_calendar",!0),this.parent.sendQuestionOrAction({actionOrQuestion:t})),i}}},l={icon:"artifacts",key:"artifacts",get disabled(){return!1},get name(){return t.artifacts},get enabled(){return e.shouldEnable("artifacts")},onChange:t=>{e.toggleSkill("artifacts",t)},tips:{content:t.artifactsContent,title:t.artifacts,quickReplyList:[(0,v.x)(t.artifactsQuickReply.example1,{key:"react"}),(0,v.x)(t.artifactsQuickReply.example2,{key:"Artifacts"}),(0,v.x)(t.artifactsQuickReply.example3,{key:"Artifacts"})],onQuickReplyClick:async t=>(e.toggleSkill("artifacts",!0),await i.sendQuestionOrAction({actionOrQuestion:t}),!0)}},d={icon:"dataAnalysisFill",key:"code_interpreter",get disabled(){return!1},get name(){return t.dataAnalysis},get enabled(){return e.shouldEnable("code_interpreter")},onChange:t=>{e.toggleSkill("code_interpreter",t)},tips:{content:t.dataAnalysisContent,title:t.dataAnalysis,quickReplyList:[{text:t.dataAnalysisReply.example1,fileInfo:{url:"https://assets.monica.im/assets/files/user_preview.csv",name:"frequency of uv.csv",type:"txt"}},{text:t.dataAnalysisReply.example2,fileInfo:{url:"https://assets.monica.im/assets/files/Bank_Churn.csv",name:"Bank_Churn.csv",type:"txt"}}],onQuickReplyClick:async(t,a)=>{e.toggleSkill("code_interpreter",!0);let{isEnough:o}=D.K.checkCredits({source:"code_interpreter_skill_example",module:"genius_bot"});return o&&eo.A.setGpt4Enabled(!0),i.modelAndSource.baseModelEnabled&&!i.modelAndSource.checkModelSupportSkill(i.modelAndSource.baseModelKey,"code_interpreter")&&eo.A.setBaseModelKey(i.modelAndSource.baseModelKey[0]),a&&"string"!=typeof a&&a.fileInfo?await i.chatBotSkillCard.runSkillWithFile({question:t,skillCard:{skillType:"code_interpreter",question:t},reportExtData:{source:"add_skill_dialog_code_interpreter"},hideAfterSend:!1},a.fileInfo):await i.sendQuestionOrAction({actionOrQuestion:t}),!0}}};return{generalIntelligence:{icon:"monicaChat",key:"intelligence",get name(){return t.generalIntelligence},get enabled(){return!0},iconColor:"var(--theme-icon-brand)",disabled:!0,tips:{get detail(){return[{title:t.generalIntelligenceTips.reasoning,content:[t.generalIntelligenceTips.reasoningPart1]},{title:t.generalIntelligenceTips.perception,content:[t.generalIntelligenceTips.perceptionPart1,t.generalIntelligenceTips.perceptionPart2]},{title:t.generalIntelligenceTips.selfReflection,content:[t.generalIntelligenceTips.selfReflectionPart1]}]}}},webAccess:o,drawPicture:n,taskReminder:r,memoAccess:{icon:"memo",key:"memo",get disabled(){return!i.isPreviewMode&&!eo.A.gpt4Enabled},get name(){return t.memoAccess},get enabled(){return e.shouldEnable("memo_access")},onChange:t=>{e.toggleSkill("memo_access",t)},tips:{get detail(){return[{title:t.memoAccess,content:[t.memoAccessTips.memoAccessPart1,t.memoAccessTips.memoAccessPart2]}]}}},memory:s,artifacts:l,dataAnalysis:d}}init(){this.initServiceListener(),this.initMonicaBotConfig(),this.initMemoryData()}async initServiceListener(){d.y.on("monicaBotConfigChange",e=>{this.handleMonicaBotConfigChange(e)}),d.y.on("memoryV2Change",e=>{this.memoryInfo={...this.memoryInfo,...e}}),this.parent.emitter.listenBy(this,"agentStatusFinish",e=>{e.find(e=>"update_memory"===e.type)&&this.fetchMemoryData({useCache:!1,autoUpdate:!0})})}async initMonicaBotConfig(){let e=await d.y.getMonicaBotConfig({autoUpdate:!0,useCache:!0});this.handleMonicaBotConfigChange(e)}async toggleUserSkill(e,t){let i=this.userSkillIds;if(t){if(i.some(t=>t.uid===e))return;i.push({uid:e})}else i=i.filter(t=>t.uid!==e);let a={...this.monicaConfigData||{},monicaUserSkillList:i};this.handleMonicaBotConfigChange(a);try{await d.y.saveMonicaBot(a)}catch(o){eh.M.error(w.m.formatErrorMsg(o)),t?i=i.filter(t=>t.uid!==e):i.push({uid:e}),this.handleMonicaBotConfigChange({...a,monicaUserSkillList:i})}}handleMonicaBotConfigChange(e){var t;this.loadSkillData((null==e?void 0:e.monicaSysSkillList)||[]),this.hasTask=(null==e?void 0:null===(t=e.monicaProperty)||void 0===t?void 0:t.hasTask)||!1,this.userSkillIds=(null==e?void 0:e.monicaUserSkillList)||[],this.monicaConfigData=e,f.o.isExtension&&this.hasTask&&d.y.startLoopNotification()}shouldShowSkill(e){return!this.parent.isPreviewMode&&!f.o.isChatPDF&&("web_access"===e&&!!this.parent.botData.isGeniusBot||this.parent.botData.isMonicaBot)}shouldEnableSkill(e){let t=this.sysSkills.find(t=>t.uid===e);return(null==t?void 0:t.enable)||!1}async toggleSkill(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(this.shouldEnableSkill(e)===t)return;if(t&&a){if(!["artifacts"].includes(e)&&!ep.userController.isVipUser){D.K.handleCreditsNotEnough({module:"genius_bot",source:"unlock_skill_dialog_click_upgrade",featureName:"skills"});return}if("web_access"===e){let{isEnough:e,handleCreditsNotEnough:t}=D.K.checkCredits({module:"web_search",source:"web_access_click_upgrade"});if(!e){t();return}}else if("book_calendar"===e||"draw_image"===e||"memory"===e){let{handleCreditsNotEnough:e,isEnough:t}=D.K.checkCredits({source:"skill_quick_reply",module:"genius_bot"});if(!t){e();return}}}let o=this.sysSkills.find(t=>t.uid===e);o?o.enable=t:this.sysSkills.push({uid:e,enable:t}),i&&await d.y.setSysSkills(this.sysSkills)}async loadSkillData(e){let t=[];0===e.length?t=[{uid:"web_access",enable:ep.userController.isVipUser},{uid:"draw_image",enable:!1},{uid:"book_calendar",enable:!1},{uid:"memo_access",enable:!1}]:e.forEach(e=>{t.push(e)}),e.find(e=>"code_interpreter"===e.uid)||t.push({uid:"code_interpreter",enable:ep.userController.isVipUser}),e.find(e=>"artifacts"===e.uid)||t.push({uid:"artifacts",enable:!0}),this.sysSkills=t}memoryMarkRead(){P.ll.set("memorySuggestionLastViewedAt",Date.now())}async clearMemoryItems(){try{await d.y.clearMemory()}catch(e){eh.M.error(w.m.formatErrorMsg(e))}}async deleteMemoryItem(e){if(e)try{await d.y.deleteMemoryItem({itemId:e})}catch(e){eh.M.error(w.m.formatErrorMsg(e))}}async updateMemoryInstructionAndResponsePreference(e){try{var t,i,a;let o={};void 0!==e.instruction&&e.instruction!==(null===(t=this.memoryInfo)||void 0===t?void 0:t.instruction)&&(o.instruction=e.instruction),void 0!==e.responsePreference&&e.responsePreference!==(null===(i=this.memoryInfo)||void 0===i?void 0:i.responsePreference)&&(o.responsePreference=e.responsePreference),await d.y.updateMemoryInstructionAndResponsePreference(o),e.responsePreference!==(null===(a=this.memoryInfo)||void 0===a?void 0:a.responsePreference)&&P.ll.set("memoryResponsePreferenceUpdatedTime",Math.floor(Date.now()/1e3))}catch(e){eh.M.error(w.m.formatErrorMsg(e))}}async createMemoryItem(e){try{await d.y.createMemoryItem({content:e}),await this.fetchMemoryData()}catch(e){eh.M.error(w.m.formatErrorMsg(e))}}async updateMemoryItem(e){try{await d.y.updateMemoryItem(e)}catch(e){eh.M.error(w.m.formatErrorMsg(e))}}async initMemoryData(){this.memoryInfo=await d.y.initMemoryData(),this.updateMemorySuggestions("refresh",{useCache:!0})}async updateMemorySuggestions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"append",t=arguments.length>1?arguments[1]:void 0;"refresh"===e&&(this.memorySuggestionList=[],this.memorySuggestionLoading=!0);let{list:i,total:a}=await d.y.getMemorySuggestions({limit:20,offset:this.memorySuggestionList.length,status:"pending"},e=>{let{list:t,total:i}=e;this.memorySuggestionTotal=i,this.memorySuggestionList=t},t);this.memorySuggestionList=[...this.memorySuggestionList,...i],this.memorySuggestionLoading=!1,this.memorySuggestionTotal=a}async acceptMemorySuggestion(e){this.memorySuggestionList=this.memorySuggestionList.filter(t=>t.id!==e.suggestionId),this.memorySuggestionTotal=this.memorySuggestionTotal-1,await d.y.acceptMemorySuggestion(e),this.fetchMemoryData()}async rejectMemorySuggestion(e){this.memorySuggestionList=this.memorySuggestionList.filter(t=>t.id!==e.suggestionId),this.memorySuggestionTotal=this.memorySuggestionTotal-1,await d.y.rejectMemorySuggestion(e)}async rejectAllMemorySuggestion(){this.memorySuggestionList=[],this.memorySuggestionTotal=0,await d.y.rejectAllMemorySuggestions()}async fetchMemoryData(e){try{let t=await d.y.getMemory(e);this.memoryInfo=t}catch(e){eh.M.error(w.m.formatErrorMsg(e))}}toggleEnablePersonalizedMemory(e){this.toggleSkill("use_custom_memory",e)}toggleAutoLearn(e){this.toggleSkill("memory",e)}async toggleMemoryItemPin(e){var t;let i={...e},a=(null===(t=this.memoryInfo)||void 0===t?void 0:t.itemList)||[],o=a.findIndex(e=>e.id===i.id);if(-1===o)return;let s=i.pinned;a[o].pinned=!i.pinned,this.memoryInfo={...this.memoryInfo,itemList:a};try{await d.y.toggleMemoryItemPin(i)}catch(e){a[o].pinned=s,this.memoryInfo={...this.memoryInfo,itemList:a},eh.M.error(w.m.formatErrorMsg(e))}}constructor(e){(0,a._)(this,"parent",void 0),(0,a._)(this,"instructionMaxLength",void 0),(0,a._)(this,"maxMemoryItems",void 0),(0,a._)(this,"sysSkills",void 0),(0,a._)(this,"userSkillIds",void 0),(0,a._)(this,"hasTask",void 0),(0,a._)(this,"memoryInfo",void 0),(0,a._)(this,"memorySuggestionTotal",void 0),(0,a._)(this,"memorySuggestionList",void 0),(0,a._)(this,"memorySuggestionLoading",void 0),(0,a._)(this,"memoryResponsePreferenceUpdateTime",void 0),(0,a._)(this,"monicaConfigData",void 0),this.parent=e,this.instructionMaxLength=1500,this.maxMemoryItems=15,this.sysSkills=[],this.userSkillIds=[],this.hasTask=!1,this.memoryInfo=null,this.memorySuggestionTotal=0,this.memorySuggestionList=[],this.memorySuggestionLoading=!1,this.memoryResponsePreferenceUpdateTime=0,this.monicaConfigData=null,(0,k.rC)(this)}}(0,o.gn)([s.SB],eR.prototype,"sysSkills",void 0),(0,o.gn)([s.SB],eR.prototype,"userSkillIds",void 0),(0,o.gn)([s.SB],eR.prototype,"hasTask",void 0),(0,o.gn)([s.SB],eR.prototype,"memoryInfo",void 0),(0,o.gn)([s.SB],eR.prototype,"memorySuggestionTotal",void 0),(0,o.gn)([s.SB],eR.prototype,"memorySuggestionList",void 0),(0,o.gn)([s.SB],eR.prototype,"memorySuggestionLoading",void 0),(0,o.gn)([s.SB],eR.prototype,"memoryResponsePreferenceUpdateTime",void 0),(0,o.gn)([k.Fl],eR.prototype,"hasNewMemorySuggestion",null),(0,o.gn)([k.Fl],eR.prototype,"recommendedSkills",null),(0,o.gn)([k.Fl],eR.prototype,"enableAutoLearnForChat",null),(0,o.gn)([k.Fl],eR.prototype,"enablePersonalizedMemory",null);class eU{get hasPresetPrompt(){var e;return!!(null===(e=this.presetPrompt)||void 0===e?void 0:e.length)&&!!this.currentPrompt}handlePresetPrompt(e){let t=this.parsePrompt(e);if(!(null==t?void 0:t.length)){this.parent.content.endsWith("/")&&this.parent.setContent(this.parent.content.slice(0,-1)),this.insertInput(e.content);return}this.presetPrompt=t,this.currentPrompt=e}sendPrompt(){this.parent.setContent(""),this.parent.sendQuestionOrAction({actionOrQuestion:""})}getFinalPrompt(e,t){if(!e)return"";if(!(null==t?void 0:t.length))return e.content;let i=e.content||"",a=new Map(t.map(e=>{let t="";return t="select"===e.type||e.value?e.value||"":"language"===e.type?e.value||eo.A.finalChatPresetPromptLanguage:e.label,[e.label.toLowerCase(),t]})),o=0,s="";for(;o<i.length;){if("\\"===i[o]&&("["===i[o+1]||"$"===i[o+1]&&"["===i[o+2])){let e="$"===i[o+1]?3:2,t=i.indexOf("\\]",o+e);if(-1!==t){let a=i.slice(o+e,t);s+="$"===i[o+1]?"$[".concat(a,"]"):"[".concat(a,"]"),o=t+2;continue}}let e=i.indexOf("$[",o),t=i.indexOf("[",o),n=-1,r=!1;if(-1!==e&&(-1===t||e<t)?(n=e+1,r=!0):-1!==t?(n=t,r=!1):n=-1,-1===n){s+=i.slice(o);break}s+=i.slice(o,r?n-1:n);let l=n+1,d=1,c=!1;for(;l<i.length;){if("\\"===i[l]){c=!c,l++;continue}if(!c){if("["===i[l])d++;else if("]"===i[l]&&0==--d)break}c=!1,l++}if(l>=i.length){s+=i.slice(r?n-1:n);break}let h=i.slice(n+1,l),g=h.indexOf(":"),p=h;-1!==g&&(p=h.slice(0,g).trim());let A=a.get(p.toLowerCase());A?s+=A:s+=p,o=l+1}return s}parsePrompt(e){if(!e)return[];let t=e.content||"",i=[],a=0,o=0;for(;a<t.length;){let e=t.indexOf("$[lang]",a),s=t.indexOf("\\[",a),n=t.indexOf("[",a);if(-1===e&&-1===s&&-1===n)break;let r=-1,l="bracket";if(-1!==e&&(-1===r||e<r)&&(r=e,l="dollar"),-1!==s&&(-1===r||s<r)&&(r=s,l="backslash"),-1!==n&&(-1===r||n<r)&&(r=n,l="bracket"),-1===r)break;if(a=r,"dollar"===l)i.push({type:"language",index:o,label:"lang",value:eo.A.chatPresetPromptLanguage}),o++,a+=6;else if("backslash"===l){let e=t.indexOf("\\]",a+2);if(-1!==e){let s=t.slice(a+2,e),n=t.lastIndexOf(":",a),r=-1!==n?t.slice(t.lastIndexOf("\n",n)+1,n).trim():s;i.push({type:"text",index:o,label:r,value:"[".concat(s,"]")}),o++,a=e+2}else a+=2}else{let e=a+1,s=!1;for(;e<t.length;){if("\\"===t[e]){s=!s,e++;continue}if(!s&&"]"===t[e])break;s=!1,e++}if(e<t.length){let s=t.slice(a+1,e).replace(/\\([[\]])/g,"$1");if(s.includes(":")){let[e,t]=s.split(":").map(e=>e.trim());if(t.includes(",")){let a=t.split(",").map(e=>e.trim());i.push({type:"select",index:o,label:e,options:a,value:a[0]||""})}else i.push({type:"text",index:o,label:e,value:t})}else i.push({type:"text",index:o,label:s});o++,a=e+1}else a++}}return i}updatePresetValue(e,t){if(!this.presetPrompt)return;let i=this.presetPrompt.findIndex(t=>t.index===e.index);-1!==i&&(this.presetPrompt[i].value=t)}updatePresetPrompt(e){this.currentPrompt=e}clearPrompt(){this.currentPrompt=null,this.presetPrompt=null,this.parent.focusPrimaryInput()}async insertInput(e){let t=this.parent.textareaNode;t&&(this.parent.focusPrimaryInput(),await w.m.delay(10),document.execCommand("insertText",!1,e),await w.m.delay(100),t.scrollTop=t.scrollHeight)}initServiceEventListeners(){U.W.on("myPromptsChange",e=>{if(this.currentPrompt){let i=e.findIndex(e=>{var t;return e.id===(null===(t=this.currentPrompt)||void 0===t?void 0:t.id)});if(-1!==i)this.handlePresetPrompt(e[i]);else{var t;this.currentPrompt.userId===(null===(t=ep.userController.userInfo)||void 0===t?void 0:t.id)&&this.clearPrompt()}}})}constructor(e){(0,a._)(this,"parent",void 0),(0,a._)(this,"currentPrompt",void 0),(0,a._)(this,"presetPrompt",void 0),this.parent=e,this.currentPrompt=null,this.presetPrompt=null,(0,k.rC)(this)}}(0,o.gn)([s.SB],eU.prototype,"currentPrompt",void 0),(0,o.gn)([s.SB],eU.prototype,"presetPrompt",void 0),(0,o.gn)([k.Fl],eU.prototype,"hasPresetPrompt",null);class eP{get progressPercentage(){return Math.floor((this.parseProgress+this.readingProgress)/2)}get isReadingUnfinished(){return"reading"===this.readingStatus||"streaming"===this.readingStatus}markReadingStart(){this.readingStatus="reading",this.parseProgress=0,this.readingProgress=0,w.m.fakeProgress(3,e=>{this.parseProgress=e})}markReadingCompleted(){this.readingStatus="completed",this.readingProgress=100}markReadingFailed(){null!==this.readingStatus&&(this.readingStatus="failed"),this.parseProgress=0,this.readingProgress=0}markReadingReset(){this.readingStatus=null}markStreamingStarted(){"streaming"!==this.readingStatus&&(this.readingStatus="streaming",this.parseProgress=100,w.m.fakeProgress(5,e=>{this.readingProgress=e}))}markFinished(e){this.markReadingCompleted(),e&&this.setCurrentArticle(e)}setCurrentReadingType(e){this.currentReadingType=e}setCurrentArticle(e,t){this.currentArticle=e||null,this.imageList=t}constructor(){(0,a._)(this,"readingStatus",null),(0,a._)(this,"parseProgress",0),(0,a._)(this,"readingProgress",0),(0,a._)(this,"currentArticle",null),(0,a._)(this,"imageList",void 0),(0,a._)(this,"currentReadingType",null),(0,k.rC)(this)}}(0,o.gn)([s.SB],eP.prototype,"readingStatus",void 0),(0,o.gn)([s.SB],eP.prototype,"parseProgress",void 0),(0,o.gn)([s.SB],eP.prototype,"readingProgress",void 0),(0,o.gn)([s.SB],eP.prototype,"currentArticle",void 0),(0,o.gn)([s.SB],eP.prototype,"imageList",void 0),(0,o.gn)([s.SB],eP.prototype,"currentReadingType",void 0),(0,o.gn)([k.Fl],eP.prototype,"progressPercentage",null),(0,o.gn)([k.Fl],eP.prototype,"isReadingUnfinished",null);let{isQuestion:eF,isErrorReply:eO,isReply:eN,isReadEnhanceReply:eV,isVideoSummaryReply:eQ}=u.MonicaChatTypeCheckers,ez=!1;class eH extends ew.Q{get renderItems(){return this.chatTree.renderItems}get lastRenderItem(){return this.renderItems[this.renderItems.length-1]}get isQAInRenderItems(){if(this.renderItems.length<2)return!1;let e=this.renderItems[this.renderItems.length-1];if(!u.MonicaChatTypeCheckers.isReply(e))return!1;for(let t=this.renderItems.length-2;t>=0;t--){let i=this.renderItems[t];if(u.MonicaChatTypeCheckers.isQuestion(i))return!0;if(!u.MonicaChatTypeCheckers.isReply(i)||i.data.questionId!==e.data.questionId)break}return!1}get isReadingInRenderItems(){return this.renderItems.some(e=>u.MonicaChatTypeCheckers.isReadEnhanceReply(e))}get isVideoSummaryInRenderItems(){return this.renderItems.some(e=>u.MonicaChatTypeCheckers.isVideoSummaryReply(e))}get isAIFormInRenderItems(){return this.renderItems.some(e=>u.MonicaChatTypeCheckers.isAIFormReply(e))}get chatModel(){let e=this.modelAndSource;if(this.finalBotData.isMonicaBot&&!e.chatWithMemoEnabled&&e.baseModelEnabled)return e.baseModelKey}get conversationOptions(){var e,t,i,a,o,s;let n=this.modelAndSource.chatWithMemoEnabled,r=(0,k.ZN)(this.clientConfig.sysSkills),l=this.chatBotSkillCard.cardType;l&&(n=!1);let d=this.isPreviewMode?this.getBotCreateData():void 0,c=!n&&this.modelAndSource.knowledgeSourceEnabled&&(this.finalBotData.isMonicaBot||this.getSupportWebAccess(null===(t=this.finalBotData.botItem)||void 0===t?void 0:null===(e=t.toolData)||void 0===e?void 0:e.useModel));return c&&(d?null===(s=d.toolData)||void 0===s||null===(o=s.sysSkillList)||void 0===o||o.push({uid:"web_access",enable:!0}):r.push({uid:"web_access",enable:!0})),(f.o.isChatPDF||l)&&(r=[]),{respondLanguage:eo.A.finalChatRespondLanguage,useModel:this.finalBotData.isMonicaBot&&this.finalBotData.useGpt4Module?"gpt-4":null===(a=this.finalBotData.botItem)||void 0===a?void 0:null===(i=a.toolData)||void 0===i?void 0:i.useModel,isVip:ep.userController.isVipUser,createBotData:d,chatWithMemoEnabled:n,sysSkills:r,aiRespLanguage:eo.A.finalGlobalRespondLanguage,chatModel:this.chatModel,knowledgeSource:c?this.modelAndSource.knowledgeSourceKey:void 0,isIncognito:eo.A.isIncognitoMode,maxToken:em.T.chatTokenLimit,manualArtifactEnabled:"artifacts"===l,renderItemsToSync:this.renderItems.flatMap(e=>e.synced||u.MonicaChatTypeCheckers.isQuestion(e)&&"prepare_chat_with_file"===e.data.type?[]:[e]),useNewMemory:!0,useMemorySuggestion:!0}}get textContent(){return this.content.trim()}get actionListVisible(){return this.intentMessage&&this.isFinished&&this.botData.uiOptions.allowIntent}get showHomeView(){if(this.renderItems.length>1||this.isLoading)return!1;if(this.isPreviewMode){var e;return((null===(e=this.botData.botItem)||void 0===e?void 0:e.exampleList)||[]).length>0}return!f.o.isChatPDF&&!this.loadFromConvHistory}get finalBotData(){let e=this.chatBotMention.mentionData;if((null==e?void 0:e.type)==="bot"&&!this.chatBotSkillCard.cardType){let t=this.botData.parent.getBotItemById(e.botData.uid);if(t)return t.controller.botData}return this.botData}get firstReplyItem(){return this.renderItems.find((e,t)=>(!this.botData.isMonicaBot||0!==t)&&"reply"===e.itemType)}get isPrepareChatWithFile(){var e;let t=this.lastRenderItem;return!!t&&!!u.MonicaChatTypeCheckers.isQuestion(t)&&null!==(e=t.data.fileManagers)&&void 0!==e&&!!e.length}setMicrophonePermission(e){this.microphonePermission=e}get forSharePreview(){return this.isShareMode||this.isShareImageMode||this.isSelectMode}get gpt4Enabled(){return eo.A.gpt4Enabled}get imageUploadPreviewUrl(){return this.imageUploadHistory?URL.createObjectURL(this.imageUploadHistory):""}get conversationInfoWithoutChatItems(){return this.conversationInfo?{...this.conversationInfo,conversationId:this.conversationInfo.id,items:[]}:null}get conversationId(){return this.conversationInfo?this.conversationInfo.id:""}get suggestions(){let e=this.lastRenderItem;return!this.intentMessage&&e&&"reply"===e.itemType&&!eV(e)&&e.data.suggestions?e.data.suggestions:[]}get errorMsg(){let e=this.lastRenderItem;return e&&eO(e)?e.data.content:""}get isChatEmpty(){let e=this.renderItems.filter(eN);return!(e.length>1&&"error"!==e[e.length-1].data.type)}get inputDisabled(){return!!(this.botData.botItem&&this.botData.parent.checkBotPermission(this.botData.botItem))||!!this.isOptimizingPrompt}get hasSummaryMessage(){return this.renderItems.some(e=>eV(e)||eQ(e))}async init(){this.initialized||(this.initialized=!0,M.Q.init(),this.artifactManager.initServiceListeners(),d.y.on("conversationChange",e=>{"update"===e.type&&this.conversationInfo&&this.conversationId===e.conversation.conversationId&&(this.conversationInfo={...this.conversationInfo,...e.conversation})}),d.y.on("convListChange",e=>{let{lastSenderTabId:t,botId:i,convId:a}=e;this.botData.botId===i&&this.conversationId===a&&this.lastSenderTabId!==t&&c.Tn.getConversationFromCache(a).then(e=>{e&&(this.targetConversationId=this.conversationId,this.handleGetConversation(e,!1),this.scrollManager.scrollToBottom())})}),d.y.on("cancelConvListChange",e=>{let{lastSenderTabId:t,botId:i,convId:a}=e;this.botData.botId!==i||this.conversationId!==a||this.lastSenderTabId===t||this.isFinished||this.stopTask()}),x.X.on("realtimeEnd",async e=>{let{realtimeItems:t}=e;if(this.conversationInfo){let e=await c.Tn.realtimeContinueInChat({conversationInfo:this.conversationInfo,items:t});await this.addChatItems(e)}}),await this.initConversation("init"),this.promptManager.initServiceEventListeners())}beforeSendQuestion(){this.lastSenderTabId=void 0,this.conversationId&&!this.isChatEmpty&&d.y.emitCancelLastChat({convId:this.conversationId,botId:this.botData.botId}).then(e=>{this.lastSenderTabId=e})}async beforeChat(e){return!!await en.n.checkoutHighTrafficDialogEnable(e)}getMessageToolVisible(e){return!!(!this.showMessageTools||this.showMessageTools.includes(e))}destroy(){y.f.getProxy(this).disposeAll(),this.emitter.removeAllListeners()}setAtBot(e){this.chatBotMention.setBot(e)}async continueInChat(e,t,i,a){await d.y.setLastActiveConversation(null),await er.w.show("chat"),this.continueInChatHandler({data:e,actionOrQuestion:t,mindMapData:i,conversationId:a})}resetOnLogout(){this.newConversation(!0)}updateUsageInfo(){B.gM.updateUsageInfos([this.botData.usageModule,"credits"])}focusPrimaryInput(){this.emitter.emit("focusPrimaryInput")}async initConversation(e){if(this.conversationInfo)return;"newChat"===e&&d.y.setLastActiveConversation({botUid:p.Z9.monica});let t=this.botData.getBotInfo();this.conversationInfo=await c.Tn.createConversation({botInfo:t,tabInfo:this.getTabInfo()}),this.chatTree.reset(),this.chatTree.loadItems(this.conversationInfo.items),this.scrollManager.reset(),"init"===e&&y.f.getProxy(this).add((0,k.U5)(()=>ec.N.selectedText,e=>{this.onSelectedTextChange(e||"")})).add((0,k.U5)(()=>ed.w.clipboardText,e=>{this.onClipboardTextChange(e)})),this.artifactManager.close()}setCustomReplySourceClickHandler(e){this.customReplySourceClickHandler=e}handleReplySourceClick(e,t){if(this.customReplySourceClickHandler){this.customReplySourceClickHandler(e);return}this.botData.parent.views.openReplySourceDialog({insertTarget:t||"mainWindow",content:e.text})}async handleReplySourceClickForReading(e){return!!f.o.isExtension&&h.T3.showReadingSources(e)}handleDrawerImageClick(e,t){let i=this.renderItems.flatMap(e=>{if(eN(e)){var t;return(null===(t=e.data.agentStatus)||void 0===t?void 0:t.flatMap(e=>{if("draw_img_result"===e.type){var t,i;return[{src:(null===(t=e.metadata)||void 0===t?void 0:t.imageUrl)||"",id:(null===(i=e.metadata)||void 0===i?void 0:i.imageId)||""}]}return[]}))||[]}return[]}).find(t=>e.includes(t.id)),a=null==t?void 0:t.find(e=>"code_interpreter"===e.type);if(!i&&a){this.handleDownloadSandboxFile(e);return}this.botData.parent.views.openCommonImagePreviewDialog({src:(null==i?void 0:i.src)||"",insertTarget:"mainWindow"})}async handleDownloadSandboxFile(e){let t;if(!e)return;let i=v.S.Global.components.ChatComponents.ChatMessage.ChatReply;try{let a=e.replace(/^sandbox:\/*(mnt\/data\/)?/,"");t=eh.M.loading(i.downloading);let o=await d.y.getCodeInterpreterFile({convId:this.conversationId,fileName:a});await w.m.downloadFile(o.data.url,a),t.close(),eh.M.success(i.downloaded)}catch(e){null==t||t.close(),eh.M.error(w.m.formatErrorMsg(e))}}afterSetMemoAction(){this.intentMessage&&this.clearIntent()}setIsShareMode(){this.isShareMode=!0}setIsShareImgMode(){this.isShareImageMode=!0}initShareChatTree(e,t){this.chatTree.initShareChatTree(e,t||this.conversationId),this.renderItems.forEach(e=>{if(u.MonicaChatTypeCheckers.isReply(e)){let t=n.C.parseArtifactContent(e.data.content);t&&(t.forEach(e=>{e.streaming=!1}),e.data.artifacts=t)}})}clearIntent(){this.intentMessage=null}setContent(e){this.content=e,this.prevTriggerPromptId=0}getBotCreateData(){throw Error("not implemented")}enablePreviewMode(){this.isPreviewMode=!0,this.shouldCreateTitle=!1}async addChatItems(e){this.chatTree.addItems(e),this.syncMessageToServer()}async syncMessageToServer(){try{await c.Tn.updateChatItems(this.conversationId,this.chatTree.renderItems);let e=this.getTabInfo();return await c.Tn.syncMessagesToServer({conversationId:this.conversationId,origin:e.url,originPageTitle:e.title,botUid:this.botData.botId})}catch(e){console.error("[chatBoxController.ts] syncMessagesToServer error",e)}return[]}async retryQuestion(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastRenderItem;if(e){if(!u.MonicaChatTypeCheckers.isReply(e))throw Error("lastRenderItem is not a reply, cannot retry");if("read_enhance"===e.data.type){this.retryReading();return}if("humanize"===e.data.type){this.createHumanizeQuestion(e,!0);return}this.doRetry(e,"retry")}}async editQuestion(){let e=this.getLastQuestion();e&&this.questionEditingOperation.open(e)}async doRetry(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.parentItemId;if(u.MonicaChatTypeCheckers.isReply(e)&&e.data.questionId&&(o=e.data.questionId),!o){console.error("[ChatBoxController.answerAgain]: parent noe not found",{chatRenderItem:e});return}let s=this.chatTree.findNodeById(o);(null==s?void 0:s.data.itemType)==="reply"&&(s=this.chatTree.findNodeById(s.data.parentItemId));let n=s;if(!n){console.error("[ChatBoxController.answerAgain]: parent node not found",{chatRenderItem:e});return}let r=n.data;a&&delete r.data.chatModel,this.createTask(async e=>{var o,s=this;let l=this.getTabInfo(),d=!1,h={itemId:"msg:".concat(w.m.genId()),conversationId:r.conversationId,itemType:"reply",summary:"",parentItemId:r.itemId,data:{type:"text",content:"",questionId:r.itemId,atBotInfo:r.data.atBotInfo}};this.chatTree.addItems([h]);let g={...this.conversationOptions,manualWebSearchEnabled:i,useModel:a?"gpt-4":this.conversationOptions.useModel,chatModel:a?"":this.conversationOptions.chatModel,renderItemsToSync:null===(o=this.conversationOptions.renderItemsToSync)||void 0===o?void 0:o.flatMap(e=>e.itemId===h.itemId?[]:[e])};g.manualWebSearchEnabled&&!g.knowledgeSource&&this.botData.isMonicaBot&&!this.modelAndSource.chatWithMemoEnabled&&(g.knowledgeSource=this.modelAndSource.knowledgeSourceKey);let{taskId:p}=await c.Tn.retryQuestion({conversationId:this.conversationId,questionId:n.data.itemId,tabInfo:l,botInfo:this.botData.getBotInfo(),type:t,conversationOptions:g},this.createChatDataUpdateHandler(function(){for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];d||(s.chatTree.removeNodes([h.itemId]),d=!0),e(...i)}),e=>{this.handleChunkTask(e)});this.taskId=p})}async doWebSearchOrGpt4(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t){let{isEnough:e,handleCreditsNotEnough:t}=D.K.checkCredits({module:"web_search",source:"web_access_click_upgrade"});if(!e){t();return}}if(i){let{isEnough:e,handleCreditsNotEnough:t}=D.K.checkCredits({module:"genius_bot",source:"gpt4_limit_dialog_click_upgrade_v2"});if(!e){t();return}}(()=>{this.doRetry(e,"answer_again",t,i)})()}async doDoubleCheck(e){let t=D.K.checkCredits({module:"web_search",source:"web_access_click_upgrade"});if(!t.isEnough){t.handleCreditsNotEnough();return}let i=D.K.checkCredits({module:"genius_bot",source:"gpt4_limit_dialog_click_upgrade_v2"});if(!i.isEnough){i.handleCreditsNotEnough();return}(()=>{let t=this.chatTree.getReplyQuestion(e.itemId);if(!t)throw Error("question not found");this.sendQuestionOrAction({actionOrQuestion:t.data.content,questionImgUrl:t.data.imgUrl,fromBotTask:t.data.fromBotTask,questionType:t.data.type,useGpt4:!0,useWebSearch:!0,fileManagers:t.data.fileManagers,chatTemplate:t.data.chatTemplate})})()}async prepareChatWithFile(e){var t;let{content:i,parentItemId:a,fileManagers:o,chatTemplate:s,reportExtData:n,scene:r,skillCard:l,onSend:d}=e,c="basic_query";(this.finalBotData.useGpt4Module||(null==l?void 0:l.skillType)&&this.modelAndSource.advancedModelSkill.includes(null==l?void 0:l.skillType))&&(c="genius_bot");let{handleCreditsNotEnough:h,isEnough:g}=D.K.checkCredits({source:"chat_with_file",module:c});if(!g){h();return}let p=1===o.length&&o[0].isImage,A=o.every(e=>"webpage"===e.fileInfo.fileType);if(!p&&!("read_web"===r||"gen_document"===r||A)){let{isEnough:e,handleCreditsNotEnough:t}=D.K.checkCredits({source:"chat_with_file",module:"reading_pdf"});if(!e){t();return}}this.isFinished=!1,this.setContent(""),null==d||d(),this.chatBotAttachment.updateFileMangers([]),this.chatBotAttachment.uploadFileMangers(o);let m=this.createQuestion(i,null!=a?a:null===(t=this.lastRenderItem)||void 0===t?void 0:t.itemId,"prepare_chat_with_file",{fileManagers:o,chatTemplate:s,skillCardInfo:l});this.chatTree.addItems([m]),w.m.delay(100).then(()=>{this.scrollManager.afterAddQuestion()});let u=!1,f=()=>{!u&&o.every(e=>"finished"===e.state)&&(u=!0,this.chatWithFile({content:i,fileInfos:o.map(e=>e.fileInfo),chatTemplate:s,skillCard:e.skillCard},m,n))};f(),o.forEach(e=>{e.options.onFinished=()=>{f()}})}async chatWithFile(e,t,i){var a;let{content:o,fileInfos:s,chatTemplate:n,skillCard:r}=e,l=t?t.parentItemId:null===(a=this.lastRenderItem)||void 0===a?void 0:a.itemId;if("continue"!==(await em.T.checkTokenByFileInfos(s,{source:em.T.userEvent.source.tokenFileLimit,upgradeEventName:"chat_with_file_upgrade"})).status)return;let d=r&&this.chatBotSkillCard.supportChatWithFile(r.skillType),{question:h,reply:g,taskId:p}=await c.Tn.askQuestion({type:d?"skill_card":"file_with_text",content:o,fileInfos:s,conversationInfo:this.conversationInfo,tabInfo:this.getTabInfo(),parentItemId:l,botInfo:this.botData.getBotInfo(),chatTemplate:n,conversationOptions:this.conversationOptions,skillCard:r},this.createChatDataUpdateHandler(this.onMessageUpdate),i);t&&this.chatTree.removeNodes([t.itemId]),this.chatTree.addItems([h,g]),this.taskId=p,this.isLoading=!0,this.isFinished=!1}prepareQuestion(e){this.cacheQuestion=e;let t=this.createReply("",e.itemId,{});this.chatTree.addItems([e,t]),this.isLoading=!0,this.isFinished=!1,this.scrollManager.afterAddQuestion()}async sendQuestion(e,t,i,a){var o,s;let{parentItemId:n,questionType:r="text",actionId:l,quoteContent:h,fromBotTask:p,atBotInfo:A,fileInfos:m,useWebSearch:u,useGpt4:f,skillCard:y,pdfInfos:v}=t;if(this.beforeSendQuestion(),this.isPrepareChat){let i=this.createQuestion(e,n||(null===(s=this.lastRenderItem)||void 0===s?void 0:s.itemId),r,t);this.prepareQuestion(i);return}if(this.prevTriggerPromptId&&(g.M.trackRunPromptEvent({customPromptId:this.prevTriggerPromptId}),this.prevTriggerPromptId=0),this.readingEnhance.isReadingUnfinished){this.openReadingUnfinishedToast();return}if(this.intentMessage)return;let w=this.conversationOptions.chatModel;A&&!this.botData.parent.isMonica(A.uid)&&(w=void 0);let C="boolean"==typeof f?"gpt-4":this.conversationOptions.useModel;globalThis.console.warn(this.renderItems.flatMap(e=>e.synced?[]:[e]));let{taskId:b,question:S,reply:I}=await c.Tn.askQuestion({type:r,content:e,actionId:l,atBotInfo:A,fileInfos:m,conversationInfo:this.conversationInfo,tabInfo:this.getTabInfo(),parentItemId:null!=n?n:null===(o=this.lastRenderItem)||void 0===o?void 0:o.itemId,botInfo:this.botData.getBotInfo(),chatPdfWithGenMindMap:t.chatPdfWithGenMindMap,conversationOptions:{...this.conversationOptions,useModel:C,chatModel:w,manualWebSearchEnabled:"boolean"==typeof u?u:this.conversationOptions.manualWebSearchEnabled},quoteContent:h,fromBotTask:p,skillCard:y,pdfInfos:v},this.createChatDataUpdateHandler(this.onMessageUpdate),a,e=>{this.handleChunkTask(e)});i&&this.chatTree.removeNodes([i.itemId]),this.chatTree.addItems([S,I]),this.isLoading=!0,this.isFinished=!1,this.scrollManager.afterAddQuestion(),this.taskId=b,this.onMessageUpdate(null,this.isFinished),this.conversationInfoWithoutChatItems&&d.y.updateConversationByLocal({...this.conversationInfoWithoutChatItems,updatedAt:Date.now()}),d.y.setLastActiveConversation({botUid:this.botData.getBotInfo().id,convId:this.conversationId,lastMsgUpdateTime:new Date().toUTCString()})}async shareConversation(){var e;let t=this.getTabInfo(),i=await c.Tn.shareConversation({conversationId:this.conversationId,lastItemId:(null===(e=this.getLastReply())||void 0===e?void 0:e.itemId)||"",origin:t.url,originPageTitle:t.title});return 0!==i.code?Promise.reject(Error(i.msg)):Promise.resolve(i)}async readingSummary(e){var t;let{type:i="summary",content:a,showSidePanel:o,behaviorEvent:s,waitToMemoSaved:n}=e;if(this.beforeSendQuestion(),!this.isFinished)return;if(s&&g.M.createUserBehaviorEvent(s),o&&await er.w.show(),this.readingEnhance.isReadingUnfinished){console.warn("reading already started");return}if(this.intentMessage&&this.clearIntent(),"chat_with_article"===i){this.chatBotSkillCard.showCard("read_web");return}this.readingEnhance.markReadingStart();let r=await L.j.getPageSimpleData({}),l=this.createQuestion(a||v.S.Global.modules.ChatBox.ReadingEnhance.readThisPage,null===(t=this.lastRenderItem)||void 0===t?void 0:t.itemId,"file_with_text",{webPageInfo:{title:(null==r?void 0:r.title)||"",url:(null==r?void 0:r.url)||"",type:i}}),d=this.createReply("",l.itemId,{type:"read_enhance"});this.chatTree.addItems([l,d]),this.isLoading=!0,this.isFinished=!1,this.scrollManager.afterAddQuestion();let c=await L.j.getContentForReading({});this.readingEnhance.setCurrentArticle({title:(null==c?void 0:c.title)||"",url:(null==c?void 0:c.url)||"",content:(null==c?void 0:c.content)||"",fullContent:(null==c?void 0:c.fullContent)||"",thumbnail:(null==c?void 0:c.thumbnail)||"",type:"web"},(null==c?void 0:c.images)||[]);let h=w.m.createFile(JSON.stringify(c),"".concat(w.m.genId(),".json"),"application/json"),p=new eC.pW({onFinished:async()=>{if("finished"!==p.state){this.readingEnhance.markReadingFailed(),d.data.content=p.errorMessage,d.data.type="error",this.chatTree.updateItem(d),this.readingEnhance.markReadingFailed(),this.loading=!1,this.isFinished=!0,this.syncMessageToServer();return}this.genReading({type:i,fileInfo:p.fileInfo,reply:d,waitToMemoSaved:n}),l.data.fileInfos=[p.fileInfo],this.chatTree.updateItem(l),this.readingEnhance.setCurrentReadingType(i)},check:!1});p.init(h),p.updateFileInfo({fileType:"webpage"}),p.handleFile()}async chatContinueWithDynamicAction(e){var t,i,a;let{toolData:o,payload:s}=e,{replyData:n,sitePayload:r}=s,l=this.createQuestion("",null===(t=this.lastRenderItem)||void 0===t?void 0:t.itemId,"file_with_text",{type:"dynamic_action",dynamicActionPayload:{toolData:o,url:null==r?void 0:r.meta.url,title:null==r?void 0:r.meta.title}}),d=l.itemId,c=null===(a=n.extraData)||void 0===a?void 0:null===(i=a.otherReply)||void 0===i?void 0:i.map(e=>{let t={conversationId:this.conversationId,data:e,itemId:w.m.genId(),itemType:"reply",summary:e.content,parentItemId:d};return d=t.itemId,t});this.addChatItems([l,...c||[]]),await this.syncMessageToServer()}async chatWithArticle(){this.focusPrimaryInput();let e=await L.j.getPageSimpleData({}),[t]=this.chatBotAttachment.createEmptyManagers([{fileName:(null==e?void 0:e.title)||"",fileType:"webpage",fileUrl:(null==e?void 0:e.url)||"",fileMetaInfo:{sourceUrl:(null==e?void 0:e.url)||"",title:(null==e?void 0:e.title)||""}}],e=>{e.options={check:!1}});this.chatBotAttachment.updateFileMangers([t]),this.chatBotMention.deleteMentionAction();let i=await L.j.getContentForReading({}),a=w.m.createFile(JSON.stringify(i),"".concat(w.m.genId(),".json"),"application/json");t.init(a),this.chatBotAttachment.uploadFileMangers([t])}async genReading(e){let{type:t,fileInfo:i,reply:a,waitToMemoSaved:o}=e;if("reading"!==this.readingEnhance.readingStatus)return;let s=[],{taskId:r}=await c.Tn.genSummary({useModel:this.botData.useGpt4Module?p.f2:p.Q7,fileInfos:[i],language:eo.A.finalReadingSummaryRespondLanguage,aiRespLanguage:eo.A.finalGlobalRespondLanguage,taskType:t,type:"webPage",version:2},(e,t,i)=>{if(i){a.data.content=i,a.data.type="error",this.readingEnhance.markReadingFailed(),this.isLoading=!1,this.isFinished=!0,this.chatTree.updateItem(a),this.syncMessageToServer();return}if(!e)return;let{fullText:r}=e;if(e.sources&&(s=e.sources),void 0!==e.suggestionLoading&&(a.data.suggestionLoading=e.suggestionLoading),e.suggestions&&(a.data.suggestions=e.suggestions.map(e=>({text:e}))),r&&(this.readingEnhance.markStreamingStarted(),a.data.content=r,a.data.sources=s,this.chatTree.updateItem(a),this.isLoading=!1),t){var l;this.isFinished=!0;let e=(null===(l=s[0])||void 0===l?void 0:l.sourceType)||"article",{sources:t}=n.C.transformReplyContent(e,r,s);a.data.sources=t,eo.A.memoReadingSummaryAutoSave?(this.saveReadingToMemo(r).then(()=>{o&&this.readingEnhance.markFinished()}).catch(()=>{o&&this.readingEnhance.markReadingFailed()}),o||this.readingEnhance.markFinished()):this.readingEnhance.markFinished(),this.syncMessageToServer()}});this.taskId=r}async retryReading(){var e,t,i,a;let o=null===(e=this.lastRenderItem)||void 0===e?void 0:e.parentItemId,s=this.chatTree.findNodeById(o).data,n=null===(t=s.data.fileInfos)||void 0===t?void 0:t[0];if(!n){console.error("no file info");return}let r={itemId:w.m.genId(),conversationId:s.conversationId,itemType:"reply",summary:"",parentItemId:s.itemId,data:{type:"read_enhance",content:"",questionId:s.itemId}};this.chatTree.addItems([r]),this.isFinished=!1,this.isLoading=!0,this.readingEnhance.markReadingStart(),this.genReading({type:(null===(a=s.data)||void 0===a?void 0:null===(i=a.webPageInfo)||void 0===i?void 0:i.type)||"summary",fileInfo:n,reply:r})}getSkillConfigData(){let e=this.clientConfig.getSkillConfig({shouldEnable:e=>this.clientConfig.shouldEnableSkill(e),toggleSkill:(e,t)=>{this.clientConfig.toggleSkill(e,t,!0)}});if(this.botData.isMonicaBot)return e}openReadingUnfinishedToast(){eh.M.error(v.S.Global.controllers.chatBoxController.openReadingToast)}openTaskFailedToast(){eh.M.error(v.S.Global.controllers.chatBoxController.taskCreationFailed)}openReadFailedToast(e){eh.M.error("".concat(v.S.Global.controllers.chatBoxController.readFailed,"(").concat(e,")"))}async stopTask(){var e,t;let i=this.getLastReply(),a=this.getLastQuestion();if(null==a||null===(e=a.data.fileManagers)||void 0===e||e.forEach(e=>{e.cancelTask()}),await c.Tn.cancelTask(this.taskId),this.checkShouldCreateConvTitle(),this.artifactManager.artifactDataManager.artifactData&&(this.artifactManager.artifactDataManager.markAsSteamFinished(),this.lastRenderItem&&u.MonicaChatTypeCheckers.isReply(this.lastRenderItem)&&this.lastRenderItem.data.artifacts&&(this.lastRenderItem.data.artifacts.forEach(e=>{e.streaming=!1}),this.chatTree.updateItem(this.lastRenderItem))),this.isPrepareChatWithFile&&this.lastRenderItem&&u.MonicaChatTypeCheckers.isQuestion(this.lastRenderItem)){this.lastRenderItem.data.fileInfos=(null===(t=this.lastRenderItem.data.fileManagers)||void 0===t?void 0:t.map(e=>e.fileInfo))||[],delete this.lastRenderItem.data.fileManagers,this.chatTree.updateItem(this.lastRenderItem);let e=this.createReply("User canceled",this.lastRenderItem.itemId,{type:"error"});this.chatTree.addItems([e]),this.syncMessageToServer()}else this.readingEnhance.isReadingUnfinished&&(c.Tn.cancelTask(this.taskId,"reading"),this.readingEnhance.markReadingFailed(),i&&!i.data.content&&(i.data.type="error",i.data.content="User canceled",this.chatTree.updateItem(i),this.syncMessageToServer()));this.compositeTaskIds.length&&(await Promise.all(this.compositeTaskIds.map(e=>c.Tn.cancelTask(e))),this.compositeTaskIds=[]),this.isLoading=!1,this.isFinished=!0}getLastReply(){return this.findLastReply()}getLastQuestion(){for(let e=this.renderItems.length-1;e>=0;e--){let t=this.renderItems[e];if(eF(t))return t}return null}async newConversation(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isFinished||this.stopTask(),this.modelAndSource.forceChatWithMemoEnabled=!1,this.loadFromConvHistory=!1,this.setQuote(null),this.conversationInfo=null,this.clearIntent(),this.chatBotMention.mentionData=null,this.isFinished=!0,this.isLoading=!1,this.loadMoreParams=null,this.taskId="",this.isPreviewMode||(this.shouldCreateTitle=!0),this.readingEnhance.markReadingReset(),e&&ec.N.clearSelection(),await this.initConversation("newChat"),this.focusPrimaryInput(),this.closeShareMenu(),this.closeMemoSelectMenu(),er.w.saveChatPageParams()}async handleGetConversation(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.targetConversationId===e.id&&(e.items.forEach(e=>{if(u.MonicaChatTypeCheckers.isReply(e)){delete e.data.relatedQuestionLoading;let t=n.C.parseArtifactContent(e.data.content);t&&(t.forEach(e=>{e.streaming=!1}),e.data.artifacts=t)}}),t&&d.y.setLastActiveConversation({botUid:this.botData.botId,convId:e.id,lastMsgUpdateTime:new Date().toUTCString()}),this.chatTree.loadItems(e.items),this.conversationInfo=e,e.title&&e.title!==C.Q0||(this.shouldCreateTitle=!0),t&&this.scrollManager.scrollToBottom())}async loadConversation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cacheWithUpdate";this.loadMoreParams=null,this.stopTask(),this.setQuote(null),this.clearIntent(),this.taskId="",this.isLoading=!1,this.isFinished=!0,this.shouldCreateTitle=!1,this.loadFromConvHistory=!0,this.chatTree.reset(),this.scrollManager.reset(),this.targetConversationId=e;let i=await c.Tn.getConversationFromCache(e);try{if(i){if(await this.handleGetConversation(i),"cacheWithUpdate"===t){this.loadMoreParams=null;try{await this.fetchConversation(e)}catch(e){}}else{var a;this.loadMoreParams={hasMore:!0,nextReq:null===(a=i.items[0])||void 0===a?void 0:a.seq}}}else this.loading=!0,await this.fetchConversation(e)}catch(e){console.error("error loadConversation",e),await this.newConversation()}this.emitter.emit("loadConversation",{conversationId:e}),this.artifactManager.loadArtifactsInConversation({conversationId:e}),this.artifactManager.close(),this.loading=!1,er.w.saveChatPageParams()}async handleConversationLoadMore(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.loadMoreParams||this.loadMoreLoading)return!1;let{hasMore:t,nextReq:i}=this.loadMoreParams;if(!t)return!1;try{return this.loadMoreLoading=!0,await this.fetchConversation(this.conversationId,i,!e),this.loadMoreLoading=!1,!0}catch(e){return this.loadMoreLoading=!1,!1}}async fetchConversation(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(this.targetConversationId!==e)return;let a=await c.Tn.fetchConversation({conversationId:e,limit:30,seq:t}),o=this.renderItems.length;await this.handleGetConversation(a.conversation,i);let s=this.renderItems.length;this.loadMoreParams={hasMore:a.hasMore,nextReq:a.nextSeq},s-o<30&&a.hasMore&&(this.loadMoreLoading=!1,await this.handleConversationLoadMore())}async createTask(e){if(!this.isFinished)return;let t={module:"basic_query",source:"chat_query_quota_exceeded"};em.T.isCustomCtx&&this.botData.isMonicaBot?(t.module="credits",t.source="custom_ctx"):this.botData.useGpt4Module?(t.module="genius_bot",t.source="advanced_query_dialog"):(t.module="basic_query",t.source="chat_query_quota_exceeded",f.o.isChatPDF&&(t.source="chatpdf_chat_query_quota_exceeded"));let i=D.K.checkCredits(t);if(!i.isEnough){i.handleCreditsNotEnough();return}if(await this.beforeChat())return;let a=async(e,t,a)=>{if(a&&a===b.Eg.quotaExceeded){i.handleCreditsNotEnough();return}if(a&&a===b.Eg.webSearchExceeded){D.K.handleCreditsNotEnough({module:"web_search",source:"chat_web_search_quota_exceeded"});return}if(a&&a===b.Eg.creditsQuotaExceed){i.handleCreditsNotEnough();return}t&&!a&&(this.checkShouldCreateConvTitle(),ep.userController.openPromotion("afterChat"))};try{await e(a)}catch(e){}this.isLoading=!0,this.isFinished=!1}handleHistoryClick(){this.botData.parent.views.openConvHistoryDrawer({currentConvId:this.conversationId,botId:this.botData.botId,insertTarget:{botId:this.botData.botId,type:"botContainer"},hideActionButtons:f.o.isChatPDF,onClickItem:async(e,t)=>{e.conversationId&&e.chatBotUid&&(await this.botData.parent.loadConversionForBot(e.chatBotUid,e.conversationId),null==t||t(),this.artifactManager.close())},onNewChat:()=>{this.newConversation()}})}async sendQuestionOrAction(e){}async sendCompareQuestion(e){var t,i;let a;let{botList:o,question:s,convId:n,behaviorData:r}=e;if(this.beforeSendQuestion(),!this.isFinished)return;let{isEnough:l,handleCreditsNotEnough:d}=D.K.checkCredits({source:(null==r?void 0:r.source)||"chat",module:"genius_bot",reportExtData:null==r?void 0:r.eventData});if(!l){d();return}if("sidebar"===eA.L.mainWindowMode){h.T3.openMonicaChatTabPage({tabKey:"chat",chatData:{type:"compare",convId:n,question:s,botList:o,isIncognitoMode:eo.A.isIncognitoMode}}),h.T3.on("refreshConversation",e=>{let{convId:t}=e;n===t&&this.loadConversation(n,"cacheFirst")}),this.newConversation(),er.w.hide();return}this.intentMessage&&this.clearIntent(),n||await this.newConversation(),a="string"==typeof s?this.createQuestion(s,null===(t=this.lastRenderItem)||void 0===t?void 0:t.itemId,"text"):this.createQuestion(s.data.content,null===(i=this.lastRenderItem)||void 0===i?void 0:i.itemId,s.data.type,s.data);let g=this.createReply("",a.itemId,{type:"compare"});this.chatTree.addItems([a,g]),this.isLoading=!0,this.isFinished=!1,this.scrollManager.afterAddQuestion();let p=[];g.data.comparePayload=p;let A=[],m=o.map((e,t)=>{var i,o,s;let n;let r=this.createReply("",void 0,{atBotInfo:{logoUrl:e.logoUrl||"",name:e.name,uid:e.uid}});p.push(r);let l=new Promise(e=>{n=e}),d=c.Tn.genCompare({type:a.data.type,content:a.data.content,actionId:a.data.actionId,atBotInfo:{...e,useMode:null===(i=e.toolData)||void 0===i?void 0:i.useModel,logoUrl:e.logoUrl||C.py},fileInfos:a.data.fileInfo?[a.data.fileInfo]:a.data.fileInfos,conversationInfo:this.conversationInfo,tabInfo:this.getTabInfo(),parentItemId:null===(o=this.lastRenderItem)||void 0===o?void 0:o.itemId,botInfo:this.botData.getBotInfo(),conversationOptions:{...this.conversationOptions,useModel:null===(s=e.toolData)||void 0===s?void 0:s.useModel,manualWebSearchEnabled:this.conversationOptions.manualWebSearchEnabled},isCompare:!0,chatTemplate:a.data.chatTemplate,skillCard:a.data.skillCardInfo},(e,i,a)=>{0===t&&(null==e?void 0:e.data)&&(g.data={...g.data,...null==e?void 0:e.data,comparePayload:p,type:"compare",atBotInfo:g.data.atBotInfo}),Object.assign(r,e),a&&(n(g.itemId),Object.assign(r,{content:a,type:"error"})),i&&n(g.itemId),e&&(this.compositeLoading[e.itemId]=!1,this.chatTree.updateItem(g))}).then(e=>{let{taskId:t,reply:i}=e;return this.compositeLoading[i.itemId]=!0,t});return A.push(d),l}),u=await Promise.all(A);this.compositeTaskIds=u,await Promise.all(m),this.isFinished=!0,this.isLoading=!1,await this.syncMessageToServer(),h.T3.refreshConversation(this.conversationId)}setTextareaNode(e){this.textareaNode=e}setTextareaCursorIndex(e){this.textareaCursorIndex=e}async handleImageChatUpload(e,t){if(!eg.Gi.checkIsImage(e)){eh.M.error(v.S.Global.controllers.uploadHelper.fileTypeNotSupported);return}this.focusPrimaryInput(),this.clearIntent(),this.chatBotAttachment.handleFiles([e]),t&&g.M.createUserBehaviorEvent({eventName:"upload_image_success",source:t,extData:{module:"chat"}})}async sendSaveMemoMsg(e){if(!e)return;let t=await c.Tn.runSaveMemoAction({actionId:C.Ln.saveToMemo,conversationInfo:this.conversationInfo,question:e});this.chatTree.addItems(t),this.isLoading=!0,this.sendSaveMemoMsgLoading=!0,this.content="",this.chatBotMention.deleteMentionAction();try{let t=await A.R.createFromText(e),i=await c.Tn.afterSaveMemoAction({conversationInfo:this.conversationInfo,memoInfo:t.item});this.addChatItems(i),setTimeout(()=>{this.checkShouldCreateConvTitle()},2e3)}catch(e){eh.M.error(w.m.formatErrorMsg(e))}finally{this.isLoading=!1,this.sendSaveMemoMsgLoading=!1}}setTextareaCaretPosition(e){this.textareaCaretPosition=e}getActionLabel(e){return e===C.Ln.askMemo?v.S.Global.modules.ChatBox.askMemo:e===C.Ln.saveToMemo?v.S.Global.modules.ChatBox.saveToMemo:""}setQuote(e){this.chatQuote=null,e&&(this.chatBotAttachment.clearFiles(),e.imgUrl?this.chatBotAttachment.quoteImage(e.imgUrl):e.fileInfos?this.chatBotAttachment.quoteFiles(e.fileInfos):e.content&&(this.chatQuote={content:e.content,type:"text"}),this.chatBotSkillCard.cardType&&this.chatBotSkillCard.hideCard())}chatItemToString(e){let{itemType:t,data:i}=e;if("question"===t){let{content:e,type:t,imgUrl:a}=i;return"image_with_text"===t&&a?"".concat(e,"\n![](").concat(a,")"):e}if("video_summary"===i.type){let{content:e,videoSummaryInfo:t}=i;if(!t)return e;let{videoUrl:a,highlights:o}=t,s=o.map(e=>{let{start:t,title:i,abstract:o}=e,s=o.map(e=>"- ".concat(e)).join("\n");return"[".concat(w.m.convertUnixToHms(t),"](").concat("".concat(a,"&t=").concat(t),") ").concat(i,"\n").concat(s)}).join("\n");return"".concat(e,"\n\n").concat(s)}return i.content}openShareMenu(){this.isSelectMode=!0,this.selectAllMessageIdsForShare()}closeShareMenu(){this.isSelectMode=!1,this.clearSelectedMessageIdsForShare()}openMemoSelectMenu(e){this.isSelectMode=!0,this.showMemoSelect=!0;let t=this.chatTree.getReplyQuestion(e);t&&(this.selectedMessageIds=[t.itemId])}closeMemoSelectMenu(){this.isSelectMode=!1,this.showMemoSelect=!1,this.clearSelectedMessageIdsForMemo()}sortMessageIds(e){return e.sort((e,t)=>{var i,a,o,s;return(null!==(o=null===(i=this.renderItems.find(t=>t.itemId===e))||void 0===i?void 0:i.seq)&&void 0!==o?o:0)-(null!==(s=null===(a=this.renderItems.find(e=>e.itemId===t))||void 0===a?void 0:a.seq)&&void 0!==s?s:0)})}toggleMsgSelected(e){let t=this.selectedMessageIds.indexOf(e);-1===t?this.selectedMessageIds.push(e):this.selectedMessageIds.splice(t,1),this.sortMessageIds(this.selectedMessageIds)}clearSelectedMessageIdsForShare(){this.selectedMessageIds=[]}selectAllMessageIdsForShare(){this.selectedMessageIds=this.getAllQuestionIds()}clearSelectedMessageIdsForMemo(){this.selectedMessageIds=[]}selectAllMessageIdsForMemo(){this.selectedMessageIds=this.getAllQuestionIds()}getAllQuestionIds(){return this.renderItems.filter(e=>u.MonicaChatTypeCheckers.isQuestion(e)).map(e=>e.itemId)}continueInChatForChat(e){var t;if(!e.length)return;let i=new Map;i.set(e[0].parentItemId,null===(t=this.lastRenderItem)||void 0===t?void 0:t.itemId);let a=()=>"msg:".concat(w.m.genId()),o=e=>{if(!e)return a();if(i.has(e))return i.get(e);let t=a();return i.set(e,t),t},s=e.flatMap(e=>{let{itemType:t}=e,i=o(e.itemId),a=o(e.parentItemId);return"question"===t?this.createQuestion(e.data.content,a,e.data.type,e.data,i):"reply"===t?this.createReply(e.data.content,a,e.data,i):[]});s&&this.addChatItems(s)}getTabInfo(){return{title:document.title,url:location.href}}async openArtifact(e){let{content:t="",artifactId:i="",artifactName:a="",artifactType:o="",uid:s="",conversationId:r="",chatItemId:l="",objectUrl:d}=e,c=r,h=l;if(!r){var g;await this.newConversation();let e=t;!t&&d&&(e=await ei.H.fetchContent(d));let r={content:e,id:i,name:a,type:o},l=this.createReply(n.C.transformArtifactContent(r),null===(g=this.lastRenderItem)||void 0===g?void 0:g.itemId,{artifacts:[{data:r,streaming:!1}]});c=this.conversationId,h=l.itemId,await m.D.updateArtifactSnapshot({uid:s,conversationId:c,chatItemId:h}),this.chatTree.addItems([l]),await this.syncMessageToServer()}await this.loadConversation(c,"cacheWithUpdate");let p=this.chatTree.findNodeById(h),A=null==p?void 0:p.data;if(A&&u.MonicaChatTypeCheckers.isReply(A)){let t=(A.data.artifacts||[]).find(t=>t.data.id===e.artifactId);this.artifactManager.show({artifactData:t,convId:this.conversationId,replyId:A.itemId,enableQuickFix:!0})}}async remixArtifact(e){var t;let i=this.createReply(n.C.transformArtifactContent(e),null===(t=this.lastRenderItem)||void 0===t?void 0:t.itemId,{artifacts:[{data:e,streaming:!1}]});this.chatTree.addItems([i]),await this.syncMessageToServer(),this.artifactManager.createSyncArtifactTask([{artifactData:e,conversationId:i.conversationId,itemId:i.itemId,version:1}]),this.artifactManager.show({artifactData:{data:e,streaming:!1},replyId:i.itemId,convId:i.conversationId,enableQuickFix:!0}),this.sendQuestionOrAction({actionOrQuestion:v.S.Global.modules.ChatBox.artifactQuestion})}async createHumanizeQuestion(e,t){var i,a;let o,s,n;if(!R.L.checkBypass())return;t?(o=null===(i=this.lastRenderItem)||void 0===i?void 0:i.parentItemId,s=(n=this.chatTree.findNodeById(o).data).data.quoteContent||""):(o=null===(a=this.lastRenderItem)||void 0===a?void 0:a.itemId,s=e.data.content,n=this.createQuestion(v.S.Global.components.ChatComponents.ChatMessage.ChatReply.humanize,o,"humanize",{quoteContent:s}));let r=this.createReply("",n.itemId,{type:"humanize"});t?this.chatTree.addItems([r]):this.chatTree.addItems([n,r]),this.isLoading=!0,this.isFinished=!1,await R.L.bypass(s,async(e,t,i)=>{if(e&&(this.isLoading=!1,r.data.content=e,this.chatTree.addOrUpdateItem(r)),t||i){if(this.isFinished=!0,this.isLoading=!1,i){r.data.type="error",r.data.content=i,this.chatTree.addOrUpdateItem(r),this.syncMessageToServer();return}this.chatTree.addOrUpdateItem(r),await this.syncMessageToServer();return}})}async handleAIContentDetectResult(e){if(!R.L.checkBypass()){this.updateAiContentDetectResult(e,{isEnough:!1,checkStatus:"error"});return}this.updateAiContentDetectResult(e,{checkStatus:"checking",isEnough:!0,progress:0});let{stop:t}=w.m.fakeProgress(5,t=>{this.updateAiContentDetectResult(e,{checkStatus:"checking",progress:t})});try{let t=await R.L.check(e.data.content);t.data&&this.updateAiContentDetectResult(e,{modelStateList:R.L.getModelStateList(t.data),checkStatus:R.L.getCheckStatus(t.data)})}catch(i){let t=w.m.formatErrorMsg(i);t===b.Eg.quotaExceeded?this.updateAiContentDetectResult(e,{isEnough:!1,checkStatus:"error"}):this.updateAiContentDetectResult(e,{isEnough:!1,checkStatus:"error",errorMsg:t})}this.updateAiContentDetectResult(e,{progress:100}),t()}updateChatHomeViewInnerWidth(){var e;this.chatHomeViewInnerWidth=(null===(e=this.chatHomeViewInnerEl)||void 0===e?void 0:e.clientWidth)||0}updateAiContentDetectResult(e,t){e.data.aiContentDetectResult={...e.data.aiContentDetectResult,...t},this.chatTree.addOrUpdateItem(e)}createChatDataUpdateHandler(e){let t=this.conversationId,i=null,a=[],o=!1,s=[],l=!0,c=[];return(h,p,A,m)=>{var y,v,w,C;if(o&&(o=!1),m&&(this.isLoading=!0,o=!0),this.isFinished!==p&&(this.isFinished=p,p)){this.emitter.emit("agentStatusFinish",s),s.some(e=>"update_memory"===e.type)&&(U.W.createUserBehaviorEvent({eventName:"agentstatus_show",source:"memory"}),U.W.createUserBehaviorEvent({eventName:"memory_updated",source:"chat"})),s.some(e=>"update_memory_suggestion"===e.type)&&(U.W.createUserBehaviorEvent({eventName:"agentstatus_show",source:"memory_suggestion"}),U.W.createUserBehaviorEvent({eventName:"memory_suggestion_updated",source:"chat"}),this.clientConfig.updateMemorySuggestions("refresh")),this.usageInfoLoading=!0;let e=this.getLastQuestion();u.MonicaChatTypeCheckers.isChatPdfQuestion(e)&&(null===(w=e.data.pdfInfos)||void 0===w?void 0:w[0])&&es.docChatController.saveDocChatToMemo({name:e.data.pdfInfos[0].fileName,pdfId:e.data.pdfInfos[0].pdfId},(null==h?void 0:h.data.content)||""),setTimeout(()=>{let e=Array.from(new Set(a));e.length>0?B.gM.updateUsageInfos(e).finally(()=>{this.usageInfoLoading=!1}):this.usageInfoLoading=!1},1e3),h&&h.itemId===(null===(C=this.lastRenderItem)||void 0===C?void 0:C.itemId)&&this.speakReplyItem({text:h.data.content,itemId:h.itemId})}h&&(i=h);let b=!1;null==h||null===(y=h.data.agentStatus)||void 0===y||y.forEach(e=>{var t;b=!0,s.find(t=>t.type===e.type)||s.push(e);let i=null===(t=e.metadata)||void 0===t?void 0:t.usageModule;i&&a.push(i)});let S=!b||(null==i?void 0:i.data.content);if(this.isLoading&&S&&!o&&(this.isLoading=!1),t!==this.conversationId||!h||"reply"!==h.itemType)return;let I=n.C.parseArtifactContent(h.data.content)||[],_=I[I.length-1];if(l&&_){let e=!!_.data.content&&!r.y.shouldRenderRawContent(_.data.type);"ext-side-panel"!==f.o.entryType&&eo.A.artifactAutoOpenDialog&&e&&(this.artifactManager.show({artifactData:_,convId:this.conversationId,replyId:h.itemId,enableQuickFix:!0}),l=!1)}let T=this.artifactManager.artifactDataManager.artifactData,k=null==T?void 0:T.artifactId,E=!(null==T?void 0:T.content)||!k||k===(null==_?void 0:null===(v=_.data)||void 0===v?void 0:v.id),M=!p&&((null==_?void 0:_.streaming)||!1);if(_&&E&&this.artifactManager.artifactDataManager.setArtifactData(this.artifactManager.chatArtifactData2ServerArtifactData({artifact:_.data,conversationId:this.conversationId,replyId:h.itemId})),!M&&k&&k===(null==_?void 0:_.data.id)&&T.chatItemId===h.itemId&&this.artifactManager.artifactDataManager.markAsSteamFinished(),h.data.artifacts=I,I&&I.forEach(e=>{let t=e.data.id;if(!c.includes(t)&&!e.streaming){let i=this.artifactManager.mergedArtifactsVersionMap[t]||[];this.artifactManager.createSyncArtifactTask([{artifactData:e.data,conversationId:this.conversationId,itemId:h.itemId,version:i.length}]),c.push(t)}}),p&&I){I.forEach(e=>{e.streaming=!1,g.M.createUserBehaviorEvent({eventName:N.R.UserEvent.CREATED,extData:{type:e.data.type,id:e.data.id}})});let e=I[I.length-1],t=e&&!!e.data.content&&!r.y.shouldRenderRawContent(e.data.type);"ext-sidebar"!==f.o.entryType&&e&&eo.A.artifactAutoOpenDialog&&t&&this.artifactManager.show({artifactData:e,convId:this.conversationId,replyId:h.itemId,enableQuickFix:!0})}ea.p.handleAddOrUpdateReplyMessage(h),d.y.emitConvListChange({botId:this.botData.botId,convId:this.conversationId}).then(e=>{this.lastSenderTabId=e}),this.chatTree.addOrUpdateItem(h),e(h,p,A)}}findLastReply(){return null}async saveReadingToMemo(e,t){let i=this.readingEnhance.currentArticle;if(!i)return;let a=w.m.genId();try{let e=this.readingEnhance.imageList;if(null==e?void 0:e.length){let t=await eg.Gi.batchUploadRemoteFileToS3({module:"memo_note",links:e,objId:a});t.length===e.length&&t.forEach((t,a)=>{var o;e[a]===i.thumbnail&&(i.thumbnail=t),i.fullContent=null===(o=i.fullContent)||void 0===o?void 0:o.replaceAll(e[a],t)}),this.readingEnhance.setCurrentArticle(i)}}catch(e){console.error(e)}let o={type:"readingSummary",originalUrl:i.url,originalTitle:i.title,originalExtId:i.url,originalContentMd5:S.D.md5(i.content),bannerImgUrl:i.thumbnail,summary:e.replace(/\[\d+\]/g,""),articleSummary:i.fullContent,fromReadingPdf:t||i.fromReadingPdf||!1},s=await el.a.createFromEmbed({uid:a,embedData:o});this.lastCreatedMemoId=s.item.uid}createQuestion(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"msg:".concat(w.m.genId());return{conversationId:this.conversationId,itemId:o,itemType:"question",summary:e,parentItemId:t,data:{type:i,content:e,...a}}}createReply(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"msg:".concat(w.m.genId());return{itemId:a,conversationId:this.conversationId,itemType:"reply",summary:e,data:{type:"text",content:e,questionId:null,...i},parentItemId:t}}handleChunkTask(e){let t=e.id,i=e.query;i&&new l.v(async(e,t)=>await g.M.proxyFetch(e,t),async e=>await g.M.abortProxyFetch(e),(e,t)=>{console.log("".concat(e," search web error"),t)}).doSearch(i).then(e=>{g.M.pushResult({taskId:t,taskType:"client_search",result:{items:e.sites.map((e,t)=>({title:e.title,url:e.url,index:t,content:e.snippet}))}})})}async chatWithFiles(e){let{data:t,reportExtData:i}=e,{question:a,tabs:o,template:s,instructions:n,attachment:r}=t,l=await Promise.all((o||[]).map(async e=>{var t;let i="";if(e.id)try{let t=await L.j.getContentForReading({tabId:e.id});i=(null==t?void 0:t.fullContent)||""}catch(e){}return w.m.createFile(i,(null===(t=e.title)||void 0===t?void 0:t.replaceAll(".","-"))||"","text/plain;charset=utf-8")})),d=[...await this.chatBotAttachment.createFileManagers(l,(e,t)=>{e.options={...e.options,check:!1},e.updateFileInfo({fileMetaInfo:{browserTabIcon:null==o?void 0:o[t].favIconUrl,browserTabTitle:null==o?void 0:o[t].title,title:null==o?void 0:o[t].title,sourceUrl:null==o?void 0:o[t].url},fileType:"browser_tab"})}),...await this.chatBotAttachment.createFileManagers(r||[],e=>{e.options={...e.options,check:!0}})];this.sendQuestionOrAction({fileManagers:d,chatTemplate:s?{uid:s.uid,name:s.name,content:s.markdownContent,instruction:n||""}:void 0,actionOrQuestion:a||"",reportExtData:i,scene:e.scene})}openMindMapDialog(e){let t=this.botData.parent.views.openMindMapDialog(e);setTimeout(()=>{var e;null===(e=this.mindMapDialogDisposer)||void 0===e||e.call(this),this.mindMapDialogDisposer=null==t?void 0:t.dispose},0)}async openRealtime(){if(f.o.isDesktop)_.y.getService().createOrShowWindow("realtime","default",!0);else{let e=await P.ll.get("realtimeUsed"),t=f.o.isExtension?{offsetX:(window.innerWidth-416)/2-37,offsetY:(window.innerHeight-522)/2-127}:{};e?this.botData.parent.views.openRealtimeDialog({},t):(P.ll.set("realtimeUsed",!0),et({insertTarget:"mainWindow",handleStart:()=>{et.dispose(),this.botData.parent.views.openRealtimeDialog({},t)}}))}}getSupportWebAccess(e){if(!e)return!1;let t=F.S.getModelItem(e);return null==t?void 0:t.capabilities.includes("tools")}checkShouldCreateConvTitle(){this.shouldCreateTitle&&(this.shouldCreateTitle=!1,c.Tn.createConversationTitle(this.conversationId,e=>{this.conversationId===e.id&&(this.conversationInfo={...this.conversationInfo,...e}),er.w.saveChatPageParams(),d.y.updateConversationByLocal({...this.conversationInfoWithoutChatItems,updatedAt:Date.now()})}))}checkShouldCreateResourceTag(e){var t,i,a,o,s,n,r;if(!e)return;(null===(i=this.conversationInfo)||void 0===i?void 0:null===(t=i.infoData)||void 0===t?void 0:t.hasArtifact)||(null===(o=this.conversationInfo)||void 0===o?void 0:null===(a=o.infoData)||void 0===a?void 0:a.hasDoc)||null===(r=e.data.artifacts)||void 0===r||!r.length||d.y.updateConversationByLocal({conversationId:this.conversationId,infoData:{hasArtifact:!0}});let l=e.data.agentStatus;l&&!(null===(n=this.conversationInfo)||void 0===n?void 0:null===(s=n.infoData)||void 0===s?void 0:s.hasImg)&&l.find(e=>"draw_img"===e.type||"draw_img_result"===e.type)&&d.y.updateConversationInfo({conversationId:this.conversationId,hasImg:!0})}constructor(e){super(),(0,a._)(this,"botData",void 0),(0,a._)(this,"textareaNode",void 0),(0,a._)(this,"textareaCursorIndex",void 0),(0,a._)(this,"textareaCaretPosition",void 0),(0,a._)(this,"chatTree",void 0),(0,a._)(this,"readingEnhance",void 0),(0,a._)(this,"clientConfig",void 0),(0,a._)(this,"chatBotMention",void 0),(0,a._)(this,"chatBotAttachment",void 0),(0,a._)(this,"chatBotSkillCard",void 0),(0,a._)(this,"modelAndSource",void 0),(0,a._)(this,"sendQuestionReadySource",void 0),(0,a._)(this,"artifactManager",void 0),(0,a._)(this,"promptManager",void 0),(0,a._)(this,"scrollManager",void 0),(0,a._)(this,"dialogInsertTarget",void 0),(0,a._)(this,"baseModelKey",void 0),(0,a._)(this,"chatHomeViewInnerEl",void 0),(0,a._)(this,"conversationInfo",void 0),(0,a._)(this,"inputPlaceholder",void 0),(0,a._)(this,"expandEnable",void 0),(0,a._)(this,"showMessageTools",void 0),(0,a._)(this,"chatHomeViewInnerWidth",void 0),(0,a._)(this,"isOptimizingPrompt",void 0),(0,a._)(this,"content",void 0),(0,a._)(this,"isPreviewMode",void 0),(0,a._)(this,"intentMessage",void 0),(0,a._)(this,"isFinished",void 0),(0,a._)(this,"isLoading",void 0),(0,a._)(this,"sendSaveMemoMsgLoading",void 0),(0,a._)(this,"loading",void 0),(0,a._)(this,"loadMoreLoading",void 0),(0,a._)(this,"speakingMsgId",void 0),(0,a._)(this,"renderFromArtifactBuilder",void 0),(0,a._)(this,"compositeLoading",void 0),(0,a._)(this,"replySourceData",void 0),(0,a._)(this,"questionEditingData",void 0),(0,a._)(this,"readingRendered",void 0),(0,a._)(this,"loadFromConvHistory",void 0),(0,a._)(this,"imageUploadHistory",void 0),(0,a._)(this,"imageUploadVisible",void 0),(0,a._)(this,"imageUploadLoading",void 0),(0,a._)(this,"imageUploadProgress",void 0),(0,a._)(this,"chatQuote",void 0),(0,a._)(this,"isSelectMode",void 0),(0,a._)(this,"showMemoSelect",void 0),(0,a._)(this,"selectedMessageIds",void 0),(0,a._)(this,"isShareMode",void 0),(0,a._)(this,"isShareImageMode",void 0),(0,a._)(this,"inChatCompareMode",void 0),(0,a._)(this,"isPrepareChat",void 0),(0,a._)(this,"cacheQuestion",void 0),(0,a._)(this,"usageInfoLoading",void 0),(0,a._)(this,"realtimeOpen",void 0),(0,a._)(this,"microphonePermission",void 0),(0,a._)(this,"shouldCreateTitle",void 0),(0,a._)(this,"targetConversationId",void 0),(0,a._)(this,"prevTriggerPromptId",void 0),(0,a._)(this,"lastCreatedMemoId",void 0),(0,a._)(this,"questionEditingOperation",void 0),(0,a._)(this,"onClipboardTextChange",void 0),(0,a._)(this,"onSelectedTextChange",void 0),(0,a._)(this,"emitter",void 0),(0,a._)(this,"customReplySourceClickHandler",void 0),(0,a._)(this,"taskId",void 0),(0,a._)(this,"compositeTaskIds",void 0),(0,a._)(this,"initialized",void 0),(0,a._)(this,"lastSenderTabId",void 0),(0,a._)(this,"loadMoreParams",void 0),(0,a._)(this,"mindMapDialogDisposer",void 0),(0,a._)(this,"continueInChatHandler",void 0),(0,a._)(this,"onMessageUpdate",void 0),(0,a._)(this,"speakReplyItem",void 0),this.botData=e,this.textareaNode=null,this.textareaCursorIndex=0,this.textareaCaretPosition=null,this.chatTree=new eu.B,this.readingEnhance=new eP,this.clientConfig=new eR(this),this.chatBotMention=new e_(this),this.chatBotAttachment=new eC.o3(this),this.chatBotSkillCard=new ek(this),this.modelAndSource=new eD(this),this.sendQuestionReadySource=w.m.createReadySource(),this.artifactManager=new ev(this),this.promptManager=new eU(this),this.scrollManager=new eE(this),this.dialogInsertTarget=null,this.baseModelKey="",this.chatHomeViewInnerEl=null,this.conversationInfo=null,this.inputPlaceholder="",this.expandEnable=!0,this.showMessageTools=void 0,this.chatHomeViewInnerWidth=0,this.isOptimizingPrompt=!1,this.content="",this.isPreviewMode=!1,this.intentMessage=null,this.isFinished=!0,this.isLoading=!1,this.sendSaveMemoMsgLoading=!1,this.loading=!1,this.loadMoreLoading=!1,this.speakingMsgId=null,this.renderFromArtifactBuilder=!1,this.compositeLoading={},this.replySourceData={visible:!1,content:""},this.questionEditingData={visible:!1,question:null},this.readingRendered=!1,this.loadFromConvHistory=!1,this.imageUploadHistory=null,this.imageUploadVisible=!1,this.imageUploadLoading=!1,this.imageUploadProgress=0,this.chatQuote=null,this.isSelectMode=!1,this.showMemoSelect=!1,this.selectedMessageIds=[],this.isShareMode=!1,this.isShareImageMode=!1,this.inChatCompareMode=!1,this.isPrepareChat=!1,this.cacheQuestion=null,this.usageInfoLoading=!1,this.realtimeOpen=!1,this.microphonePermission="prompt",this.shouldCreateTitle=!0,this.targetConversationId="",this.prevTriggerPromptId=0,this.lastCreatedMemoId="",this.questionEditingOperation={open:e=>{this.questionEditingData={visible:!0,question:JSON.parse(JSON.stringify(e))}},close:()=>{this.questionEditingData={visible:!1,question:null}}},this.onClipboardTextChange=(0,T.Z)(async e=>{if(this.botData.uiOptions.allowIntent&&!this.chatBotAttachment.fileManagers.length){if(e){var t;this.intentMessage=await c.Tn.createIntentCandidate({conversationInfo:this.conversationInfo,type:"clipboard",content:e,parentItemId:null===(t=this.lastRenderItem)||void 0===t?void 0:t.itemId})}else this.clearIntent()}},200,{trailing:!0}),this.onSelectedTextChange=(0,T.Z)(async e=>{if(this.botData.uiOptions.allowIntent){if(e){var t;this.intentMessage=await c.Tn.createIntentCandidate({conversationInfo:this.conversationInfo,type:"selection",content:e,parentItemId:null===(t=this.lastRenderItem)||void 0===t?void 0:t.itemId}),this.chatBotMention.mentionData&&this.chatBotMention.deleteMentionAction()}else this.clearIntent()}},200,{trailing:!0}),this.customReplySourceClickHandler=null,this.taskId="",this.compositeTaskIds=[],this.initialized=!1,this.loadMoreParams=null,this.onMessageUpdate=async(e,t,i)=>{t&&(this.checkShouldCreateConvTitle(),this.checkShouldCreateResourceTag(e))},this.speakReplyItem=e=>{},(0,k.rC)(this),this.emitter=new I.v,e.botId!==p.Z9.monica||ez||(ez=!0,this.continueInChatHandler=(0,O.c)({name:"chat.continueInChat",channels:["desktop","web","extensionSidePanel","extensionContent"],handler:async e=>{var t,i;let{data:a,actionOrQuestion:o,mindMapData:s}=e;if("searchEnhance"===a.type){let e=await c.Tn.continueSearchEnhanceInChat({conversationInfo:this.conversationInfo,question:a.question,response:n.C.searchEnhanceTransformers.toChatContent(a),agentStatus:s?[E.Qp.createMindMapAgentStatus(s)]:[]});await this.addChatItems(e)}else if("quickAction"===a.type){let e=await c.Tn.continueQuickActionInChat({conversationInfo:this.conversationInfo,result:a.result,promptContent:a.content,selectedText:a.selectedText});await this.addChatItems(e)}else if("videoSummary"===a.type){let e=await c.Tn.continueVideoSummaryInChat({conversationInfo:this.conversationInfo,summaryInfo:{videoTitle:a.originalTitle,videoUrl:a.originalUrl,summary:a.summary,highlights:(null!==(t=a.highlightsV2)&&void 0!==t?t:[]).map(e=>({...e,abstract:e.abstract.map(e=>{let{text:t}=e;return t})}))},agentStatus:s?[E.Qp.createMindMapAgentStatus(s)]:[]});await this.addChatItems(e)}else if("readingSummary"===a.type||"pdfReading"===a.type){let e=await c.Tn.continueReadingInChat({conversationInfo:this.conversationInfo,suggestions:(a.suggestions||[]).map(e=>({text:e})),summary:a.summary,title:a.originalTitle,url:a.originalUrl,docReadingInfo:a.fromReadingPdf?{title:a.originalTitle,url:a.originalUrl,desc:a.originalUrl}:void 0});if("pdfReading"===a.type){let t=e[0],i=v.S.Global.services.monicaService.docChatReplyContent,o=n.C.getMarkdownLinkStr(a.originalTitle,es.docChatController.genWebPdfUrl(a.originalExtId)),s=(0,v.x)(i.content,{link:o});t.summary=s,t.data.content=s}await this.addChatItems(e)}else if("imageSummary"===a.type){let e=await c.Tn.commonContinueInChat({conversationInfo:this.conversationInfo,content:a.summary});await this.addChatItems(e)}else if("mark"===a.type){let e=[a.content,...(a.extraEmbedMarkItems||[]).map(e=>e.content)],t=await c.Tn.commonContinueInChat({conversationInfo:this.conversationInfo,content:e.join("\n\n")});await this.addChatItems(t)}else if("dynamic_action"===a.type)await this.chatContinueWithDynamicAction(a);else if("translate"===a.type){let e=this.createQuestion(a.sourceContent,null===(i=this.lastRenderItem)||void 0===i?void 0:i.itemId,"skill_card",{skillCardInfo:{skillType:"translate",question:a.sourceContent,translateConf:{fromLang:a.sourceLang,toLang:a.toLang,enableGlossary:eo.A.translationGlossaryEnabled}}}),t=e.itemId,o=this.createReply(a.translatedContent,t);await this.addChatItems([e,o])}else if("twitter"===a.type){let e=a.userName||a.tagName,t="";e&&(t="".concat(e," tweeted:"));let i=a.articleText?'"'.concat(a.articleText,'"'):"",o=await c.Tn.commonContinueInChat({conversationInfo:this.conversationInfo,content:[t,i].filter(e=>e).join("\n\n")});await this.addChatItems(o)}else if("chat"===a.type)this.loadConversation(a.originConversationId);else if("commonTranslate"===a.type||"quickActionTranslate"===a.type){let e=await c.Tn.commonContinueInChat({conversationInfo:this.conversationInfo,content:[a.input,a.detail].join("\n\n")});await this.addChatItems(e)}else console.warn("unknown embed data type",a);o?setTimeout(()=>{this.sendQuestionOrAction({actionOrQuestion:o})},20):this.scrollManager.afterAddQuestion()}}))}}(0,o.gn)([s.SB],eH.prototype,"conversationInfo",void 0),(0,o.gn)([s.SB],eH.prototype,"inputPlaceholder",void 0),(0,o.gn)([s.SB],eH.prototype,"expandEnable",void 0),(0,o.gn)([s.SB],eH.prototype,"showMessageTools",void 0),(0,o.gn)([s.SB],eH.prototype,"chatHomeViewInnerWidth",void 0),(0,o.gn)([s.SB],eH.prototype,"isOptimizingPrompt",void 0),(0,o.gn)([k.Fl],eH.prototype,"renderItems",null),(0,o.gn)([k.Fl],eH.prototype,"lastRenderItem",null),(0,o.gn)([k.Fl],eH.prototype,"isQAInRenderItems",null),(0,o.gn)([k.Fl],eH.prototype,"isReadingInRenderItems",null),(0,o.gn)([k.Fl],eH.prototype,"isVideoSummaryInRenderItems",null),(0,o.gn)([k.Fl],eH.prototype,"isAIFormInRenderItems",null),(0,o.gn)([k.Fl],eH.prototype,"chatModel",null),(0,o.gn)([k.Fl],eH.prototype,"conversationOptions",null),(0,o.gn)([k.Fl],eH.prototype,"textContent",null),(0,o.gn)([k.Fl],eH.prototype,"actionListVisible",null),(0,o.gn)([k.Fl],eH.prototype,"showHomeView",null),(0,o.gn)([k.Fl],eH.prototype,"finalBotData",null),(0,o.gn)([k.Fl],eH.prototype,"firstReplyItem",null),(0,o.gn)([k.Fl],eH.prototype,"isPrepareChatWithFile",null),(0,o.gn)([s.SB],eH.prototype,"content",void 0),(0,o.gn)([s.SB],eH.prototype,"isPreviewMode",void 0),(0,o.gn)([s.SB],eH.prototype,"intentMessage",void 0),(0,o.gn)([s.SB],eH.prototype,"isFinished",void 0),(0,o.gn)([s.SB],eH.prototype,"isLoading",void 0),(0,o.gn)([s.SB],eH.prototype,"sendSaveMemoMsgLoading",void 0),(0,o.gn)([s.SB],eH.prototype,"loading",void 0),(0,o.gn)([s.SB],eH.prototype,"loadMoreLoading",void 0),(0,o.gn)([s.SB],eH.prototype,"speakingMsgId",void 0),(0,o.gn)([s.SB],eH.prototype,"renderFromArtifactBuilder",void 0),(0,o.gn)([s.SB],eH.prototype,"compositeLoading",void 0),(0,o.gn)([s.SB],eH.prototype,"replySourceData",void 0),(0,o.gn)([s.SB],eH.prototype,"questionEditingData",void 0),(0,o.gn)([s.SB],eH.prototype,"readingRendered",void 0),(0,o.gn)([s.SB],eH.prototype,"loadFromConvHistory",void 0),(0,o.gn)([s.SB],eH.prototype,"imageUploadHistory",void 0),(0,o.gn)([s.SB],eH.prototype,"imageUploadVisible",void 0),(0,o.gn)([s.SB],eH.prototype,"imageUploadLoading",void 0),(0,o.gn)([s.SB],eH.prototype,"imageUploadProgress",void 0),(0,o.gn)([s.SB],eH.prototype,"chatQuote",void 0),(0,o.gn)([s.SB],eH.prototype,"isSelectMode",void 0),(0,o.gn)([s.SB],eH.prototype,"showMemoSelect",void 0),(0,o.gn)([s.SB],eH.prototype,"selectedMessageIds",void 0),(0,o.gn)([s.SB],eH.prototype,"isShareMode",void 0),(0,o.gn)([s.SB],eH.prototype,"isShareImageMode",void 0),(0,o.gn)([s.SB],eH.prototype,"inChatCompareMode",void 0),(0,o.gn)([s.SB],eH.prototype,"isPrepareChat",void 0),(0,o.gn)([s.SB],eH.prototype,"cacheQuestion",void 0),(0,o.gn)([s.SB],eH.prototype,"usageInfoLoading",void 0),(0,o.gn)([s.SB],eH.prototype,"realtimeOpen",void 0),(0,o.gn)([s.SB],eH.prototype,"microphonePermission",void 0),(0,o.gn)([k.Fl],eH.prototype,"forSharePreview",null),(0,o.gn)([k.Fl],eH.prototype,"gpt4Enabled",null),(0,o.gn)([k.Fl],eH.prototype,"imageUploadPreviewUrl",null),(0,o.gn)([k.Fl],eH.prototype,"conversationInfoWithoutChatItems",null),(0,o.gn)([k.Fl],eH.prototype,"suggestions",null),(0,o.gn)([k.Fl],eH.prototype,"errorMsg",null),(0,o.gn)([k.Fl],eH.prototype,"isChatEmpty",null),(0,o.gn)([k.Fl],eH.prototype,"inputDisabled",null),(0,o.gn)([k.Fl],eH.prototype,"hasSummaryMessage",null)},8287:function(e,t,i){"use strict";i.d(t,{E:function(){return h}});var a=i(66084),o=i(52921),s=i(56607),n=i(73047),r=i(32930),l=i(91433),d=i(90180),c=i(45476);class h{get botItem(){return this.parent.botItems.find(e=>e.uid===this.botId)||null}get botConfig(){return this.botItem?this.botItem.botConfig:null}get defaultUsageModule(){var e;return(null===(e=this.botConfig)||void 0===e?void 0:e.modelOptions.usageModule)||"basic_query"}get isSystemBot(){return Object.values(l.Z9).includes(this.botId)}get isAgentBot(){return Object.values(l.tW).includes(this.botId)}get isMonicaBot(){return this.botId===l.Z9.monica}get isGeniusBot(){return this.botId===l.Z9.genius}get isGpt4(){var e,t;let i=null===(t=this.botItem)||void 0===t?void 0:null===(e=t.toolData)||void 0===e?void 0:e.useModel;return"gpt-4"===i||"gpt-4v"===i||"gpt-4o"===i}get uiOptions(){var e;let t=(0,n.ZN)((null===(e=this.botConfig)||void 0===e?void 0:e.uiOptions)||{});return s.o.isExtension||(t.allowReading=!1),s.o.isChatPDF&&(t.allowMention=!1),s.o.isDesktop||(t.allowVoiceResponse=!1),t}get useGpt4Module(){var e;return!!this.isGeniusBot||"genius_bot"===this.defaultUsageModule||!!this.isGpt4||null!==(e=this.botConfig)&&void 0!==e&&!!e.modelOptions.allowGpt4&&d.A.gpt4Enabled}get usageModule(){var e;if((null===(e=this.botItem)||void 0===e?void 0:e.controller)instanceof c._){let e=this.botItem.controller;if(this.isMonicaBot&&e.modelAndSource.baseModelEnabled){let t=e.modelAndSource.baseModelKey,i=e.modelAndSource.modelList.find(e=>e.key===t);if(i&&"credits"===i.usageModule)return i.usageModule;if(r.S.checkIsStandardModel(t))return"basic_query"}}return this.useGpt4Module?"genius_bot":this.defaultUsageModule}getBotInfo(){var e;return{id:this.botId,usageModule:this.usageModule,sendTaskType:null===(e=this.botConfig)||void 0===e?void 0:e.modelOptions.sendTaskType}}updateViewId(){var e;(null===(e=this.botItem)||void 0===e?void 0:e.viewId)?this.botItem.viewId++:this.botItem.viewId=1}constructor(e,t){(0,a._)(this,"botId",void 0),(0,a._)(this,"parent",void 0),this.botId=e,this.parent=t,(0,n.rC)(this)}}(0,o.gn)([n.Fl],h.prototype,"botItem",null),(0,o.gn)([n.Fl],h.prototype,"botConfig",null),(0,o.gn)([n.Fl],h.prototype,"isSystemBot",null),(0,o.gn)([n.Fl],h.prototype,"isAgentBot",null),(0,o.gn)([n.Fl],h.prototype,"isMonicaBot",null),(0,o.gn)([n.Fl],h.prototype,"isGeniusBot",null),(0,o.gn)([n.Fl],h.prototype,"isGpt4",null),(0,o.gn)([n.Fl],h.prototype,"uiOptions",null),(0,o.gn)([n.Fl],h.prototype,"useGpt4Module",null),(0,o.gn)([n.Fl],h.prototype,"usageModule",null)},98966:function(e,t,i){"use strict";i.d(t,{t:function(){return y}});var a=i(66084),o=i(52921),s=i(34491),n=i(62753),r=i(46260),l=i(73361),d=i(44469),c=i(92235),h=i(88882),g=i(60445),p=i(56607),A=i(73047),m=i(90180),u=i(18245),f=i(79854);class y extends f.Q{get usageModel(){return this.botData.usageModule}get showHomeView(){return 0===this.chatItems.length&&!this.isLoading}get canGenerateVideo(){return 0!==this.chatItems.filter(e=>"answer"===e.type).length}onScroll(e){let{scrollTop:t,clientHeight:i,scrollHeight:a}=e.currentTarget;t+i>=a-2?this.scrollBtnVisible=!1:this.scrollBtnVisible=!0}scrollToBottom(){setTimeout(()=>{if(this.scrollableContainer){let{scrollHeight:e,clientHeight:t}=this.scrollableContainer;this.scrollableContainer.scrollTop=e-t}})}setTextareaRef(e){this.textareaRef=e}async init(e){this.botController=e}destroy(){}setScrollableContainer(e){this.scrollableContainer=e}stopTask(){this.addChatItems([{itemId:c.m.genId(),type:"error",data:{role:"user",content:h.S.Global.modules.ChatBox.requestCanceled}}]),this.requestProgress=0,this.isLoading=!1,this.cancelRequest()}async askQuestion(e,t){if(!e)return;let{handleCreditsNotEnough:i,isEnough:a}=u.K.checkCredits({source:"make_it_more",module:this.usageModel});if(!a){i();return}this.isFinished=!1,this.taskUid=c.m.genId(),this.sessionId=c.m.genId(),t||this.addChatItems([{type:"question",itemId:this.taskUid,data:{role:"user",content:e}}]),this.scrollToBottom(),this.isLoading=!0,this.setQuestion(""),await r.D.createGenImageTask({data:{messages:this.chatItems.filter(e=>"error"!==e.type).map(e=>e.data),sessionId:this.sessionId},taskInfo:{language:m.A.finalChatRespondLanguage,taskType:"gen_image",taskUid:this.taskUid}}),this.receiveMassage()}newChat(){this.question="",this.isLoading=!1,this.chatItems=[],this.sessionId="",this.cancelRequest()}doRetry(){if(!this.chatItems.length)return;this.requestProgress=0;let e=this.chatItems[this.chatItems.length-2];this.chatItems.pop(),this.askQuestion(e.data.content,!0)}setQuestion(e){this.question=e}resetOnLogout(){}focusPrimaryInput(){setTimeout(()=>{var e;null===(e=this.textareaRef)||void 0===e||e.focus({cursor:"end"})})}updateUsageInfo(){l.gM.updateUsageInfos([this.botData.usageModule])}addChatItems(e){e.forEach(e=>{this.chatItems.push(e)})}doGenerate(){let e=c.m.genId();n.$.setData({event:"getMakeIteMoreTaskData",payload:{taskId:e},result:{messageList:this.chatItems.flatMap(e=>"question"===e.type?[{type:"question",content:e.data.content}]:"answer"===e.type?[{type:"answer",content:e.data.content,imgs:[e.data.imageUrl]}]:[])}}),d.T3.openPage("".concat(c.m.getWebOrigin()).concat(c.m.genUrl(g.oo.makeItMore,{taskId:e,from:p.o.isExtension?"extension":"web"})))}updateImageFetchingStatus(){let e=this.requestProgress+10*Math.random();e<99&&(this.requestProgress=parseInt(e.toFixed(0)))}cancelRequest(){this.isFinished=!0,r.D.cancelGenImageTask({sessionId:this.sessionId,taskUid:this.taskUid})}async receiveMassage(){setTimeout(()=>{let e=async()=>{if(!this.isFinished){try{let e=await r.D.loopGenImageTask({taskInfo:{taskType:"gen_image",taskUid:this.taskUid}});if(!(null==e?void 0:e.data)||"not_found"===e.data.status){this.isFinished=!0,this.addChatItems([{itemId:c.m.genId(),type:"error",data:{role:"wrongdoer",content:"error"}}]);return}let{status:t,result:i,pendingSeq:a,pendingSeconds:o,statusDetail:s}=e.data;if("pending"===t){this.isPending=!0,this.pendingDetail=s;return}if("running"===t&&0===a&&0===o&&""===s&&(this.isPending=!1,this.updateImageFetchingStatus()),"success"===t&&i){this.requestProgress=100,this.addChatItems([{type:"answer",itemId:c.m.genId(),data:i}]),this.isLoading=!1,this.scrollToBottom(),setTimeout(()=>{this.scrollToBottom()},2e3),this.updateUsageInfo(),this.requestProgress=0,this.isFinished=!0;return}}catch(e){console.error(e),this.isFinished=!0;return}setTimeout(()=>{e()},1e3)}};e()},3e3)}constructor(e){super(),(0,a._)(this,"botData",void 0),(0,a._)(this,"scrollableContainer",void 0),(0,a._)(this,"textareaRef",void 0),(0,a._)(this,"isFinished",void 0),(0,a._)(this,"isQueuing",void 0),(0,a._)(this,"isPending",void 0),(0,a._)(this,"pendingDetail",void 0),(0,a._)(this,"chatItems",void 0),(0,a._)(this,"isLoading",void 0),(0,a._)(this,"question",void 0),(0,a._)(this,"requestProgress",void 0),(0,a._)(this,"scrollBtnVisible",void 0),(0,a._)(this,"sessionId",void 0),(0,a._)(this,"taskUid",void 0),(0,a._)(this,"botController",void 0),this.botData=e,this.scrollableContainer=null,this.isFinished=!0,this.isQueuing=!1,this.isPending=!1,this.pendingDetail="",this.chatItems=[],this.isLoading=!1,this.question="",this.requestProgress=0,this.scrollBtnVisible=!1,this.sessionId="",this.taskUid="",(0,A.rC)(this)}}(0,o.gn)([s.SB],y.prototype,"isFinished",void 0),(0,o.gn)([s.SB],y.prototype,"isQueuing",void 0),(0,o.gn)([s.SB],y.prototype,"isPending",void 0),(0,o.gn)([s.SB],y.prototype,"pendingDetail",void 0),(0,o.gn)([s.SB],y.prototype,"chatItems",void 0),(0,o.gn)([s.SB],y.prototype,"isLoading",void 0),(0,o.gn)([s.SB],y.prototype,"question",void 0),(0,o.gn)([s.SB],y.prototype,"requestProgress",void 0),(0,o.gn)([s.SB],y.prototype,"scrollBtnVisible",void 0),(0,o.gn)([A.Fl],y.prototype,"showHomeView",null),(0,o.gn)([A.Fl],y.prototype,"canGenerateVideo",null)},1396:function(e,t,i){"use strict";i.d(t,{Mp:function(){return K}});var a=i(66084),o=i(52921),s=i(34491),n=i(4461),r=i(91433),l=i(3978),d=i(38172),c=i(24900),h=i(46756),g=i(11502),p=i(92020),A={src:"https://assets.monica.im/home-web/_next/static/media/artifact-builder.bc9f9c87.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAARVBMVEVFTfpPSP1XQP9FT/27wfw1Wvk0W/qtr/1MaXFXQP8/Uvybo/wxXPpZPv9OQ/2/wvw2UvpGTP7Iy/y2t/s2Xf8+Uv2uuf2JjjBFAAAADnRSTlMu8bOu+/ey/gD88Pns7JsNYTcAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA/SURBVHicFcZHEoAwDACxTbcDOJ3/P5VBJyHklDIC9+79VMg7vuUagdTnbGU46omrFXOE8Uc9ODPTBwSv6pEPVxgCT9oZAsIAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},m={src:"https://assets.monica.im/home-web/_next/static/media/bot-artist-logo.4a8cca11.png",height:96,width:96,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAbFBMVEVMaXG9vb5ibHpRVIA3kpSQkK319fKbeoTFoY5RXmtjPOc3DOxJsuNTYGx0cfWcuP+FjZBaqdxLWmGWn6DOeLm+npjYpW9VRJrOkP+eaffp2LP88u3k4PGnpqZ1fZCwvJzD6P+MjLHutazUlYqrZZUEAAAAHHRSTlMA/WCvHC38DTzbYSmk+MPr/MWS+7TT/Indw/z828kI5QAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAENJREFUeJwVy0cSgCAQAMFBkQVzjmD8/x8tLn1rADKJ6t5VLgGWZ2jPFNi8Mb4ukDUoFZocxnc/7hKYvvnqdLzWWoEfXlMC51q/duQAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},u={src:"https://assets.monica.im/home-web/_next/static/media/bot-notification-logo.e6f4da3a.png",height:96,width:96,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAV1BMVEVVQnokNvjaz6//6Ij8xFP/zFBSP/X6v0/u7ohABu3///7Ky81ArbtTQPWnTMZ6v/LMe/iXpf96e/h7g/rDj/94QPH1y3D/1GG8vL3Ux//AvKfPv6/fzf84AVfZAAAAFnRSTlMBKv35kPG2fQ8W/Pxbm1rIyNz+/tybA5VUtAAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAD9JREFUeJwVy8cRgCAAAMEjJxUFBQz91+mw/wUQginYWmwAri/GewXOkdI4gP2V8snA1pRqC+BN78bP5rR28ANLlwIekJYMvgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},f=i(67176),y=i(91202),v=i(18715),w={src:"https://assets.monica.im/home-web/_next/static/media/llama-70b.8b6588d2.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAS1BMVEX+//9dnu10rvJn3b1xuf0+mYHa6v3f8P1R3Lb2+v9v5sO92/vv9v5msvxPl+1DtphJkH1cspcqdWHj8/xgvJ9SqPzP4vih0P2GwP3BlLWiAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPUlEQVR4nAXBBwKAMAgAsaML6HTr/19qAjh0gDbDmxq49CAkR4Mmeb6Cj7uUORxOBVWI9crbXiNmKx/Z7Ac7+gHotXVHOAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},C={src:"https://assets.monica.im/home-web/_next/static/media/cover.177cc6cf.jpg",height:300,width:338,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAHAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAb/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGuB//EABUQAQEAAAAAAAAAAAAAAAAAABIi/9oACAEBAAEFAqf/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAEDAQE/AX//xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAECAQE/AX//xAAWEAADAAAAAAAAAAAAAAAAAAAAEkH/2gAIAQEABj8Cin//xAAXEAADAQAAAAAAAAAAAAAAAAAAEUGx/9oACAEBAAE/IVbQ/9oADAMBAAIAAwAAABAL/8QAFhEAAwAAAAAAAAAAAAAAAAAAAAEh/9oACAEDAQE/EHT/xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQIBAT8QXb//xAAZEAACAwEAAAAAAAAAAAAAAAABEQAhMXH/2gAIAQEAAT8QDRNDFrs//9k=",blurWidth:8,blurHeight:7},b={src:"https://assets.monica.im/home-web/_next/static/media/makeItMoreBotIcon.8e2da297.svg",height:13,width:20,blurWidth:0,blurHeight:0},S=i(93270),I={src:"https://assets.monica.im/home-web/_next/static/media/search-agent-logo.e488eb63.png",height:96,width:96,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEVWn/8uiPxNmv6fyP5Xn/91sf8uhvpOmf47jvpao/9ap/8rhfuXxf+IvP5yqeq00/tpqv++0tyzwa4zgUZcAAAACnRSTlP+y/7/0P3QL/3LJRvB0AAAAAlwSFlzAABCcAAAQnABbvJfbQAAADpJREFUeJwFwYkBgDAMA7HDbkn6A/sPi0QUJErQevWiN6jne6dAXnsb0DrP9BAwbWfSujRSF1FA444fOUcBjW7ne8gAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},_={src:"https://assets.monica.im/home-web/_next/static/media/tour-genius-logo.5af86ffd.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAhFBMVEVFMB0AmWo9PDg9OjdNRT2DB+U/PD0dcU0aqol6wLJFQEE2tZhuNe4yspaKCO6RkYU0tphGQUFBvZ+jl44zM8gOVPBBQT1DQz7Hx8I7NzcAmtpSOL1DQULQz84st5hKwKalpaZPR1skspHwv/9WqY+zhf9ezLWSmM9TmoVNt8XC2P+VjP5t1iBEAAAAHHRSTlMDHvtgIzabDv3+xtiZ2Vz98+nw/EZYOs39STi0hwFb0wAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAEpJREFUeJwFwQUCgCAQBMBFBcTuPATs+P//nAECPyrFKAFBRNR3QOI8z80B+KGtHb4G2ZZrXb8t+LUrdT8TWHGaZakYZGrCcI3lD6WtBPBRCHsVAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},T=i(88882),k=i(21320),E=i(92235),M=i(60445),x=i(92660),B=i(56607),D=i(73047),L=i(33381),R=i(18508),U=i(90180),P=i(18312),F=i(15851),O=i(11201);class N{get botItem(){return this.parent.botItems.find(e=>e.uid===this.botId)||null}get botConfig(){return this.botItem?this.botItem.botConfig:null}get isArtistBot(){return this.botId===r.Z9.artist}get isMakeItMore(){return this.botId===r.qJ.makeItMore}get usageModule(){return L.userController.isFreeUser?"image_gen":"credits"}getBotInfo(){return{id:this.botId,usageModule:this.usageModule}}updateViewId(){var e;(null===(e=this.botItem)||void 0===e?void 0:e.viewId)?this.botItem.viewId++:this.botItem.viewId=1}constructor(e,t){(0,a._)(this,"botId",void 0),(0,a._)(this,"parent",void 0),this.botId=e,this.parent=t,(0,D.rC)(this)}}(0,o.gn)([D.Fl],N.prototype,"botItem",null),(0,o.gn)([D.Fl],N.prototype,"botConfig",null),(0,o.gn)([D.Fl],N.prototype,"isArtistBot",null),(0,o.gn)([D.Fl],N.prototype,"isMakeItMore",null),(0,o.gn)([D.Fl],N.prototype,"usageModule",null);var V=i(45476),Q=i(8287),z=i(98966),H=i(41602),W=i(76469),G=i(79854);class j extends G.Q{async init(e){this.botController=e}destroy(){}updateUsageInfo(){}resetOnLogout(){var e;this.items=[],this.loading=!0;let t=null===(e=this.botController)||void 0===e?void 0:e.botItems.find(e=>e.uid===this.botData.botId);t&&(t.hasOpened=!1)}focusPrimaryInput(){}initServiceEventListeners(){H.B.on("notificationDataChange",e=>{e&&this.updateNotificationList(e)})}async feedback(e,t){await H.B.feedbackNotification({id:e,like:t})}async executeAction(e){if("link"===e.type&&e.url){this.jumpToPage(e.url);return}if("bot"===e.type&&e.botUid){this.botController.openBot(e.botUid);return}}async fetchNotificationList(e){if(this.items.length>0)return;let t=null==e?void 0:e.cacheOnly;t||(this.loading=!0);try{var i,a;let o=await H.B.getNotificationData({userCreatedAt:null!==(a=null===(i=L.userController.userInfo)||void 0===i?void 0:i.createdAt)&&void 0!==a?a:0},e);o&&this.updateNotificationList(o,!t)}catch(e){F.M.error(E.m.formatMonicaSdkError(e))}this.loading=!1}jumpToPage(e){window.open(e,"_blank")}async updateNotificationList(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.items=e.itemList,p.ll.setUiFlag("unreadNotificationCount",e.unreadCount),t&&this.updateScroll()}updateScroll(){this.emitter.emit("dataChanged")}constructor(e){super(),(0,a._)(this,"botData",void 0),(0,a._)(this,"items",void 0),(0,a._)(this,"loading",void 0),(0,a._)(this,"emitter",void 0),(0,a._)(this,"botController",void 0),this.botData=e,this.items=[],this.loading=!0,this.emitter=new W.v,(0,D.rC)(this)}}(0,o.gn)([s.SB],j.prototype,"items",void 0),(0,o.gn)([s.SB],j.prototype,"loading",void 0);class J{get S(){return T.S.Global.controllers.botController}get currentBot(){return this.botItems.find(e=>e.uid===this.currentBotId)}get currentConversationId(){var e;if((null===(e=this.currentBot)||void 0===e?void 0:e.controller)instanceof V._)return this.currentBot.controller.conversationId}get allBots(){return this.botItems.reduce((e,t)=>([r.Z9.monica,r.Z9.notification].includes(t.uid)||"chat_bot"!==t.type&&"custom_bot"!==t.type&&"agent_bot"!==t.type||e.push(t),e),[])}get pinBots(){let e=U.A.pinBotIds,t=this.allBots.filter(e=>{var t;return null===(t=e.userAction)||void 0===t?void 0:t.actionPinned}).sort((t,i)=>{var a,o,s,n,r;let l=e.indexOf(t.uid),d=e.indexOf(i.uid);return -1!==l&&-1!==d?l-d:-1!==l?-1:-1!==d?1:null!==(r=this.sortBot(k.L.getTimestamp(null!==(s=null===(a=t.userAction)||void 0===a?void 0:a.actionPinnedTime)&&void 0!==s?s:0),k.L.getTimestamp(null!==(n=null===(o=i.userAction)||void 0===o?void 0:o.actionPinnedTime)&&void 0!==n?n:0)))&&void 0!==r?r:0}),i=this.getBotItemById(r.Z9.monica);return i&&!t.some(e=>this.isMonica(e.uid))?[i,...t]:t}get recentBots(){return[this.botItems.find(e=>{let{uid:t}=e;return this.isMonica(t)}),...this.allBots].filter(e=>{var t;return null===(t=e.lastMessageInfo)||void 0===t?void 0:t.lastMessageTime}).sort((e,t)=>{var i,a,o,s,n;let r=k.L.getTimestamp(null!==(o=null===(i=e.lastMessageInfo)||void 0===i?void 0:i.lastMessageTime)&&void 0!==o?o:0),l=k.L.getTimestamp(null!==(s=null===(a=t.lastMessageInfo)||void 0===a?void 0:a.lastMessageTime)&&void 0!==s?s:0);return null!==(n=this.sortBot(l,r))&&void 0!==n?n:0})}get dislikeTags(){return[{key:"misunderstanding",name:()=>this.S.misunderstanding,label:"Misunderstanding the question"},{key:"slowResponse",name:()=>this.S.slowResponse,label:"Slow answer"},{key:"misinformation",name:()=>this.S.misinformation,label:"Misinformation"},{key:"generalAnswer",name:()=>this.S.generalAnswer,label:"Answer is too general"},{key:"irrelevantSources",name:()=>this.S.irrelevantSources,label:"Irrelevant sources"},{key:"other",name:()=>this.S.otherFeedback,label:"Other"}]}setViews(e){this.views=e}handleMonicaLastMsgTimeChange(e){e&&(K.getBotItemById(r.Z9.monica).lastMessageInfo={lastMessageTime:e})}async init(){var e;this.fromBotFramework||(l.aS.on("allChatBotListChange",e=>{this.updateChatBotItems(e)}),l.aS.on("allArtistBotListChange",e=>{this.updateArtistBotItems(e)}),l.aS.getStorage("monicaLastMsgTime").then(e=>{this.handleMonicaLastMsgTimeChange(e)}),l.aS.on("monicaLastMsgTimeChange",e=>{this.handleMonicaLastMsgTimeChange(e)}),l.aS.on("compareBotListChange",e=>{this.updateChatBotItems(e,!0),this.compareBotList=e}),l.aS.on("recentBotsDeleteTimeChange",e=>{this.recentBotsDeleteTime=e||{}}),d.W.on("userLogout",()=>{this.initDefaultBots()}),d.W.on("userInfoChange",e=>{if(e){var t;null===(t=this.getBotItemById(r.Z9.monica))||void 0===t||t.controller.init(this)}}),c.Tn.on("chatItemsSynced",e=>{let{ids:t}=e;t.forEach(e=>{let t=this.getActiveChatBotController();if(t){let i=t.chatTree.findNodeById(e);i&&(i.data.synced=!0)}})})),null===(e=this.getBotItemById(r.Z9.monica))||void 0===e||e.controller.init(this)}async createBot(e){let t=await h.y.saveBot({botData:e});if(!t.uid)throw Error("bot create failed");return this.updateChatBotItems([t]),t}getBotItemById(e){return this.botItems.find(t=>t.uid===e)}async openRemoteBot(e,t){let i=!1;setTimeout(()=>{i||(this.fetchRemoteBotDetailLoading=!0)});try{let i=await this.getRemoteBotItemById(e),a=K.checkBotPermission(i);if(a){F.M.error(a);return}await K.openBot(i.uid,t)}finally{i=!0,this.fetchRemoteBotDetailLoading=!1}}async getRemoteBotItemById(e){let t=this.getBotItemById(e);if(t)return t;this.botDetailCache.has(e)||this.botDetailCache.set(e,l.aS.getBotDetail(e));let i=await this.botDetailCache.get(e);return this.updateChatBotItems([i.data]),i.data}async initBotItems(){l.aS.getAllChatBotList({useCache:!0,autoUpdate:!0}).then(e=>{this.updateChatBotItems(e)}),l.aS.getAllArtistBotList({useCache:!0,autoUpdate:!0},()=>{this.artistBotItemsReadySource.markReady()}).then(e=>{this.updateArtistBotItems(e)}),l.aS.getCompareBotList({useCache:!0,autoUpdate:!0}).then(e=>{this.compareBotList=e}),l.aS.getRecentBotsDeletedTime().then(e=>{this.recentBotsDeleteTime=e||{}})}async refreshBotItems(e){"chat"===e||"bots"===e?this.refreshedChatBotList||(this.refreshedChatBotList=!0,l.aS.getAllChatBotList({autoUpdate:!0,useCache:!1})):this.refreshedArtistBotList||(this.refreshedArtistBotList=!0,l.aS.getAllArtistBotList({autoUpdate:!0,useCache:!1}))}isArtistBot(e){return"artist_bot"===e}isChatBot(e){return"chat_bot"===e||"custom_bot"===e}isAgentBot(e){return"agent_bot"===e}updateChatBotItems(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[];for(let a=0;a<e.length;a++){let o=e[a];if(!this.isChatBot(o.type)&&!this.isAgentBot(o.type))continue;let s=this.botItems.findIndex(e=>e.uid===o.uid);if(-1!==s&&!t){let e=this.botItems[s];this.botItems[s].userAction=o.userAction,this.botItems[s].name=o.name,this.botItems[s].logoUrl=o.logoUrl,this.botItems[s].exampleList=o.exampleList,this.botItems[s].creatorInfo=o.creatorInfo,this.isMonica(e.uid)||(this.botItems[s].botConfig=o.botConfig,this.botItems[s].toolData=o.toolData),o.description&&(this.botItems[s].description=o.description),"artist_bot"!==e.type&&(e.lastMessageInfo=o.lastMessageInfo);continue}"agent_bot"===o.type?i.push({...o,hasOpened:!1,controller:new R.o(new Q.E(o.uid,this))}):i.push({...o,hasOpened:!1,controller:new V._(new Q.E(o.uid,this))})}this.botItems=this.botItems.concat(i)}updateArtistBotItems(e){let t=[];for(let i=0;i<e.length;i++){let a=e[i],o=this.botItems.findIndex(e=>e.uid===a.uid);if(-1!==o){this.botItems[o].userAction=a.userAction,this.botItems[o].name=a.name,this.botItems[o].logoUrl=a.logoUrl,this.botItems[o].botConfig=a.botConfig,this.botItems[o].exampleList=a.exampleList,this.botItems[o].coverUrl=a.coverUrl,a.description&&(this.botItems[o].description=a.description);continue}t.push({...a,controller:new O.F(new N(a.uid,this))})}this.botItems=this.botItems.concat(t)}sortBots(e){let t=(e,t)=>-1!==e||-1!==t?-1!==e&&-1===t?-1:-1===e&&-1!==t?1:e-t:null;return e.sort((e,i)=>{let a=[r.Z9.monica,r.Z9.genius,r.Z9.artist],o=t(a.indexOf(e.uid),a.indexOf(i.uid));if(null!==o)return o;let s=t(e.userAction.actionPinned?k.L.getTimestamp(e.userAction.actionPinnedTime||0):-1,i.userAction.actionPinned?k.L.getTimestamp(i.userAction.actionPinnedTime||0):-1);if(null!==s)return s;if("classification"in e&&"classification"in i){let a=t("custom"===e.classification?1:-1,"custom"===i.classification?1:-1);if(null!==a)return a}return 0})}selectBot(){this.currentBot&&(this.isArtistBot(this.currentBot.type)||this.currentBot.controller instanceof z.t?this.views.artistBotsExploreDrawer({insertTarget:{botId:this.currentBot.uid,type:"botContainer"}}):(this.isChatBot(this.currentBot.type)||this.isAgentBot(this.currentBot.type))&&this.views.chatBotsExploreDrawer({insertTarget:{botId:this.currentBot.uid,type:"botContainer"}}))}async openBot(e,t){let{autoUpdateQuota:i=!0}=t||{},a=this.currentBotId;if(a===e)return;let o=this.getBotItemById(e);if(!o){console.error("BotController.setBot: bot ".concat(e," not found"));return}let s=this.getBotItemById(a);(null==s?void 0:s.controller)instanceof V._&&o.controller instanceof V._&&s.controller.artifactManager.close(),o.hasOpened||(o.hasOpened=!0,await o.controller.init(this)),this.currentBotId=e,i&&o.controller.updateUsageInfo(),o.controller.focusPrimaryInput()}async loadConversionForBot(e,t){var i,a;let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];await this.openRemoteBot(e),(null===(i=this.currentBot)||void 0===i?void 0:i.controller)instanceof V._?await this.currentBot.controller.loadConversation(t,o?"cacheFirst":"cacheWithUpdate"):(null===(a=this.currentBot)||void 0===a?void 0:a.controller)instanceof R.o&&await this.currentBot.controller.loadTask(t)}async beforeContinueInChat(){P.J.onTabChange("chat"),this.currentBotId!==r.Z9.monica&&await this.openBot(r.Z9.monica);let e=this.getActiveChatBotController();return await e.newConversation(),e}getMonicaChatController(){return this.getBotItemById(r.Z9.monica).controller}getActiveBotItemController(){return this.currentBot?this.currentBot.controller:null}getActiveChatBotController(){let e=this.getActiveBotItemController();return e instanceof V._?e:null}getMakeItMoreController(){return this.botItems.find(e=>e.uid===r.qJ.makeItMore).controller}getNotificationController(){let e=this.getBotItemById(r.Z9.notification);return null==e?void 0:e.controller}async toggleFavorite(e,t){let i=this.getBotItemById(e);if(!i){console.warn("BotController.toggleFavorite: bot ".concat(e," not found"));return}let{controller:a,...o}=i;await l.aS.toggleBotPin(o,t,this.isArtistBot(i.type)?"artist":"chat")}handleReport(e){L.userController.checkAuthForWeb()&&this.views.openCommonReportDialog({insertTarget:"mainWindow",targetType:"chat_bot",id:e})}handleEdit(e){window.open(E.m.genUrl("".concat(E.m.getWebOrigin()).concat(M.Cl.botDetail),{uid:e}),"_blank")}handleShare(e){this.views.openShareBotDialog({insertTarget:"mainWindow",...e})}checkBotPermission(e){if((null==e?void 0:e.type)!=="artist_bot"){if(!e||e.deleted)return T.S.Global.controllers.botController.botDeleted;if(L.userController.userInfo&&e.userId!==L.userController.userInfo.id&&!e.isPublic&&!e.accessByLink)return T.S.Global.controllers.botController.notAccess}}isMonica(e){return e===r.Z9.monica}getBotModelBadge(e,t){let i="";return"gpt-4o"!==t&&"gpt-4"!==t||x.IW.includes(e)||(i="GPT-4o"),"claude-3.5-sonnet"!==t||x.hg.includes(e)||(i="Claude 3.5 Sonnet"),i}botItemToString(e){let t=(0,D.ZN)(e);return Reflect.deleteProperty(t,"controller"),t}setIsFromBotFramework(){this.fromBotFramework=!0}async handleLikeMessage(e,t){let{chatItemId:i}=e;if(!0===this.msgFeedbackDict[i]){Reflect.deleteProperty(this.msgFeedbackDict,i);return}g.M.createUserBehaviorEvent({eventName:"chat_feedback_like_click",source:t}),L.userController.openPromotion("feedback"),this.msgFeedbackDict[i]=!0,await l.aS.feedbackChatLike(e)}async handleUnlikeMessage(e,t){let{chatItemId:i}=e;if(!1===this.msgFeedbackDict[i]){Reflect.deleteProperty(this.msgFeedbackDict,i);return}d.W.createUserBehaviorEvent({eventName:"chat_feedback_dis_like_click",source:t}),this.msgFeedbackDict[i]=!1,await l.aS.feedbackChatLike(e)}getBotTags(e){var t,i;return"chat_bot"!==e.type&&"custom_bot"!==e.type?[]:this.isMonica(e.uid)||(null===(i=e.botConfig)||void 0===i?void 0:null===(t=i.featureOptions)||void 0===t?void 0:t.official)?[this.S.BotConfig.official]:[]}togglePinBot(e,t){let i=U.A.pinBotIds,a=i.includes(e);d.W.createUserBehaviorEvent({eventName:"bots_pin_click",source:t,extData:{botUid:e,pin:!a}}),a?p.ll.set("pinBotIds",i.filter(t=>t!==e)):p.ll.set("pinBotIds",[e,...i])}isOfficialBot(e){if("chat_bot"===e.type){var t;return null===(t=e.botConfig.featureOptions)||void 0===t?void 0:t.official}return!1}async openConversionView(e,t){if(!e||!t)return;let i=await this.getRemoteBotItemById(e);if(i){"web-home"===B.o.entryType&&history.replaceState(null,"",location.pathname);let a=i.controller;if(await K.openBot(e),a instanceof V._){if(a.conversationId===t)return;a.loadConversation(t,"cacheWithUpdate")}else a instanceof R.o&&a.loadTask(t)}}sortBot(e,t){return -1!==e||-1!==t?-1!==e&&-1===t?-1:-1===e&&-1!==t?1:e-t:null}initDefaultBots(){this.botItems=[{createdAt:0,creatorInfo:{},updatedAt:0,uid:r.Z9.monica,isPublic:!0,type:"chat_bot",name:"Monica",logoUrl:(0,n.Q)(S.Z),controller:new V._(new Q.E(r.Z9.monica,this)),description:T.S.Global.controllers.botController.monicaDesc,hasKnowledgeBase:!0,hasUserSkill:!1,hasOpened:!0,userAction:{actionPinned:!0,actionAdded:!1,actionLike:!1,actionUsed:!1},botConfig:{homeViewOptions:{welcomeMsg:"",welcomeMsgStreamTime:0},modelOptions:{allowGpt4:!0,sendTaskType:"chat_with_custom_bot",usageModule:"basic_query"},uiOptions:{allowReading:!0,allowVoiceResponse:!0,allowChatFile:!0,allowMention:!0,allowPromptLibrary:!0,allowShareChat:!0,allowIntent:!0,allowSelectRespLang:!0,allowAt:!0,allowCompare:!0,allowPromptOptimize:!0}}},{createdAt:0,creatorInfo:{},updatedAt:0,uid:r.Z9.artifactBuilder,isPublic:!0,type:"chat_bot",name:"Artifact Builder",logoUrl:(0,n.Q)(A),controller:new V._(new Q.E(r.Z9.artifactBuilder,this)),hasKnowledgeBase:!0,hasUserSkill:!1,userAction:{actionPinned:!1,actionAdded:!1,actionLike:!1,actionUsed:!1},botConfig:{modelOptions:{usageModule:"basic_query",allowGpt4:!1},homeViewOptions:{welcomeMsgStreamTime:0},uiOptions:{allowReading:!1,allowVoiceResponse:!1,allowChatFile:!1,allowMention:!1,allowPromptLibrary:!1,allowShareChat:!1,allowIntent:!1,allowSelectRespLang:!1,allowAt:!1,allowCompare:!1,hideBotHeader:!0}}},{name:"GPT-4o",type:"custom_bot",logoUrl:(0,n.Q)(v.Z),controller:new V._(new Q.E(r.qJ.gpt4o,this)),isPublic:!0,toolData:{useModel:"gpt-4o",sysSkillList:[{uid:"web_access",allowUserModify:!1,enable:!0,forceEnable:!1}]},botConfig:{modelOptions:{usageModule:"genius_bot",sendTaskType:"chat"},homeViewOptions:{welcomeMsgStreamTime:0},uiOptions:{allowPromptLibrary:!0,allowMention:!0,allowAt:!0,allowSelectRespLang:!0,allowShareChat:!0,allowCompare:!0,allowPromptOptimize:!0}},uid:r.qJ.gpt4o,userAction:{actionLike:!1,actionUsed:!1,actionAdded:!1,actionPinned:!1},creatorInfo:{avatar:"",name:"",userId:0},lastMessageInfo:{}},{name:"Claude 3 Sonnet",type:"chat_bot",controller:new V._(new Q.E(r.qJ.claude3Sonnet,this)),logoUrl:(0,n.Q)(f.Z),toolData:{useModel:""},isPublic:!0,botConfig:{modelOptions:{usageModule:"genius_bot"},homeViewOptions:{welcomeMsgStreamTime:0},uiOptions:{allowPromptLibrary:!0,allowAt:!0,allowSelectRespLang:!0,allowShareChat:!0,allowCompare:!0,allowPromptOptimize:!0}},uid:r.qJ.claude3Sonnet,userAction:{actionLike:!1,actionUsed:!1,actionAdded:!1,actionPinned:!1},creatorInfo:{avatar:"",name:"",userId:0},lastMessageInfo:{}},{name:"Gemini 1.5 Pro",type:"chat_bot",logoUrl:(0,n.Q)(y.Z),controller:new V._(new Q.E(r.qJ.gemini15Pro,this)),toolData:{useModel:""},isPublic:!0,botConfig:{modelOptions:{usageModule:"genius_bot"},homeViewOptions:{welcomeMsgStreamTime:0},uiOptions:{allowMention:!0,allowAt:!0,allowSelectRespLang:!0,allowShareChat:!0,allowCompare:!0,allowPromptOptimize:!0}},uid:r.qJ.gemini15Pro,userAction:{actionLike:!1,actionUsed:!1,actionAdded:!1,actionPinned:!1},creatorInfo:{avatar:"",name:"",userId:0},lastMessageInfo:{}},{name:"Llama 3 70B",type:"chat_bot",controller:new V._(new Q.E(r.qJ.llama370b,this)),logoUrl:(0,n.Q)(w),toolData:{useModel:""},isPublic:!0,botConfig:{modelOptions:{usageModule:"genius_bot"},homeViewOptions:{welcomeMsgStreamTime:0},uiOptions:{allowMention:!0,allowAt:!0,allowSelectRespLang:!0,allowShareChat:!0,allowCompare:!0,allowPromptOptimize:!0}},uid:r.qJ.llama370b,userAction:{actionLike:!1,actionUsed:!1,actionAdded:!1,actionPinned:!1},creatorInfo:{avatar:"",name:"",userId:0},lastMessageInfo:{}},{name:"Claude 3 Opus",type:"chat_bot",controller:new V._(new Q.E(r.qJ.claude3Opus,this)),logoUrl:(0,n.Q)(f.Z),isPublic:!0,toolData:{useModel:""},botConfig:{modelOptions:{usageModule:"genius_bot"},homeViewOptions:{welcomeMsgStreamTime:0},uiOptions:{allowPromptLibrary:!0,allowAt:!0,allowSelectRespLang:!0,allowShareChat:!0,allowCompare:!0,allowPromptOptimize:!0}},uid:r.qJ.claude3Opus,userAction:{actionLike:!1,actionUsed:!1,actionAdded:!1,actionPinned:!1},creatorInfo:{avatar:"",name:"",userId:0},lastMessageInfo:{}},{name:"Claude 3.5 Sonnet",description:"anthropic's most advanced model, it surpasses the claude 3 opus. offering superior intelligence and speed. excelling in reasoning, knowledge, coding, and vision tasks.",controller:new V._(new Q.E(r.qJ.claude35Sonnet,this)),welcomeMessage:"",prompt:"",logoUrl:(0,n.Q)(f.Z),toolData:{useModel:"claude-3"},isPublic:!0,accessByLink:!1,createdAt:"2024-06-21t10:52:25z",hasKnowledgeBase:!1,hasUserSkill:!1,botConfig:{modelOptions:{usageModule:"genius_bot"},homeViewOptions:{welcomeMsgStreamTime:0},uiOptions:{allowPromptLibrary:!0,allowAt:!0,allowSelectRespLang:!0,allowShareChat:!0,allowCompare:!0,allowPromptOptimize:!0}},uid:r.qJ.claude35Sonnet,type:"chat_bot",userAction:{},lastMessageInfo:{},statisticiansInfo:{}},{type:"artist_bot",uid:r.qJ.makeItMore,name:"Make it more",logoUrl:b,coverUrl:C,controller:new z.t(new N(r.qJ.makeItMore,this)),get description(){return T.S.Global.controllers.botController.makeItMoreDesc},hasOpened:!1,viewId:1,userAction:{actionPinned:!0,actionAdded:!1,actionLike:!1,actionUsed:!1},properties:{},botConfig:{homeViewOptions:{welcomeMsgStreamTime:0,welcomeMsg:""},modelOptions:{usageModule:"artist_bot"},uiOptions:{referenceImageEnabled:!0}}},{createdAt:0,creatorInfo:{},updatedAt:0,uid:r.Z9.genius,isPublic:!0,type:"chat_bot",name:"Genius",logoUrl:(0,n.Q)(_),controller:new V._(new Q.E(r.Z9.genius,this)),description:T.S.Global.controllers.botController.geniusDesc,hasKnowledgeBase:!1,hasUserSkill:!1,hasOpened:!1,userAction:{actionPinned:!1,actionAdded:!1,actionLike:!1,actionUsed:!1},botConfig:{homeViewOptions:{welcomeMsg:"",welcomeMsgStreamTime:0},modelOptions:{allowGpt4:!1,sendTaskType:"chat_with_custom_bot",usageModule:"genius_bot"},uiOptions:{allowVoiceResponse:!0,allowPromptLibrary:!0,allowShareChat:!0,allowIntent:!0,allowSelectRespLang:!0}}},{createdAt:0,creatorInfo:{},updatedAt:0,uid:r.tW.searchAgent,type:"agent_bot",name:"Search Agent",logoUrl:(0,n.Q)(I),controller:new R.o(new Q.E(r.tW.searchAgent,this)),description:T.S.Global.controllers.botController.monicaDesc,hasKnowledgeBase:!1,hasUserSkill:!1,hasOpened:!1,userAction:{actionPinned:!1,actionAdded:!1,actionLike:!1,actionUsed:!1},botConfig:{homeViewOptions:{welcomeMsg:"",welcomeMsgStreamTime:0},modelOptions:{allowGpt4:!0,sendTaskType:"agent",usageModule:"basic_query"},uiOptions:{}}},{createdAt:0,uid:r.Z9.artist,type:"artist_bot",name:"Artist",logoUrl:(0,n.Q)(m),controller:new O.F(new N(r.Z9.artist,this)),description:T.S.Global.controllers.botController.artistDesc,hasOpened:!1,tags:[],userAction:{actionPinned:!0,actionAdded:!1,actionLike:!1,actionUsed:!1},properties:{},botConfig:{homeViewOptions:{welcomeMsgStreamTime:0,welcomeMsg:""},modelOptions:{usageModule:"artist_bot"},uiOptions:{referenceImageEnabled:!0}}},{createdAt:0,creatorInfo:{},updatedAt:0,uid:r.Z9.notification,type:"chat_bot",name:"Monica Team",logoUrl:(0,n.Q)(u),controller:new j(new Q.E(r.Z9.notification,this)),description:T.S.Global.controllers.botController.notificationDesc,hasKnowledgeBase:!1,hasUserSkill:!1,userAction:{actionPinned:!1,actionAdded:!1,actionLike:!1,actionUsed:!1},botConfig:{homeViewOptions:{welcomeMsg:"",welcomeMsgStreamTime:0},modelOptions:{allowGpt4:!0,sendTaskType:"chat",usageModule:"basic_query"},uiOptions:{}}}].filter(e=>!B.o.isDesktop||e.uid!==r.qJ.makeItMore)}constructor(){(0,a._)(this,"views",void 0),(0,a._)(this,"artistBotItemsReadySource",E.m.createReadySource()),(0,a._)(this,"currentBotId",r.Z9.monica),(0,a._)(this,"botItems",[]),(0,a._)(this,"msgFeedbackDict",{}),(0,a._)(this,"fetchRemoteBotDetailLoading",!1),(0,a._)(this,"compareBotList",[]),(0,a._)(this,"recentBotsDeleteTime",{}),(0,a._)(this,"commandKeyword",""),(0,a._)(this,"refreshedChatBotList",!1),(0,a._)(this,"refreshedArtistBotList",!1),(0,a._)(this,"botDetailCache",new Map),(0,a._)(this,"fromBotFramework",!1),(0,D.rC)(this),this.initDefaultBots()}}(0,o.gn)([s.SB],J.prototype,"currentBotId",void 0),(0,o.gn)([s.SB],J.prototype,"botItems",void 0),(0,o.gn)([s.SB],J.prototype,"msgFeedbackDict",void 0),(0,o.gn)([s.SB],J.prototype,"fetchRemoteBotDetailLoading",void 0),(0,o.gn)([s.SB],J.prototype,"compareBotList",void 0),(0,o.gn)([s.SB],J.prototype,"recentBotsDeleteTime",void 0),(0,o.gn)([s.SB],J.prototype,"commandKeyword",void 0),(0,o.gn)([D.Fl],J.prototype,"S",null),(0,o.gn)([D.Fl],J.prototype,"currentBot",null),(0,o.gn)([D.Fl],J.prototype,"currentConversationId",null),(0,o.gn)([D.Fl],J.prototype,"allBots",null),(0,o.gn)([D.Fl],J.prototype,"pinBots",null),(0,o.gn)([D.Fl],J.prototype,"recentBots",null),(0,o.gn)([D.Fl],J.prototype,"dislikeTags",null);let K=new J},80288:function(e,t,i){"use strict";i.d(t,{Y3:function(){return o},aU:function(){return y},iY:function(){return v},oK:function(){return w}});var a,o,s=i(66084),n=i(52921),r=i(34491),l=i(92235),d=i(73047),c=i(46756),h=i(15851),g=i(34889);let p=[".docx",".doc"],A=[".xls",".xlsx"],m=".pdf",u=[".md",".mdx"],f=[".txt",".csv"],y=[".c",".cs",".cpp",".html",".java",".md",".php",".py",".rb",".tex",".txt",".css",".js",".json",".jsonl"],v=[...p,m,".csv",...f,...A,...u,...y];(a=o||(o={}))[a.Pending=0]="Pending",a[a.Indexed=1]="Indexed",a[a.Failed=2]="Failed";class w{static getFileType(e){let t=l.m.getFileExt(e);return m===t?"pdf":A.includes(t)?"xlsx":p.includes(t)?t.substring(1):u.includes(t)?"markdown":f.includes(t)?"txt":v.includes(t)?t.substring(1):""}get addedKnowledgeList(){return this.addedKnowledgeIds.flatMap(e=>{let t=this.knowledgeList.find(t=>t.uid===e);return t?[t]:[]})}async loadData(e){(null==e?void 0:e.knowledgeList)&&(this.addedKnowledgeIds=e.knowledgeList.flatMap(e=>e.uid?[e.uid]:[])),this.fetchKnowledgeList()}getKnowledge(e){return this.knowledgeList.find(t=>t.uid===e)}addKnowledge(e){this.addedKnowledgeIds.includes(e)||(this.addedKnowledgeIds.push(e),this.parent.save("knowledge"))}removeKnowledge(e){let t=this.addedKnowledgeIds.findIndex(t=>t===e);-1!==t&&(this.addedKnowledgeIds.splice(t,1),this.parent.save("knowledge"))}async deleteKnowledge(e){await c.y.deleteKnowledge(e),this.knowledgeList=this.knowledgeList.filter(t=>t.uid!==e.baseUid),this.addedKnowledgeIds=this.addedKnowledgeIds.filter(t=>t!==e.baseUid)}async deleteDocument(e){if(await c.y.deleteDocuments(e),this.knowledgeDocuments[e.baseUid]){this.knowledgeDocuments[e.baseUid]=this.knowledgeDocuments[e.baseUid].filter(t=>t.uid!==e.documentUid);let t=this.knowledgeList.find(t=>t.uid===e.baseUid);t&&(t.documentTotalSize=this.knowledgeDocuments[e.baseUid].reduce((e,t)=>e+t.fileSize,0),t.documentCount=this.knowledgeDocuments[e.baseUid].length)}}async createKnowledge(e,t){let{data:i}=await c.y.createKnowledge(e,t),a={uid:i.uid,name:e.name,description:e.description};return this.knowledgeList.unshift(a),i.uid}async updateKnowledge(e,t){await c.y.updateKnowledge(e,t);let i=this.knowledgeList.find(t=>t.uid===e.baseUid);i&&(i.name=e.name,i.description=e.description)}async updateDocuments(e,t){let{data:i}=await c.y.updateDocuments(e,t);return i.docIds||[]}async fetchKnowledgeList(){if(this.knowledgeListPromise)return await this.knowledgeListPromise;this.knowledgeListPromise=c.y.getKnowledgeList();let e=await this.knowledgeListPromise;return this.knowledgeList=e,e}async fetchDocuments(e){if(this.knowledgeDocuments[e])return this.loopParseFileTaskForceRunning(e),this.knowledgeDocuments[e];let t=await c.y.getKnowledgeDocuments({baseUid:e});return this.knowledgeDocuments[e]=t.map(e=>({...e,progress:0!==e.status?0:e.progress})),this.knowledgeDocuments[e].forEach(e=>{let t=e.uid;0!==e.status||this.stopFakeProgressMap[t]||this.startFakeProgress(e)}),this.loopParseFileTaskForceRunning(e),t}cancelUploading(e,t){let i=(this.knowledgeDocuments[e]||[]).findIndex(e=>{var i;return(null===(i=e.uploadTask)||void 0===i?void 0:i.id)===t});this.knowledgeDocuments[e].splice(i,1),this.uploadCancelTokens[t].cancel()}async loopDocumentsStatus(e,t){let{baseUid:i,docIds:a=[]}=e;if(0===a.length)throw Error("documentUidList is empty");let o=await c.y.getKnowledgeDocuments(e,t);return o.forEach(e=>{let{status:t}=e,a=e.uid;this.knowledgeDocuments[i].forEach(i=>{if(i.uid===a){let o=Object.keys(e);0!==t||this.stopFakeProgressMap[a]||this.startFakeProgress(i),o.forEach(o=>{"progress"===o?1===t&&(this.stopFakeProgressMap[a]&&(this.stopFakeProgressMap[a](),delete this.stopFakeProgressMap[a]),i.progress=Math.max(e.progress||0,i.progress||0)):i[o]=e[o]})}})}),o}async pushDocumentTask(e,t,i){let a=t.map(t=>this.createTask(e,t));null==i||i(a.map(e=>e.uploadTask.id)),await this.uploadFiles(a),await this.createParseTask(e),"idle"===this.loopStatus&&this.loopParseFileTaskForceRunning(e)}stopLoop(){this.loopStopped=!0,this.loopStatus="idle"}loopParseFileTaskForceRunning(e){this.loopStopped=!1,this.loopParseFileTask(e)}async loopParseFileTask(e){if(this.loopStopped)return;let t=e=>0!==e,i=this.knowledgeDocuments[e].filter(e=>!t(e.status)&&e.uid).map(e=>e.uid);if(0===i.length){this.loopStatus="idle";return}this.loopStatus="running",await this.loopDocumentsStatus({baseUid:e,docIds:i}),await l.m.asyncDelay(1e3),await this.loopParseFileTask(e)}async uploadFiles(e){let t=e.map(async e=>{try{let{objectUrl:t}=await this.uploadFile(e);e.uploadTask.url=t,e.uploadTask.progress=100}catch(t){e.uploadTask.errMsg=l.m.formatErrorMsg(t)}});await Promise.all(t)}async uploadFile(e){let t=new g.jI;this.uploadCancelTokens[e.uploadTask.id]=t;let{stop:i}=l.m.fakeProgress(10,t=>{e.uploadTask.progress=t}),a=e.uploadTask.file,{objectUrl:o,preSignedUrl:s}=await g.Gi.getS3PreSignedModuleUrl({filename:a.name,module:"chat_bot"});return await g.Gi.uploadFileToS3(s,a,t=>{i(),e.uploadTask.progress=Math.max(t,e.uploadTask.progress)},t),e.uploadTask.status="done",{objectUrl:o}}async createParseTask(e){let t=this.knowledgeDocuments[e].filter(e=>e.uploadTask&&"done"===e.uploadTask.status&&!e.status);if(0===t.length)return;let i=l.m.genId(),a=new AbortController;this.parseTaskAbortControllers[i]=a;try{(await this.updateDocuments({baseUid:e,items:t.map(e=>{let{url:t,file:{size:i,name:a}}=e.uploadTask;return{fileType:w.getFileType(a),docName:a,url:t,docSize:i}})},{abortSignal:a.signal})).forEach((e,i)=>{let a=t[i];a.uid=e,a.status=0});let i=this.knowledgeList.find(t=>t.uid===e);if(i){i.updatedAt=Date.now();let e=i.documentTotalSize||0;i.documentTotalSize=t.reduce((e,t)=>e+(t.fileSize||0),e)}}catch(e){throw h.M.error(l.m.formatErrorMsg(e)),e}finally{delete this.parseTaskAbortControllers[i]}}createTask(e,t){let i={baseUid:e,fileSize:t.size,fileType:w.getFileType(t.name),name:t.name,uploadTask:{file:t,id:l.m.genId(),url:"",status:"uploading",progress:0}};return this.knowledgeDocuments[e]||(this.knowledgeDocuments[e]=[]),this.knowledgeDocuments[e].unshift(i),this.knowledgeDocuments[e][0]}startFakeProgress(e){let t=e.uid,{stop:i}=l.m.fakeProgress(120,t=>{e.progress=t});this.stopFakeProgressMap[t]=i}constructor(e){(0,s._)(this,"parent",void 0),(0,s._)(this,"knowledgeList",void 0),(0,s._)(this,"knowledgeDocuments",void 0),(0,s._)(this,"addedKnowledgeIds",void 0),(0,s._)(this,"parseTaskAbortControllers",void 0),(0,s._)(this,"uploadCancelTokens",void 0),(0,s._)(this,"loopStatus",void 0),(0,s._)(this,"loopStopped",void 0),(0,s._)(this,"stopFakeProgressMap",void 0),(0,s._)(this,"knowledgeListPromise",void 0),this.parent=e,this.knowledgeList=[],this.knowledgeDocuments={},this.addedKnowledgeIds=[],this.parseTaskAbortControllers={},this.uploadCancelTokens={},this.loopStatus="idle",this.loopStopped=!1,this.stopFakeProgressMap={},this.knowledgeListPromise=null,(0,d.rC)(this)}}(0,n.gn)([r.SB],w.prototype,"knowledgeList",void 0),(0,n.gn)([r.SB],w.prototype,"knowledgeDocuments",void 0),(0,n.gn)([r.SB],w.prototype,"addedKnowledgeIds",void 0),(0,n.gn)([d.Fl],w.prototype,"addedKnowledgeList",null)},89322:function(e,t,i){"use strict";i.d(t,{p:function(){return f}});var a=i(66084),o=i(52921),s=i(34491),n=i(56607),r=i(92235),l=i(51018),d=i(73047),c=i(39936),h=i(41884),g=i(1396),p=i(90180),A=i(37949),m=i(67061);class u{get windowPlacement(){return"ext-sidebar"===n.o.entryType?"left"===A.w.sidebarPosition?"right":"left":"horizontal"===m.L.mainWindowMode?"right":"center"}get windowOffsetX(){return"left"===this.windowPlacement?-16:"right"===this.windowPlacement?16:0}get isHorizontalView(){return"horizontal"===m.L.mainWindowMode}get resourcePanelVisible(){return this.isHorizontalView&&Object.values(this.windowInfos).some(e=>e.visible)}openWindow(e,t){var i,a;if(null===(i=g.Mp.getMonicaChatController())||void 0===i||i.artifactManager.close(),t&&(this.windowInfos[e].data=t),this.windowInfos[e].visible)return;Object.keys(this.windowInfos).forEach(t=>{t!==e&&this.windowInfos[t].visible&&this.closeWindow(t)}),this.windowInfos[e].visible=!0;let o={relativeDomConfig:{el:null!==(a=this.monicaBotEl)&&void 0!==a?a:void 0,placement:this.windowPlacement},offsetX:this.windowOffsetX,displayMode:this.isHorizontalView?"panel":"window"},s="";switch(e){case"search":s=this.views.openSearchResourceWindow({},o);break;case"file":s=this.views.openFileResourceWindow({},o)}this.windowInfos[e].id=s}closeWindow(e){this.windowInfos[e].visible=!1;let{id:t}=this.windowInfos[e];t&&h.E.disposeWindow(t),"search"===e&&this.prevReplyMsg&&this.manuallyClosedReplyIds.push(this.prevReplyMsg.itemId)}closeAllWindow(){Object.keys(this.windowInfos).forEach(e=>{this.closeWindow(e)}),this.manuallyClosedReplyIds=[]}setViews(e){this.views=e}handleAddOrUpdateReplyMessage(e){this.checkAndOpenSearchWindow(e),this.prevReplyMsg=e}getFilesFromChatItems(e){let t=[];return e.forEach(e=>{if("question"===e.itemType){let{conversationId:i,itemId:a,data:o}=e,{fileInfo:s,fileInfos:n=[],webPageInfo:r}=o;s&&t.push({conversationId:i,chatItemId:a,resourceType:"file",chatFileData:s}),1===n.length&&r?t.push({conversationId:i,chatItemId:a,resourceType:"file",chatFileData:{...n[0],fileType:"browser_tab",fileMetaInfo:{title:r.title,sourceUrl:r.url}}}):n.forEach(e=>{t.push({conversationId:i,chatItemId:a,resourceType:"file",chatFileData:e})})}if("reply"===e.itemType){var i,a;let{conversationId:o,itemId:s,data:n}=e;null===(i=n.artifacts)||void 0===i||i.forEach(e=>{t.push({conversationId:o,chatItemId:s,resourceType:"artifact",chatArtifactData:e})}),null===(a=n.agentStatus)||void 0===a||a.forEach(e=>{var i,a;if("text_status"===e.type&&(null===(i=e.metadata)||void 0===i?void 0:i.metaRenderType)==="image_list"&&(null===(a=e.metadata.metaImageInfos)||void 0===a||a.forEach(e=>{t.push({conversationId:o,chatItemId:s,resourceType:"file",chatFileData:{fileUid:r.m.genId(),...this.getFileInfoFromLink(e.url)}})})),"draw_img_result"===e.type&&e.metadata){let{imageId:i,imageUrl:a=""}=e.metadata;t.push({conversationId:o,chatItemId:s,resourceType:"file",chatFileData:{fileUid:i,...this.getFileInfoFromLink(a)}})}if("mind_map"===e.type&&t.push({conversationId:o,chatItemId:s,resourceType:e.type,chatMindMapData:{data:e.text}}),"ai_form"===e.type&&e.text){let i=l.c.parsePartialJson(e.text);i&&t.push({conversationId:o,chatItemId:s,resourceType:e.type,chatAiFormData:i})}})}}),t.reverse()}getDefaultWindowOptions(e){let t=window.innerWidth-64,i=window.innerHeight-32;return{container:e,initData:{width:this.isHorizontalView?.3*t:Math.min(350,t),height:i},resizeTouchArea:20,getMinSize:()=>({width:300,height:400}),getMaxSize:()=>({width:this.isHorizontalView?t/2:t,height:i})}}checkAndOpenSearchWindow(e){let{itemId:t,data:i}=e;if(p.A.chatExpandResearchEnable){let{sources:e}=c.C.transformReplyContent("web_search",i.content,i.sources||null,!0);!e.length||"web-chat-pdf"===n.o.entryType||"ext-sidebar"===n.o.entryType&&!A.w.visible||this.manuallyClosedReplyIds.includes(t)||this.openWindow("search",e)}}getFileInfoFromLink(e){var t,i;let a=e.split("?")[0];return{fileUrl:e,fileName:null!==(t=a.split("/").pop())&&void 0!==t?t:"",fileExt:null!==(i=a.split(".").pop())&&void 0!==i?i:""}}constructor(){(0,a._)(this,"monicaBotEl",null),(0,a._)(this,"windowInfos",{search:{id:"",visible:!1},file:{id:"",visible:!1}}),(0,a._)(this,"views",void 0),(0,a._)(this,"prevReplyMsg",null),(0,a._)(this,"manuallyClosedReplyIds",[]),(0,d.rC)(this)}}(0,o.gn)([s.SB],u.prototype,"windowInfos",void 0),(0,o.gn)([d.Fl],u.prototype,"windowPlacement",null),(0,o.gn)([d.Fl],u.prototype,"windowOffsetX",null),(0,o.gn)([d.Fl],u.prototype,"isHorizontalView",null),(0,o.gn)([d.Fl],u.prototype,"resourcePanelVisible",null);let f=new u},67925:function(e,t,i){"use strict";i.d(t,{customPromptController:function(){return A}});var a=i(66084),o=i(52921),s=i(34491),n=i(38172),r=i(92020),l=i(88882),d=i(92347),c=i(76469),h=i(73047),g=i(33381);class p{get promptRenderList(){return this.transformPromptList(this.promptList)}get actionRenderList(){return this.transformPromptList(this.actionList)}get composeActionRenderList(){return this.transformPromptList(this.composeActionList)}get recommendPromptRenderList(){return this.transformPromptList(this.recommendPromptList)}init(){g.userController.ensureHasCachedUserInfo().then(()=>{this.initList({autoUpdate:!1})}).catch(e=>{console.error("unable to init customPromptController"),console.error(e)}),(0,h.U5)(()=>l.a.locale,()=>{this.tryRefreshPromptLibrary(!1)})}initServiceEventListeners(){n.W.on("myPromptsChange",e=>{this.promptList=e}),n.W.on("selectionActionsChange",e=>{this.actionList=e}),n.W.on("composeActionListChange",e=>{this.composeActionList=e}),n.W.on("promptsI18nChange",e=>{this.customPromptI18n=e}),n.W.on("categoryListChange",e=>{this.categoryList=e})}tryForceUpdate(){this.hasForceUpdated||(this.initList({useCache:!1}),this.hasForceUpdated=!0)}async updateCategoryList(){if(this.categoryList.length>0)return;let e=await n.W.getCategoryList();this.categoryList=e}add(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mainWindow",a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.operationData={visible:!0,promptType:e,operation:"add",prompt:this.getEmptyPrompt(a),insertTarget:i},t&&(this.operationData.prompt.content=t)}edit(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mainWindow";this.operationData={visible:!0,promptType:e,operation:"edit",prompt:{...t},insertTarget:i}}async pin(e,t){n.W.updateCustomPrompt(e,{id:t.id,pinned:t.pinned},!0);let i=[];i=e===d.kq.MyPrompt?this.promptList.map(e=>e.id===t.id?{...e,pinned:!!t.pinned}:e):e===d.kq.SelectionAction?this.actionList.map(e=>e.id===t.id?{...e,pinned:!!t.pinned}:e):this.composeActionList.map(e=>e.id===t.id?{...e,pinned:!!t.pinned}:e),n.W.updateCustomPromptCache(e,i)}async hide(e,t){n.W.updateCustomPrompt(e,{id:t.id,hided:t.hided},!0);let i=[];i=e===d.kq.MyPrompt?this.promptList:e===d.kq.SelectionAction?this.actionList:this.composeActionList,n.W.updateCustomPromptCache(e,i)}async sort(e,t,i){await n.W.sortCustomPrompt(e,t,i)}async save(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{operation:t,promptType:i}=this.operationData,a=(0,h.ZN)(this.operationData.prompt);if(a.category||(a.category=this.defaultCategory),"add"===t)await n.W.addCustomPrompt(i,a,e),this.tryRefreshPromptLibrary(!1);else{let e=JSON.parse(JSON.stringify(a));0!==e.baseOnSystemId&&i===d.kq.SelectionAction&&(delete e.name,delete e.iconName),await n.W.updateCustomPrompt(i,e),this.eventEmitter.emit("updatePromptLibrary",a)}}async delete(){let{promptType:e,prompt:t}=this.operationData;await n.W.deleteCustomPrompt(e,t.id),this.tryRefreshPromptLibrary(!1)}hideOperation(){this.operationData.visible=!1}gotoSettingPage(){r.ll.openMonicaOptionsPage({menuKey:"textSelectionTool"})}getPromptCategoryName(e){let t=e||this.defaultCategory,i=this.categoryList.find(e=>e.key===t);return i?i.name:t}tryRefreshPromptLibrary(e){this.eventEmitter.emit("refreshPromptLibrary",{onlyFirstPage:e})}async refreshMyPrompts(){this.myPromptsRefreshed||(n.W.getCustomPrompts(d.kq.MyPrompt,{useCache:!1}),this.myPromptsRefreshed=!0)}async initList(e){this.customPromptI18n=await n.W.getPromptsI18n(e),this.promptList=await n.W.getCustomPrompts(d.kq.MyPrompt,e),this.actionList=await n.W.getCustomPrompts(d.kq.SelectionAction,e),this.composeActionList=await n.W.getCustomPrompts(d.kq.ComposeAction,e),this.recommendPromptList=await n.W.getRecommendPrompts(e)}getEmptyPrompt(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{id:0,name:"",content:"",directSend:!1,baseOnSystemId:0,contentModified:!1,pinned:!1,iconName:"",position:0,isPublic:e,type:"",locale:l.a.locale,usedScenes:["reading_website","edit_text"]}}transformPromptList(e){var t,i;let a=null===(i=this.customPromptI18n)||void 0===i?void 0:null===(t=i.locale)||void 0===t?void 0:t[l.a.locale];return a?e.map(e=>{let t=0!==e.baseOnSystemId,i=e.systemKey?a[e.systemKey]:void 0;return t&&i?{...e,name:e.contentModified?e.name:i.name,content:e.contentModified?e.content:i.content}:e}):e}constructor(){(0,a._)(this,"operationData",{visible:!1,operation:null,promptType:d.kq.SelectionAction,prompt:this.getEmptyPrompt(),insertTarget:"mainWindow"}),(0,a._)(this,"categoryList",[]),(0,a._)(this,"promptList",[]),(0,a._)(this,"actionList",[]),(0,a._)(this,"composeActionList",[]),(0,a._)(this,"recommendPromptList",[]),(0,a._)(this,"customPromptI18n",null),(0,a._)(this,"defaultCategory","other"),(0,a._)(this,"eventEmitter",new c.v),(0,a._)(this,"hasForceUpdated",!1),(0,a._)(this,"myPromptsRefreshed",!1),(0,h.rC)(this)}}(0,o.gn)([s.SB],p.prototype,"operationData",void 0),(0,o.gn)([s.SB],p.prototype,"categoryList",void 0),(0,o.gn)([s.SB],p.prototype,"promptList",void 0),(0,o.gn)([s.SB],p.prototype,"actionList",void 0),(0,o.gn)([s.SB],p.prototype,"composeActionList",void 0),(0,o.gn)([s.SB],p.prototype,"recommendPromptList",void 0),(0,o.gn)([s.SB],p.prototype,"customPromptI18n",void 0),(0,o.gn)([h.Fl],p.prototype,"promptRenderList",null),(0,o.gn)([h.Fl],p.prototype,"actionRenderList",null),(0,o.gn)([h.Fl],p.prototype,"composeActionRenderList",null),(0,o.gn)([h.Fl],p.prototype,"recommendPromptRenderList",null);let A=new p},49795:function(e,t,i){"use strict";i.d(t,{G$:function(){return o},OL:function(){return M},g$:function(){return B}});var a,o,s=i(66084),n=i(52921),r=i(34491),l=i(22046),d=i(47549),c=i(92020),h=i(59133),g=i(5431),p=i(92235),A=i(56607),m=i(60445),u=i(31640),f=i(92660),y=i(32004),v=i(88882),w=i(90107),C=i(73047),b=i(90180),S=i(38172),I=i(63243),_=i(15851),T=i(82715),k=i(33381);let E=["arxiv.org","www.ncbi.nlm.nih.gov","scholar.google.com","doaj.org","ndltd.org","nap.nationalacademies.org","www.base-search.net","digital.library.upenn.edu","library.harvard.edu/digital-collections","digitalcollections.library.yale.edu","lib.msu.edu","earchives.lib.purdue.edu","rucore.libraries.rutgers.edu","library.osu.edu","library.syracuse.edu","library.brown.edu","www.jsu.edu","ota.ahds.ac.uk","ocw.mit.edu","digital.library.sydney.edu.au","catalogue.curtin.edu.au","www.ice.com","www.nasdaq.com","www.londonstockexchange.com","www.tsx.com","www.nasdaqomx.com","www.euronext.com","www.nsx.com.au","www.six-group.com","www.dbag.com","www.deutsche-boerse.com","www.sse.com.cn","www.szse.cn","www.bse.cn","www.twse.com.tw","www.bseindia.com","www.nseindia.com","global.krx.co.kr","www.jpx.co.jp","www.b3.com.br","www.jse.co.za","www.sec.gov","www.uscourts.gov","www.whitehouse.gov","www.wto.org","www.who.int","www.un.org","www.state.gov","dodiac.dtic.mil","www.uscourts.gov","curia.europa.eu","docjax.com","cnki.net","pubmed.cn","www.wanfangdata.com.cn","so.hiqq.com.cn","www.sciencedirect.com","www.oalib.com","www.highwirepress.com","www.infox-med.com","oalib.com","www.researchgate.net","www.sciencedirect.com","link.springer.com","onlinelibrary.wiley.com","www.jstor.org","pubmed.ncbi.nlm.nih.gov","www.arxiv.org","ieeexplore.ieee.org","dl.acm.org","ydzk.chineselaw.com","www.buch-der-synergie.de","plato.stanford.edu","www.sergroup.com","edisciplinas.usp.br","psyarxiv.com","support.castandcrew.com","www.doxis.com","d3v3rcl2jr3rbr.cloudfront.net"],M="system_01";(a=o||(o={})).Regular="normal",a.Turbo="turbo";class x extends d.Y{get pageNum(){return Object.keys(this.pageData).length}init(){this.initTargetLanguage(),this.initLocaleList(),this.initReaction(),this.initListener()}onPageChange(){this.translateViewVisibility&&this.translate()}manualTranslate(){this.translate()}showTranslateTip(){this.tipTimer&&clearTimeout(this.tipTimer),b.A.docChatTranslateTipsShowed||(c.ll.setUiFlag("docChatTranslateTipsShowed",!0),this.translateTipVisible=!0,this.tipTimer=setTimeout(()=>{this.translateTipVisible=!1,this.tipTimer=null},3e3))}async downloadSourceFile(){S.W.createUserBehaviorEvent({eventName:"chatpdf_function_click",extData:{function:"download"}});let e=await fetch(I.docChatController.currentDocInfo.signedUrl),t=await e.blob(),i=URL.createObjectURL(t);p.m.downloadFile(i,I.docChatController.currentDocInfo.name),URL.revokeObjectURL(i)}async downloadTranslateFile(){var e;if(this.downloadingTranslation)return;S.W.createUserBehaviorEvent({eventName:"chatpdf_function_click",extData:{function:"download_translate"}});let t=this.iframe||document.createElement("iframe");t.style.position="fixed",t.style.zIndex="-1",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.pointerEvents="none",t.style.opacity="0.01",t.src=p.m.genUrl("".concat(A.o.host).concat(m.Cl.docPrint),{pdfUrl:I.docChatController.currentDocInfo.signedUrl,from:"auto"===this.sourceLang?g.k.AUTO_DETECT_LANG:this.sourceLang,to:u.q.standardizeLocale(u.q.getLocaleByComposeLanguage(this.targetLang)),pdfName:(null===(e=I.docChatController.currentDocInfo)||void 0===e?void 0:e.name)||""}),t.onerror=t.onabort=()=>{this.cancelDownloadTranslation(),_.M.error("Download failed, please try again.")},this.iframe||(document.body.appendChild(t),this.iframe=t,this.downloadingTranslation=!0)}async cancelDownloadTranslation(){this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this.downloadingTranslation=!1}canRename(e){return e!==M}resetTranslateStatus(){this.hideOriginal=!1,this.translatedPages={},this.translatingPages={},Object.values(this.pageData).forEach(e=>{e.paragraphs.forEach(e=>{e.translateResult=""})}),this.translateViewVisibility=!1,this.cancelDownloadTranslation()}reset(){this.pageSizes=[],this.pageData={},this.currentPage=0,this.screenshotMode=!1,this.resetTranslateStatus()}checkUrlInWhitelist(e){if(!e)return!1;try{let t=new URL(e);return E.includes(t.host)}catch(e){return!1}}changeMode(e){this.activeMode=e,localStorage.setItem(f.storageKeys.chatPdfCtxMode,e)}restQuickPanel(){super.restQuickPanel(),this.quickActionQuestionId=null}updateParagraphExpandHeight(e){var t;let{expandHeight:i,pageIndex:a,paragraph:o}=e,s=null===(t=this.pageData[a])||void 0===t?void 0:t.paragraphs.find(e=>e.id===o.id);s&&(s.expandHeight=i)}initTargetLanguage(){y.f.getProxy(this).add((0,C.U5)(()=>v.a.locale,()=>{this.targetLang=u.q.getComposeLanguageKeyByLocale(v.a.locale)}))}async initLocaleList(){let e=await h.Q.getLocaleList();this.localeList=(0,w.Z)(e,e=>e.locale)}async initReaction(){y.f.getProxy(this).add((0,C.U5)(()=>[this.sourceLang,this.targetLang],()=>{let e=this.translateViewVisibility,t=this.hideOriginal;this.resetTranslateStatus(),this.translateViewVisibility=e,this.hideOriginal=t,this.translateViewVisibility&&this.translate()})),y.f.getProxy(this).add((0,C.U5)(()=>this.currentPage,()=>{this.onPageChange()}))}async initListener(){window.addEventListener("message",e=>{if("doc-print"===e.data.source)switch(e.data.name){case"error":_.M.error(e.data.data),this.cancelDownloadTranslation();break;case"destroy":this.downloadingTranslation=!1,this.cancelDownloadTranslation()}})}async translatePage(e){if(this.translatingPages[e]||this.translatedPages[e]||!this.pageData[e])return null;try{this.translatingPages[e]=!0;let t=I.docChatController.docId,{paragraphs:i}=await T.L.translatePage(this.pageData[e],"auto"===this.sourceLang?g.k.AUTO_DETECT_LANG:this.sourceLang,u.q.standardizeLocale(u.q.getLocaleByComposeLanguage(this.targetLang)),()=>I.docChatController.docId===t);return this.translatedPages[e]=!0,i}finally{this.translatingPages[e]=!1}}async translate(){let e=Date.now(),t=await this.translateAdjacentPage(),i=Math.ceil((Date.now()-e)/1e3),a=0,o=0,s="",n="";t.forEach(e=>{"fulfilled"===e.status&&e.value&&(a++,e.value.length&&(s=s||e.value[0].from,n=n||e.value[0].to,o+=e.value.reduce((e,t)=>e+t.text.length,0)))}),0!==a&&S.W.createUserBehaviorEvent({eventName:"chatpdf_translation",extData:{duration:i,totalChars:o,totalPages:a,sourceLang:s,targetLang:n}})}async translateAdjacentPage(){return k.userController.isFreeUser?(await Promise.allSettled(Array.from({length:5}).map((e,t)=>this.translatePage(t)))).filter(Boolean):(await Promise.allSettled([this.translatePage(this.currentPage-1),this.translatePage(this.currentPage),this.translatePage(this.currentPage+1)])).filter(Boolean)}constructor(){super(),(0,s._)(this,"pdfReadySource",p.m.createReadySource()),(0,s._)(this,"translateViewVisibility",!1),(0,s._)(this,"localeList",[]),(0,s._)(this,"sourceLang","auto"),(0,s._)(this,"targetLang",u.q.getComposeLanguageKeyByLocale(v.a.locale)),(0,s._)(this,"translateTipVisible",!1),(0,s._)(this,"translatingPages",{}),(0,s._)(this,"displayMode","expand"),(0,s._)(this,"currentPage",0),(0,s._)(this,"pageData",{}),(0,s._)(this,"downloadingTranslation",!1),(0,s._)(this,"hideOriginal",!1),(0,s._)(this,"screenshotMode",!1),(0,s._)(this,"autoOpenTranslate",!1),(0,s._)(this,"pageSizes",[]),(0,s._)(this,"activeMode","normal"),(0,s._)(this,"quickActionQuestionId",null),(0,s._)(this,"iframe",null),(0,s._)(this,"tipTimer",null),(0,s._)(this,"translatedPages",{}),(0,s._)(this,"handleTranslateToolbarClick",()=>{this.translateViewVisibility?this.resetTranslateStatus():(S.W.createUserBehaviorEvent({eventName:"chatpdf_function_click",extData:{function:"translate"}}),this.translateViewVisibility=!0,this.showTranslateTip(),this.translate())}),(0,C.rC)(this),l.S.isRunInServerSide||(this.activeMode=localStorage.getItem(f.storageKeys.chatPdfCtxMode)||"normal")}}(0,n.gn)([r.SB],x.prototype,"translateViewVisibility",void 0),(0,n.gn)([r.SB],x.prototype,"localeList",void 0),(0,n.gn)([r.SB],x.prototype,"sourceLang",void 0),(0,n.gn)([r.SB],x.prototype,"targetLang",void 0),(0,n.gn)([r.SB],x.prototype,"translateTipVisible",void 0),(0,n.gn)([r.SB],x.prototype,"translatingPages",void 0),(0,n.gn)([r.SB],x.prototype,"displayMode",void 0),(0,n.gn)([r.SB],x.prototype,"currentPage",void 0),(0,n.gn)([r.SB],x.prototype,"pageData",void 0),(0,n.gn)([r.SB],x.prototype,"downloadingTranslation",void 0),(0,n.gn)([r.SB],x.prototype,"hideOriginal",void 0),(0,n.gn)([r.SB],x.prototype,"screenshotMode",void 0),(0,n.gn)([r.SB],x.prototype,"autoOpenTranslate",void 0),(0,n.gn)([r.SB],x.prototype,"pageSizes",void 0),(0,n.gn)([r.SB],x.prototype,"activeMode",void 0),(0,n.gn)([r.SB],x.prototype,"quickActionQuestionId",void 0),(0,n.gn)([r.Fl],x.prototype,"pageNum",null);let B=new x},63243:function(e,t,i){"use strict";i.d(t,{docChatController:function(){return p}});var a=i(66084),o=i(52921),s=i(34491),n=i(92235),r=i(56607),l=i(73047),d=i(38172),c=i(18245),h=i(90230);class g{get docId(){return this._docId}get thumbnailVisible(){return!this.isThumbnailCollapsed}get isInDocChatPage(){return!!this.docId}get enterFromShare(){return"share"===n.m.getUrlParams().source}get featConfig(){return{headerCollapseVisible:!this.enterFromShare,enableRename:this.docId&&!this.enterFromShare}}docChatQuotaCheck(){let e=c.K.checkCredits({module:"reading_pdf",source:"chatpdf_upload_num_limit"});if(!e.isEnough)return e.handleCreditsNotEnough(),!1;let t=c.K.checkCredits({module:"basic_query",source:"chatpdf_chat_query_quota_exceeded",featureName:"pdfQueryLimit"});return!!t.isEnough||(t.handleCreditsNotEnough(),!1)}saveDocChatToMemo(e,t){let i={type:"pdfReading",originalUrl:this.genWebPdfUrl(e.pdfId),originalTitle:e.name||"",originalExtId:e.pdfId||"",originalContentMd5:"",summary:t,articleSummary:t,fromReadingPdf:!0};h.a.createFromEmbed({embedData:i})}init(e,t){if(this.chatController=e,this.docChatPageController=t,e.setCustomReplySourceClickHandler(e=>{var t;let{pdfLinePosList:i,sourcePage:a}=e;if(a){this.pdfHighlights=[{pageIndex:a-1,left:0,top:0,width:0,height:0}],this.jumpToHighlight(this.pdfHighlights[0]);return}if(i&&(null===(t=i[0])||void 0===t?void 0:t.length)===5){this.pdfHighlights=i.map(e=>{let[t,i,a,o,s]=e;return{pageIndex:t-1,left:i,top:a,width:o-i,height:s-a}}).sort((e,t)=>e.pageIndex!==t.pageIndex?e.pageIndex-t.pageIndex:e.top-t.top),this.jumpToHighlight(this.pdfHighlights[0]);return}this.views.openReplySourceDialog({insertTarget:"mainWindow",content:e.text})}),r.o.isDesktop)return;let i=n.m.getUrlParams();this.setDocId(i.doc_id),this.isSidebarCollapsed="share"===i.source||!!i.doc_id&&"pdf_translation"===i.action}setSelectedTextForIntent(e){this.chatController.onSelectedTextChange(e)}clearHighlights(){this.pdfHighlights=[]}genWebPdfUrl(e){return n.m.getChatDocPageUrl(e?{doc_id:e}:{})}updateConversationLoadingStatus(e){this.loadConversationLoading=e}collapseSidebarAndChatView(){this.isSidebarCollapsed=!0,this.isChatViewCollapsed=!0,this.isThumbnailCollapsed=!0}setViews(e){this.views=e}setCurrentDocInfo(e){this.currentDocInfo=e,document.title="ChatPDF | ".concat(e.name)}setDocId(e){if(e!==this.docId){if(this._docId=e||"",this.clearHighlights(),this.docChatPageController.reset(),e){let t=new URL(location.href),i=t.searchParams.get("utm");(t=n.m.clearUrlParams(location.href)).searchParams.append("doc_id",e),i&&t.searchParams.append("utm",i),history.replaceState(null,"",t.toString()),this.pdfOpenStartTime=performance.now()}else{let e=new URL(location.href);e.searchParams.delete("doc_id"),history.replaceState(null,"",e.toString()),this.currentDocInfo=null,this.isSidebarCollapsed=!1}}}statPdfOpenPerf(){if(0===this.pdfOpenStartTime||!this.currentDocInfo)return;let e=performance.now()-this.pdfOpenStartTime;d.W.createUserBehaviorEvent({eventName:"chatpdf_load_pdf",extData:{loadTime:e,size:this.currentDocInfo.size,pages:this.docChatPageController.pageNum}}),this.pdfOpenStartTime=0}async sendPdfQuestion(){if(!this.currentDocInfo)throw Error("No pdf info");let{uid:e,name:t,size:i,signedUrl:a}=this.currentDocInfo;this.chatController.shouldCreateTitle=!0,await this.chatController.sendQuestionOrAction({questionType:"chat_pdf",chatPdfWithGenMindMap:this.generateMindMap,pdfInfos:[{pdfId:e,fileSize:i,fileName:t,fileCdnUrl:a}],actionOrQuestion:"PDF"})}async newPdfChat(){let e=this.chatController.renderItems.find(e=>"chat_pdf"===e.data.type),t=this.chatController.renderItems.find(t=>t.parentItemId===(null==e?void 0:e.itemId)),i=this.chatController.renderItems[0],a=this.chatController.renderItems.find(e=>"reply"===e.itemType&&"read_enhance"===e.data.type&&e.parentItemId===i.itemId);await this.chatController.newConversation();let o=this.chatController.renderItems[0];if(!e&&a&&this.currentDocInfo){let e=this.chatController.createQuestion("",o.itemId,"chat_pdf",{pdfInfos:[{pdfId:this.currentDocInfo.uid,fileSize:this.currentDocInfo.size,fileName:this.currentDocInfo.name,fileCdnUrl:this.currentDocInfo.signedUrl,fileObjectUrl:this.currentDocInfo.signedUrl}]}),t=this.chatController.createReply(a.data.content,e.itemId,a.data);this.chatController.chatTree.addItems([e,t])}else{if(!e||!t||!o)return;let i=this.chatController.createQuestion("",o.itemId,"chat_pdf",e.data),a=this.chatController.createReply(t.data.content,i.itemId,t.data);this.chatController.chatTree.addItems([i,a])}this.chatController.conversationInfo&&(this.chatController.conversationInfo.items=this.chatController.renderItems),this.chatController.scrollManager.scrollToBottom()}constructor(){(0,a._)(this,"views",void 0),(0,a._)(this,"pdfHighlights",[]),(0,a._)(this,"currentDocInfo",null),(0,a._)(this,"isSidebarCollapsed",!1),(0,a._)(this,"isChatViewCollapsed",!1),(0,a._)(this,"isThumbnailCollapsed",!1),(0,a._)(this,"loadConversationLoading",!1),(0,a._)(this,"generateMindMap",!1),(0,a._)(this,"_docId",""),(0,a._)(this,"loadFromHistory",!1),(0,a._)(this,"chatController",void 0),(0,a._)(this,"docChatPageController",void 0),(0,a._)(this,"jumpToHighlight",null),(0,a._)(this,"pdfOpenStartTime",0),(0,l.ky)(this)}}(0,o.gn)([s.SB],g.prototype,"pdfHighlights",void 0),(0,o.gn)([s.SB],g.prototype,"currentDocInfo",void 0),(0,o.gn)([s.SB],g.prototype,"isSidebarCollapsed",void 0),(0,o.gn)([s.SB],g.prototype,"isChatViewCollapsed",void 0),(0,o.gn)([s.SB],g.prototype,"isThumbnailCollapsed",void 0),(0,o.gn)([s.SB],g.prototype,"loadConversationLoading",void 0),(0,o.gn)([s.SB],g.prototype,"generateMindMap",void 0),(0,o.gn)([s.SB],g.prototype,"_docId",void 0),(0,o.gn)([s.SB],g.prototype,"loadFromHistory",void 0),(0,o.gn)([l.Fl],g.prototype,"docId",null),(0,o.gn)([l.Fl],g.prototype,"thumbnailVisible",null),(0,o.gn)([l.Fl],g.prototype,"enterFromShare",null),(0,o.gn)([l.Fl],g.prototype,"featConfig",null);let p=new g},1159:function(e,t,i){"use strict";i.d(t,{h:function(){return S}});var a=i(66084),o=i(52921),s=i(34491),n=i(88575),r=i(76469);class l{isContentEmpty(e){if(!e)return!0;if(this.isBasicInput(e))return""===e.value;let t=0;for(let i of e.childNodes)if(!(i instanceof HTMLBRElement)||(t+=1)>1)return!1;return!0}isBasicInput(e){return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement}}let d=new l;var c=i(92235),h=i(28901),g=i(74145),p=i(31284),A=i(20978),m=i(73047),u=i(39160),f=i(22046);let y={targetConfig:{contentEditable:[{site:"feishu",matcher:/https?:\/\/.*\.feishu.cn\/docx\/.*/,realTargetSelector:".page-block-children .render-unit-wrapper"}]}},v={attributes:["data-language","data-enable-monica=false"]},w={isMatch(e){let t=f.S.location,{host:i,paths:a}=e;return t.hostname===i&&(!a||a.some(e=>t.pathname.includes(e)))},get isBlackSite(){return[{host:"www.google.com",paths:["/search"]}].some(this.isMatch)},get isSkipHeightCheck(){return[{host:"translate.google.com"},{host:"chatgpt.com"}].some(this.isMatch)}},C=n.c.getLogger("EditableController");class b extends r.v{get isTargetContentEmpty(){if(!this.targetInfo)throw Error("no target");return d.isContentEmpty(this.targetInfo.el)}get whenReady(){return this._whenReady.promise}init(e){this.initFinished||(this.rootContainer=e,C.debug("editableController init"),this.addGlobalListeners(),this.initFinished=!0,this._whenReady.resolve())}updateRootContainer(e){this.rootContainer=e}destroy(){this.disposableCollection.dispose(),this.targetInfo=null,this.targetRange=null}lockTarget(){if(!this.targetInfo)throw Error("cannot lock target when no targetInfo");this.targetLocked=!0}unlockTarget(){this.targetLocked=!1}isInMonicaRoot(e){var t,i;if(this.rootContainer===e)return!0;let a=null!==(i=null===(t=this.rootContainer)||void 0===t?void 0:t.shadowRoot)&&void 0!==i?i:this.rootContainer;return a===e||(null==a?void 0:a.contains(e))}checkEditableElement(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isIgnoreElement(e)||w.isBlackSite||!i&&this.isInMonicaRoot(e)||e.dataset.monicaIgnore||e.getAttribute(u.SB))return!1;let a=getComputedStyle(e);if("editor"===t){let t=e instanceof HTMLTextAreaElement;if(!e.isContentEditable&&!t)return!1;let{width:i,height:o}=e.getBoundingClientRect();if(i<150)return!1;let s=parseInt(a.paddingTop)+parseInt(a.paddingBottom),n=parseInt(a.fontSize),r=o-s<1.5*("normal"===a.lineHeight?1.2*n:parseInt(a.lineHeight));if(t&&r&&!w.isSkipHeightCheck||e.className.includes("search")&&r)return!1}if("0"===a.opacity||"none"===a.display||"hidden"===a.visibility)return!1;let o={realTarget:e,type:this.getEditableElementType(e)};if(e.isContentEditable){let t=y.targetConfig.contentEditable.find(e=>e.matcher.test(location.href));t&&(o.realTarget=e.querySelector(t.realTargetSelector))}return o}checkNodeInEditable(e){if(!this.targetInfo)return!1;let t=this.targetInfo.originalEl;return!!(this.targetInfo.originalEl===e||this.targetInfo.originalEl.contains(e))&&this.checkEditableElement(t,"editor",!0)}getEditableElementType(e){if(e instanceof HTMLInputElement)return"input";if(e instanceof HTMLTextAreaElement)return"textarea";if(e.isContentEditable)return"contenteditable";throw TypeError("not editable element")}async replaceText(e){let{type:t,text:i,inputEl:a,replaceOffset:o=0}=e;if("replaceAll"===t?a&&await this.selectAll(a):"replaceSelection"===t&&this.restoreRange(),o<0){let e=this.targetInfo.el;if(d.isBasicInput(e))e.setSelectionRange(e.selectionEnd+o,e.selectionEnd);else{let e=this.selectDocument.getSelection().getRangeAt(0);e.setStart(e.endContainer,Math.max(0,e.endOffset+o))}}a&&"true"===a.getAttribute("data-lexical-editor")&&(document.execCommand("cut"),await c.m.delay(100)),document.execCommand("insertText",!1,i)}insertText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("contentEditable"===this.restoreRange(t)){let e=window.getSelection();e&&e.getRangeAt(0).collapse(!1)}document.execCommand("insertText",!1,e)}insertTextToRichEditor(e,t){var i,a,o;let s=new ClipboardEvent("paste",{clipboardData:new DataTransfer,bubbles:!0,cancelable:!0});null===(i=s.clipboardData)||void 0===i||i.setData("text/plain",e),t?(t.focus(),t.dispatchEvent(s)):null===(o=this.targetInfo)||void 0===o||null===(a=o.el)||void 0===a||a.dispatchEvent(s)}focusTarget(){this.targetInfo&&this.restoreRange()}unsetTarget(){this.hasInsertTarget=!1;let e=this.targetInfo;e&&!this.targetLocked&&(this.targetInfo=null,C.debug("unset target"),this.emit("targetChange",{target:null,oldTarget:e}))}async selectAll(e){if(e.focus(),e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)e.setSelectionRange(0,e.value.length);else if(e.isContentEditable){let t=this.selectDocument.createRange();t.selectNodeContents(e);let i=this.selectDocument.getSelection();i&&(i.removeAllRanges(),i.addRange(t),await c.m.delay(100),document.execCommand("selectAll"))}}isIgnoreElement(e){let{attributes:t}=v;return t.some(t=>{if(-1!==t.indexOf("=")){let[i,a]=t.split("=");return e.getAttribute(i)===a}return e.hasAttribute(t)})}addGlobalListeners(){let e=new MutationObserver(()=>{h.x.findAccessibleDocuments().forEach(e=>{if(!this.documentsMap.has(e)){let t=(0,A.Z)(()=>{this.handleSelectionChange(e)},10);this.documentsMap.set(e,!0),e.addEventListener("selectionchange",t),this.disposableCollection.push({dispose(){e.removeEventListener("selectionchange",t)}})}})});e.observe(document.body,{childList:!0,subtree:!0}),this.disposableCollection.push({dispose(){e.disconnect()}})}handleSelectionChange(e){var t;this.selectDocument=e;let i=this.getSelectedNode();if(C.debug("handle selection change",i),!i)return;let[a,o]=i;if(null===(t=this.rootContainer)||void 0===t?void 0:t.contains(a))return;let s=this.findSelectedEditableElement(a);if((null==s?void 0:s.id)==="copy-to-clipboard")return;if(!(null==s?void 0:s.contains(o)))return this.unsetTarget();let n=this.checkEditableElement(s,"allInput",!0);if(!n)return this.unsetTarget();let r=this.setTarget(s,n.realTarget),l=this.saveRange();this.hasInsertTarget=!0,this.emit("targetSelectionChange",{target:r,range:l})}findSelectedEditableElement(e){var t,i;if(d.isBasicInput(e))return e;if(e instanceof HTMLElement){if(!e.isContentEditable)return null;if(!(null===(i=e.parentElement)||void 0===i?void 0:i.isContentEditable))return e}else if(!e.parentElement.isContentEditable)return null;let a=e.parentElement;for(;null===(t=a.parentElement)||void 0===t?void 0:t.isContentEditable;)a=a.parentElement;return a}setTarget(e,t){let i=this.targetInfo,a={originalEl:e,el:t,type:this.getEditableElementType(t),selectDocument:this.selectDocument};return a.el===(null==i?void 0:i.el)?i:(this.targetInfo=a,this.addTargetEventListeners(),C.debug("set target",a),this.emit("targetChange",{target:a,oldTarget:i}),a)}addTargetEventListeners(){let e="listenerAdded_".concat(this.sessionId),t=this.targetInfo.el;t.dataset[e]||(t.dataset[e]="true",t.addEventListener("input",e=>{this.targetInfo&&this.targetInfo.el===e.target&&(this.saveRange(),C.debug("targetInput emit"),this.emit("targetInput",{target:this.targetInfo,evt:e}))}),t.addEventListener("scroll",(0,A.Z)(e=>{this.targetInfo&&this.targetInfo.el===e.target&&(C.debug("target scroll emit"),this.emit("targetScroll",{target:this.targetInfo,evt:e}))},5)),t.addEventListener("keydown",e=>{this.targetInfo&&this.targetInfo.el===e.target&&(C.debug("target keydown emit"),this.emit("targetKeydown",{target:this.targetInfo,evt:e}))}))}saveRange(){let e,t,i;let a=this.targetInfo.el,o=this.selectDocument.getSelection(),s=o.getRangeAt(0).cloneRange();C.debug("save range",s),d.isBasicInput(a)?(e=a.selectionStart,t=a.selectionEnd,i=a.selectionStart===a.selectionEnd):(e=null,t=null,i=o.isCollapsed);let n={range:s,input:a,isCollapsed:i,selectionOffset:e,selectionOffsetEnd:t};return this.targetRange=n,n}restoreRange(e){let t=e||this.targetRange;if(C.debug("restore range",t),!t)return;let{input:i,range:a}=t;if(d.isBasicInput(i))return i.focus(),i.setSelectionRange(t.selectionOffset,t.selectionOffsetEnd),"basicInput";{let e=this.selectDocument.getSelection();return e&&(e.removeAllRanges(),e.addRange(a)),"contentEditable"}}getSelectedNode(){let e=this.selectDocument.getSelection();if(!e||0===e.rangeCount)return null;let t=e.getRangeAt(0);return[t.startContainer.childNodes[t.startOffset]||t.startContainer,t.endContainer.childNodes[t.endOffset]||t.endContainer]}constructor(){super(),(0,a._)(this,"hasInsertTarget",!1),(0,a._)(this,"targetInfo",null),(0,a._)(this,"targetRange",null),(0,a._)(this,"targetLocked",!1),(0,a._)(this,"rootContainer",void 0),(0,a._)(this,"initFinished",!1),(0,a._)(this,"sessionId",c.m.genId(!0)),(0,a._)(this,"disposableCollection",new g.K),(0,a._)(this,"documentsMap",new Map),(0,a._)(this,"selectDocument",globalThis.document),(0,a._)(this,"_whenReady",new p.B),(0,m.rC)(this)}}(0,o.gn)([s.SB],b.prototype,"hasInsertTarget",void 0),(0,o.gn)([s.SB],b.prototype,"targetInfo",void 0),(0,o.gn)([s.SB],b.prototype,"targetRange",void 0);let S=new b},446:function(e,t,i){"use strict";var a,o;i.d(t,{Ns:function(){return s},T:function(){return n},WT:function(){return a}}),(o=a||(a={}))[o.running=-1]="running",o[o.success=0]="success",o[o.queue=3]="queue";let s={removeBackground:"image_tools_remove_background",imageGenerator:"image_tools_generate_image",removeText:"image_tools_remove_text",upscale:"image_tools_upscale",changeBackground:"image_tools_change_background",removeBrushedArea:"image_tools_remove_object",removeObject:"image_tools_remove_object",imageAnimator:e=>e(),generateImageByScenario:"image_tools_generate_image_by_scenario",template:"image_tools_template",realtimeGenerateImageByText:"image_tools_realtime_generate_image_by_text",realtimeGenerateImageByCanvas:"image_tools_realtime_generate_image_by_canvas",editImage:""},n={replaceImageBgForm:{color:"",prompt:"",originUrl:""},removeImageBgForm:{originUrl:""},upscaleImageForm:{originUrl:"",width:0,height:0},removeObjectForm:{originUrl:"",maskUrl:"",taskType:"inpainting_mask"},removeRemoveBrushedArea:{originUrl:"",maskUrl:"",taskType:"inpainting_mask"},removeTextForm:{originUrl:""},editImageForm:{originUrl:""},generateImageForm:{imageCount:1,prompt:"",modelType:"gpt-image-1",aspectRatio:"1:1",imageStyle:"auto"},generateVideoForm:{seed:"0",cfgScale:"2",duration:"2",modelType:"svd",originUrl:"",generateFrom:"image",motionBucketId:"40"},generateImageByScenarioForm:{imageScene:"logo",prompt:"",aspectRatio:"1:1",imageCount:1,modelType:"playground2_5",imageStyle:"auto"},templateForm:{template:"onediff_old_photo_restore",originUrl:""},realtimeGenerateByCanvasForm:{imageStyle:"auto",cfgScale:"5",imgBase64:"",prompt:""},realtimeGenerateByTextForm:{imageStyle:"auto",prompt:""}}},8621:function(e,t,i){"use strict";i.d(t,{imageController:function(){return eU}});var a,o,s,n,r,l=i(66084),d=i(52921),c=i(34491),h=i(22046),g=i(33381),p=i(71576),A=i(58812);class m extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var u=JSON.parse('{"fill":"none","content":"\\n<g id=\\"square\\">\\n<path id=\\"Vector\\" fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M6.46809 1.75H13.5309C14.2043 1.74999 14.755 1.74998 15.2026 1.78655C15.6658 1.8244 16.0842 1.90514 16.475 2.10423C17.0865 2.41582 17.5837 2.913 17.8953 3.52453C18.0944 3.91527 18.1751 4.33367 18.213 4.79693C18.2495 5.2445 18.2495 5.7952 18.2495 6.46858V13.5314C18.2495 14.2048 18.2495 14.7555 18.213 15.2031C18.1751 15.6663 18.0944 16.0847 17.8953 16.4755C17.5837 17.087 17.0865 17.5842 16.475 17.8958C16.0842 18.0949 15.6658 18.1756 15.2026 18.2134C14.755 18.25 14.2043 18.25 13.5309 18.25H6.46809C5.79471 18.25 5.24401 18.25 4.79644 18.2134C4.33318 18.1756 3.91478 18.0949 3.52404 17.8958C2.91252 17.5842 2.41533 17.087 2.10374 16.4755C1.90465 16.0847 1.82391 15.6663 1.78606 15.2031C1.7495 14.7555 1.7495 14.2048 1.74951 13.5314V6.46858C1.7495 5.7952 1.7495 5.2445 1.78606 4.79693C1.82391 4.33367 1.90465 3.91527 2.10374 3.52453C2.41533 2.913 2.91252 2.41582 3.52404 2.10423C3.91478 1.90514 4.33318 1.8244 4.79644 1.78655C5.24401 1.74998 5.79472 1.74999 6.46809 1.75ZM4.91859 3.28157C4.54809 3.31184 4.34907 3.36735 4.20503 3.44074C3.87575 3.60852 3.60803 3.87623 3.44025 4.20552C3.36686 4.34956 3.31135 4.54858 3.28108 4.91908C3.2501 5.29833 3.24951 5.78756 3.24951 6.5V13.5C3.24951 14.2124 3.2501 14.7017 3.28108 15.0809C3.31135 15.4514 3.36686 15.6504 3.44025 15.7945C3.60803 16.1238 3.87575 16.3915 4.20503 16.5593C4.34907 16.6327 4.54809 16.6882 4.91859 16.7184C5.29785 16.7494 5.78707 16.75 6.49951 16.75H13.4995C14.212 16.75 14.7012 16.7494 15.0804 16.7184C15.4509 16.6882 15.65 16.6327 15.794 16.5593C16.1233 16.3915 16.391 16.1238 16.5588 15.7945C16.6322 15.6504 16.6877 15.4514 16.7179 15.0809C16.7489 14.7017 16.7495 14.2124 16.7495 13.5V6.5C16.7495 5.78756 16.7489 5.29833 16.7179 4.91908C16.6877 4.54858 16.6322 4.34956 16.5588 4.20552C16.391 3.87623 16.1233 3.60852 15.794 3.44074C15.65 3.36735 15.4509 3.31184 15.0804 3.28157C14.7012 3.25058 14.212 3.25 13.4995 3.25H6.49951C5.78707 3.25 5.29785 3.25058 4.91859 3.28157Z\\" fill=\\"#55555D\\"/>\\n</g>\\n\\n","viewBox":"0 0 20 20"}');let f=c._Y.createComponent("AspectRatio11Icon",m,e=>(0,p.jsx)(A.s,{...e.props,name:"AspectRatio11Icon",iconData:u}));class y extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var v=JSON.parse('{"fill":"none","content":"\\n<g id=\\"rectangle-03\\">\\n<path id=\\"Vector\\" fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M8.96809 0.916748H11.0309C11.7043 0.91674 12.255 0.916732 12.7026 0.9533C13.1658 0.99115 13.5842 1.07189 13.975 1.27098C14.5865 1.58257 15.0837 2.07975 15.3953 2.69128C15.5944 3.08202 15.6751 3.50042 15.713 3.96368C15.7495 4.41124 15.7495 4.96195 15.7495 5.63533V14.3648C15.7495 15.0382 15.7495 15.5889 15.713 16.0365C15.6751 16.4997 15.5944 16.9181 15.3953 17.3089C15.0837 17.9204 14.5865 18.4176 13.975 18.7292C13.5842 18.9283 13.1658 19.009 12.7026 19.0469C12.255 19.0834 11.7043 19.0834 11.0309 19.0834H8.96809C8.29471 19.0834 7.74401 19.0834 7.29644 19.0469C6.83318 19.009 6.41478 18.9283 6.02404 18.7292C5.41252 18.4176 4.91533 17.9204 4.60374 17.3089C4.40465 16.9181 4.32391 16.4997 4.28606 16.0365C4.2495 15.5889 4.2495 15.0382 4.24951 14.3648V5.63533C4.2495 4.96195 4.2495 4.41124 4.28606 3.96368C4.32391 3.50042 4.40465 3.08202 4.60374 2.69128C4.91533 2.07975 5.41252 1.58257 6.02404 1.27098C6.41478 1.07189 6.83318 0.99115 7.29644 0.9533C7.74401 0.916732 8.29472 0.91674 8.96809 0.916748ZM7.41859 2.44832C7.04809 2.47859 6.84907 2.5341 6.70503 2.60749C6.37575 2.77527 6.10803 3.04298 5.94025 3.37227C5.86686 3.5163 5.81135 3.71533 5.78108 4.08583C5.7501 4.46508 5.74951 4.95431 5.74951 5.66675V14.3334C5.74951 15.0459 5.7501 15.5351 5.78108 15.9143C5.81135 16.2848 5.86686 16.4839 5.94025 16.6279C6.10803 16.9572 6.37575 17.2249 6.70503 17.3927C6.84907 17.4661 7.04809 17.5216 7.41859 17.5518C7.79785 17.5828 8.28707 17.5834 8.99951 17.5834H10.9995C11.712 17.5834 12.2012 17.5828 12.5804 17.5518C12.9509 17.5216 13.15 17.4661 13.294 17.3927C13.6233 17.2249 13.891 16.9572 14.0588 16.6279C14.1322 16.4839 14.1877 16.2848 14.2179 15.9143C14.2489 15.5351 14.2495 15.0459 14.2495 14.3334V5.66675C14.2495 4.95431 14.2489 4.46508 14.2179 4.08583C14.1877 3.71533 14.1322 3.5163 14.0588 3.37227C13.891 3.04298 13.6233 2.77527 13.294 2.60749C13.15 2.5341 12.9509 2.47859 12.5804 2.44832C12.2012 2.41733 11.712 2.41675 10.9995 2.41675H8.99951C8.28707 2.41675 7.79785 2.41733 7.41859 2.44832Z\\" fill=\\"#55555D\\"/>\\n</g>\\n\\n","viewBox":"0 0 20 20"}');let w=c._Y.createComponent("AspectRatio916Icon",y,e=>(0,p.jsx)(A.s,{...e.props,name:"AspectRatio916Icon",iconData:v}));class C extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var b=JSON.parse('{"fill":"none","content":"\\n<g id=\\"rectangle-04\\">\\n<path id=\\"Vector\\" fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M5.63509 4.25H14.3646C15.038 4.24999 15.5887 4.24998 16.0362 4.28655C16.4995 4.3244 16.9179 4.40514 17.3086 4.60423C17.9202 4.91582 18.4174 5.413 18.7289 6.02453C18.928 6.41527 19.0088 6.83367 19.0466 7.29693C19.0832 7.7445 19.0832 8.2952 19.0832 8.96858V11.0314C19.0832 11.7048 19.0832 12.2555 19.0466 12.7031C19.0088 13.1663 18.928 13.5847 18.7289 13.9755C18.4174 14.587 17.9202 15.0842 17.3086 15.3958C16.9179 15.5949 16.4995 15.6756 16.0362 15.7134C15.5887 15.75 15.038 15.75 14.3646 15.75H5.63508C4.96171 15.75 4.411 15.75 3.96344 15.7134C3.50017 15.6756 3.08178 15.5949 2.69104 15.3958C2.07951 15.0842 1.58232 14.587 1.27073 13.9755C1.07164 13.5847 0.990906 13.1663 0.953056 12.7031C0.916488 12.2555 0.916495 11.7048 0.916504 11.0314V8.96858C0.916495 8.2952 0.916488 7.7445 0.953056 7.29693C0.990906 6.83367 1.07164 6.41527 1.27073 6.02453C1.58232 5.413 2.07951 4.91582 2.69104 4.60423C3.08178 4.40514 3.50017 4.3244 3.96344 4.28655C4.411 4.24998 4.96171 4.24999 5.63509 4.25ZM4.08558 5.78157C3.71508 5.81184 3.51606 5.86735 3.37202 5.94074C3.04274 6.10852 2.77502 6.37623 2.60724 6.70552C2.53385 6.84956 2.47835 7.04858 2.44807 7.41908C2.41709 7.79833 2.4165 8.28756 2.4165 9V11C2.4165 11.7124 2.41709 12.2017 2.44807 12.5809C2.47835 12.9514 2.53385 13.1504 2.60724 13.2945C2.77502 13.6238 3.04274 13.8915 3.37202 14.0593C3.51606 14.1327 3.71508 14.1882 4.08558 14.2184C4.46484 14.2494 4.95406 14.25 5.6665 14.25H14.3332C15.0456 14.25 15.5348 14.2494 15.9141 14.2184C16.2846 14.1882 16.4836 14.1327 16.6277 14.0593C16.9569 13.8915 17.2247 13.6238 17.3924 13.2945C17.4658 13.1504 17.5213 12.9514 17.5516 12.5809C17.5826 12.2017 17.5832 11.7124 17.5832 11V9C17.5832 8.28756 17.5826 7.79833 17.5516 7.41908C17.5213 7.04858 17.4658 6.84956 17.3924 6.70552C17.2247 6.37623 16.9569 6.10852 16.6277 5.94074C16.4836 5.86735 16.2846 5.81184 15.9141 5.78157C15.5348 5.75058 15.0456 5.75 14.3332 5.75H5.6665C4.95406 5.75 4.46484 5.75058 4.08558 5.78157Z\\" fill=\\"#6841EA\\"/>\\n</g>\\n\\n","viewBox":"0 0 20 20"}');let S=c._Y.createComponent("AspectRatio169Icon",C,e=>(0,p.jsx)(A.s,{...e.props,name:"AspectRatio169Icon",iconData:b}));class I extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var _=JSON.parse('{"fill":"none","content":"\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M6.46858 1.75H13.5314C14.2048 1.74999 14.7555 1.74998 15.2031 1.78655C15.6663 1.8244 16.0847 1.90514 16.4755 2.10423C17.087 2.41582 17.5842 2.913 17.8958 3.52453C18.0949 3.91527 18.1756 4.33367 18.2134 4.79693C18.25 5.2445 18.25 5.7952 18.25 6.46858V13.5314C18.25 14.2048 18.25 14.7555 18.2134 15.2031C18.1756 15.6663 18.0949 16.0847 17.8958 16.4755C17.5842 17.087 17.087 17.5842 16.4755 17.8958C16.0847 18.0949 15.6663 18.1756 15.2031 18.2134C14.7555 18.25 14.2048 18.25 13.5314 18.25H6.46858C5.7952 18.25 5.2445 18.25 4.79693 18.2134C4.33367 18.1756 3.91527 18.0949 3.52453 17.8958C2.913 17.5842 2.41582 17.087 2.10423 16.4755C1.90514 16.0847 1.8244 15.6663 1.78655 15.2031C1.74998 14.7555 1.74999 14.2048 1.75 13.5314V6.46858C1.74999 5.7952 1.74998 5.2445 1.78655 4.79693C1.8244 4.33367 1.90514 3.91527 2.10423 3.52453C2.41582 2.913 2.913 2.41582 3.52453 2.10423C3.91527 1.90514 4.33367 1.8244 4.79693 1.78655C5.2445 1.74998 5.7952 1.74999 6.46858 1.75ZM3.25 9.91667V13.5C3.25 14.2124 3.25058 14.7017 3.28157 15.0809C3.31184 15.4514 3.36735 15.6504 3.44074 15.7945C3.60852 16.1238 3.87623 16.3915 4.20552 16.5593C4.34956 16.6327 4.54858 16.6882 4.91908 16.7184C5.29833 16.7494 5.78756 16.75 6.5 16.75H11.75V9.91667H3.25ZM11.75 8.41667H3.25V6.5C3.25 5.78756 3.25058 5.29833 3.28157 4.91908C3.31184 4.54858 3.36735 4.34956 3.44074 4.20552C3.60852 3.87623 3.87623 3.60852 4.20552 3.44074C4.34956 3.36735 4.54858 3.31184 4.91908 3.28157C5.29833 3.25058 5.78756 3.25 6.5 3.25H11.75V8.41667ZM13.25 16.75H13.5C14.2124 16.75 14.7017 16.7494 15.0809 16.7184C15.4514 16.6882 15.6504 16.6327 15.7945 16.5593C16.1238 16.3915 16.3915 16.1238 16.5593 15.7945C16.6327 15.6504 16.6882 15.4514 16.7184 15.0809C16.7494 14.7017 16.75 14.2124 16.75 13.5V6.5C16.75 5.78756 16.7494 5.29833 16.7184 4.91908C16.6882 4.54858 16.6327 4.34956 16.5593 4.20552C16.3915 3.87623 16.1238 3.60852 15.7945 3.44074C15.6504 3.36735 15.4514 3.31184 15.0809 3.28157C14.7017 3.25058 14.2124 3.25 13.5 3.25H13.25V16.75Z\\" fill=\\"#595959\\"/>\\n\\n","viewBox":"0 0 20 20"}');let T=c._Y.createComponent("AspectRatioCustomIcon",I,e=>(0,p.jsx)(A.s,{...e.props,name:"AspectRatioCustomIcon",iconData:_}));class k extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var E=JSON.parse('{"fill":"none","content":"\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M5.39683 1.75004C5.43072 1.75005 5.46511 1.75007 5.50001 1.75007C5.91422 1.75007 6.25001 2.08586 6.25001 2.50007C6.25001 2.91429 5.91422 3.25007 5.50001 3.25007C4.75425 3.25007 4.52849 3.25651 4.36178 3.30118C3.84414 3.43988 3.43982 3.84421 3.30112 4.36184C3.25645 4.52855 3.25001 4.75431 3.25001 5.50007C3.25001 5.91429 2.91422 6.25007 2.50001 6.25007C2.0858 6.25007 1.75001 5.91429 1.75001 5.50007C1.75001 5.46517 1.74999 5.43078 1.74997 5.39689C1.74965 4.80035 1.74941 4.35735 1.85223 3.97362C2.12964 2.93834 2.93828 2.1297 3.97355 1.85229C4.35729 1.74947 4.80029 1.74971 5.39683 1.75004ZM15.6382 3.30118C15.4715 3.25651 15.2458 3.25007 14.5 3.25007C14.0858 3.25007 13.75 2.91429 13.75 2.50007C13.75 2.08586 14.0858 1.75007 14.5 1.75007C14.5349 1.75007 14.5693 1.75005 14.6032 1.75004C15.1997 1.74971 15.6427 1.74947 16.0265 1.85229C17.0617 2.1297 17.8704 2.93834 18.1478 3.97362C18.2506 4.35735 18.2504 4.80035 18.25 5.39688C18.25 5.43078 18.25 5.46517 18.25 5.50007C18.25 5.91429 17.9142 6.25007 17.5 6.25007C17.0858 6.25007 16.75 5.91429 16.75 5.50007C16.75 4.75431 16.7436 4.52855 16.6989 4.36184C16.5602 3.84421 16.1559 3.43988 15.6382 3.30118ZM7.75001 2.50007C7.75001 2.08586 8.0858 1.75007 8.50001 1.75007H11.5C11.9142 1.75007 12.25 2.08586 12.25 2.50007C12.25 2.91429 11.9142 3.25007 11.5 3.25007H8.50001C8.0858 3.25007 7.75001 2.91429 7.75001 2.50007ZM2.50001 7.75007C2.91422 7.75007 3.25001 8.08586 3.25001 8.50007V9.65199C3.29527 9.62586 3.34129 9.60087 3.38804 9.57705C3.75204 9.39158 4.13957 9.31766 4.56114 9.28322C4.96704 9.25005 5.46531 9.25006 6.06904 9.25007H6.43099C7.03471 9.25006 7.53298 9.25005 7.93888 9.28322C8.36045 9.31766 8.74798 9.39158 9.11198 9.57705C9.67647 9.86467 10.1354 10.3236 10.423 10.8881C10.6085 11.2521 10.6824 11.6396 10.7169 12.0612C10.75 12.4671 10.75 12.9654 10.75 13.5691V13.931C10.75 14.5348 10.75 15.033 10.7169 15.4389C10.6824 15.8605 10.6085 16.248 10.423 16.612C10.3992 16.6588 10.3742 16.7048 10.3481 16.7501H11.5C11.9142 16.7501 12.25 17.0859 12.25 17.5001C12.25 17.9143 11.9142 18.2501 11.5 18.2501H6.48378C6.46627 18.2501 6.44868 18.2501 6.43099 18.2501H6.06903C5.46531 18.2501 4.96704 18.2501 4.56114 18.2169C4.13957 18.1825 3.75204 18.1086 3.38804 17.9231C2.82355 17.6355 2.36461 17.1765 2.07699 16.612C1.89152 16.248 1.8176 15.8605 1.78316 15.4389C1.74999 15.033 1.75 14.5348 1.75001 13.931V13.5691C1.75001 13.5488 1.75001 13.5286 1.75001 13.5085V8.50007C1.75001 8.08586 2.0858 7.75007 2.50001 7.75007ZM6.10001 16.7501H6.40001C7.04245 16.7501 7.47917 16.7495 7.81673 16.7219C8.14554 16.695 8.3137 16.6463 8.431 16.5866C8.71324 16.4428 8.94271 16.2133 9.08652 15.9311C9.14629 15.8138 9.19498 15.6456 9.22185 15.3168C9.24943 14.9792 9.25001 14.5425 9.25001 13.9001V13.6001C9.25001 12.9576 9.24943 12.5209 9.22185 12.1834C9.19498 11.8545 9.14629 11.6864 9.08652 11.5691C8.94271 11.2868 8.71324 11.0574 8.431 10.9136C8.3137 10.8538 8.14554 10.8051 7.81673 10.7782C7.47917 10.7507 7.04245 10.7501 6.40001 10.7501H6.10001C5.45758 10.7501 5.02086 10.7507 4.68329 10.7782C4.35448 10.8051 4.18633 10.8538 4.06903 10.9136C3.78678 11.0574 3.55731 11.2868 3.4135 11.5691C3.35373 11.6864 3.30504 11.8545 3.27817 12.1833C3.25059 12.5209 3.25001 12.9576 3.25001 13.6001V13.9001C3.25001 14.5425 3.25059 14.9792 3.27817 15.3168C3.30504 15.6456 3.35373 15.8138 3.4135 15.9311C3.55731 16.2133 3.78678 16.4428 4.06903 16.5866C4.18633 16.6463 4.35448 16.695 4.68329 16.7219C5.02086 16.7495 5.45758 16.7501 6.10001 16.7501ZM17.5 7.75007C17.9142 7.75007 18.25 8.08586 18.25 8.50007V11.5001C18.25 11.9143 17.9142 12.2501 17.5 12.2501C17.0858 12.2501 16.75 11.9143 16.75 11.5001V8.50007C16.75 8.08586 17.0858 7.75007 17.5 7.75007ZM17.5 13.7501C17.9142 13.7501 18.25 14.0859 18.25 14.5001C18.25 14.535 18.25 14.5694 18.25 14.6033C18.2504 15.1998 18.2506 15.6428 18.1478 16.0265C17.8704 17.0618 17.0617 17.8704 16.0265 18.1478C15.6427 18.2507 15.1997 18.2504 14.6032 18.2501C14.5693 18.2501 14.5349 18.2501 14.5 18.2501C14.0858 18.2501 13.75 17.9143 13.75 17.5001C13.75 17.0859 14.0858 16.7501 14.5 16.7501C15.2458 16.7501 15.4715 16.7436 15.6382 16.699C16.1559 16.5603 16.5602 16.1559 16.6989 15.6383C16.7436 15.4716 16.75 15.2458 16.75 14.5001C16.75 14.0859 17.0858 13.7501 17.5 13.7501Z\\" fill=\\"#55555D\\"/>\\n\\n","viewBox":"0 0 20 20"}');let M=c._Y.createComponent("ScaleBaseIcon",k,e=>(0,p.jsx)(A.s,{...e.props,name:"ScaleBaseIcon",iconData:E}));var x=i(19110),B=i(90180),D=i(13942),L=i(38172),R=i(15851),U=i(73361),P=i(34891),F=i(18245),O=i(11502),N=i(34889);class V extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var Q=JSON.parse('{"fill":"none","content":"\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M5.63558 2.5835H14.3651C15.0385 2.58349 15.5892 2.58348 16.0367 2.62005C16.5 2.6579 16.9184 2.73863 17.3091 2.93773C17.9207 3.24931 18.4178 3.7465 18.7294 4.35803C18.9285 4.74877 19.0093 5.16717 19.0471 5.63043C19.0837 6.07799 19.0837 6.6287 19.0837 7.30208V12.6983C19.0837 13.3716 19.0837 13.9223 19.0471 14.3699C19.0093 14.8332 18.9285 15.2516 18.7294 15.6423C18.4178 16.2538 17.9207 16.751 17.3091 17.0626C16.9184 17.2617 16.5 17.3424 16.0367 17.3803C15.5892 17.4168 15.0385 17.4168 14.3651 17.4168H5.63557C4.9622 17.4168 4.41149 17.4168 3.96392 17.3803C3.50066 17.3424 3.08226 17.2617 2.69152 17.0626C2.08 16.751 1.58281 16.2538 1.27122 15.6423C1.07213 15.2516 0.991394 14.8332 0.953544 14.3699C0.916977 13.9223 0.916984 13.3716 0.916992 12.6982V7.30208C0.916984 6.6287 0.916977 6.07799 0.953544 5.63043C0.991394 5.16717 1.07213 4.74877 1.27122 4.35803C1.58281 3.7465 2.08 3.24931 2.69152 2.93773C3.08226 2.73863 3.50066 2.6579 3.96392 2.62005C4.41149 2.58348 4.9622 2.58349 5.63558 2.5835ZM4.08607 4.11507C3.71557 4.14534 3.51655 4.20084 3.37251 4.27424C3.04323 4.44201 2.77551 4.70973 2.60773 5.03901C2.53434 5.18305 2.47883 5.38208 2.44856 5.75258C2.41758 6.13183 2.41699 6.62106 2.41699 7.3335V12.6668C2.41699 13.3793 2.41758 13.8685 2.44856 14.2478C2.47883 14.6183 2.53434 14.8173 2.60773 14.9613C2.77551 15.2906 3.04323 15.5583 3.37251 15.7261C3.51655 15.7995 3.71557 15.855 4.08607 15.8853C4.46533 15.9162 4.95455 15.9168 5.66699 15.9168H14.3337C15.0461 15.9168 15.5353 15.9162 15.9146 15.8853C16.2851 15.855 16.4841 15.7995 16.6281 15.7261C16.9574 15.5583 17.2251 15.2906 17.3929 14.9613C17.4663 14.8173 17.5218 14.6183 17.5521 14.2478C17.5831 13.8685 17.5837 13.3793 17.5837 12.6668V7.3335C17.5837 6.62106 17.5831 6.13183 17.5521 5.75258C17.5218 5.38208 17.4663 5.18305 17.3929 5.03901C17.2251 4.70973 16.9574 4.44201 16.6281 4.27424C16.4841 4.20084 16.2851 4.14534 15.9146 4.11507C15.5353 4.08408 15.0461 4.0835 14.3337 4.0835H5.66699C4.95455 4.0835 4.46533 4.08408 4.08607 4.11507Z\\" fill=\\"#55555D\\"/>\\n\\n","viewBox":"0 0 20 20"}');let z=c._Y.createComponent("AspectRatio43Icon",V,e=>(0,p.jsx)(A.s,{...e.props,name:"AspectRatio43Icon",iconData:Q}));class H extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var W=JSON.parse('{"fill":"none","content":"\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M7.30196 0.916647H12.6981C13.3715 0.916639 13.9222 0.916631 14.3698 0.953199C14.833 0.991049 15.2514 1.07178 15.6422 1.27088C16.2537 1.58246 16.7509 2.07965 17.0625 2.69118C17.2616 3.08192 17.3423 3.50032 17.3802 3.96358C17.4167 4.41114 17.4167 4.96185 17.4167 5.63523V14.3647C17.4167 15.0381 17.4167 15.5888 17.3802 16.0364C17.3423 16.4996 17.2616 16.918 17.0625 17.3088C16.7509 17.9203 16.2537 18.4175 15.6422 18.7291C15.2514 18.9282 14.833 19.0089 14.3698 19.0468C13.9222 19.0833 13.3715 19.0833 12.6981 19.0833H7.30195C6.62858 19.0833 6.07787 19.0833 5.63031 19.0468C5.16704 19.0089 4.74865 18.9282 4.35791 18.7291C3.74638 18.4175 3.24919 17.9203 2.9376 17.3088C2.73851 16.918 2.65778 16.4996 2.61993 16.0364C2.58336 15.5888 2.58337 15.0381 2.58337 14.3647V5.63523C2.58337 4.96185 2.58336 4.41114 2.61993 3.96358C2.65778 3.50032 2.73851 3.08192 2.9376 2.69118C3.24919 2.07965 3.74638 1.58246 4.35791 1.27088C4.74865 1.07178 5.16704 0.991049 5.63031 0.953199C6.07787 0.916631 6.62858 0.916639 7.30196 0.916647ZM5.75245 2.44822C5.38195 2.47849 5.18293 2.53399 5.03889 2.60739C4.70961 2.77516 4.44189 3.04288 4.27411 3.37216C4.20072 3.5162 4.14522 3.71523 4.11494 4.08573C4.08396 4.46498 4.08337 4.95421 4.08337 5.66665V14.3333C4.08337 15.0458 4.08396 15.535 4.11494 15.9142C4.14522 16.2847 4.20072 16.4838 4.27411 16.6278C4.44189 16.9571 4.70961 17.2248 5.03889 17.3926C5.18293 17.466 5.38195 17.5215 5.75245 17.5517C6.13171 17.5827 6.62093 17.5833 7.33337 17.5833H12.6667C13.3791 17.5833 13.8684 17.5827 14.2476 17.5517C14.6181 17.5215 14.8172 17.466 14.9612 17.3926C15.2905 17.2248 15.5582 16.9571 15.726 16.6278C15.7994 16.4838 15.8549 16.2847 15.8851 15.9142C15.9161 15.535 15.9167 15.0458 15.9167 14.3333V5.66665C15.9167 4.95421 15.9161 4.46498 15.8851 4.08573C15.8549 3.71523 15.7994 3.5162 15.726 3.37216C15.5582 3.04288 15.2905 2.77516 14.9612 2.60739C14.8172 2.53399 14.6181 2.47849 14.2476 2.44822C13.8684 2.41723 13.3791 2.41665 12.6667 2.41665H7.33337C6.62093 2.41665 6.13171 2.41723 5.75245 2.44822Z\\" fill=\\"#55555D\\"/>\\n\\n","viewBox":"0 0 20 20"}');let G=c._Y.createComponent("AspectRatio34Icon",H,e=>(0,p.jsx)(A.s,{...e.props,name:"AspectRatio34Icon",iconData:W}));class j extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var J=JSON.parse('{"fill":"none","content":"\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M5.63521 5.08334H14.3647C15.0381 5.08334 15.5888 5.08333 16.0364 5.1199C16.4996 5.15775 16.918 5.23848 17.3088 5.43757C17.9203 5.74916 18.4175 6.24635 18.7291 6.85787C18.9282 7.24862 19.0089 7.66701 19.0467 8.13027C19.0833 8.57784 19.0833 9.12855 19.0833 9.80192V10.1981C19.0833 10.8715 19.0833 11.4222 19.0467 11.8697C19.0089 12.333 18.9282 12.7514 18.7291 13.1421C18.4175 13.7537 17.9203 14.2509 17.3088 14.5624C16.918 14.7615 16.4996 14.8423 16.0364 14.8801C15.5888 14.9167 15.0381 14.9167 14.3647 14.9167H5.63521C4.96183 14.9167 4.41112 14.9167 3.96356 14.8801C3.5003 14.8423 3.0819 14.7615 2.69116 14.5624C2.07963 14.2509 1.58244 13.7537 1.27086 13.1421C1.07176 12.7514 0.991028 12.333 0.953178 11.8697C0.91661 11.4222 0.916618 10.8715 0.916626 10.1981V9.80193C0.916618 9.12855 0.91661 8.57784 0.953178 8.13027C0.991028 7.66701 1.07176 7.24862 1.27086 6.85787C1.58244 6.24635 2.07963 5.74916 2.69116 5.43757C3.0819 5.23848 3.5003 5.15775 3.96356 5.1199C4.41112 5.08333 4.96183 5.08334 5.63521 5.08334ZM4.08571 6.61491C3.71521 6.64518 3.51618 6.70069 3.37214 6.77408C3.04286 6.94186 2.77514 7.20958 2.60737 7.53886C2.53397 7.6829 2.47847 7.88192 2.4482 8.25242C2.41721 8.63168 2.41663 9.1209 2.41663 9.83334V10.1667C2.41663 10.8791 2.41721 11.3683 2.4482 11.7476C2.47847 12.1181 2.53397 12.3171 2.60737 12.4612C2.77514 12.7904 3.04286 13.0582 3.37214 13.2259C3.51618 13.2993 3.71521 13.3548 4.08571 13.3851C4.46496 13.4161 4.95419 13.4167 5.66663 13.4167H14.3333C15.0457 13.4167 15.535 13.4161 15.9142 13.3851C16.2847 13.3548 16.4837 13.2993 16.6278 13.2259C16.9571 13.0582 17.2248 12.7904 17.3926 12.4612C17.4659 12.3171 17.5215 12.1181 17.5517 11.7476C17.5827 11.3683 17.5833 10.8791 17.5833 10.1667V9.83334C17.5833 9.1209 17.5827 8.63168 17.5517 8.25242C17.5215 7.88192 17.4659 7.6829 17.3926 7.53886C17.2248 7.20958 16.9571 6.94186 16.6278 6.77408C16.4837 6.70069 16.2847 6.64518 15.9142 6.61491C15.535 6.58393 15.0457 6.58334 14.3333 6.58334H5.66663C4.95419 6.58334 4.46496 6.58393 4.08571 6.61491Z\\" fill=\\"#55555D\\"/>\\n\\n","viewBox":"0 0 20 20"}');let K=c._Y.createComponent("AspectRatio52Icon",j,e=>(0,p.jsx)(A.s,{...e.props,name:"AspectRatio52Icon",iconData:J}));class q extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var X=JSON.parse('{"fill":"none","content":"\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M8.13521 0.916672H12.698C13.3714 0.916663 13.9221 0.916656 14.3697 0.953224C14.833 0.991074 15.2514 1.07181 15.6421 1.2709C16.2536 1.58249 16.7508 2.07968 17.0624 2.6912C17.2615 3.08194 17.3422 3.50034 17.3801 3.9636C17.4166 4.41117 17.4166 4.96187 17.4166 5.63525V14.3648C17.4166 15.0381 17.4166 15.5888 17.3801 16.0364C17.3422 16.4997 17.2615 16.9181 17.0624 17.3088C16.7508 17.9203 16.2536 18.4175 15.6421 18.7291C15.2514 18.9282 14.833 19.0089 14.3697 19.0468C13.9221 19.0834 13.3714 19.0833 12.698 19.0833H8.13521C7.46183 19.0833 6.91112 19.0834 6.46356 19.0468C6.0003 19.0089 5.5819 18.9282 5.19116 18.7291C4.57963 18.4175 4.08244 17.9203 3.77086 17.3088C3.57176 16.9181 3.49103 16.4997 3.45318 16.0364C3.41661 15.5888 3.41662 15.0381 3.41663 14.3648V5.63525C3.41662 4.96188 3.41661 4.41117 3.45318 3.9636C3.49103 3.50034 3.57176 3.08194 3.77086 2.6912C4.08244 2.07968 4.57963 1.58249 5.19116 1.2709C5.5819 1.07181 6.0003 0.991074 6.46356 0.953224C6.91112 0.916656 7.46183 0.916663 8.13521 0.916672ZM6.58571 2.44824C6.21521 2.47851 6.01618 2.53402 5.87214 2.60741C5.54286 2.77519 5.27514 3.04291 5.10737 3.37219C5.03397 3.51623 4.97847 3.71525 4.9482 4.08575C4.91721 4.46501 4.91663 4.95423 4.91663 5.66667V14.3333C4.91663 15.0458 4.91721 15.535 4.9482 15.9143C4.97847 16.2848 5.03397 16.4838 5.10737 16.6278C5.27514 16.9571 5.54286 17.2248 5.87214 17.3926C6.01618 17.466 6.21521 17.5215 6.58571 17.5518C6.96496 17.5828 7.45419 17.5833 8.16663 17.5833H12.6666C13.3791 17.5833 13.8683 17.5828 14.2475 17.5518C14.618 17.5215 14.8171 17.466 14.9611 17.3926C15.2904 17.2248 15.5581 16.9571 15.7259 16.6278C15.7993 16.4838 15.8548 16.2848 15.8851 15.9143C15.916 15.535 15.9166 15.0458 15.9166 14.3333V5.66667C15.9166 4.95423 15.916 4.46501 15.8851 4.08575C15.8548 3.71525 15.7993 3.51623 15.7259 3.37219C15.5581 3.04291 15.2904 2.77519 14.9611 2.60741C14.8171 2.53402 14.618 2.47851 14.2475 2.44824C13.8683 2.41726 13.3791 2.41667 12.6666 2.41667H8.16663C7.45419 2.41667 6.96496 2.41726 6.58571 2.44824Z\\" fill=\\"#55555D\\"/>\\n\\n","viewBox":"0 0 20 20"}');let Z=c._Y.createComponent("AspectRatio45Icon",q,e=>(0,p.jsx)(A.s,{...e.props,name:"AspectRatio45Icon",iconData:X}));class Y extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var $=JSON.parse('{"fill":"none","content":"\\n<g id=\\"rectangle-2:3\\">\\n<path id=\\"Rounded rectangle (Stroke)\\" fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M13.3335 1.66699C14.7142 1.66699 15.8335 2.78628 15.8335 4.16699L15.8335 15.8337C15.8335 17.2144 14.7142 18.3337 13.3335 18.3337L6.66683 18.3337C5.28612 18.3337 4.16683 17.2144 4.16683 15.8337L4.16683 4.16699C4.16683 2.78628 5.28612 1.66699 6.66683 1.66699L13.3335 1.66699ZM14.1668 4.16699C14.1668 3.70675 13.7937 3.33366 13.3335 3.33366L6.66683 3.33366C6.20659 3.33366 5.8335 3.70675 5.8335 4.16699L5.8335 15.8337C5.8335 16.2939 6.20659 16.667 6.66683 16.667L13.3335 16.667C13.7937 16.667 14.1668 16.2939 14.1668 15.8337L14.1668 4.16699Z\\" fill=\\"white\\"/>\\n</g>\\n\\n","viewBox":"0 0 20 20"}');let ee=c._Y.createComponent("Rectangle23Icon",Y,e=>(0,p.jsx)(A.s,{...e.props,name:"Rectangle23Icon",iconData:$}));class et extends c.PN{constructor(...e){super(...e),(0,l._)(this,"props",void 0)}}var ei=JSON.parse('{"fill":"none","content":"\\n<g id=\\"rectangle-3:2\\">\\n<path id=\\"Rounded rectangle (Stroke)\\" fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M1.6665 6.66699C1.6665 5.28628 2.78579 4.16699 4.1665 4.16699H15.8332C17.2139 4.16699 18.3332 5.28628 18.3332 6.66699V13.3337C18.3332 14.7144 17.2139 15.8337 15.8332 15.8337H4.1665C2.78579 15.8337 1.6665 14.7144 1.6665 13.3337V6.66699ZM4.1665 5.83366C3.70627 5.83366 3.33317 6.20675 3.33317 6.66699V13.3337C3.33317 13.7939 3.70627 14.167 4.1665 14.167H15.8332C16.2934 14.167 16.6665 13.7939 16.6665 13.3337V6.66699C16.6665 6.20675 16.2934 5.83366 15.8332 5.83366H4.1665Z\\" fill=\\"white\\"/>\\n</g>\\n\\n","viewBox":"0 0 20 20"}');let ea=c._Y.createComponent("Rectangle32Icon",et,e=>(0,p.jsx)(A.s,{...e.props,name:"Rectangle32Icon",iconData:ei}));var eo=i(91990);(o=(a=n||(n={})).UpscaleConfigKey||(a.UpscaleConfigKey={})).base="base",o.custom="custom",o["16:9"]="16:9",o["4:3"]="4:3",o["1:1"]="1:1",o["3:4"]="3:4",o["9:16"]="9:16";var es=i(63869),en={src:"https://assets.monica.im/home-web/_next/static/media/auto.76e4c917.webp",height:400,width:400,blurDataURL:"data:image/webp;base64,UklGRloAAABXRUJQVlA4IE4AAAAQAgCdASoIAAgAAkA4JYgCdAEegmYRFgyAAP7eIbIEVPYuAhx/6WaEKxsZ4YQd8CCVvMud0tWzp4Ew7XEl1TZX7hmwijeBu1ZPcLGoAAA=",blurWidth:8,blurHeight:8},er={src:"https://assets.monica.im/home-web/_next/static/media/cardsAndInvitation.233d3809.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAALVBMVEXV0shMaXHg29L19O7W2c6xsajs7Ojf39H49/B/f2r18+rw7OHW18rY2Mz9+/ZFc6BdAAAADnRSTlMgACf4FiT+9fwG6vjj8DbEbhIAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA2SURBVHicHcZJEsAgDAMwu84GtPn/c5lGJ4E0MyNBfKn9/DnVNYmQJoo4k+7KyVa+ILjc3RcvJHQBFPa/fr0AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},el={src:"https://assets.monica.im/home-web/_next/static/media/logo.62fda06c.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEVMaXFefXW6omt7gFu5oXCsmGqklWGvoXmll2yHg1aqjXGRilx9l5OOh1uMhFWIglZ6kotVak9jc1aBimpYUXY6AAAAEXRSTlMA+ZX6OixSExueCcn56Wbf+p3DsP4AAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA1SURBVHicTYu3EQAgEIAw5/C6/66eldLQADys1u7amb1bBPqqSjzgzVTLAmGIlHyjmFL43gMpWgEzrmX7/wAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},ed={src:"https://assets.monica.im/home-web/_next/static/media/poster.b60f0d9b.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAWlBMVEVMaXEZBgTr0K59cXoqKipmLzDC09MXEhsABAnKgFqDjJPeyb55hpJ4ZGteZXZ4TVTYq5X/1bP58+OhnqRCHBS+sK+USkREGhRZMzVGTl+MgIluJSI+MD+1oKMJw6oQAAAAGXRSTlMA5yH9BhsXJyEbKfrp/vT0/PD88/Hz/e/+cY9VVQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAEBJREFUeJwVyUcOgDAMAMENKXYIEHrn/99Evo00QE4pAuSp+E6BZv78IIbS30trNZ7XZoj781YrdcfqDEFFNPADSZ4CJLbkLAMAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},ec={src:"https://assets.monica.im/home-web/_next/static/media/sticker.ec7bee3a.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAV1BMVEVMaXFbSSirYVmtiCTktVZ4VUKqiDn/1EDXsVXvxwC9h0n5zFXXtYGHiW2UbUO/lEGeVUCnYCV4Vy6GdF1fgJiXelosGhcPCRFzYV85HRkWOGLzxp/RlYBQg7rnAAAAFHRSTlMA1Pk4R/5qHF4Q5i3g1K6I+/qbvjG8bWkAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA+SURBVHicFcpHEsAgEAPBAQNrnBM4/v+dLukyfRBgqUEzF4cspOrfIGy3/2bBncs19sD0rPFodd5Lp0IOBvw9HwHPr6SpkwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},eh={src:"https://assets.monica.im/home-web/_next/static/media/wallpaper.9b2dce48.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAALVBMVEU9R1IMEBMpQVMVJzReXGAZGRMlODgRGiMxVG5oZ21NSk9DXXEuOkO1kHskKjNorxu0AAAACHRSTlMBLHx3gg8Ne3o3H8YAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAAySURBVHicJcrHEQAgEAJAMF0w9F+uo/DaAQAMcuClZNaPtqMI4U2TuxqbUx87S+hkBy4agQDBVN9WgwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},eg={src:"https://assets.monica.im/home-web/_next/static/media/anime3d.3868cb80.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAclBMVEVEPSw/QzfHiT9CSzxhcE5HUUJtfF58gVtFUjBsUTNyf1VQTDqCcldXZEtIV0WpilpyYkvNhkNuc0idhmqQelxdXkNidVuWWi/CdTxuaVOWiGJ7bEF8ajmZcDuLZ0SjhlR8Nw3QoWKGRRSIg095XkdoekuTmTvxAAAACXRSTlP7////////+vm3tZfjAAAACXBIWXMAABYlAAAWJQFJUiTwAAAARUlEQVR4nAXBhQGAMAADsDIfc8Hd/n+RBGi6VkghAa4JGXoGUDum4B1MM8UyewdNzXJUzsHyuoeLZah2O+/0fICN+i1V/Wt9A6RCht8sAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},ep={src:"https://assets.monica.im/home-web/_next/static/media/cinema.3354581e.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAATlBMVEXJg5q5Z4LarbfWlKawycovNT650M0qLzmmw8fGzcnOkqTWtLzH2dBmXmlmaHHWxsaSbYVUT1vZ2dHlvcCuVm6hW3ahcY6jcI7Lw8a6f5Tpw+zZAAAACnRSTlP9////////9Pn+tjNrjgAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAEFJREFUeJwdwYkRgCAMBMALnEED4fPvv1Fn3MVKkm0HSOoMEFA1B5MDqk+MkBOlZIu4L2wtB3t7R63V3cdAWn7pA0j6AkJKHNlpAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},eA={src:"https://assets.monica.im/home-web/_next/static/media/comic.18cfb385.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAgVBMVEUpPE5tT0aen5WAWEtoTUqJlpVLT1W9n2xFTlN6Qjl7gX1LWVHLpGaYc1VkcnR0cXBGRD1cY0yZp56Uk4B4ZVjSr2uSXDmHUkEhIymxmoyBammme1Ohfne0q6e1u62KhoGHj4WIgmSrmXDCwL2MiGKqvaYbPCZbdXOar7BeWVkrOjHu6BISAAAACnRSTlP5////9f7/9fn+IuGrFQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAElJREFUeJwFwQUCgCAABLADFJVG7O76/wPdkBLbKlUmcMyOfV1pSLHQoSMFXnpsE204nL/8yjgQP3e+z8JA5CGcmhhETH4y4/gBm9UERpY+wU8AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},em={src:"https://assets.monica.im/home-web/_next/static/media/cyberpunk.38513fe1.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAdVBMVEUULC8TIyYuO0A1TlkbICEwQUxemqwrKiAVFhJPOy1YZ3Nzjp1jT0BTg5VBOzs4RVVFVGMQDg1Jd4thbYdhOjgvJiQ7LCxQVVONRGxsf49wVmxymKiRaG9bTEecU2hgj6U7Y3JcWG5yVEcyMDdERkNgJzhlkqWzJ6wtAAAACnRSTlP8////////8vX1ZhvqhgAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAElJREFUeJwFwYcBgCAQBLATeFSQJoi9l/1HNAHEIWX71CgKLr94dxDC7ea0HcIwmTY64NqWWXtmkZp11KpvEHL2ijOB6k1EROUPkIAD4ziaZfkAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},eu={src:"https://assets.monica.im/home-web/_next/static/media/fantasy.d976d02b.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAQlBMVEUdMk0lRGcYK0geNVQhPFwlSXEdPGASGCQXKD4SGCQvVHwVIjQoUX1aWng3P1g0RmUxZJQwYY5OhbgtTnFvb41DdKP+pn3oAAAACXRSTlP9////////9PwqRjdoAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAPklEQVR4nAXBBwKAIAwEsOuElo36/6+aoGqSqgBi95NcE9Rv8noHzjaGjIns7mbOaLpPmldEgB60QIlQ4lZ+S3cCCt/5WWIAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},ef={src:"https://assets.monica.im/home-web/_next/static/media/japaneseAnime.a5a0cf87.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAWlBMVEXOdlc8QkG5b1RwYT7VeFZRSEeiZ1Ozp5mVaF/BjXhsV0qXX0yKXEpiV0hcS0CrbVWudVt9bWNlS0InOD1LRkAgLDGng2z2w6ZyX0SOcGbXsJeoiHx4WFe7gGk66KzfAAAACnRSTlP7////////+fX+H0DHlgAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAERJREFUeJwFwQcCgCAMBLAD2oIM2Yrr/980AbS0lgFkNXpXmhDm5KQiIfCod90JnsNzXkyQtxxFywbEtLyQhVsmGf/ZH2KoAttdtPxYAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},ey={src:"https://assets.monica.im/home-web/_next/static/media/model3d.4bf9a269.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAbFBMVEVwY01aSTa3rpe3nnu6poaKd2GIgWuTjXmhim1EOy+rn4WwqJKXkXyLYTywimCfe1RhRi/n4cvRv6GecUpzRCFubGKDeGBrUjyUhGWsjmqRbU3l1ruOgm/m7N5sV0N+dGPeyKiIVy5NMR6dl4eFQGS0AAAACnRSTlP9////9f//+f76V1yJZQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAEZJREFUeJwFwYcBgCAQBLADfKRLtXf339EEGCF7Yzow4sssnQXzIkhnCdHzLFaaEGs+tlAA/ZY7JaHQLlafoXBo+tqp9v4HaQsDdNnu4gkAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},ev={src:"https://assets.monica.im/home-web/_next/static/media/oilPainting.2014df14.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAclBMVEVoW1SAi4tLVESXnJelpaFsZmR0eHbOw7SSj4qIlZyBZmSRlI5zdE2bgWrUybehn5G1rpqaYh+or6SHlI2riXi8mlCdn4WMg4ByZVhwXF2cVTwjLBhlbVuvgk65ionXvpK3bkWnfmS5oYyzfHbAvZ/LilCFfAKEAAAACnRSTlPy////////9fX5dCuAmwAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAEdJREFUeJwFwQUCgCAABLAjVUIau/X/X3RDxyJ/OGuRyu2vbDXqd77HNg/gudQQlALZHV3oJCBJWimRAoxHY7QUaPreOzviB5amA74u0VTdAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},ew={src:"https://assets.monica.im/home-web/_next/static/media/pencil.c3c6b4d0.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAdVBMVEXr6eLKt563rJLTuqXe1cOtkn7t6+Xb1cTr5Na6ooF9alauq5dsUj2ph2RqXEyNkIflvJa5tKPqyLnr3s7AvK1wb2LczK7q1Lqmm4OblIjCmH2cknbRln7w6tvlxZ+EdFmhbkTFwKx7ZT7IxKiip6LClnz138N7CJoLAAAACHRSTlP5////////+dyN/mYAAAAJcEhZcwAAFiUAABYlAUlSJPAAAABFSURBVHicBcEFAoAgAASwA+kGu9v/P9ENKIUpCIAtE029Erjffa5Ip3Aav7FB17DXp8bgCaJLa2wdxxMOra0hgMy5oVz+hYEDrMwHi5EAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},eC={src:"https://assets.monica.im/home-web/_next/static/media/pixel.968f3b26.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAhFBMVEUiOklWWVlHZlswUVthZFEzTko+NUZ5r79JXkgkN1tROEdnXldLRlRPU14/c3Z0n5+ly8i75905PlW5rlnAl2GHiFSEfkxlfVGScGIuY12glHpGgHlyh3ugbHKbQkdolY+qfH17sqxmqMeVo58nSj6kwLlfa36Nvsxxn7DJ3s02Vjtalp2Ii6F3AAAACnRSTlP6////////+v7yGIaHEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAElJREFUeJwFwQUCgCAABLBDCUXS7m7//z83YH+/y60C/LzdMw8W+vB+G2UIZcXSt4qBm6lL6oCBh6ZJKJNISVBkFSUAaF5GOv4BvEYESjasnzcAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},eb={src:"https://assets.monica.im/home-web/_next/static/media/realistic.2098ef71.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAb1BMVEViXklAPipwbltTTziwtZyRk4RpY06anXpbVDmDhnehe2E2NBtmTz5vcWEvIxmShmmoqovbsoeFa0sUEw5bV0FLRzyKjX6ChHdQPTO1kXdwZUngtJNcPiiIi2ivtYmiil2/x5y3l22AWUNoRyW2hlieMWzsAAAACnRSTlP8/////v///Pr5KfdEzQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAEdJREFUeJwFwQcCgCAMBLADbEGm4N7z/280QT2gFZINaIx+6lmBQrSz7wSk2OxqncPCeHKSAUTqzXeq0Oz6/IrR0M11FCj+AXCkA2bW+C43AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},eS={src:"https://assets.monica.im/home-web/_next/static/media/waterColor.28d2534b.png",height:200,width:200,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAATlBMVEX37eK4x9n55ND418v43crVyM/W2uX44tfR2OLV1+L40sK4vdDnubzC0N/56dbrycLtzc/1w7rLtMams8v50L3Ix8/i3d/UpbHArMTZu8E4YwSPAAAACnRSTlP+/////////PL1JzGBdgAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAEFJREFUeJwFwYcBwCAMAzAHnEDZo/P/RysBAJpzAcGzOTIgzZNMiShlet878T1lDNUbut6lVzZY3juLGA6pVarFH0u/AllQ9P+7AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},eI=i(76469),e_=i(92235),eT=i(88882),ek=i(56607),eE=i(60445),eM=i(73047),ex=i(47720),eB=i(446);class eD{getImageTaskId(e,t){return"".concat(e,"_").concat(t)}getFileStatus(e){return this.fileList.find(t=>t.id===e)}checkIsImage(e){return this.imageFileTypes.includes(e.type)}async uploadFile(e,t){if(!N.Gi.checkIsImage(e))return;this.cancel(t);let i="task canceled",a=!1,o=()=>{if(a)throw i},s={status:"loading",file:e,id:t,cancel:()=>{a=!0}};if(this.updateTask(s),e.size>1048576*this.options.maxFileSize)return s.status="error",s.errorText=eT.S.Base.uploadHelper.fileSizeExceed,this.updateTask(s),R.M.error(s.errorText),s;s.imgPreviewUrl=await e_.m.fileToDataUrl(e),this.updateTask(s);try{o();let{preSignedUrl:t,cdnUrl:i}=await N.Gi.getS3PreSignedModuleUrl({module:"image_tools",filename:e.name});o(),await N.Gi.uploadFileToS3(t,e,()=>{}),o(),s.status="success",s.cdnUrl=i,this.updateTask(s)}catch(e){s.status="error",e===i?s.errorText=i:e&&(s.errorText=e_.m.formatErrorMsg(e),R.M.error(s.errorText))}return s}async handleDropFile(e,t,i){if(!this.checkIsImage(t))return;i("");let a=await this.uploadFile(t,e);(null==a?void 0:a.status)==="success"&&i(a.cdnUrl||"")}cancel(e){let t=this.fileList.find(t=>t.id===e);t&&(t.cancel(),this.fileList=this.fileList.filter(t=>t.id!==e))}cancelAll(){this.fileList.forEach(e=>e.cancel()),this.fileList=[]}updateTask(e){let t=this.fileList.findIndex(t=>t.id===e.id);-1!==t?this.fileList[t]=e:this.fileList.push(e)}finishTask(e){this.fileList=this.fileList.filter(t=>t.id!==e)}constructor(e){(0,l._)(this,"options",void 0),(0,l._)(this,"fileList",void 0),(0,l._)(this,"imageFileTypes",void 0),(0,l._)(this,"retry",void 0),this.options=e,this.fileList=[],this.imageFileTypes=["image/jpeg","image/png","image/jpg"],this.retry=null,(0,eM.rC)(this)}}(0,d.gn)([c.SB],eD.prototype,"fileList",void 0);class eL{get canUpscaleCustom(){var e;return(null===(e=eU.templateForm.upscaleConfig)||void 0===e?void 0:e.upscaleKey)==="custom"}get cropperSize(){var e;let t=null===(e=eU.templateForm.upscaleConfig)||void 0===e?void 0:e.outer;return t?{width:t[0],height:t[1]}:null}get imagePosition(){var e;let t=null===(e=eU.templateForm.upscaleConfig)||void 0===e?void 0:e.imageConfig;return t?{left:t.left,top:t.top,width:t.width,height:t.height}:{left:0,top:0,width:0,height:0}}setAspectRatio(e){this.aspectRatio=e}resizeImage(e,t){let i,a,o,s;if(!this.aspectRatio||!this.cropperSize)return;let n=e+this.imagePosition.width,r=e+this.imagePosition.height,l=0,d=0;if(e>0){let e=this.getImageSizeRange(t);if(i=e.widthRange,a=e.heightRange,l=e.availableWidth,d=e.availableHeight,this.imagePosition.width<this.minImageSize&&(i[0]=this.imagePosition.width),this.imagePosition.height<this.minImageSize&&(a[0]=this.imagePosition.height),l/this.aspectRatio<=d){s=(o=this.getValidSize(i,n))/this.aspectRatio;let e=this.getValidSize(a,s);e!==s&&(o=(s=e)*this.aspectRatio)}else{o=(s=this.getValidSize(a,r))*this.aspectRatio;let e=this.getValidSize(i,o);e!==o&&(o=e,o=s*this.aspectRatio)}}else{let e=this.minImageSize,t=this.minImageSize;this.imagePosition.width<this.minImageSize&&(e=this.imagePosition.width),this.imagePosition.height<this.minImageSize&&(t=this.imagePosition.height),n<e?s=(o=e)/this.aspectRatio:r<t?o=(s=t)*this.aspectRatio:s=(o=n)/this.aspectRatio}let c=o-this.imagePosition.width,h=s-this.imagePosition.height;return this.updateImageConfig({left:this.imagePosition.left,top:this.imagePosition.top,width:o,height:s}),{deltaX:c,deltaY:h}}imageZoom(e){let t=e*this.imagePosition.width-this.imagePosition.width,i=e*this.imagePosition.height-this.imagePosition.height;this.updateImageSize({deltaX:t,deltaY:i},"bottom-right")}initImagePosition(){if(this.aspectRatio&&this.cropperSize){let e,t;let i=this.cropperSize.width-2*this.defaultPadding.width,a=this.cropperSize.height-2*this.defaultPadding.height;i/this.aspectRatio<=a?(e=i,t=i/this.aspectRatio):(t=a,e=a*this.aspectRatio);let o=(this.cropperSize.width-e)/2,s=(this.cropperSize.height-t)/2;this.updateImageConfig({left:o,top:s,width:e,height:t})}}handleInit(e){let t=e||"base";this.cropperPosition=null;let i=this.rateConfig[t];if("base"===t&&this.aspectRatio)i=this.aspectRatio>1?[this.defaultBaseSize*this.aspectRatio,this.defaultBaseSize]:[this.defaultBaseSize,this.defaultBaseSize/this.aspectRatio];else if("custom"===t){var a;i=(null===(a=eU.templateForm.upscaleConfig)||void 0===a?void 0:a.outer)||i}let[o,s]=i;this.updateOuter({width:o,height:s}),this.initImagePosition(),setTimeout(()=>{this.sketchDom&&this.cropperDom&&this.calculateCropperPosition(this.sketchDom,this.cropperDom)},0)}init(e){(null==e?void 0:e.upscaleKey)&&e.imageConfig||this.handleInit(null==e?void 0:e.upscaleKey)}resetImagePosition(){this.updateImageConfig({left:0,top:0,width:0,height:0}),this.aspectRatio=null,this.cropperPosition=null}getRelativePosition(e){let t=e.getBoundingClientRect();return{left:t.left/this.mobileRate,top:t.top/this.mobileRate,scrollLeft:e.scrollLeft/this.mobileRate,scrollTop:e.scrollTop/this.mobileRate,scrollWidth:e.scrollWidth/this.mobileRate,scrollHeight:e.scrollHeight/this.mobileRate}}getSizeRange(e){let t=[this.minCropperSize,this.maxCropperSize],i=[this.minCropperSize,this.maxCropperSize],a=0,o=0;if(!this.cropperSize||!this.sketchDom||!this.cropperDom||!this.cropperPosition)return{widthRange:t,heightRange:i,availableWidth:a,availableHeight:o};("left"===e||"bottom-left"===e||"top-left"===e)&&(t[0]=this.cropperSize.width-this.imagePosition.left,t[1]=this.cropperSize.width+this.cropperPosition.left>this.maxCropperSize?this.maxCropperSize:this.cropperSize.width+this.cropperPosition.left,a=this.imagePosition.left);let s=this.getRelativePosition(this.sketchDom);return("right"===e||"bottom-right"===e||"top-right"===e)&&(t[0]=this.imagePosition.left+this.imagePosition.width,t[1]=s.scrollWidth-this.cropperPosition.left-25>this.maxCropperSize?this.maxCropperSize:s.scrollWidth-this.cropperPosition.left-25,a=t[1]-this.imagePosition.left-this.imagePosition.width),("top"===e||"top-left"===e||"top-right"===e)&&(i[0]=this.cropperSize.height-this.imagePosition.top,i[1]=this.cropperSize.height+this.cropperPosition.top>this.maxCropperSize?this.maxCropperSize:this.cropperSize.height+this.cropperPosition.top,o=this.cropperPosition.top),("bottom"===e||"bottom-left"===e||"bottom-right"===e)&&(i[0]=this.imagePosition.top+this.imagePosition.height,i[1]=s.scrollHeight-this.cropperPosition.top-25>this.maxCropperSize?this.maxCropperSize:s.scrollHeight-this.cropperPosition.top-25,o=i[1]-this.imagePosition.top-this.imagePosition.height),{widthRange:t,heightRange:i,availableWidth:a,availableHeight:o}}getImageSizeRange(e){let t=[this.minImageSize,this.maxCropperSize],i=[this.minImageSize,this.maxCropperSize],a=0,o=0;return this.cropperSize&&this.cropperPosition&&(("left"===e||"bottom-left"===e||"top-left"===e)&&(t[1]=this.imagePosition.left+this.imagePosition.width,a=this.imagePosition.left),("right"===e||"bottom-right"===e||"top-right"===e)&&(t[1]=this.cropperSize.width-this.imagePosition.left,a=t[1]-this.imagePosition.width),("top"===e||"top-left"===e||"top-right"===e)&&(i[1]=this.imagePosition.top+this.imagePosition.height,o=this.imagePosition.top),("bottom"===e||"bottom-left"===e||"bottom-right"===e)&&(i[1]=this.cropperSize.height-this.imagePosition.top,o=i[1]-this.imagePosition.height)),{widthRange:t,heightRange:i,availableWidth:a,availableHeight:o}}updateImageSize(e,t){let{deltaX:i,deltaY:a}=e,o=this.resizeImage(Math.abs(i)>Math.abs(a)?i:a,t);t&&o&&this.updateImagePosition({deltaX:-o.deltaX,deltaY:-o.deltaY},t)}updateCropperSize(e,t){var i;let{deltaX:a,deltaY:o}=e;if(!this.cropperSize||!(null===(i=eU.templateForm.upscaleConfig)||void 0===i?void 0:i.upscaleKey))return;let{widthRange:s,heightRange:n,availableHeight:r,availableWidth:l}=this.getSizeRange(t),d={deltaX:a,deltaY:o};if(this.canUpscaleCustom){let e=this.cropperSize.width+a,i=this.cropperSize.height+o,r=this.getValidSize(s,e),l=this.getValidSize(n,i);d.deltaX=r-this.cropperSize.width,d.deltaY=l-this.cropperSize.height,this.updateOuter({width:r,height:l}),this.updateImagePosition(d,t),this.updateCropperPosition(d,t)}else{let e=Math.abs(a)>Math.abs(o)?a:o,i=i=>{let a,o;if(!this.cropperSize)return;let c=this.cropperSize.width+e,h=this.cropperSize.height+e;l/i<=r?o=((a=this.getValidSize(s,c))-this.cropperSize.width)/i+this.cropperSize.height:a=((o=this.getValidSize(n,h))-this.cropperSize.height)*i+this.cropperSize.width,d.deltaX=a-this.cropperSize.width,d.deltaY=o-this.cropperSize.height,this.updateOuter({width:a,height:o}),this.updateImagePosition(d,t),this.updateCropperPosition(d,t)};if("base"===eU.templateForm.upscaleConfig.upscaleKey){if(!this.aspectRatio)return;i(this.aspectRatio);return}if("16:9"===eU.templateForm.upscaleConfig.upscaleKey){i(16/9);return}if("1:1"===eU.templateForm.upscaleConfig.upscaleKey){i(1);return}if("3:4"===eU.templateForm.upscaleConfig.upscaleKey){i(3/4);return}if("9:16"===eU.templateForm.upscaleConfig.upscaleKey){i(9/19);return}if("4:3"===eU.templateForm.upscaleConfig.upscaleKey){i(4/3);return}}}setCropperSize(e){var t;if(!(null===(t=eU.templateForm.upscaleConfig)||void 0===t?void 0:t.upscaleKey))return;if(!this.imagePosition.width){this.updateOuter(e);return}let i=[this.imagePosition.left+this.imagePosition.width<this.minCropperSize?this.minCropperSize:this.imagePosition.left+this.imagePosition.width,this.maxCropperSize],a=[this.imagePosition.top+this.imagePosition.height<this.minCropperSize?this.minCropperSize:this.imagePosition.top+this.imagePosition.height,this.maxCropperSize],{width:o,height:s}=e,n=this.getValidSize(i,o),r=this.getValidSize(a,s);this.updateOuter({width:n,height:r})}imageMove(e){if(!this.cropperSize)return;let{xDelta:t,yDelta:i}=e,a=this.imagePosition.left+t,o=this.imagePosition.top+i,s=[0,this.cropperSize.width-this.imagePosition.width],n=[0,this.cropperSize.height-this.imagePosition.height],r=this.getValidSize(s,a),l=this.getValidSize(n,o);this.updateImageConfig({left:r,top:l,width:this.imagePosition.width,height:this.imagePosition.height})}calculateCropperPosition(e,t){this.sketchDom=e,this.cropperDom=t;let i=this.getRelativePosition(e),a=this.getRelativePosition(t),o={left:a.left-i.left+i.scrollLeft,top:a.top-i.top+i.scrollTop};this.cropperPosition=o}dispose(){this.resetImagePosition(),this.cropperDom=null,this.sketchDom=null}getValidSize(e,t){return Math.max(e[0],Math.min(e[1],t))}updateImageConfig(e){var t;(null===(t=eU.templateForm.upscaleConfig)||void 0===t?void 0:t.upscaleKey)&&(eU.templateForm.upscaleConfig.imageConfig=e)}updateOuter(e){var t;(null===(t=eU.templateForm.upscaleConfig)||void 0===t?void 0:t.upscaleKey)&&(eU.templateForm.upscaleConfig.outer=[e.width,e.height])}roundToInteger(e){return Math.round(e)}updateCropperPosition(e,t){let{deltaX:i,deltaY:a}=e;if(!this.cropperPosition)return;let o={xDelta:0,yDelta:0};("top"===t||"top-left"===t||"top-right"===t)&&(o.yDelta=-a),("left"===t||"top-left"===t||"bottom-left"===t)&&(o.xDelta=-i);let s=this.cropperPosition.left+o.xDelta,n=this.cropperPosition.top+o.yDelta;this.cropperPosition={left:s>0?s:0,top:n>0?n:0}}updateImagePosition(e,t){let{deltaX:i,deltaY:a}=e,o={xDelta:0,yDelta:0};("top"===t||"top-left"===t||"top-right"===t)&&(o.yDelta=a),("left"===t||"top-left"===t||"bottom-left"===t)&&(o.xDelta=i),this.imageMove(o)}constructor(){(0,l._)(this,"defaultPadding",{width:50,height:50}),(0,l._)(this,"defaultSize",{width:500,height:500}),(0,l._)(this,"sketchDom",null),(0,l._)(this,"cropperDom",null),(0,l._)(this,"minImageSize",80),(0,l._)(this,"maxCropperSize",1024),(0,l._)(this,"minCropperSize",300),(0,l._)(this,"defaultBaseSize",400),(0,l._)(this,"mobileZoomBase",800),(0,l._)(this,"rateConfig",{custom:[500,500],base:[500,500],"16:9":[630,354],"1:1":[500,500],"3:4":[500,667],"9:16":[354,630],"4:3":[500,375]}),(0,l._)(this,"aspectRatio",null),(0,l._)(this,"cropperPosition",null),(0,l._)(this,"mobileRate",1),(0,eM.rC)(this)}}(0,d.gn)([c.Fl],eL.prototype,"canUpscaleCustom",null),(0,d.gn)([c.Fl],eL.prototype,"cropperSize",null),(0,d.gn)([c.Fl],eL.prototype,"imagePosition",null),(0,d.gn)([c.SB],eL.prototype,"aspectRatio",void 0),(0,d.gn)([c.SB],eL.prototype,"cropperPosition",void 0),(0,d.gn)([c.SB],eL.prototype,"mobileRate",void 0),(s=r||(r={}))[s.TrialExceed=30530]="TrialExceed";class eR extends eI.v{get from(){return new URL(h.S.location.href).searchParams.get("from")}get selectThumbnailImageUrl(){return this.generateImageThumbnailUrls[this.activeImageIndex]||""}get selectImageCdnUrl(){return this.generateImageCdnUrls[this.activeImageIndex]||""}get generateImageThumbnailUrls(){var e;return(null===(e=this.generateImageInfo)||void 0===e?void 0:e.urls)||[]}get generateImageCdnUrls(){var e,t;return(null===(e=this.generateImageInfo)||void 0===e?void 0:e.cdnUrlList.length)?this.generateImageInfo.cdnUrlList:(null===(t=this.generateImageInfo)||void 0===t?void 0:t.urls)||[]}get generateImageHasWaterMark(){var e;return!!(null===(e=this.generateImageInfo)||void 0===e?void 0:e.info.hasWaterMark)}get generateVideoHasWaterMark(){var e;return!!(null===(e=this.generateVideoInfo)||void 0===e?void 0:e.info.hasWaterMark)}get generateVideoUrl(){var e;return(null===(e=this.generateVideoInfo)||void 0===e?void 0:e.url)||""}get showDetail(){return this.routeKey&&eo.U.includes(this.routeKey)}get history(){return this.imageHistoryMap[this.activeHistoryTab]}get isMobile(){return e_.m.getIsMobile()}get isIpad(){return e_.m.getIsIpad()}get functionType(){return this.routeKey?["removeBackground","removeText","removeBrushedArea","removeObject","changeBackground","upscale"].includes(this.routeKey)?"editImage":this.routeKey:null}get hasImageUploading(){let e=this.imageUploadManager.fileList;return!!e.length&&e.some(e=>"loading"===e.status)}get isImageUpscaleWorkflow(){return"template"===eU.functionType&&"out_painting_image"===eU.templateForm.template}get pixverseTemplateList(){return(ex.serverConfigController.getStaticConfig("pixverseTemplateList")||[]).map(e=>({key:e.templateId,label:e.displayName||"",img:e.thumbnailPath||"",video:e.thumbnailVideoPath,prompt:e.displayPrompt}))}get templateConfigList(){return ex.serverConfigController.getStaticConfig("workflowConfigList")||[]}get templateConfigListOptions(){return this.templateConfigList.find(e=>e.template===this.templateForm.template)}get imageModelsConfigList(){return(ex.serverConfigController.getStaticConfig("imageGenConfigList")||[]).map(e=>({key:e.model,pro:e.isStar,isNew:e.isNew,desc:e.description,label:e.name,img:e.iconUrl,argsOption:e.argsOption}))}get videoModelsConfigList(){return(ex.serverConfigController.getStaticConfig("videoGenConfigList")||[]).map(e=>({key:e.model,pro:e.isStar,isNew:e.isNew,desc:e.description,label:e.name,img:e.iconUrl,argsOption:e.argsOption}))}get usageModule(){return g.userController.isFreeUser?"image_gen":"credits"}get imageCanCompare(){return this.baseImageUrl&&this.editImageForm.originUrl&&this.baseImageUrl!==this.editImageForm.originUrl}get S(){return eT.S.Global.modules.ImageView}get imageModelConfig(){return this.imageModelsConfigList.find(e=>e.key===this.generateImageForm.modelType)}get videoModelConfig(){return this.videoModelsConfigList.find(e=>e.key===this.generateVideoForm.modelType)}get imageModelConfigOptions(){let e=this.imageModelConfig;if(null==e?void 0:e.argsOption.image2image){var t,i;let a=this.generateImageForm.originUrl;return{...e.argsOption.image2image,freeCost:a?e.argsOption.image2image.freeCost:null==e?void 0:null===(t=e.argsOption.text2image)||void 0===t?void 0:t.freeCost,vipCost:a?e.argsOption.image2image.vipCost:null==e?void 0:null===(i=e.argsOption.text2image)||void 0===i?void 0:i.vipCost}}return null==e?void 0:e.argsOption.text2image}get videoModelConfigOptions(){var e,t;let{generateFrom:i}=this.generateVideoForm;return"text"===i?null===(e=this.videoModelConfig)||void 0===e?void 0:e.argsOption.text2video:null===(t=this.videoModelConfig)||void 0===t?void 0:t.argsOption.image2video}get generateImageFields(){var e,t,i,a,o;let s=this.imageModelConfigOptions,n=this.getOptions((null==s?void 0:null===(e=s.imageCount)||void 0===e?void 0:e.options)||[],e=>({key:e,label:String(e)})),r=[];r="imageGenerator"===this.routeKey?((null==s?void 0:null===(a=s.styleConfig)||void 0===a?void 0:a.options)||[]).map(e=>({key:e.styleType,label:e.styleName,img:e.styleThumb})):[{key:"auto",label:this.S.auto,img:en},{key:"3d_anime",label:this.S.imageStyle["3dAnimation"],img:eg},{key:"3d_modeling",label:this.S.imageStyle["3dModeling"],img:ey},{key:"japanese_anime",label:this.S.imageStyle.anime,img:ef},{key:"movie_style",label:this.S.imageStyle.cinematic,img:ep},{key:"comic",label:this.S.imageStyle.comics,img:eA},{key:"cyberpunk",label:this.S.imageStyle.cyberpunk,img:em},{key:"fantasy_art",label:this.S.imageStyle.fantasy,img:eu},{key:"oil_painting",label:this.S.imageStyle.oil,img:ev},{key:"colored_pencil_drawing",label:this.S.imageStyle.pencil,img:ew},{key:"pixel_art",label:this.S.imageStyle.pixel,img:eC},{key:"realistic",label:this.S.imageStyle.realistic,img:eb},{key:"watercolor_painting",label:this.S.imageStyle.watercolor,img:eS}];let l=this.getOptions((null==s?void 0:null===(t=s.aspectRatioConfig)||void 0===t?void 0:t.options)||[],e=>({key:e,icon:this.getRatioIcon(e),label:e})),d={modelType:{options:this.imageModelsConfigList},imageCount:n||{options:[]},prompt:{},imageStyle:{options:r,optional:!0}};return"sd3"===this.generateImageForm.modelType&&this.generateImageForm.originUrl||(d.aspectRatio=l),(null===(i=this.imageModelConfig)||void 0===i?void 0:i.argsOption.image2image)&&(d.originUrl={optional:!0,imageRangeConfig:null===(o=this.imageModelConfig.argsOption.image2image.originUrlConfig)||void 0===o?void 0:o.rangeConfig}),(null==s?void 0:s.imageModeConfig)&&(d.mode={desc:s.imageModeConfig.tooltip,options:null==s?void 0:s.imageModeConfig.options.map(e=>({key:e.mode,label:e.modeName}))}),(null==s?void 0:s.qualityConfig)&&(d.imageQuality={options:null==s?void 0:s.qualityConfig.options.map(e=>({key:e.mode,label:e.modeName}))}),d}get generateVideoFields(){var e,t,i;let{modelType:a,generateFrom:o,originTailUrl:s}=this.generateVideoForm,n="text"===o?null===(e=this.videoModelConfig)||void 0===e?void 0:e.argsOption.text2video:null===(t=this.videoModelConfig)||void 0===t?void 0:t.argsOption.image2video,r={modelType:{options:this.videoModelsConfigList},generateFrom:{options:[{key:"text",label:this.S.generateVideoFromText},{key:"image",label:this.S.generateVideoFromImage}]}};if((null==n?void 0:n.seedConfig)&&(r.seed={}),(null==n?void 0:n.durationConfig)&&(r.duration={options:n.durationConfig.options.map(e=>({key:String(e),label:String(e)}))}),(null==n?void 0:n.creativeRatioConfig)&&(r.cfgScale={}),(null==n?void 0:n.motionConfig)&&(r.motionBucketId={}),("svd"===a||"runway"===a)&&(r.generateFrom={options:[{key:"image",label:this.S.generateVideoFromImage}]}),"veo2"===a&&(r.generateFrom={options:[{key:"text",label:this.S.generateVideoFromText}]}),(null==n?void 0:n.creativeRatioConfig)&&(r.cfgScale={}),r.prompt={optional:"image"===o&&"pixverse"!==a&&"wan2_1"!==a},(null==n?void 0:n.firstFrameConfig)&&(r.originUrl={imageRangeConfig:null==n?void 0:null===(i=n.firstFrameConfig)||void 0===i?void 0:i.rangeConfig}),(null==n?void 0:n.negativePromptSupport)&&(r.negativePrompt={optional:!n.negativePromptRequired}),(null==n?void 0:n.aspectRatioConfig)&&(r.aspectRatio={options:n.aspectRatioConfig.options.map(e=>({key:e,label:e,icon:this.getRatioIcon(e)}))}),(null==n?void 0:n.lastFrameConfig)&&(r.originTailUrl={optional:!0,imageRangeConfig:n.lastFrameConfig.rangeConfig}),(null==n?void 0:n.qualityConfig)&&(r.quality={options:n.qualityConfig.options.map(e=>({key:e,label:e}))}),(null==n?void 0:n.cameraControlConfig)&&(r.cameraControl={options:[{label:this.S.cameraControlOptions.none,key:"none"},{label:this.S.cameraControlOptions.vertical,key:"vertical"},{label:this.S.cameraControlOptions.horizontal,key:"horizontal"},{label:this.S.cameraControlOptions.pull,key:"zoom"},{label:this.S.cameraControlOptions.horizontalSway,key:"pan"},{label:this.S.cameraControlOptions.verticalSway,key:"tilt"},{label:this.S.cameraControlOptions.rotate,key:"roll"},{label:this.S.cameraControlOptions.moveBottom,key:"down_back"},{label:this.S.cameraControlOptions.pullTop,key:"forward_up"},{label:this.S.cameraControlOptions.rotateRight,key:"right_turn_forward"},{label:this.S.cameraControlOptions.rotateLeft,key:"left_turn_forward"}]}),null==n?void 0:n.modeConfig){let e=n.modeConfig.options;r.mode={options:[{key:"std",label:this.S.highPerformance},{key:"pro",label:this.S.highQuality}].filter(t=>e.find(e=>e===t.key))}}return"kling"===a&&(r.duration={options:[{key:"5",label:"5",pro:"pro"===this.generateVideoForm.mode},{key:"10",label:"10",pro:!0,disabled:"image"===o&&!!s}]}),"pixverse"===a&&(r.templateId={options:this.pixverseTemplateList},"std"===this.generateVideoForm.mode?r.duration={options:[{key:"5",label:"5"},{key:"8",label:"8"}]}:r.duration={options:[{key:"5",label:"5"}]}),r}get generateImageByScenarioFields(){let e={prompt:{},imageScene:{options:[{key:"logo",label:"Logo",img:el},{key:"mobile_wallpaper",label:this.S.scenario.mobileWallpaper,img:eh},{key:"poster",label:this.S.scenario.poster,img:ed},{key:"sticker",label:this.S.scenario.sticker,img:ec},{key:"cards_and_invites",label:this.S.scenario.cardsAndInvitation,img:er}]},imageStyle:{optional:!0},imageCount:{options:[{key:1,label:"1"},{key:2,label:"2"},{key:3,label:"3"},{key:4,label:"4"}]}},{imageScene:t}=eU.generateImageByScenarioForm;return e.aspectRatio||(e.aspectRatio={}),"mobile_wallpaper"===t?e.aspectRatio.options=[{key:"1:1",label:"1:1",icon:f},{key:"9:16",label:"9:16",icon:w}]:e.aspectRatio.options=[{key:"16:9",label:"16:9",icon:S},{key:"1:1",label:"1:1",icon:f},{key:"9:16",label:"9:16",icon:w}],e}get templateFields(){let e=ex.serverConfigController.getStaticConfig("imageToolHomePageConfig"),t=(null==e?void 0:e.imageToolTemplates)||[];t=t.filter(e=>"template"===e.routeKey),this.templateWhiteList.length&&(t=this.templateWhiteList.reduce((e,i)=>{let a=t.find(e=>{var t;return(null===(t=e.payload)||void 0===t?void 0:t.template)===i});return a&&e.push(a),e},[]));let i={template:{options:t.map(e=>{var t;return{key:(null===(t=e.payload)||void 0===t?void 0:t.template)||"",img:e.selectImage,image:e.image,label:e.title}})}};if(this.templateConfigListOptions){let{argsOption:e}=this.templateConfigListOptions;if(e.extraImageUrlConfig&&(i.extraImageUrl={optional:!e.extraImageUrlConfig.required,imageRangeConfig:e.extraImageUrlConfig.rangeConfig}),e.originUrlConfig&&(i.originUrl={optional:!e.originUrlConfig.required,imageRangeConfig:e.originUrlConfig.rangeConfig}),e.promptConfig&&(i.prompt={optional:!e.promptConfig.required}),e.templateAspectRatioConfig){let{options:t,required:a,supportCustom:o}=e.templateAspectRatioConfig;i.templateAspectRatio={options:[...(t||[]).map(e=>({key:{value:e.value||"",isCustom:!1},label:e.label||"",icon:e.value?this.getRatioIcon(e.value):void 0,desc:this.getRatioDesc(e.value||"")})),...o?[{key:{value:"1820:1560",isCustom:!0},label:this.S.customDesc,icon:T}]:[]],customRange:{width:[1560,4096],height:[1560,4096]},optional:!a}}if(e.styleConfig){let{options:t,required:a}=e.styleConfig;i.imageStyle={options:t.map(e=>({key:e.styleType,label:e.styleName,img:e.styleThumb})),optional:!a}}e.upscaleConfig&&(i.upscaleConfig={options:[{key:{upscaleKey:n.UpscaleConfigKey.custom},label:this.S.upscaleConfig.custom,icon:T},{key:{upscaleKey:n.UpscaleConfigKey.base},label:this.S.upscaleConfig.base,icon:M},{key:{upscaleKey:n.UpscaleConfigKey["16:9"]},label:"16:9",icon:this.getRatioIcon("16:9")},{key:{upscaleKey:n.UpscaleConfigKey["4:3"]},label:"4:3",icon:this.getRatioIcon("4:3")},{key:{upscaleKey:n.UpscaleConfigKey["1:1"]},label:"1:1",icon:this.getRatioIcon("1:1")},{key:{upscaleKey:n.UpscaleConfigKey["3:4"]},label:"3:4",icon:this.getRatioIcon("3:4")},{key:{upscaleKey:n.UpscaleConfigKey["9:16"]},label:"9:16",icon:this.getRatioIcon("9:16")}],customRange:{width:[300,1024],height:[300,1024]},optional:!e.upscaleConfig.required})}return i}get tagMap(){return[{key:"auto",label:this.S.auto},{key:"3d_anime",label:this.S.imageStyle["3dAnimation"]},{key:"3d_modeling",label:this.S.imageStyle["3dModeling"]},{key:"japanese_anime",label:this.S.imageStyle.anime},{key:"movie_style",label:this.S.imageStyle.cinematic},{key:"comic",label:this.S.imageStyle.comics},{key:"cyberpunk",label:this.S.imageStyle.cyberpunk},{key:"fantasy_art",label:this.S.imageStyle.fantasy},{key:"oil_painting",label:this.S.imageStyle.oil},{key:"colored_pencil_drawing",label:this.S.imageStyle.pencil},{key:"pixel_art",label:this.S.imageStyle.pixel},{key:"realistic",label:this.S.imageStyle.realistic},{key:"watercolor_painting",label:this.S.imageStyle.watercolor},{key:"logo",label:"Logo"},{key:"mobile_wallpaper",label:this.S.scenario.mobileWallpaper},{key:"poster",label:this.S.scenario.poster},{key:"sticker",label:this.S.scenario.sticker},{key:"cards_and_invites",label:this.S.scenario.cardsAndInvitation},{key:"video",label:this.S.video},{key:"recraft3",label:"Recraft"},{key:"kling",label:"Kling"},{key:"pix_moonbeam",label:this.S.imageStyle.pix_moonbeam},{key:"pix_sunflower",label:this.S.imageStyle.pix_sunflower},{key:"pix_neverLand",label:this.S.imageStyle.pix_neverLand},{key:"pix_daydream",label:this.S.imageStyle.pix_daydream},{key:"pix_starfield",label:this.S.imageStyle.pix_starfield},{key:"pix_midsummer",label:this.S.imageStyle.pix_midsummer},{key:"pix_whimsical",label:this.S.imageStyle.pix_whimsical},{key:"pix_diamond",label:this.S.imageStyle.pix_diamond},{key:"pix_rosebud",label:this.S.imageStyle.pix_rosebud},{key:"pix_anime",label:this.S.imageStyle.pix_anime},{key:"pix_sundae",label:this.S.imageStyle.pix_sundae}].reduce((e,t)=>(e[t.key]=t.label,e),{})}get costCredit(){var e,t,i,a,o;let{usageModule:s,functionType:n,generateImageForm:r,generateVideoForm:l,generateImageByScenarioForm:d}=eU;if("image_gen"===s){if("imageGenerator"===n){let{imageCount:t,modelType:i,imageQuality:a}=r,o=null===(e=this.imageModelConfigOptions)||void 0===e?void 0:e.freeCost;return("gpt-image-1"===i&&(o="low"===a?4:"medium"===a?8:100),o)?o*t:8*t}let t=!1;if("template"===n)return this.templateConfigListOptions?this.templateConfigListOptions.freeCost:4;if("imageAnimator"===n){let{modelType:e,duration:i,mode:a}=l;if("svd"===e)return 2;if(g.userController.isCoreCountryUser&&!(("kling"===e||"klingV1_6"===e)&&"pro"===a&&"5"!==i)||"kling"===e&&"5"===i&&"std"===a||"klingV1_6"===e&&"5"===i&&"std"===a||"pixverse"===e&&"5"===i&&"std"===a)return 8;t=!0}if(!t)return 4}if("imageGenerator"===n){let{imageQuality:e,imageCount:a}=r,o=(null===(t=this.imageModelConfigOptions)||void 0===t?void 0:t.vipCost)||x.Zw.sdxl,s=null===(i=this.imageModelConfigOptions)||void 0===i?void 0:i.vipCostOptions;if(s){let t=s.find(t=>!("imageQuality"in t)||t.imageQuality===e);(null==t?void 0:t.cost)&&(o=t.cost)}return o*a}if("imageAnimator"===n){let{modelType:e,duration:t,mode:i}=l,o=null===(a=this.videoModelConfigOptions)||void 0===a?void 0:a.vipCost;if(o){let e=o.find(e=>(!("duration"in e)||e.duration===Number(t))&&(!("mode"in e)||e.mode===i));if(null==e?void 0:e.cost)return e.cost}return x.yN[e]}return"template"===n?(null===(o=this.templateConfigListOptions)||void 0===o?void 0:o.vipCost)||10:"generateImageByScenario"===n?x.wX[d.imageScene||"poster"]*d.imageCount:"realtimeGenerateImageByText"===n||"realtimeGenerateImageByCanvas"===n?30:x.Y.imageOtherTool}get editImageRangeConfig(){return{sizeRange:{width:{min:300,max:2048},height:{min:300,max:2048}},aspectRatioRange:{min:.4,max:2.5}}}setViews(e){this.views=e}async openCropper(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=await new Promise(i=>{this.views.openCropper({insertTarget:"dialogRoot",images:e.map(e=>({imageSrc:e.url,rangeConfig:e.rangeConfig,errorType:e.errorType})),onClose:()=>{i(null)},onSubmit:e=>{i(e)},canNotCloseModal:t})});return i&&e.forEach((e,t)=>{let{updater:a}=e;a(i[t])}),i}async showDownloadMobilePopoverIfNeed(){let{downloadMobilePopoverShowed:e}=await es.i7.getAll();!e&&(ek.o.isExtension||this.initImageOnboardingShowed)&&(this.showDownloadMobilePopover=!0,es.i7.markDownloadMobilePopoverShowed())}init(){this.initImageOnboardingShowed=B.A.imageOnboardingShowed,es.i7.getAll().then(e=>{let{imageHistoryMap:t,scaleNoticeShowed:i,imageNewTagsMap:a}=e;this.imageHistoryMap=t,this.scaleNoticeShowed=i,this.imageNewTagsMap=a}),es.i7.on("scaleNoticeShowedChange",e=>{this.scaleNoticeShowed=e}),es.i7.on("imageNewTagsMapChange",e=>{this.imageNewTagsMap=e}),D.P.getIsExtInstalled().then(e=>{this.extensionInstalled=e}),(0,eM.U5)(()=>[this.functionType,B.A.inited,B.A.imageDetailBackShowed],()=>{if(B.A.inited&&"seo"===this.from&&!this.isMobile&&!B.A.imageDetailBackShowed){this.showDetailBackGuide=!0,B.A.setImageDetailBackShowed(!0);return}})}sendEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return L.W.createUserBehaviorEvent({eventName:e,extData:t})}initDetailPayload(e){if(e){if(delete e.taskType,"imageGenerator"===this.functionType&&(this.generateImageForm=e,this.checkImageForm()),"imageAnimator"===this.functionType){this.generateVideoForm=e;let{modelType:t,generateFrom:i,duration:a,originTailUrl:o}=this.generateVideoForm;"kling"===t&&"image"===i&&"10"===a&&o&&(this.generateVideoForm.duration="5",R.M.error(this.S.Frames.durationTips)),this.checkVideoForm()}"generateImageByScenario"!==this.functionType||(this.generateImageByScenarioForm=e,this.generateImageByScenarioForm.imageStyle||(this.generateImageByScenarioForm.imageStyle="auto")),"template"===this.functionType&&(this.templateForm=e||{},this.checkTemplateForm()),"editImage"===this.functionType&&(this.editImageForm=e)}}async uploadImageBase64File(e,t){let i=e_.m.dataURLtoFile(e,t);return(await this.uploadManager.uploadFile({filename:i.name,module:"image_tools"},i),"success"===this.uploadManager.status)?this.uploadManager.uploadResult.cdnUrl:null}setDrawerPosition(e){e?(this.drawerExpanded=!0,this.drawerStyles.transform="translateY(0)"):(this.drawerStyles.transform="translateY(calc(80vh - 160px))",this.drawerExpanded=!1)}resetDrawerPosition(){this.drawerExpanded?this.drawerStyles.transform="translateY(0)":this.drawerStyles.transform="translateY(calc(80vh - 160px))"}async resetImageToolsForm(){if("changeBackground"===this.routeKey){this.replaceImageBgForm=eB.T.replaceImageBgForm;return}if("removeBackground"===this.routeKey){this.removeImageBgForm=eB.T.removeImageBgForm;return}if("upscale"===this.routeKey){this.upscaleImageForm=eB.T.upscaleImageForm;return}if("removeObject"===this.routeKey){this.removeObjectForm=eB.T.removeObjectForm;return}if("removeBrushedArea"===this.routeKey){this.removeRemoveBrushedArea=eB.T.removeRemoveBrushedArea;return}"removeText"===this.routeKey&&(this.removeTextForm=eB.T.removeTextForm)}async selectFileForImageEdit(){e_.m.selectFile(e=>{let[t]=e;t&&this.handleUploadImageForImageEdit(t)},{accept:this.imageType})}setGenerateImageInfo(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={urls:e.urls,cdnUrlList:e.cdnUrlList,info:{hasWaterMark:e.info.hasWaterMark,id:e.info.id}};this.generateImageInfo=o,this.activeImageIndex=i,"editImage"===this.functionType&&(this.editImageForm.originUrl=o.urls[0]);let s=e_.m.getUrlParams();s.generateInfo=JSON.stringify(o),(null==t?void 0:t.length)&&t.forEach(e=>{delete s[e]});let n=e_.m.setUrlParams(s,h.S.location.href.split("?")[0]);h.S.isRunInServerSide||window.history.replaceState({path:n},"",n),a||this.updateOriginUrlByResult(o.urls[0])}setGenerateVideoInfo(e,t){let i={url:e.url,info:e.info};this.generateVideoInfo=i;let a=e_.m.getUrlParams();a.generateVideoInfo=JSON.stringify(i),(null==t?void 0:t.length)&&t.forEach(e=>{delete a[e]});let o=e_.m.setUrlParams(a,h.S.location.href.split("?")[0]);h.S.isRunInServerSide||window.history.replaceState({path:o},"",o)}async handleUploadImageForImageEdit(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.imageType.includes(e.type)){R.M.error(this.S.imageTypeLimit);return}try{if(t||(this.editImageUploading=!0),this.tempImageUrl=await e_.m.fileToDataUrl(e),await this.uploadManager.uploadFile({filename:e.name,module:"image_tools"},e),"success"===this.uploadManager.status){let e=this.uploadManager.uploadResult.cdnUrl;if(t){let t=await this.checkAllImages([{url:e,rangeConfig:this.editImageRangeConfig,updater:t=>{e=t}}]);t.length&&await this.openCropper(t,!0)}return this.editImageForm.originUrl=e,this.baseImageUrl=e,this.initEditImageForm(),e}"error"===this.uploadManager.status&&R.M.error(this.S.uploadFailed)}catch(e){R.M.error(e_.m.formatErrorMsg(e))}finally{this.tempImageUrl="",this.editImageUploading=!1}}async editImageByTool(e,t){let i=e,a=await this.checkAllImages([{url:e,rangeConfig:this.editImageRangeConfig,updater:e=>{i=e}}]);(!a.length||await this.openCropper(a))&&(this.baseImageUrl=i,this.editImageForm.originUrl=i,this.gotoSimple(t))}gotoSimple(e){this.currentGeneratingTask&&this.currentGeneratingTask.cancel(),this.expectedTime=null,this.taskWaitingInfo=null,this.preRouteKey=this.routeKey,this.routeKey=e,this.generateEventPayload=null,this.imageUploadManager.cancelAll();let t=new URL(h.S.location.href);t.searchParams.set("key",e),h.S.isRunInServerSide||history.replaceState(null,"",t.toString())}gotoWithLink(e){let t=new URL(e);if((t.pathname.includes("/video")||t.pathname.includes("/image"))&&t.searchParams.get("key")){let e;let{key:i,payload:a}=Object.fromEntries(t.searchParams);if(a)try{e=JSON.parse(a)}catch(e){}this.goto(i,e);return}window.open(e,ek.o.isWeb?"_self":"_blank")}goto(e,t){this.currentGeneratingTask&&this.currentGeneratingTask.cancel(),this.expectedTime=null,this.generateImageInfo=null,this.generateVideoInfo=null,this.taskWaitingInfo=null,this.generateEventPayload=null,this.isPreviewing=!1,this.activeImageIndex=0;let i=this.getBaseUrl();this.imageUploadManager.cancelAll(),this.upscaleManager.dispose(),"editImage"!==this.functionType&&(i.searchParams.delete("generateImages"),i.searchParams.delete("generateVideoUrl"),i.searchParams.delete("generateInfo"),i.searchParams.delete("generateVideoInfo"));let a="";if(ek.o.isWeb&&(this.routeKey=e),e){if(i.searchParams.set("key",e),t)switch(a=JSON.stringify(t),e){case"changeBackground":this.replaceImageBgForm={...t};break;case"removeBrushedArea":this.removeRemoveBrushedArea={...t};break;case"removeBackground":this.removeImageBgForm={...t};break;case"removeObject":this.removeObjectForm={...t};break;case"upscale":this.upscaleImageForm={...t};break;case"generateImageByScenario":this.generateImageByScenarioForm={...t},this.generateImageByScenarioForm.imageStyle||(this.generateImageByScenarioForm.imageStyle="auto");break;case"imageAnimator":if(t.templateId){let e=Number(t.templateId);e||(t.templateId=e)}this.generateVideoForm={...t},this.checkVideoForm();break;case"imageGenerator":this.generateImageForm={...t},this.checkImageForm();break;case"removeText":this.removeTextForm={...t};break;case"realtimeGenerateImageByCanvas":this.realtimeGenerateByCanvasForm={...t},this.realtimeGenerateByCanvasForm.imageStyle||(this.realtimeGenerateByCanvasForm.imageStyle="auto");break;case"realtimeGenerateImageByText":this.realtimeGenerateByTextForm={...t},this.realtimeGenerateByTextForm.imageStyle||(this.realtimeGenerateByTextForm.imageStyle="auto");break;case"template":this.templateForm={...t},this.checkTemplateForm()}else switch(e){case"changeBackground":a=JSON.stringify(this.replaceImageBgForm);break;case"removeBrushedArea":a=JSON.stringify(this.removeRemoveBrushedArea);break;case"removeBackground":a=JSON.stringify(this.removeImageBgForm);break;case"removeObject":a=JSON.stringify(this.removeObjectForm);break;case"upscale":a=JSON.stringify(this.upscaleImageForm);break;case"generateImageByScenario":a=JSON.stringify(this.generateImageByScenarioForm);break;case"imageAnimator":a=JSON.stringify(this.generateVideoForm);break;case"imageGenerator":a=JSON.stringify(this.generateImageForm),this.checkImageForm();break;case"removeText":a=JSON.stringify(this.removeTextForm);break;case"realtimeGenerateImageByCanvas":a=JSON.stringify(this.realtimeGenerateByTextForm);break;case"realtimeGenerateImageByText":a=JSON.stringify(this.realtimeGenerateByCanvasForm);break;case"template":a=JSON.stringify(this.templateForm)}}a&&i.searchParams.set("payload",a),ek.o.isWeb?history.pushState(null,"",i.toString()):(i.searchParams.set("from",ek.o.isExtension?"ext":"desktop"),window.open(i,"_blank"))}back(){this.currentGeneratingTask&&this.currentGeneratingTask.cancel(),this.expectedTime=null,this.taskWaitingInfo=null,this.generateImageInfo=null,this.generateVideoInfo=null,this.activeImageIndex=0,this.tempImageUrl="",this.preRouteKey=this.routeKey,this.routeKey=void 0,this.baseImageUrl="",this.realTimeByCanvasImageUrl="",this.realTimeByTextImageUrl="",this.generateEventPayload=null,this.upscaleManager.dispose(),this.isPreviewing=!1,this.imageUploadManager.cancelAll(),this.editImageForm={...eB.T.editImageForm},this.generateImageForm={...eB.T.generateImageForm},this.generateVideoForm={...eB.T.generateVideoForm},this.generateVideoForm={...eB.T.generateVideoForm},this.generateImageByScenarioForm={...eB.T.generateImageByScenarioForm},this.templateForm={...eB.T.templateForm},this.realtimeGenerateByCanvasForm={...eB.T.realtimeGenerateByCanvasForm},this.realtimeGenerateByTextForm={...eB.T.realtimeGenerateByTextForm};let e=new URL(h.S.location.href);e.searchParams.delete("generateVideoUrl"),e.searchParams.delete("generateImages"),e.searchParams.delete("generateInfo"),e.searchParams.delete("selectImageUrl"),e.searchParams.delete("key"),e.searchParams.delete("payload"),e.searchParams.delete("activeIndex"),e.searchParams.delete("showHistory"),this.detectTitle(),history.pushState(null,"",e)}deleteQuery(e){let t=new URL(h.S.location.href);e.forEach(e=>{t.searchParams.delete(e)}),history.pushState(null,"",t.toString())}getBaseUrl(){return new URL("image"===this.viewType?ek.o.isWeb?this.isMobile?e_.m.genFullUrl(eE.oo.imageTool):h.S.location.href:e_.m.genFullUrl(eE.Cl.monicaWebImage):ek.o.isWeb?e_.m.getIsMobile()?e_.m.genFullUrl(eE.oo.videoTool):h.S.location.href:e_.m.genFullUrl(eE.Cl.video))}async triggerFormChange(){return"realtimeGenerateImageByCanvas"===this.functionType?await this.generateImageByCanvas():await this.generateImageByText()}async generateImageByCanvas(){let e=this.generateImageByCanvasFlag+=1,{url:t,costTime:i}=await es.i7.generateImageByCanvas({...this.realtimeGenerateByCanvasForm,cfgScale:Number(this.realtimeGenerateByCanvasForm.cfgScale),imgBase64:this.getImageFileContent(this.realtimeGenerateByCanvasForm.imgBase64)});return e>this.currentGenerateImageByCanvasFlag&&(this.realTimeByCanvasImageUrl=t,this.currentGenerateImageByCanvasFlag=e,{isOk:!0,costTime:i})}async generateImageByText(){let e=this.generateImageByTextFlag+=1,{url:t,costTime:i}=await es.i7.generateImageByText(this.realtimeGenerateByTextForm);return e>this.currentGenerateImageByTextFlag&&(this.realTimeByTextImageUrl=t,this.currentGenerateImageByTextFlag=e,{isOk:!0,costTime:i})}setPayload(){let e=e_.m.getUrlParams(),t=this.getPayload();t?e.payload=JSON.stringify(t):delete e.payload;let i=e_.m.setUrlParams(e,h.S.location.href.split("?")[0]);window.history.replaceState({path:i},"",i)}sendUpscaleNoticeIfNeed(){this.scaleNoticeShowed||(es.i7.markScaleNoticeShowed(),this.emit("showScaleNoticeChange"))}async checkImage(e){let{url:t,rangeConfig:i}=e;return t in this.imageCheckCache?this.imageCheckCache[t]:new Promise(e=>{let a=new Image;a.src=t,a.onload=()=>{let o;let s=a.naturalWidth,n=a.naturalHeight,r=s/n,{sizeRange:l,aspectRatioRange:d}=i,c=s>=l.width.min&&s<=l.width.max,h=n>=l.height.min&&n<=l.height.max,g=r>=d.min&&r<=d.max,p=c&&h&&g;p||(o=c&&h?"ratio":"size"),this.imageCheckCache[t]={isValid:p,errorType:o},e({isValid:p,errorType:o})},a.onerror=()=>{e({isValid:!1,errorType:"size"})}})}async checkAllImages(e){return Promise.all(e.map(e=>this.checkImage(e))).then(t=>t.reduce((t,i,a)=>(i.isValid||t.push({...e[a],errorType:i.errorType||"size"}),t),[]))}async checkImagesAndCrop(){var e,t,i,a,o;let s=async e=>{let t=await this.checkAllImages(e);return!t.length||!!await this.openCropper(t)},n=[];return"imageGenerator"===this.routeKey?this.generateImageForm.originUrl&&(null===(e=this.generateImageFields.originUrl)||void 0===e?void 0:e.imageRangeConfig)&&n.push({url:this.generateImageForm.originUrl,rangeConfig:this.generateImageFields.originUrl.imageRangeConfig,updater:e=>{this.generateImageForm.originUrl=e}}):"imageAnimator"===this.routeKey?(this.generateVideoForm.originUrl&&(null===(t=this.generateVideoFields.originUrl)||void 0===t?void 0:t.imageRangeConfig)&&n.push({url:this.generateVideoForm.originUrl,rangeConfig:this.generateVideoFields.originUrl.imageRangeConfig,updater:e=>{this.generateVideoForm.originUrl=e}}),this.generateVideoForm.originTailUrl&&(null===(i=this.generateVideoFields.originTailUrl)||void 0===i?void 0:i.imageRangeConfig)&&n.push({url:this.generateVideoForm.originTailUrl,rangeConfig:this.generateVideoFields.originTailUrl.imageRangeConfig,updater:e=>{this.generateVideoForm.originTailUrl=e}})):"changeBackground"===this.routeKey||"removeBackground"===this.routeKey||"upscale"===this.routeKey||"removeObject"===this.routeKey||"removeBrushedArea"===this.routeKey||"removeText"===this.routeKey||"generateImageByScenario"===this.routeKey||"realtimeGenerateImageByCanvas"===this.routeKey||"realtimeGenerateImageByText"===this.routeKey||"template"===this.routeKey&&(this.templateForm.originUrl&&(null===(a=this.templateFields.originUrl)||void 0===a?void 0:a.imageRangeConfig)&&n.push({url:this.templateForm.originUrl,rangeConfig:this.templateFields.originUrl.imageRangeConfig,updater:e=>{this.templateForm.originUrl=e}}),this.templateForm.extraImageUrl&&(null===(o=this.templateFields.extraImageUrl)||void 0===o?void 0:o.imageRangeConfig)&&n.push({url:this.templateForm.extraImageUrl,rangeConfig:this.templateFields.extraImageUrl.imageRangeConfig,updater:e=>{this.templateForm.extraImageUrl=e}})),await s(n)}async handleSubmit(){this.isMobile&&this.setDrawerPosition(!1);let e=await this.preCheck();if(!e.isEnough)return e.handleNotEnough(),this.submitLoading=!1,!0;this.setPayload();let t=!0;try{let e=this.getFormPayload();if(e){let t="imageAnimator"===this.routeKey,i=this.getGenerateEventPayload(e);eU.sendEvent(t?"video_tool_click":"image_tool_click",{button:"submit",position:"detail",...i||{}})}if(!await this.checkImagesAndCrop())return this.submitLoading=!1,!0;this.submitLoading=!0,"imageGenerator"===this.routeKey?t=await this.handleImageGenerate():"imageAnimator"===this.routeKey?t=await this.handleVideoGenerate():"changeBackground"===this.routeKey?t=await this.handleReplaceBackground():"removeBackground"===this.routeKey?t=await this.handleRemoveBackground():"upscale"===this.routeKey?t=await this.handleUpscale():"removeObject"===this.routeKey?t=await this.handleRemoveObject():"removeBrushedArea"===this.routeKey?t=await this.handleRemoveBrushedArea():"removeText"===this.routeKey?t=await this.handleRemoveText():"generateImageByScenario"===this.routeKey?t=await this.handleGenerateImageByScenario():"realtimeGenerateImageByCanvas"===this.routeKey?(t=await this.handleRealtimeGenerateImageByCanvas())&&this.sendUpscaleNoticeIfNeed():"realtimeGenerateImageByText"===this.routeKey?(t=await this.handleRealtimeGenerateImageByText())&&this.sendUpscaleNoticeIfNeed():"template"===this.routeKey&&(t=await this.handleGenerateByTemplate())}catch(a){var i;t=!1,"object"==typeof a&&(null==a?void 0:null===(i=a.data)||void 0===i?void 0:i.code)===30530?(0,P.B)({insertTarget:"dialogRoot",okText:this.S.payNotice.pay,content:this.S.payNotice.trailNotice,onOk:async()=>{try{if("paddle"===g.userController.paymentPlatform)return await es.i7.payPaddle(),(0,P.B)({insertTarget:"dialogRoot",okText:this.S.payNotice.gotIt,content:this.S.payNotice.paddleNotice,onOk:()=>!0,hideCancel:!0}),!0;return await es.i7.payFastspring(),(0,P.B)({insertTarget:"dialogRoot",okText:this.S.payNotice.gotIt,content:this.S.payNotice.fastspringNotice,onOk:()=>!0,hideCancel:!0}),!0}catch(e){return"object"==typeof e&&"object"==typeof e.message?R.M.error(e_.m.formatErrorMsg(e.message.subscription||"api fail")):R.M.error(e_.m.formatErrorMsg(e)),!1}},hideCancel:!0}):F.K.isQuotaExceedError(a)?(e.handleNotEnough(),t=!0):a&&R.M.error(e_.m.formatErrorMsg(a,this.S.failed))}return(()=>{U.gM.updateUsageInfos([this.usageModule])})(),this.submitLoading=!1,this.expectedTime=null,this.taskWaitingInfo=null,t}getMaxUsed(){if(!g.userController.isVipUser){if("imageGenerator"===this.functionType){let{modelType:e,imageQuality:t}=this.generateImageForm;return"sdxl"===e||"flux_schnell"===e||"flux_dev"===e||"playground2_5"===e||"recraft3"===e||"imagen3"===e||"pix_ai"===e?this.extensionInstalled?8:4:"sd3"===e||"sd3_5"===e||"flux_pro"===e||"dalle3"===e||"ideogram2"===e||"flux_ultra"===e?this.extensionInstalled?8:0:"gpt-image-1"===e?"high"===t?0:this.extensionInstalled?8:4:0}if("imageAnimator"===this.functionType){let{modelType:e,mode:t,duration:i}=this.generateVideoForm;return g.userController.isCoreCountryUser?"kling"===e&&"pro"===t&&"5"!==i||"klingV1_6"===e&&"pro"===t&&"5"!==i?0:this.extensionInstalled?8:4:"svd"===e?this.extensionInstalled?8:4:("kling"===e&&"std"===t&&"5"===i||"klingV1_6"===e&&"std"===t&&"5"===i||"pixverse"===e&&"std"===t&&"5"===i)&&this.extensionInstalled?8:0}if("realtimeGenerateImageByText"===this.functionType||"realtimeGenerateImageByCanvas"===this.functionType||"editImage"===this.functionType||"generateImageByScenario"===this.functionType)return this.extensionInstalled?8:4;if("template"===this.functionType)return"remove_water_mark"===this.templateForm.template?this.extensionInstalled?8:0:this.extensionInstalled?8:4}}initEditImageForm(){if("removeBackground"===eU.routeKey){eU.removeImageBgForm.originUrl=eU.editImageForm.originUrl;return}if("changeBackground"===eU.routeKey){eU.replaceImageBgForm.originUrl=eU.editImageForm.originUrl;return}if("upscale"===eU.routeKey){eU.upscaleImageForm.originUrl=eU.editImageForm.originUrl;return}if("removeObject"===eU.routeKey){eU.removeObjectForm.originUrl=eU.editImageForm.originUrl;return}if("removeBrushedArea"===eU.routeKey){eU.removeRemoveBrushedArea.originUrl=eU.editImageForm.originUrl;return}if("removeText"===eU.routeKey){eU.removeTextForm.originUrl=eU.editImageForm.originUrl;return}}async preCheck(e){let t=this.getMaxUsed();if(!this.routeKey)return{isEnough:!0,handleNotEnough:()=>{}};let i="";if(e)i=e;else{let e=eB.Ns[this.routeKey];if(!e)return{isEnough:!0,handleNotEnough:()=>{}};i="function"==typeof e?e(()=>"imageAnimator"===this.functionType?"text"===this.generateVideoForm.generateFrom?"video_tools_text_animator_by_".concat(this.openFrom,"_").concat(this.generateVideoForm.modelType):"video_tools_image_animator_by_".concat(this.openFrom,"_").concat(this.generateVideoForm.modelType):""):"imageGenerator"===this.functionType?"".concat(e,"_by_").concat(this.openFrom,"_").concat(this.generateImageForm.modelType):"template"===this.functionType?"".concat(e,"_by_").concat(this.openFrom,"_").concat(this.templateForm.template):"".concat(e,"_by_").concat(this.openFrom)}let{isEnough:a,handleCreditsNotEnough:o}=F.K.checkCredits({cost:this.costCredit,module:this.usageModule,source:i,maxUsed:t,ignoreSeo:!0,featureName:"imageAnimator"===this.functionType?"animationGenerate":"imageGenerate"});return{isEnough:a,handleNotEnough:()=>{o(),O.M.createUserBehaviorEvent({eventName:"image_tools_upgrade_dialog_show",extData:{module:this.routeKey}})}}}async loopFetchTaskStatus(e,t){let i=!1,a=new Promise((a,o)=>{let s=async()=>{try{let r=await es.i7.loopTaskResult(e);if(i){a();return}if(3===r.record.resultCode){"video"===t&&r.record.waitNumber&&r.record.expectWaitTime&&(this.taskWaitingInfo={waitNumber:r.record.waitNumber||1,expectWaitTime:r.record.expectWaitTime||60,status:"queue"}),setTimeout(s,2e3);return}if(-1===r.record.resultCode){this.taskWaitingInfo&&(this.taskWaitingInfo.status="generating"),setTimeout(s,2e3);return}if(0===r.record.resultCode&&r.record.result){let{cdnUrlList:e,thumbnailUrlList:i}=this.getThumbnailUrls(r.record.result,"video"===t);R.M.success(this.S.success),a({urls:i,cdnUrlList:e,info:{hasWaterMark:r.record.hasWaterMark,id:String(r.record.id)}});return}if(30502===r.record.resultCode)R.M.error(this.S.klingFailed);else{var n;R.M.error((null===(n=r.record.result)||void 0===n?void 0:n.errorMsg)||this.S.failed)}o()}catch(e){o(),R.M.error(e_.m.formatErrorMsg(e,this.S.failed))}};s()});return this.currentGeneratingTask&&this.currentGeneratingTask.cancel(),this.currentGeneratingTask={promise:a,cancel:()=>{i=!0}},await a}findOrDefaultOption(e,t,i){var a;return t.find(t=>i?i(e,t):t.key===e)?e:(null===(a=t[0])||void 0===a?void 0:a.key)||e}checkVideoFrameResolution(e){let t=new Image;return t.src=URL.createObjectURL(e),new Promise(e=>{t.onload=()=>{let{width:i,height:a}=t;i<300||a<300?(e(!1),R.M.error(this.S.videoLimitLittle)):e(!0)}})}triggerLoopTasks(e){if(this.loopTasks.length){this.loopTasks=[...new Set([...this.loopTasks,...e])];return}this.loopTasks=e;let t=()=>{setTimeout(async()=>{let e=(await es.i7.batchGetHistoryDetails(this.loopTasks)).reduce((e,t,i)=>(t.resultCode===eB.WT.queue||t.resultCode===eB.WT.running?e.generating.push({...t,id:t.id||this.loopTasks[i]}):e.finish.push({...t,id:t.id||this.loopTasks[i]}),e),{finish:[],generating:[]});this.loopTasks=this.loopTasks.filter(t=>e.generating.some(e=>e.id===t)),this.loopTasks.length&&t(),e.finish.length&&this.updateHistory(e.finish)},5e3)};t()}async updateCurrentGenerateInfo(){var e,t;if("imageAnimator"===this.routeKey){if(null===(t=this.generateVideoInfo)||void 0===t?void 0:t.info.hasWaterMark){let e=await es.i7.getHistoryDetail(this.generateVideoInfo.info.id);if(null==e?void 0:e.result){let{thumbnailUrlList:t}=this.getThumbnailUrls(e.result,!0);this.setGenerateVideoInfo({url:t[0],info:{hasWaterMark:e.hasWaterMark,id:e.id}},["videoHistoryId","historyId"])}}return}if(null===(e=this.generateImageInfo)||void 0===e?void 0:e.info.hasWaterMark){let e=await es.i7.getHistoryDetail(this.generateImageInfo.info.id);if(null==e?void 0:e.result){let{cdnUrlList:t,thumbnailUrlList:i}=this.getThumbnailUrls(e.result,!1);this.setGenerateImageInfo({urls:i,cdnUrlList:t,info:{hasWaterMark:e.hasWaterMark,id:e.id}},["videoHistoryId","historyId"],this.activeImageIndex)}}}updateHistory(e){let t=t=>e.find(e=>e.id===t.id)||t;this.imageHistoryMap.all=this.imageHistoryMap.all.map(t),this.imageHistoryMap.image=this.imageHistoryMap.image.map(t),this.imageHistoryMap.video=this.imageHistoryMap.video.map(t)}async fetchMoreHistory(){let e=this.activeHistoryTab;try{var t,i;let a=await es.i7.getHistoryList(e,this.imageHistoryMap[e].length);if(0===a.code&&(null===(t=a.data.historyList)||void 0===t?void 0:t.length)){let t=a.data.historyList.filter(t=>!this.imageHistoryMap[e].some(e=>e.id===t.id));this.imageHistoryMap[e]=[...this.imageHistoryMap[e],...t],this.imageHistoryHasMoreMap[e]=(null===(i=a.data.historyList)||void 0===i?void 0:i.length)===30}}catch(e){R.M.error(e_.m.formatErrorMsg(e))}}async fetchHistory(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.activeHistoryTab;try{this.fetchHistoryLoading=!0;let a=await es.i7.getHistoryList(t);if(this.fetchHistoryLoading=!1,0===a.code){var i;if(this.imageHistoryMap[t]=a.data.historyList||[],this.imageHistoryHasMoreMap[t]=(null===(i=a.data.historyList)||void 0===i?void 0:i.length)===30,e){let e=(a.data.historyList||[]).filter(e=>e.resultCode===eB.WT.running||e.resultCode===eB.WT.queue);e.length&&this.triggerLoopTasks(e.map(e=>e.id));return}}}catch(e){this.fetchHistoryLoading=!1,R.M.error(e_.m.formatErrorMsg(e))}}async deleteHistory(e){await es.i7.deleteHistory(e)}detectTitle(){var e,t,i,a,o,s,n,r,l,d,c;let{functionType:g,templateForm:p,templateFields:A,generateImageForm:m,generateVideoForm:u,generateImageByScenarioForm:f,generateImageFields:y,generateVideoFields:v,generateImageByScenarioFields:w}=this;if(!ek.o.isExtension){if("imageGenerator"===g&&(document.title="".concat(this.S.aiDraw," - ").concat(null===(t=y.modelType.options)||void 0===t?void 0:null===(e=t.find(e=>e.key===m.modelType))||void 0===e?void 0:e.label," - Monica")),"imageAnimator"===g&&(document.title="".concat(this.S.aiVideo," - ").concat(null===(o=v.modelType)||void 0===o?void 0:null===(a=o.options)||void 0===a?void 0:null===(i=a.find(e=>e.key===u.modelType))||void 0===i?void 0:i.label," - Monica")),"editImage"===g){let e=null===(s=[{key:"removeBackground",label:eT.S.Global.modules.Artist.ImageRouteBar.removeBackground},{key:"removeText",label:eT.S.Global.modules.Artist.ImageRouteBar.removeText},{key:"removeBrushedArea",label:eT.S.Global.modules.Artist.ImageRouteBar.removeBrushedArea},{key:"removeObject",label:eT.S.Global.modules.Artist.ImageRouteBar.removeBrushedArea},{key:"changeBackground",label:eT.S.Global.modules.Artist.ImageRouteBar.replaceBackground},{key:"upscale",label:eT.S.Global.modules.Artist.ImageRouteBar.upscale}].find(e=>e.key===eU.routeKey))||void 0===s?void 0:s.label;h.S.isRunInServerSide||(document.title="".concat(this.S.editImage).concat(e?" - ".concat(e):""," - Monica"))}"template"===g&&(document.title="".concat(null==A?void 0:null===(r=A.template.options)||void 0===r?void 0:null===(n=r.find(e=>e.key===p.template))||void 0===n?void 0:n.label," - Monica")),"generateImageByScenario"===g&&(document.title="".concat(this.S.drawByTemplate," - ").concat(null===(c=w.imageScene)||void 0===c?void 0:null===(d=c.options)||void 0===d?void 0:null===(l=d.find(e=>e.key===f.imageScene))||void 0===l?void 0:l.label," - Monica")),"realtimeGenerateImageByText"===g&&(document.title="".concat(this.S.realtimeDraw," - Monica")),"realtimeGenerateImageByCanvas"===g&&(document.title="".concat(this.S.realtimeCanvas," - Monica")),g||("image"===this.viewType?document.title="".concat(this.S.image," - Monica"):document.title="".concat(this.S.video," - Monica"))}}checkVideoForm(){var e,t,i;if(this.generateVideoForm.originUrl&&!this.generateVideoForm.generateFrom&&(this.generateVideoForm.generateFrom="image"),this.generateVideoForm.generateFrom=this.findOrDefaultOption(this.generateVideoForm.generateFrom,(null===(e=this.generateVideoFields.generateFrom)||void 0===e?void 0:e.options)||[]),Object.keys(this.generateVideoFields).forEach(e=>{var t,i;(null===(t=this.generateVideoFields[e])||void 0===t?void 0:t.options)&&(this.generateVideoForm[e]=this.findOrDefaultOption(this.generateVideoForm[e],(null===(i=this.generateVideoFields[e])||void 0===i?void 0:i.options)||[]))}),this.generateVideoFields.seed&&(this.generateVideoForm.seed="0"),this.generateVideoFields.cameraControl&&(this.generateVideoForm.cameraControl="object"!=typeof this.generateVideoForm.cameraControl?{type:"none",range:0}:this.generateVideoForm.cameraControl),this.generateVideoFields.cfgScale&&(this.generateVideoForm.cfgScale=this.generateVideoForm.cfgScale||"2"),this.generateVideoFields.motionBucketId&&(this.generateVideoForm.motionBucketId=this.generateVideoForm.motionBucketId||"40"),this.generateVideoForm.templateId&&(null===(i=this.generateVideoFields.templateId)||void 0===i?void 0:null===(t=i.options)||void 0===t?void 0:t.length)){let e=this.generateVideoFields.templateId.options.find(e=>e.key===this.generateVideoForm.templateId);e&&(this.generateVideoForm.prompt=this.generateVideoForm.prompt||e.prompt)}}checkImageForm(){this.generateImageForm.imageStyle||(this.generateImageForm.imageStyle="auto"),Object.keys(this.generateImageFields).forEach(e=>{var t,i;(null===(t=this.generateImageFields[e])||void 0===t?void 0:t.options)&&(this.generateImageForm[e]=this.findOrDefaultOption(this.generateImageForm[e],(null===(i=this.generateImageFields[e])||void 0===i?void 0:i.options)||[]))})}checkTemplateForm(){Object.keys(this.templateFields).forEach(e=>{var t,i;(null===(t=this.templateFields[e])||void 0===t?void 0:t.options)&&(this.templateForm[e]=this.findOrDefaultOption(this.templateForm[e],(null===(i=this.templateFields[e])||void 0===i?void 0:i.options)||[],"templateAspectRatio"===e?(e,t)=>"object"==typeof e&&"isCustom"in e&&(e.isCustom?t.key.isCustom:!t.key.isCustom&&t.key.value===e.value):"upscaleConfig"===e?(e,t)=>"object"==typeof e&&"upscaleKey"in e&&t.key.upscaleKey===e.upscaleKey:void 0))}),"upscaleConfig"in this.templateFields&&this.upscaleManager.init(this.templateForm.upscaleConfig)}getFormPayload(){return"imageGenerator"===this.routeKey?this.generateImageForm:"imageAnimator"===this.routeKey?this.generateVideoForm:"changeBackground"===this.routeKey?this.replaceImageBgForm:"removeBackground"===this.routeKey?this.removeImageBgForm:"upscale"===this.routeKey?this.upscaleImageForm:"removeObject"===this.routeKey?this.removeObjectForm:"removeBrushedArea"===this.routeKey?this.removeRemoveBrushedArea:"removeText"===this.routeKey?this.removeTextForm:"generateImageByScenario"===this.routeKey?this.generateImageByScenarioForm:"realtimeGenerateImageByCanvas"===this.routeKey?this.realtimeGenerateByCanvasForm:"realtimeGenerateImageByText"===this.routeKey?this.realtimeGenerateByTextForm:"template"===this.routeKey?this.templateForm:null}getGenerateEventPayload(e){if(this.functionType){if("imageAnimator"===this.functionType)return{key:"imageAnimator",type:"video",modelType:e.modelType};if("editImage"===this.functionType||"realtimeGenerateImageByCanvas"===this.functionType||"realtimeGenerateImageByText"===this.functionType)return{key:this.routeKey,type:"image"};if("imageGenerator"===this.functionType)return{key:"imageGenerator",aspectRatio:e.aspectRatio,imageStyle:e.imageStyle,modelType:e.modelType,type:"image",imageQuality:e.imageQuality};if("generateImageByScenario"===this.functionType)return{key:this.routeKey,imageScene:e.imageScene,imageStyle:e.imageStyle,modelType:e.modelType,type:"image"};if("template"===this.functionType){let{loading:t,...i}=e;return delete i.prompt,{...i,key:this.routeKey,type:"image",template:i.template}}}}setGenerateEventPayload(e){let t=this.getGenerateEventPayload(e);t&&(this.generateEventPayload=t)}markIsVideo(){this.viewType="video"}markIsImage(){this.viewType="image"}async initPageStatusByUrl(e){let t=new URL(e).searchParams,i=t.get("key"),a=t.get("taskId"),o=t.get("payload"),s=t.get("generateInfo"),n=t.get("generateVideoInfo"),r=t.get("videoHistoryId"),l=t.get("historyId")||r,d=t.get("activeIndex");if(i){if(this.routeKey=i,o)try{this.initDetailPayload(JSON.parse(decodeURIComponent(o)))}catch(e){}if(s){let e=JSON.parse(decodeURIComponent(s));this.setGenerateImageInfo(e),o&&this.setGenerateEventPayload(JSON.parse(decodeURIComponent(o)))}else"editImage"!==this.functionType||"editImage"===this.routeKey||a||this.gotoSimple("editImage");if(n){let e=JSON.parse(decodeURIComponent(n));this.setGenerateVideoInfo(e),o&&this.setGenerateEventPayload(JSON.parse(decodeURIComponent(o)))}if(l&&!h.S.isRunInServerSide){let e=await es.i7.getHistoryDetail(l);if(e){let{result:t,createInfo:i,taskType:a}=e;if(["remove_text","upscale","replace_bg","remove_bg","inpainting","inpainting_mask"].includes(a)||this.initDetailPayload(i),t){let a="imageAnimator"===this.routeKey,{cdnUrlList:o,thumbnailUrlList:s}=this.getThumbnailUrls(t,a);"imageAnimator"===this.routeKey?s.length&&(this.setGenerateVideoInfo({url:s[0],info:{hasWaterMark:e.hasWaterMark,id:e.id}},["videoHistoryId","historyId"]),this.setGenerateEventPayload(i)):(this.setGenerateImageInfo({urls:s,cdnUrlList:o,info:{hasWaterMark:e.hasWaterMark,id:e.id}},["videoHistoryId","historyId"],d?Number(d):0),this.setGenerateEventPayload(i))}if("imageGenerator"===this.routeKey){let e=this.generateImageForm;("sd_upscale"===a||"sd_upscale_for_canvas"===a)&&(e.originUrl="",e.modelType="sdxl",e.imageCount=1,e.aspectRatio="1:1")}}}}}updateOriginUrlByResult(e){this.isImageUpscaleWorkflow&&(this.templateForm.originUrl=e,this.upscaleManager.initImagePosition())}handlePreviewConfirm(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isImageUpscaleWorkflow&&e&&(this.templateForm.originUrl=this.generateImageThumbnailUrls[0]),this.isPreviewing=!1}getThumbnailUrls(e){var t,i,a;let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(o){let t=(null===(a=e.cdnUrlList)||void 0===a?void 0:a.length)?e.cdnUrlList:e.cdnUrl?[e.cdnUrl]:[];return{cdnUrlList:t,thumbnailUrlList:t}}let s=(null===(t=e.thumbnailUrlList)||void 0===t?void 0:t.length)?e.thumbnailUrlList:e.thumbnailUrl?[e.thumbnailUrl]:[];return{cdnUrlList:(null===(i=e.cdnUrlList)||void 0===i?void 0:i.length)?e.cdnUrlList:s,thumbnailUrlList:s}}getPayload(){let e=null;return"imageGenerator"===this.functionType&&(e=this.generateImageForm),"imageAnimator"===this.functionType&&(e=this.generateVideoForm),"generateImageByScenario"===this.functionType&&(e=this.generateImageByScenarioForm),"template"===this.functionType&&(e=this.templateForm),"editImage"===this.functionType&&(e=this.editImageForm),e}initOpenFrom(){let e=new URLSearchParams(h.S.location.search).get("from");this.openFrom=e||"image_tool"}async handleImageGenerate(){let e={...this.generateImageForm},{imageToolsId:t,expectedTime:i}=await es.i7.textToImage(e);if(this.expectedTime=i||null,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.setGenerateEventPayload(e))}return!0}async getUrlKey(e){if(e.includes(".svg")){let t=await e_.m.fetchImageAndTransform(e,"image/png"),{preSignedUrl:i,cdnUrl:a}=await N.Gi.getS3PreSignedModuleUrl({module:"image_tools",filename:t.name});return await N.Gi.uploadFileToS3(i,t,()=>{}),a}return e}async handleVideoGenerate(){let e,t;let i={...this.generateVideoForm};if(this.generateVideoFields.originUrl&&this.generateVideoForm.originUrl){let{expectedTime:i,imageToolsId:a}=await es.i7.imageToVideo({...this.generateVideoForm,originUrl:await this.getUrlKey(this.generateVideoForm.originUrl)});e=a,t=i}else{let{expectedTime:i,imageToolsId:a}=await es.i7.textToVideo(this.generateVideoForm);e=a,t=i}if(!e)return!1;{this.expectedTime=t||0;let a=await this.loopFetchTaskStatus(e,"video");a&&(this.setGenerateVideoInfo({url:a.urls[0],info:a.info}),this.setGenerateEventPayload(i))}return!0}async handleReplaceBackground(){let e={...this.replaceImageBgForm},{imageToolsId:t,expectedTime:i}=await es.i7.replaceBackground({...this.replaceImageBgForm,originUrl:await this.getUrlKey(this.replaceImageBgForm.originUrl)});if(this.expectedTime=i,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.setGenerateEventPayload(e))}return!0}async handleRemoveBackground(){let e={...this.removeImageBgForm},{imageToolsId:t,expectedTime:i}=await es.i7.removeBackground({...this.removeImageBgForm,originUrl:await this.getUrlKey(this.removeImageBgForm.originUrl)});if(this.expectedTime=i,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.setGenerateEventPayload(e))}return!0}async handleUpscale(){let e={...this.upscaleImageForm},{imageToolsId:t,expectedTime:i}=await es.i7.upscale({...this.upscaleImageForm,originUrl:await this.getUrlKey(this.upscaleImageForm.originUrl)});if(this.expectedTime=i,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.setGenerateEventPayload(e))}return!0}async handleRemoveObject(){let e={...this.removeObjectForm},{imageToolsId:t,expectedTime:i}=await es.i7.removeObject({...this.removeObjectForm,originUrl:await this.getUrlKey(this.removeObjectForm.originUrl),maskUrl:this.removeObjectForm.maskUrl});if(this.expectedTime=i,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.setGenerateEventPayload(e))}return!0}async handleRemoveBrushedArea(){let e={...this.removeRemoveBrushedArea},{imageToolsId:t,expectedTime:i}=await es.i7.removeObject({...this.removeRemoveBrushedArea,originUrl:await this.getUrlKey(this.removeRemoveBrushedArea.originUrl),maskUrl:this.removeRemoveBrushedArea.maskUrl});if(this.expectedTime=i,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.setGenerateEventPayload(e))}return!0}async handleRemoveText(){let e={...this.removeTextForm},{imageToolsId:t,expectedTime:i}=await es.i7.removeText({...this.removeTextForm,originUrl:await this.getUrlKey(this.removeTextForm.originUrl)});if(this.expectedTime=i,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.setGenerateEventPayload(e))}return!0}async handleGenerateImageByScenario(){let e={...this.generateImageByScenarioForm},{imageToolsId:t,expectedTime:i}=await es.i7.textToImage(e);if(this.expectedTime=i||null,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.setGenerateEventPayload(e))}return!0}async handleRealtimeGenerateImageByCanvas(){let e={...this.realtimeGenerateByCanvasForm},{imageToolsId:t,expectedTime:i}=await es.i7.upgradeImageByWorkflow({originUrl:this.realTimeByCanvasImageUrl},"sd_upscale_for_canvas",this.realtimeGenerateByCanvasForm);if(this.expectedTime=i||null,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.realTimeByCanvasImageUrl=i.urls[0],this.setGenerateEventPayload(e))}return!0}async handleRealtimeGenerateImageByText(){let e={...this.realtimeGenerateByTextForm},{imageToolsId:t,expectedTime:i}=await es.i7.upgradeImageByWorkflow({originUrl:this.realTimeByTextImageUrl},"sd_upscale",this.realtimeGenerateByTextForm);if(this.expectedTime=i||null,!t)return!1;{let i=await this.loopFetchTaskStatus(t,"image");i&&(this.setGenerateImageInfo(i),this.realTimeByTextImageUrl=i.urls[0],this.setGenerateEventPayload(e))}return!0}async handleGenerateByTemplate(){let e={...this.templateForm},{originUrl:t,extraImageUrl:i}=this.templateForm,{imageToolsId:a,expectedTime:o}=await es.i7.upgradeImageByWorkflow({originUrl:t?await this.getUrlKey(t):void 0,extraImageUrl:i?await this.getUrlKey(i):void 0},e.template,this.templateForm);if(this.expectedTime=o||null,!a)return!1;{let t=await this.loopFetchTaskStatus(a,"image");t&&(this.setGenerateImageInfo(t,void 0,void 0,!0),this.setGenerateEventPayload(e),this.isImageUpscaleWorkflow&&(this.isPreviewing=!0))}return!0}getImageFileContent(e){let t="data:image/png;base64,";return e.startsWith(t)?e.split(t)[1]:e}constructor(){super(),(0,l._)(this,"generating",!1),(0,l._)(this,"isFavorite",!1),(0,l._)(this,"isCompareMode",!1),(0,l._)(this,"editImageUploading",!1),(0,l._)(this,"activeHistoryTab","all"),(0,l._)(this,"imageUploading",!1),(0,l._)(this,"expectedTime",null),(0,l._)(this,"imageHistoryMap",{all:[],image:[],video:[]}),(0,l._)(this,"imageHistoryHasMoreMap",{all:!1,image:!1,video:!1}),(0,l._)(this,"fetchHistoryLoading",!1),(0,l._)(this,"scaleNoticeShowed",!1),(0,l._)(this,"openFrom","seo"),(0,l._)(this,"canDrag",!1),(0,l._)(this,"tempImageUrl",""),(0,l._)(this,"baseImageUrl",""),(0,l._)(this,"generateImageInfo",null),(0,l._)(this,"generateVideoInfo",null),(0,l._)(this,"imageNewTagsMap",{}),(0,l._)(this,"generateEventPayload",null),(0,l._)(this,"isPreviewing",!1),(0,l._)(this,"activeImageIndex",0),(0,l._)(this,"realTimeByCanvasImageUrl",""),(0,l._)(this,"realTimeByTextImageUrl",""),(0,l._)(this,"preRouteKey",void 0),(0,l._)(this,"routeKey",void 0),(0,l._)(this,"drawerStyles",{}),(0,l._)(this,"drawerExpanded",!1),(0,l._)(this,"generateImageForm",eB.T.generateImageForm),(0,l._)(this,"replaceImageBgForm",eB.T.replaceImageBgForm),(0,l._)(this,"removeImageBgForm",eB.T.removeImageBgForm),(0,l._)(this,"upscaleImageForm",eB.T.upscaleImageForm),(0,l._)(this,"removeObjectForm",eB.T.removeObjectForm),(0,l._)(this,"removeRemoveBrushedArea",eB.T.removeRemoveBrushedArea),(0,l._)(this,"removeTextForm",eB.T.removeTextForm),(0,l._)(this,"editImageForm",eB.T.editImageForm),(0,l._)(this,"generateVideoForm",eB.T.generateVideoForm),(0,l._)(this,"generateImageByScenarioForm",eB.T.generateImageByScenarioForm),(0,l._)(this,"templateForm",eB.T.templateForm),(0,l._)(this,"realtimeGenerateByCanvasForm",eB.T.realtimeGenerateByCanvasForm),(0,l._)(this,"realtimeGenerateByTextForm",eB.T.realtimeGenerateByTextForm),(0,l._)(this,"submitLoading",!1),(0,l._)(this,"extensionInstalled",!1),(0,l._)(this,"modelDefaultOpen",!1),(0,l._)(this,"scenarioDefaultOpen",!1),(0,l._)(this,"templateDefaultOpen",!1),(0,l._)(this,"showDetailBackGuide",!1),(0,l._)(this,"showDownloadMobilePopover",!1),(0,l._)(this,"viewType","image"),(0,l._)(this,"initImageOnboardingShowed",!1),(0,l._)(this,"taskWaitingInfo",null),(0,l._)(this,"templateWhiteList",[]),(0,l._)(this,"maxResolution",[3024,4032]),(0,l._)(this,"minResolution",[512,512]),(0,l._)(this,"upscaleManager",new eL),(0,l._)(this,"imageUploadManager",new eD({maxFileSize:10485760})),(0,l._)(this,"imageType",["image/jpeg","image/png","image/jpg"]),(0,l._)(this,"generateImageByTextFlag",0),(0,l._)(this,"generateImageByCanvasFlag",0),(0,l._)(this,"currentGenerateImageByTextFlag",-1),(0,l._)(this,"currentGenerateImageByCanvasFlag",-1),(0,l._)(this,"imageCheckCache",{}),(0,l._)(this,"loopTasks",[]),(0,l._)(this,"currentGeneratingTask",null),(0,l._)(this,"uploadManager",new N.c3({maxFileSize:10485760})),(0,l._)(this,"views",void 0),(0,l._)(this,"getRatioDesc",e=>"16:9"===e?this.S.TemplateAspectRatio.computer:"4:3"===e?this.S.TemplateAspectRatio.pad:"9:16"===e?this.S.TemplateAspectRatio.phone:""),(0,l._)(this,"getRatioIcon",e=>"16:9"===e?S:"1:1"===e?f:"4:3"===e?z:"3:4"===e?G:"9:16"===e?w:"5:2"===e?K:"4:5"===e?Z:"2:3"===e?ee:"3:2"===e?ea:f),(0,l._)(this,"getOptions",(e,t)=>{if(null==e?void 0:e.length)return{options:e.map(t)}}),(0,eM.rC)(this),this.initOpenFrom()}}(0,d.gn)([c.SB],eR.prototype,"generating",void 0),(0,d.gn)([c.SB],eR.prototype,"isFavorite",void 0),(0,d.gn)([c.SB],eR.prototype,"isCompareMode",void 0),(0,d.gn)([c.SB],eR.prototype,"editImageUploading",void 0),(0,d.gn)([c.SB],eR.prototype,"activeHistoryTab",void 0),(0,d.gn)([c.SB],eR.prototype,"imageUploading",void 0),(0,d.gn)([c.SB],eR.prototype,"expectedTime",void 0),(0,d.gn)([c.SB],eR.prototype,"imageHistoryMap",void 0),(0,d.gn)([c.SB],eR.prototype,"imageHistoryHasMoreMap",void 0),(0,d.gn)([c.SB],eR.prototype,"fetchHistoryLoading",void 0),(0,d.gn)([c.SB],eR.prototype,"scaleNoticeShowed",void 0),(0,d.gn)([c.SB],eR.prototype,"openFrom",void 0),(0,d.gn)([c.SB],eR.prototype,"canDrag",void 0),(0,d.gn)([c.SB],eR.prototype,"tempImageUrl",void 0),(0,d.gn)([c.SB],eR.prototype,"baseImageUrl",void 0),(0,d.gn)([c.SB],eR.prototype,"generateImageInfo",void 0),(0,d.gn)([c.SB],eR.prototype,"generateVideoInfo",void 0),(0,d.gn)([c.SB],eR.prototype,"imageNewTagsMap",void 0),(0,d.gn)([c.SB],eR.prototype,"generateEventPayload",void 0),(0,d.gn)([c.SB],eR.prototype,"isPreviewing",void 0),(0,d.gn)([c.SB],eR.prototype,"activeImageIndex",void 0),(0,d.gn)([c.SB],eR.prototype,"realTimeByCanvasImageUrl",void 0),(0,d.gn)([c.SB],eR.prototype,"realTimeByTextImageUrl",void 0),(0,d.gn)([c.SB],eR.prototype,"preRouteKey",void 0),(0,d.gn)([c.SB],eR.prototype,"routeKey",void 0),(0,d.gn)([c.SB],eR.prototype,"drawerStyles",void 0),(0,d.gn)([c.SB],eR.prototype,"drawerExpanded",void 0),(0,d.gn)([c.SB],eR.prototype,"generateImageForm",void 0),(0,d.gn)([c.SB],eR.prototype,"replaceImageBgForm",void 0),(0,d.gn)([c.SB],eR.prototype,"removeImageBgForm",void 0),(0,d.gn)([c.SB],eR.prototype,"upscaleImageForm",void 0),(0,d.gn)([c.SB],eR.prototype,"removeObjectForm",void 0),(0,d.gn)([c.SB],eR.prototype,"removeRemoveBrushedArea",void 0),(0,d.gn)([c.SB],eR.prototype,"removeTextForm",void 0),(0,d.gn)([c.SB],eR.prototype,"editImageForm",void 0),(0,d.gn)([c.SB],eR.prototype,"generateVideoForm",void 0),(0,d.gn)([c.SB],eR.prototype,"generateImageByScenarioForm",void 0),(0,d.gn)([c.SB],eR.prototype,"templateForm",void 0),(0,d.gn)([c.SB],eR.prototype,"realtimeGenerateByCanvasForm",void 0),(0,d.gn)([c.SB],eR.prototype,"realtimeGenerateByTextForm",void 0),(0,d.gn)([c.SB],eR.prototype,"submitLoading",void 0),(0,d.gn)([c.SB],eR.prototype,"extensionInstalled",void 0),(0,d.gn)([c.SB],eR.prototype,"modelDefaultOpen",void 0),(0,d.gn)([c.SB],eR.prototype,"scenarioDefaultOpen",void 0),(0,d.gn)([c.SB],eR.prototype,"templateDefaultOpen",void 0),(0,d.gn)([c.SB],eR.prototype,"showDetailBackGuide",void 0),(0,d.gn)([c.SB],eR.prototype,"showDownloadMobilePopover",void 0),(0,d.gn)([c.SB],eR.prototype,"viewType",void 0),(0,d.gn)([c.SB],eR.prototype,"initImageOnboardingShowed",void 0),(0,d.gn)([c.SB],eR.prototype,"taskWaitingInfo",void 0),(0,d.gn)([c.SB],eR.prototype,"templateWhiteList",void 0),(0,d.gn)([c.Fl],eR.prototype,"selectThumbnailImageUrl",null),(0,d.gn)([c.Fl],eR.prototype,"selectImageCdnUrl",null),(0,d.gn)([c.Fl],eR.prototype,"generateImageThumbnailUrls",null),(0,d.gn)([c.Fl],eR.prototype,"generateImageCdnUrls",null),(0,d.gn)([c.Fl],eR.prototype,"generateImageHasWaterMark",null),(0,d.gn)([c.Fl],eR.prototype,"generateVideoHasWaterMark",null),(0,d.gn)([c.Fl],eR.prototype,"generateVideoUrl",null),(0,d.gn)([c.Fl],eR.prototype,"showDetail",null),(0,d.gn)([c.Fl],eR.prototype,"history",null),(0,d.gn)([c.Fl],eR.prototype,"isMobile",null),(0,d.gn)([c.Fl],eR.prototype,"isIpad",null),(0,d.gn)([c.Fl],eR.prototype,"functionType",null),(0,d.gn)([c.Fl],eR.prototype,"hasImageUploading",null),(0,d.gn)([c.Fl],eR.prototype,"isImageUpscaleWorkflow",null),(0,d.gn)([c.Fl],eR.prototype,"pixverseTemplateList",null),(0,d.gn)([c.Fl],eR.prototype,"templateConfigList",null),(0,d.gn)([c.Fl],eR.prototype,"templateConfigListOptions",null),(0,d.gn)([c.Fl],eR.prototype,"imageModelsConfigList",null),(0,d.gn)([c.Fl],eR.prototype,"videoModelsConfigList",null),(0,d.gn)([c.Fl],eR.prototype,"usageModule",null),(0,d.gn)([c.Fl],eR.prototype,"imageCanCompare",null),(0,d.gn)([c.Fl],eR.prototype,"S",null),(0,d.gn)([c.Fl],eR.prototype,"imageModelConfig",null),(0,d.gn)([c.Fl],eR.prototype,"videoModelConfig",null),(0,d.gn)([c.Fl],eR.prototype,"imageModelConfigOptions",null),(0,d.gn)([c.Fl],eR.prototype,"videoModelConfigOptions",null),(0,d.gn)([c.Fl],eR.prototype,"generateImageFields",null),(0,d.gn)([c.Fl],eR.prototype,"generateVideoFields",null),(0,d.gn)([c.Fl],eR.prototype,"generateImageByScenarioFields",null),(0,d.gn)([c.Fl],eR.prototype,"templateFields",null),(0,d.gn)([c.Fl],eR.prototype,"tagMap",null),(0,d.gn)([c.Fl],eR.prototype,"costCredit",null),(0,d.gn)([c.Fl],eR.prototype,"editImageRangeConfig",null);let eU=new eR},78148:function(e,t,i){"use strict";i.d(t,{liteWindowController:function(){return U}});var a=i(66084),o=i(73047),s=i(52921),n=i(34491),r=i(44015),l=i(92498),d=i(12596);class c{get backEnabled(){return!!r.$.activeFrom}handleBackClick(){"toolCard"===r.$.activeFrom&&(r.$.popoverOpenToolId="playground"),this.handleCloseClick()}show(e,t){this.visible=!0;let{left:i,top:a}=e;this.opacityHide=!0,this.position={left:0,top:0},setTimeout(()=>{let e=this.resizableController.root;if(e){let{width:o,height:s}=e.getBoundingClientRect();this.size={width:o,height:s},i+o>window.innerWidth-65&&(i=window.innerWidth-o-65),a+s>window.innerHeight-85&&(a=window.innerHeight-s-85),i=i<0?0:i,a=a<0?0:a,this.position={left:i+t.x,top:a+t.y},this.position={left:i+t.x,top:a+t.y},this.opacityHide=!1}})}updatePosition(e){this.position=e}handleDrag(){this.sizeOrPositionChangeFlag+=1}updateSize(e){this.size=e,this.sizeOrPositionChangeFlag+=1}resetPanel(){this.position={left:0,top:0}}hide(){this.visible=!1}handlePrevClick(){}handleNextClick(){}handleMaskClick(){this.hide(),r.$.cancelExtraInfo()}handleRefreshClick(){}handleStopClick(){}handleRetryClick(){}async handleSaveToMemo(){}handlePinClick(e){this.pinned=!this.pinned,this.updatePosition(e)}handleContinueInChat(e){}destroy(){this.outputList=[],this.resetPanel(),this.currentPage=0}handleContinueInputChange(e){this.continueInputText=e}constructor(){(0,a._)(this,"resultContentEl",null),(0,a._)(this,"draggableController",new l.$),(0,a._)(this,"resizableController",new d.S),(0,a._)(this,"continueInputText",""),(0,a._)(this,"visible",!1),(0,a._)(this,"input",""),(0,a._)(this,"context",""),(0,a._)(this,"activeActionId",null),(0,a._)(this,"position",{top:0,left:0}),(0,a._)(this,"isSave2Memo",!1),(0,a._)(this,"pinned",!0),(0,a._)(this,"actionListPopoverOpen",!1),(0,a._)(this,"gpt4Enabled",!1),(0,a._)(this,"isFixed",!0),(0,a._)(this,"size",{width:384,height:300}),(0,a._)(this,"isResultEdit",!1),(0,a._)(this,"webAccessEnabled",!1),(0,a._)(this,"speakEnabled",!1),(0,a._)(this,"langSelectEnabled",void 0),(0,a._)(this,"supportWebAccess",void 0),(0,a._)(this,"outputList",[]),(0,a._)(this,"currentPage",0),(0,a._)(this,"title",void 0),(0,a._)(this,"opacityHide",!1),(0,a._)(this,"sizeOrPositionChangeFlag",0),(0,a._)(this,"disableBackHotkey",!0),(0,a._)(this,"handleCopyClick",void 0),(0,a._)(this,"handleSpeakClick",void 0),(0,a._)(this,"handleEditClick",void 0),(0,a._)(this,"updateOutputItem",void 0),(0,a._)(this,"handleGp4Change",void 0),(0,a._)(this,"handleLangChange",void 0),(0,a._)(this,"handleQuoteTextChange",void 0),(0,a._)(this,"handleWebAccessChange",void 0),(0,a._)(this,"handleCloseClick",()=>{this.hide(),this.resetPanel(),r.$.handleCloseAction()}),(0,o.rC)(this)}}(0,s.gn)([n.SB],c.prototype,"continueInputText",void 0),(0,s.gn)([n.SB],c.prototype,"visible",void 0),(0,s.gn)([n.SB],c.prototype,"input",void 0),(0,s.gn)([n.SB],c.prototype,"context",void 0),(0,s.gn)([n.SB],c.prototype,"activeActionId",void 0),(0,s.gn)([n.SB],c.prototype,"position",void 0),(0,s.gn)([n.SB],c.prototype,"isSave2Memo",void 0),(0,s.gn)([n.SB],c.prototype,"pinned",void 0),(0,s.gn)([n.SB],c.prototype,"actionListPopoverOpen",void 0),(0,s.gn)([n.SB],c.prototype,"gpt4Enabled",void 0),(0,s.gn)([n.SB],c.prototype,"isFixed",void 0),(0,s.gn)([n.SB],c.prototype,"size",void 0),(0,s.gn)([n.SB],c.prototype,"isResultEdit",void 0),(0,s.gn)([n.SB],c.prototype,"webAccessEnabled",void 0),(0,s.gn)([n.SB],c.prototype,"speakEnabled",void 0),(0,s.gn)([n.SB],c.prototype,"langSelectEnabled",void 0),(0,s.gn)([n.SB],c.prototype,"supportWebAccess",void 0),(0,s.gn)([n.SB],c.prototype,"outputList",void 0),(0,s.gn)([n.SB],c.prototype,"currentPage",void 0),(0,s.gn)([n.SB],c.prototype,"title",void 0),(0,s.gn)([n.SB],c.prototype,"opacityHide",void 0),(0,s.gn)([n.SB],c.prototype,"sizeOrPositionChangeFlag",void 0),(0,s.gn)([n.SB],c.prototype,"disableBackHotkey",void 0),(0,s.gn)([n.Fl],c.prototype,"backEnabled",null);var h=i(33381),g=i(37949),p=i(90230),A=i(1396),m=i(91433),u=i(24900);class f{get backEnabled(){return!!r.$.activeFrom}get currentOutput(){return this.outputList[this.currentPage]||null}handleBackClick(){"toolCard"===r.$.activeFrom&&(r.$.popoverOpenToolId="playground"),this.hide()}setContentDom(e){this.contentDom=e}handleDrag(){this.freezeSize=!0}calculateSize(){this.contentDom&&(this.freezeSize||requestAnimationFrame(()=>{if(!this.contentDom)return;let e=this.contentDom.getBoundingClientRect(),t=this.contentDom.scrollHeight,i=t-e.height;if(window.innerWidth-t-8<0)return;let a=this.position.top-i;a<8||(this.position.top=a)}))}handleModelChange(e){r.$.refreshOutput(e)&&(this.currentModal=e)}show(e,t,i,a){this.visible=!0,this.freezeSize=!1;let{left:o,top:s}=e;this.opacityHide=!0;let{width:n,height:r}=this.size;o+n>window.innerWidth-65&&(o=window.innerWidth-n-65),s+r>window.innerHeight-85&&(s=window.innerHeight-r-85),o=o<0?0:o,s=s<8?8:s;let l=0;window.innerHeight-s<=r+85+120&&(l=Math.max(8,window.innerHeight-e.top-r)-t.y),this.position={left:o+t.x,top:s+t.y,bottom:l},this.modelList=i,this.currentModal=a||i[0].value,this.opacityHide=!0}updateOutputItem(e,t){let i=this.outputList.findIndex(t=>t.id===e);-1!==i?this.outputList[i]={...this.outputList[i],...t}:(this.outputList.push({id:e,useModel:m.Q7,type:"dynamic_action",payload:t.payload,content:t.content,...t}),this.currentPage=this.outputList.length-1)}updatePosition(e){this.position=e}updateSize(e){this.size=e,this.freezeSize=!0}resetPanel(){this.position={left:0,top:0}}hide(){this.visible=!1}handleMaskClick(){this.hide()}handleRefreshClick(){r.$.refreshOutput()}handleStopClick(){var e,t;let i=null===(e=this.currentOutput)||void 0===e?void 0:e.id;if(!i)return;u.Tn.cancelTask(i,"dynamicAction"),this.updateOutputItem(i,{loading:!1});let a=null===(t=r.$.replyDataMap[i])||void 0===t?void 0:t.extraData;a&&!0===a.loadingImage&&(a.loadingImage=!1),r.$.stopTask(i)}handleRetryClick(){}async handleSaveToMemo(){if(!this.currentOutput)return;if(this.currentOutput.memoId){await g.w.show("memo"),p.a.handleMemoClick(this.currentOutput.memoId,!0,!1);return}let e=[!!this.input&&"> ".concat(this.input),this.currentOutput.content].filter(Boolean),t=await p.a.createTextMemo({content:e.join("\n\n"),isMarkdown:!0});this.updateOutputItem(this.currentOutput.id,{memoId:t.item.uid}),p.a.saveToMemoSuccess(t.item.uid,"dialogRoot")}handlePinClick(e){this.pinned=!this.pinned,this.updatePosition(e)}async handleContinueInChat(e){var t;if(!this.currentOutput)return;r.$.sendEvent("smart_action_click",{page:"result",button:"ask",toolId:null===(t=r.$.activeCustomTool)||void 0===t?void 0:t.uid});let{payload:i}=this.currentOutput;await g.w.show("chat");let a=r.$.activeCustomTool;A.Mp.openBot(m.Z9.monica),this.handleCloseClick(),a&&(await A.Mp.beforeContinueInChat()).continueInChat({type:"dynamic_action",payload:i,toolData:(0,o.ZN)(a),title:r.$.getLocaleV2(a.i18nData,"name"),summary:""},e)}destroy(){this.handleStopClick(),this.outputList=[],this.resetPanel(),this.currentPage=0}handleContinueInputChange(e){this.continueInputText=e}constructor(){(0,a._)(this,"resultContentEl",null),(0,a._)(this,"draggableController",new l.$),(0,a._)(this,"resizableController",new d.S),(0,a._)(this,"layoutDirection","top"),(0,a._)(this,"visible",!1),(0,a._)(this,"input",""),(0,a._)(this,"context",""),(0,a._)(this,"activeActionId",null),(0,a._)(this,"position",{top:0,left:0}),(0,a._)(this,"isSave2Memo",!1),(0,a._)(this,"pinned",!0),(0,a._)(this,"actionListPopoverOpen",!1),(0,a._)(this,"gpt4Enabled",!1),(0,a._)(this,"isFixed",!0),(0,a._)(this,"size",{width:500,height:300}),(0,a._)(this,"isResultEdit",!1),(0,a._)(this,"webAccessEnabled",!1),(0,a._)(this,"speakEnabled",!1),(0,a._)(this,"disableMoreOperation",!0),(0,a._)(this,"langSelectEnabled",void 0),(0,a._)(this,"supportWebAccess",void 0),(0,a._)(this,"outputList",[]),(0,a._)(this,"currentPage",0),(0,a._)(this,"title",void 0),(0,a._)(this,"modelList",[]),(0,a._)(this,"currentModal",""),(0,a._)(this,"opacityHide",!1),(0,a._)(this,"disableBackHotkey",!0),(0,a._)(this,"continueInputText",""),(0,a._)(this,"handleCopyClick",void 0),(0,a._)(this,"handleSpeakClick",void 0),(0,a._)(this,"handleEditClick",void 0),(0,a._)(this,"handleGp4Change",void 0),(0,a._)(this,"handleLangChange",void 0),(0,a._)(this,"handleQuoteTextChange",void 0),(0,a._)(this,"handleWebAccessChange",void 0),(0,a._)(this,"contentDom",null),(0,a._)(this,"freezeSize",!1),(0,a._)(this,"handlePrevClick",()=>{this.currentPage=Math.max(0,this.currentPage-1),r.$.currentTaskId=this.outputList[this.currentPage].id}),(0,a._)(this,"handleNextClick",()=>{this.currentPage=Math.min(this.outputList.length-1,this.currentPage+1),r.$.currentTaskId=this.outputList[this.currentPage].id}),(0,a._)(this,"handleCloseClick",()=>{this.hide(),this.resetPanel()}),(0,o.rC)(this)}}(0,s.gn)([n.SB],f.prototype,"visible",void 0),(0,s.gn)([n.SB],f.prototype,"input",void 0),(0,s.gn)([n.SB],f.prototype,"context",void 0),(0,s.gn)([n.SB],f.prototype,"activeActionId",void 0),(0,s.gn)([n.SB],f.prototype,"position",void 0),(0,s.gn)([n.SB],f.prototype,"isSave2Memo",void 0),(0,s.gn)([n.SB],f.prototype,"pinned",void 0),(0,s.gn)([n.SB],f.prototype,"actionListPopoverOpen",void 0),(0,s.gn)([n.SB],f.prototype,"gpt4Enabled",void 0),(0,s.gn)([n.SB],f.prototype,"isFixed",void 0),(0,s.gn)([n.SB],f.prototype,"size",void 0),(0,s.gn)([n.SB],f.prototype,"isResultEdit",void 0),(0,s.gn)([n.SB],f.prototype,"webAccessEnabled",void 0),(0,s.gn)([n.SB],f.prototype,"speakEnabled",void 0),(0,s.gn)([n.SB],f.prototype,"disableMoreOperation",void 0),(0,s.gn)([n.SB],f.prototype,"langSelectEnabled",void 0),(0,s.gn)([n.SB],f.prototype,"supportWebAccess",void 0),(0,s.gn)([n.SB],f.prototype,"outputList",void 0),(0,s.gn)([n.SB],f.prototype,"currentPage",void 0),(0,s.gn)([n.SB],f.prototype,"title",void 0),(0,s.gn)([n.SB],f.prototype,"modelList",void 0),(0,s.gn)([n.SB],f.prototype,"currentModal",void 0),(0,s.gn)([n.SB],f.prototype,"opacityHide",void 0),(0,s.gn)([n.SB],f.prototype,"disableBackHotkey",void 0),(0,s.gn)([n.SB],f.prototype,"continueInputText",void 0),(0,s.gn)([n.Fl],f.prototype,"backEnabled",null),(0,s.gn)([n.Fl],f.prototype,"currentOutput",null);class y{async showOutput(e,t,i,a){this.hideInput(),await h.userController.checkLogin(),this.actionOutputManager.show(e,t,i,a)}async showInput(e,t){this.hideOutput(),await h.userController.checkLogin(),this.actionInputManager.show(e,t)}hideInput(){this.actionInputManager.hide()}hideOutput(){this.actionOutputManager.hide()}hide(){this.hideInput(),this.hideOutput()}constructor(){(0,a._)(this,"actionOutputManager",void 0),(0,a._)(this,"actionInputManager",void 0),(0,o.rC)(this),this.actionOutputManager=new f,this.actionInputManager=new c}}var v=i(62659),w=i(2439);class C{show(e){this.visible=!0,this.position=e.pos,this.uid=e.uid}updatePosition(e){this.position=e}updateSize(e){this.size=e}resetPanel(){this.position={left:0,top:0},this.pinned=!1}hide(){this.visible=!1}async submitComment(e){var t,i;return v.g.update({uid:this.uid,comment:e,color:null!==(i=null===(t=w.j.findMarkByUid(this.uid))||void 0===t?void 0:t.color)&&void 0!==i?i:1})}async deleteComment(){var e,t;return v.g.update({uid:this.uid,comment:"",color:null!==(t=null===(e=w.j.findMarkByUid(this.uid))||void 0===e?void 0:e.color)&&void 0!==t?t:1})}handlePrevClick(){}handleNextClick(){}handleMaskClick(){this.hide()}handleRefreshClick(){}handleStopClick(){}handleRetryClick(){}async handleSaveToMemo(){}handlePinClick(e){}handleContinueInChat(e){}handleContinueInputChange(e){this.continueInputText=e}constructor(){(0,a._)(this,"draggableController",new l.$),(0,a._)(this,"resizableController",new d.S),(0,a._)(this,"uid",void 0),(0,a._)(this,"visible",!1),(0,a._)(this,"input",""),(0,a._)(this,"context",""),(0,a._)(this,"activeActionId",null),(0,a._)(this,"position",{top:0,left:0}),(0,a._)(this,"isSave2Memo",!1),(0,a._)(this,"pinned",!1),(0,a._)(this,"actionListPopoverOpen",!1),(0,a._)(this,"gpt4Enabled",!1),(0,a._)(this,"isFixed",!1),(0,a._)(this,"size",{width:420,height:240}),(0,a._)(this,"isResultEdit",!1),(0,a._)(this,"webAccessEnabled",!1),(0,a._)(this,"speakEnabled",!1),(0,a._)(this,"backEnabled",void 0),(0,a._)(this,"langSelectEnabled",void 0),(0,a._)(this,"supportWebAccess",void 0),(0,a._)(this,"outputList",[]),(0,a._)(this,"currentPage",1),(0,a._)(this,"title",void 0),(0,a._)(this,"continueInputText",""),(0,a._)(this,"handleCopyClick",void 0),(0,a._)(this,"handleSpeakClick",void 0),(0,a._)(this,"handleEditClick",void 0),(0,a._)(this,"handleBackClick",void 0),(0,a._)(this,"updateOutputItem",void 0),(0,a._)(this,"handleGp4Change",void 0),(0,a._)(this,"handleLangChange",void 0),(0,a._)(this,"handleQuoteTextChange",void 0),(0,a._)(this,"handleWebAccessChange",void 0),(0,a._)(this,"handleCloseClick",()=>{this.hide(),this.resetPanel()}),(0,o.rC)(this)}}(0,s.gn)([n.SB],C.prototype,"visible",void 0),(0,s.gn)([n.SB],C.prototype,"input",void 0),(0,s.gn)([n.SB],C.prototype,"context",void 0),(0,s.gn)([n.SB],C.prototype,"activeActionId",void 0),(0,s.gn)([n.SB],C.prototype,"position",void 0),(0,s.gn)([n.SB],C.prototype,"isSave2Memo",void 0),(0,s.gn)([n.SB],C.prototype,"pinned",void 0),(0,s.gn)([n.SB],C.prototype,"actionListPopoverOpen",void 0),(0,s.gn)([n.SB],C.prototype,"gpt4Enabled",void 0),(0,s.gn)([n.SB],C.prototype,"isFixed",void 0),(0,s.gn)([n.SB],C.prototype,"size",void 0),(0,s.gn)([n.SB],C.prototype,"isResultEdit",void 0),(0,s.gn)([n.SB],C.prototype,"webAccessEnabled",void 0),(0,s.gn)([n.SB],C.prototype,"speakEnabled",void 0),(0,s.gn)([n.SB],C.prototype,"backEnabled",void 0),(0,s.gn)([n.SB],C.prototype,"langSelectEnabled",void 0),(0,s.gn)([n.SB],C.prototype,"supportWebAccess",void 0),(0,s.gn)([n.SB],C.prototype,"outputList",void 0),(0,s.gn)([n.SB],C.prototype,"currentPage",void 0),(0,s.gn)([n.SB],C.prototype,"title",void 0),(0,s.gn)([n.SB],C.prototype,"continueInputText",void 0);var b=i(77313),S=i(90180),I=i(67925),_=i(1159),T=i(11502),k=i(92020),E=i(10043),M=i(92235),x=i(12875);class B{get source(){return"selectionAction:Translate"===this.currentAction.systemKey?"quick_action_translate":"quick_action"}get outputList(){return this.composeOutputManger.outputList.flatMap(e=>({id:e.id,content:this.getOutputContent(e),loading:e.loading,error:e.error,useModel:e.useModel||m.Q7}))}get language(){return S.A.finalQuickActionTranslateLanguage}get langSelectValue(){return S.A.quickActionTranslateLanguage}get currentPage(){return this.composeOutputManger.activeOutputIndex}get speakEnabled(){var e;return(null===(e=this.composeOutputManger.activeOutput)||void 0===e?void 0:e.type)!=="word"}get currentActionId(){var e,t;return this.activeActionId?this.activeActionId:null===(t=I.customPromptController.actionRenderList)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.id}get currentAction(){return I.customPromptController.actionRenderList.find(e=>e.id===this.currentActionId)}get currentActionContent(){return this.currentAction.content}get backEnabled(){return null!==this.tempHandlerBackClick}get langSelectEnabled(){return(0,E._z)(this.currentAction.systemKey)||M.m.hasLangPlaceholder(this.currentAction.content)}updateSize(e){this.size=e}updatePosition(e){this.position=e}handleActionClick(e){this.activeActionId=e.id,this.generateOutput(),this.reportTranslateOrExplainActionShow()}reportTranslateOrExplainActionShow(){(0,E._z)(this.currentAction.systemKey)&&T.M.createUserBehaviorEvent({eventName:"quick_action_detail_show",extData:{tab:"translate"}}),(0,E.Go)(this.currentAction.systemKey)&&T.M.createUserBehaviorEvent({eventName:"quick_action_detail_show",extData:{tab:"explain"}})}reportTranslateActionClick(e){let{button:t,status:i}=e;(0,E._z)(this.currentAction.systemKey)&&T.M.createUserBehaviorEvent({eventName:"quick_action_detail_click",extData:{tab:"translate",button:t,status:i}})}toggleVisible(){this.visible=!this.visible}show(e){if(e){var t,i;this.size=e.liteWindowSize||{},this.triggerSource=e.triggerSource||"reading";let a={width:(null===(t=e.liteWindowSize)||void 0===t?void 0:t.width)||500,height:(null===(i=e.liteWindowSize)||void 0===i?void 0:i.height)||420};h.userController.checkLogin().finally(async()=>{if(h.userController.isLogin){if(this.input=e.input.substring(0,2e3),this.context=e.context||e.input,this.activeActionId=e.actionId,this.reportTranslateOrExplainActionShow(),this.pinned){this.composeOutputManger.clear(),this.generateOutput();return}e.onBackClick&&(this.tempHandlerBackClick=e.onBackClick),e.onCloseClick&&(this.tempHandlerCloseClick=e.onCloseClick),this.gpt4Enabled=e.gpt4Enabled,this.gpt4ChangeHandler=e.onGpt4Change,this.isFixed=!!e.isFixed;let t=e.position.left,i=e.position.top;t+a.width-window.scrollX>window.innerWidth-15&&(t=window.innerWidth-a.width+window.scrollX-15),i+a.height-window.scrollY>window.innerHeight-5&&(i=window.innerHeight-a.height+window.scrollY-5),t=t<0?0:t,i=i<0?0:i,this.position={left:t,top:i},this.generateOutput()}else this.hide(),g.w.show();this.visible=!0})}else this.visible=!0}hide(){this.visible=!1}async retry(e){(!this.beforeTriggerActionHandler||await this.beforeTriggerActionHandler(this.gpt4Enabled))&&this.composeOutputManger.generateOutput({promptContent:this.currentActionContent,selectedText:this.input,language:{key:this.resolveTargetRespLang(),name:""},actionLang:S.A.finalQuickActionTranslateLanguage,systemKey:this.currentAction.systemKey,actionInput:this.input,fullContext:this.context,actionId:this.activeActionId,useModel:this.gpt4Enabled?m.f2:m.Q7},"lite_window_quick_action_retry",{outputId:e})}triggerAction(e){h.userController.checkLogin().finally(async()=>{if(this.input=e.input.substring(0,2e3),this.context=e.input,this.activeActionId=e.actionId,this.reportTranslateOrExplainActionShow(),this.pinned){this.composeOutputManger.clear(),this.generateOutput();return}this.generateOutput(),this.visible=!0})}async generateOutput(){(!this.beforeTriggerActionHandler||await this.beforeTriggerActionHandler(this.gpt4Enabled))&&(this.setMemoSaveStatus(!1),this.composeOutputManger.generateOutput({promptContent:this.currentActionContent,selectedText:this.input.trim(),language:{key:this.resolveTargetRespLang(),name:""},originLang:this.translateOriginLang||"auto",actionLang:S.A.finalQuickActionTranslateLanguage,systemKey:this.currentAction.systemKey,actionInput:this.input.trim(),fullContext:this.context.trim(),actionId:this.activeActionId,useModel:this.gpt4Enabled?m.f2:m.Q7},this.source))}async continueInChat(e){let t=this.getMemoContent();this.handleCloseClick();let i=await A.Mp.beforeContinueInChat();await i.continueInChat(t,e)}resetPanel(){this.composeOutputManger.clear(),this.position={left:0,top:0},this.pinned=!1,this.translateOriginLang="auto",this.triggerSource=null}getMemoContent(){let e=this.currentAction.content,t=S.A.finalQuickActionTranslateLanguage;return e=M.m.transformActionContent(e,{lang:t}),{type:"quickAction",name:this.currentAction.name,content:e,result:this.getOutputContent(),icon:this.currentAction.iconName||b.jp,selectedText:this.input}}getOutputContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.composeOutputManger.activeOutput;if(!e)return"";let t=I.customPromptController.actionRenderList.find(t=>t.id===e.actionId);return(0,E._z)(null==t?void 0:t.systemKey)?[e.translation,"word"===e.type&&this.input,e.pronounce&&"/".concat(e.pronounce,"/"),e.detail].filter(Boolean).join("\n"):(null==e?void 0:e.content)||""}async setMemoSaveStatus(e){this.isSave2Memo=e}setTranslateOriginLang(e){this.translateOriginLang=null!=e?e:"auto"}updateOutputItem(e,t){let i=this.outputList.findIndex(t=>t.id===e);-1!==i&&(this.outputList[i]={...this.outputList[i],...t})}updateOutputResult(e){let t=this.composeOutputManger.outputList.find(e=>e.id===this.composeOutputManger.activeId);t&&((0,E._z)(this.currentAction.systemKey)?t.translation=e:t.content=e)}handleContinueInputChange(e){this.continueInputText=e}handleInsertAction(){let e=this.outputList[this.currentPage].content;_.h.replaceText({type:"replaceSelection",text:e}),this.handleCloseClick()}toggleActionWithOutput(){let e=this.composeOutputManger.activeOutput;(null==e?void 0:e.actionId)&&(this.activeActionId=e.actionId)}resolveTargetRespLang(){return(0,E.UX)(this.currentAction.systemKey)||(0,E.Pj)(this.currentAction.systemKey)||(0,E.hz)(this.currentAction.systemKey)?"auto":S.A.finalQuickActionRespondLanguage}constructor(){(0,a._)(this,"resultContentEl",null),(0,a._)(this,"composeOutputManger",new x.i({insertTarget:"dialogRoot",providerType:"quickAction",getScrollContainer:()=>this.resultContentEl})),(0,a._)(this,"draggableController",new l.$),(0,a._)(this,"resizableController",new d.S),(0,a._)(this,"tempHandlerBackClick",null),(0,a._)(this,"tempHandlerCloseClick",null),(0,a._)(this,"gpt4ChangeHandler",null),(0,a._)(this,"beforeTriggerActionHandler",null),(0,a._)(this,"triggerSource",null),(0,a._)(this,"visible",!1),(0,a._)(this,"input",""),(0,a._)(this,"context",""),(0,a._)(this,"activeActionId",null),(0,a._)(this,"position",{top:0,left:0}),(0,a._)(this,"isSave2Memo",!1),(0,a._)(this,"pinned",!1),(0,a._)(this,"actionListPopoverOpen",!1),(0,a._)(this,"gpt4Enabled",!1),(0,a._)(this,"isFixed",!1),(0,a._)(this,"size",{}),(0,a._)(this,"isResultEdit",!1),(0,a._)(this,"webAccessEnabled",!1),(0,a._)(this,"translateOriginLang","auto"),(0,a._)(this,"continueInputText",""),(0,a._)(this,"handlePinClick",e=>{this.pinned=!this.pinned,this.position=e}),(0,a._)(this,"handleCloseClick",()=>{this.hide(),this.resetPanel(),this.tempHandlerCloseClick&&(this.tempHandlerCloseClick(),this.tempHandlerCloseClick=null)}),(0,a._)(this,"handleLangChange",e=>{S.A.quickActionTranslateLanguage=e,k.ll.set("quickActionTranslateLanguage",e),this.generateOutput()}),(0,a._)(this,"handleSpeakClick",()=>{this.reportTranslateActionClick({button:"speak"})}),(0,a._)(this,"handleCopyClick",()=>{this.reportTranslateActionClick({button:"copy"})}),(0,a._)(this,"handleRefreshClick",()=>{this.generateOutput(),this.reportTranslateActionClick({button:"retry"})}),(0,a._)(this,"handleStopClick",()=>{let e=this.composeOutputManger.activeId;e&&this.composeOutputManger.stop(e)}),(0,a._)(this,"handleRetryClick",()=>{let e=this.composeOutputManger.activeId;e&&this.retry(e)}),(0,a._)(this,"handlePrevClick",()=>{this.composeOutputManger.handlePrevClick(),this.toggleActionWithOutput()}),(0,a._)(this,"handleNextClick",()=>{this.composeOutputManger.handleNextClick(),this.toggleActionWithOutput()}),(0,a._)(this,"handleGp4Change",async e=>{var t;null===(t=this.gpt4ChangeHandler)||void 0===t||t.call(this,e),this.gpt4Enabled=e;let i=this.composeOutputManger.activeOutput;(null==i?void 0:i.loading)||setTimeout(()=>{this.generateOutput()},100),this.reportTranslateActionClick({button:"gpt4",status:e})}),(0,a._)(this,"handleContinueInChat",e=>{this.continueInChat(e),this.reportTranslateActionClick({button:"chat"})}),(0,a._)(this,"handleResultEditStatusChange",e=>{this.isResultEdit=e}),(0,a._)(this,"handleSaveToMemo",async()=>{let e;let t=this.composeOutputManger.activeOutput;e=(0,E._z)(this.currentAction.systemKey)?(null==t?void 0:t.type)==="word"?{type:"quickActionTranslate",detail:t.detail||"",input:this.input,pronounce:t.pronounce,translation:t.translation}:{type:"commonTranslate",input:this.input,detail:(null==t?void 0:t.translation)||""}:{type:"quickAction",selectedText:this.input,content:this.currentAction.content,icon:this.currentAction.iconName,name:this.currentAction.name,result:(null==t?void 0:t.content)||""};let i=await p.a.createFromEmbed({embedData:e});p.a.saveToMemoSuccess(i.item.uid,"dialogRoot"),this.reportTranslateActionClick({button:"memo"})}),(0,a._)(this,"handleBackClick",e=>{this.tempHandlerBackClick&&(this.tempHandlerBackClick(e),this.tempHandlerBackClick=null),this.hide(),this.resetPanel()}),(0,a._)(this,"handleEditClick",()=>{this.isResultEdit=!0}),(0,a._)(this,"handleMaskClick",()=>{this.backEnabled?(this.updatePosition({left:this.position.left+this.draggableController.translate.x+this.resizableController.data.translateY,top:this.position.top+this.draggableController.translate.y+this.resizableController.data.translateY}),this.hide(),setTimeout(()=>{this.visible||this.handleCloseClick()},1e4)):this.handleCloseClick()}),(0,a._)(this,"handleTranslateOriginLangChange",e=>{this.setTranslateOriginLang(e),this.generateOutput()}),(0,o.rC)(this)}}(0,s.gn)([n.SB],B.prototype,"triggerSource",void 0),(0,s.gn)([n.SB],B.prototype,"visible",void 0),(0,s.gn)([n.SB],B.prototype,"input",void 0),(0,s.gn)([n.SB],B.prototype,"context",void 0),(0,s.gn)([n.SB],B.prototype,"activeActionId",void 0),(0,s.gn)([n.SB],B.prototype,"position",void 0),(0,s.gn)([n.SB],B.prototype,"isSave2Memo",void 0),(0,s.gn)([n.SB],B.prototype,"pinned",void 0),(0,s.gn)([n.SB],B.prototype,"actionListPopoverOpen",void 0),(0,s.gn)([n.SB],B.prototype,"gpt4Enabled",void 0),(0,s.gn)([n.SB],B.prototype,"isFixed",void 0),(0,s.gn)([n.SB],B.prototype,"size",void 0),(0,s.gn)([n.SB],B.prototype,"isResultEdit",void 0),(0,s.gn)([n.SB],B.prototype,"webAccessEnabled",void 0),(0,s.gn)([n.SB],B.prototype,"translateOriginLang",void 0),(0,s.gn)([n.SB],B.prototype,"continueInputText",void 0),(0,s.gn)([o.Fl],B.prototype,"source",null),(0,s.gn)([o.Fl],B.prototype,"outputList",null),(0,s.gn)([o.Fl],B.prototype,"language",null),(0,s.gn)([o.Fl],B.prototype,"langSelectValue",null),(0,s.gn)([o.Fl],B.prototype,"currentPage",null),(0,s.gn)([o.Fl],B.prototype,"speakEnabled",null),(0,s.gn)([o.Fl],B.prototype,"currentActionId",null),(0,s.gn)([o.Fl],B.prototype,"currentAction",null),(0,s.gn)([o.Fl],B.prototype,"currentActionContent",null),(0,s.gn)([o.Fl],B.prototype,"langSelectEnabled",null);var D=i(18245);class L{get title(){return this.userInput}get currentOutput(){return this.outputList[this.currentPage]}updatePosition(e){this.position=e}get backEnabled(){return null!==this.tempHandlerBackClick}updateSize(e){this.size=e}show(e){if(e){var t,i;let{position:a,onBack:o,onClose:s,input:n,selectText:r}=e;this.position=null!=a?a:{left:0,top:0},this.input=r||"",this.userInput=n,this.gpt4Enabled=e.gpt4Enabled,this.isFixed=null!==(t=e.isFixed)&&void 0!==t&&t,this.gpt4ChangeHandler=e.onGpt4Change,this.size=e.liteWindowSize||{},this.webAccessEnabled=null!==(i=e.webAccessEnabled)&&void 0!==i&&i,o&&(this.tempHandlerBackClick=o),s&&(this.tempHandlerCloseClick=s),this.generationOutputItem("refresh")}this.visible=!0}async generationOutputItem(e){if(this.beforeTriggerActionHandler&&!await this.beforeTriggerActionHandler(this.gpt4Enabled))return;let{isEnough:t,handleCreditsNotEnough:i}=D.K.checkCredits({module:this.gpt4Enabled?"genius_bot":"basic_query",source:this.source});if(!t){i();return}let{taskId:a}=await u.Tn.triggerQuickAskActions({selectText:this.input.trim(),userInput:this.userInput.trim(),useModel:this.gpt4Enabled?"gpt-4o":"gpt-4o-mini",webSearch:this.webAccessEnabled},(e,t,i)=>{var o;if(e){if(t||i){this.updateOutputItem(a,{loading:!1,error:i||""});return}(null===(o=e.agentStatus)||void 0===o?void 0:o.type)==="web_search"&&this.updateOutputItem(a,{webAccess:!0}),this.updateOutputItem(a,{content:null==e?void 0:e.fullText,loading:!0})}});"refresh"===e&&(this.setOutputList([...this.outputList,{id:a,loading:!0,content:"",useModel:this.gpt4Enabled?"gpt-4o":"gpt-4o-mini",userInput:this.userInput}]),this.currentPage=this.outputList.length-1),"retry"===e&&this.setOutputList(this.outputList.map((e,t)=>t===this.currentPage?{id:a,content:"",Loading:!0,useModel:this.gpt4Enabled?"gpt-4o":"gpt-4o-mini",userInput:this.userInput}:e))}hide(){this.visible=!1}resetPanel(){this.position={left:0,top:0},this.outputList=[],this.pinned=!1,this.currentPage=0}updateOutputItem(e,t){this.outputList=this.outputList.map(i=>i.id===e?{...i,...t}:i)}setOutputList(e){this.outputList=e}handleWebAccessChange(e){this.webAccessEnabled=e,e&&this.handleRefreshClick()}handleContinueInputChange(e){this.continueInputText=e}constructor(){(0,a._)(this,"source","quick_ask"),(0,a._)(this,"gpt4ChangeHandler",null),(0,a._)(this,"beforeTriggerActionHandler",null),(0,a._)(this,"tempHandlerBackClick",null),(0,a._)(this,"tempHandlerCloseClick",null),(0,a._)(this,"draggableController",new l.$),(0,a._)(this,"resizableController",new d.S),(0,a._)(this,"supportWebAccess",!0),(0,a._)(this,"webAccessForceEnabled",!1),(0,a._)(this,"position",{left:0,top:0}),(0,a._)(this,"outputList",[]),(0,a._)(this,"visible",!1),(0,a._)(this,"pinned",!1),(0,a._)(this,"currentPage",0),(0,a._)(this,"speakEnabled",!0),(0,a._)(this,"langSelectEnabled",!1),(0,a._)(this,"input",""),(0,a._)(this,"userInput",""),(0,a._)(this,"gpt4Enabled",!1),(0,a._)(this,"isFixed",!1),(0,a._)(this,"isResultEdit",!1),(0,a._)(this,"size",{}),(0,a._)(this,"webAccessEnabled",!1),(0,a._)(this,"continueInputText",""),(0,a._)(this,"handleCloseClick",()=>{this.hide(),this.resetPanel(),this.tempHandlerCloseClick&&(this.tempHandlerCloseClick(),this.tempHandlerBackClick=null)}),(0,a._)(this,"handlePinClick",()=>{this.pinned=!this.pinned}),(0,a._)(this,"handlePrevClick",()=>{this.currentPage=Math.max(0,this.currentPage-1)}),(0,a._)(this,"handleNextClick",()=>{this.currentPage=Math.min(this.outputList.length-1,this.currentPage+1)}),(0,a._)(this,"handleRefreshClick",()=>{this.generationOutputItem("refresh")}),(0,a._)(this,"handleStopClick",()=>{let e=this.currentOutput.id;e&&(u.Tn.cancelTask(e,"quickAction"),this.updateOutputItem(e,{loading:!1}))}),(0,a._)(this,"handleRetryClick",()=>{this.generationOutputItem("retry")}),(0,a._)(this,"handleEditClick",e=>{this.isResultEdit=void 0!==e?e:!this.isResultEdit}),(0,a._)(this,"handleBackClick",e=>{this.tempHandlerBackClick&&(this.tempHandlerBackClick(e),this.tempHandlerBackClick=null),this.hide(),this.resetPanel()}),(0,a._)(this,"handleSaveToMemo",async()=>{let e=["### ".concat(this.title),!!this.input&&"> ".concat(this.input),this.currentOutput.content].filter(Boolean),t=await p.a.createTextMemo({content:e.join("\n\n"),isMarkdown:!0});p.a.saveToMemoSuccess(t.item.uid,"dialogRoot")}),(0,a._)(this,"handleGp4Change",e=>{this.gpt4Enabled=e,this.generationOutputItem("refresh")}),(0,a._)(this,"handleContinueInChat",async e=>{this.currentOutput&&(await g.w.show("chat"),this.handleCloseClick())}),(0,a._)(this,"handleQuoteTextChange",e=>{this.input=e,this.handleRefreshClick()}),(0,a._)(this,"handleMaskClick",()=>{this.backEnabled?(this.updatePosition({left:this.position.left+this.draggableController.translate.x+this.resizableController.data.translateX,top:this.position.top+this.draggableController.translate.y+this.resizableController.data.translateY}),this.hide(),setTimeout(()=>{this.visible||this.handleCloseClick()},1e4)):this.handleCloseClick()}),(0,o.rC)(this)}}(0,s.gn)([n.SB],L.prototype,"position",void 0),(0,s.gn)([n.SB],L.prototype,"outputList",void 0),(0,s.gn)([n.SB],L.prototype,"visible",void 0),(0,s.gn)([n.SB],L.prototype,"pinned",void 0),(0,s.gn)([n.SB],L.prototype,"currentPage",void 0),(0,s.gn)([n.SB],L.prototype,"speakEnabled",void 0),(0,s.gn)([n.SB],L.prototype,"langSelectEnabled",void 0),(0,s.gn)([n.SB],L.prototype,"input",void 0),(0,s.gn)([n.SB],L.prototype,"userInput",void 0),(0,s.gn)([n.SB],L.prototype,"gpt4Enabled",void 0),(0,s.gn)([n.SB],L.prototype,"isFixed",void 0),(0,s.gn)([n.SB],L.prototype,"isResultEdit",void 0),(0,s.gn)([n.SB],L.prototype,"size",void 0),(0,s.gn)([n.SB],L.prototype,"webAccessEnabled",void 0),(0,s.gn)([n.SB],L.prototype,"continueInputText",void 0),(0,s.gn)([o.Fl],L.prototype,"title",null),(0,s.gn)([o.Fl],L.prototype,"currentOutput",null);class R{constructor(){(0,a._)(this,"quickActionManager",new B),(0,a._)(this,"quickAskManager",new L),(0,a._)(this,"addCommentManger",new C),(0,a._)(this,"actionToolManager",new y)}}let U=new R},18312:function(e,t,i){"use strict";i.d(t,{J:function(){return eS}});var a=i(66084),o=i(52921),s=i(34491),n=i(4461),r={src:"https://assets.monica.im/home-web/_next/static/media/aiDetectorDark.7b31c781.png",height:49,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEXc3N3c3N9MaXHh4t3Z2d3a2t3c3N+Xf/mUevibgvnc3OChjvKnk/Ha2tqm4LvAAAAADnRSTlNvgQAoO0oNZUx7lWh0FbRqiZMAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA4SURBVHicFcjBEcAwCASx5QADTtJ/uxl+GiEHCKGbmXk/jgWE+cIQi8T7PTveU4Wu66kaFGbR0z8h3wEV+WWeZQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},l={src:"https://assets.monica.im/home-web/_next/static/media/aiform.a627eb87.png",height:49,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEUjIil3Rv1hPtxnQOggICIfICEiIiVMaXEqJkEhISMlISUgICIgISFoQesjIycmJiwnJzqmvMZsAAAAEXRSTlMeNSJOhFKXACaKFH65ia2hDfDVbO4AAAAJcEhZcwAACxMAAAsTAQCanBgAAAA7SURBVHicNcZBEoAwCAPAtAUSoFr//1rHg3ta0CNTJCrwnBsEjPS9v8y5pgGwsa7Rf0yokKQo0LM7nS83XQGJDdMkvAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},d={src:"https://assets.monica.im/home-web/_next/static/media/aiformDark.fb0e1086.png",height:40,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEXV093c3dpMaXHW1tjd3dzf39+Jb/uZgvfd3d3b29uCZf/h49lxVf+tnuuZgPeUe/mpnoziAAAAEHRSTlMngQAXjLIqT5pOOV4SNYWIgpzTTwAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAADlJREFUeJwly0ESgDAIBMFhgYSoMf//rUV560ujFRZIeOGZLjDpzmw8Y+4AbMz3sh+n4QWbcrpbLH0kDQEPgPiYmQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},c={src:"https://assets.monica.im/home-web/_next/static/media/aiSearch.ceba1032.png",height:49,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEVMaXFDMX8lIyYhISUhIScfIR0hISUfHyYiIiVoQOpjPN8dHxdrQ/JyQ//IsuLWAAAADnRSTlMACheahyRdPFiEOGDiJs4d3gEAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA2SURBVHicHYs5EsAwDITQamXHR/7/3UxERQFAFM3Ms1dApVj3hfFA7GoJZFAKPDq208G/i6kPHkAAy+gFdSMAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},h={src:"https://assets.monica.im/home-web/_next/static/media/aiSearchDark.e7ff48d1.png",height:49,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAALVBMVEVMaXHf3+HOyeTd3eDb29/Nze7a2t7c3N7f4tuYgPebhfja2t6chPqMcvje3t0AaEFQAAAAD3RSTlMAXBKHHAedPCaEOJbiJm/RVk6gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAANklEQVR4nB2KSQ4AIAyEaKfVuv3/u0Y5kQDgxac3myMhmjP2ATPwWV+S0EsBsjcvaSmBLKf7BR3IANhenMsVAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},g={src:"https://assets.monica.im/home-web/_next/static/media/batchProcessor.10d15791.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAALVBMVEVWO7UhISUhISUhISchISUiIiciIiYjIyUhISQfHx4iIiZoQvNqQOhnQOllQOVsJ6HcAAAAD3RSTlMDeDwvgktnJosYWR5DwnaEYQLiAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOElEQVR4nCXByQGAMAwDMNu5U2D/cftAwpCkJ+BZVuWLNgUViTbTViRcsR0m9ODnaZrzPhjShe9cKHcBMpViy1YAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},p={src:"https://assets.monica.im/home-web/_next/static/media/batchProcessorDark.4542a89a.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEXa2t7b293b296kpODb29/e4Nzc3N/e3uHf3+GSeviZgPiYgfeXf/YEjaMCAAAADXRSTlN7LkACiRpgUGgZwkN2RzcLxgAAAAlwSFlzAAALEwAACxMBAJqcGAAAADZJREFUeJwVy8cRgDAQBLBNFwz0Xy9j/YXC1QaaZKURSpAWIdmcRTSToZCy7WNgqTrPi9vl7/wbdgDpw7D9lAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},A={src:"https://assets.monica.im/home-web/_next/static/media/bots.0f59fe38.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEWOUY4fIB8hIiMhISUiIicQGAgcIhchISZtQ/+IS/8iIiZgOdKcXf8hISVqQu8iIiYZc863AAAAEHRSTlMCVVs8qg9LmngXfkIYdECE+5GA0AAAAAlwSFlzAAALEwAACxMBAJqcGAAAADdJREFUeJwVwYURACAQBLG9F1z675YhAXDn2zfibtDIzBwitM5ZCsL6nN0CE60hw2uRSnVwk8x5LMEBJ0C11GYAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},m={src:"https://assets.monica.im/home-web/_next/static/media/botsDark.dcf7371d.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEXg4eBGRv/b29/d3d7Z2dxkP/+ahPbj6tzb297f4NmRdvra2t7k8dbYJiQIAAAADXRSTlNZAaZUPBhBCYFLeHQTpnHrAAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADVJREFUeJxFxrkBACAMA7FzYkh49p+XElVCki2JOh3Rp8iue6uTYMw5iB/Q3gIcK3OFkcnEeifMAQFhRE+/AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},u={src:"https://assets.monica.im/home-web/_next/static/media/chatHomeViewAiDetector.e89d408d.png",height:49,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAALVBMVEUhISUzM0UiIichISYhISYkJCRpQe9rQvMdHiNoQe0eISRaOcQhISUhISYgICVyKvUWAAAAD3RSTlN7ATtsSg9lTCt7I26Ikps4iYnWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAO0lEQVR4nBXJSQ4AMQgEsWogQLb5/3NHuVkyanfHhG5ExDcYmLvRDyAWg/BV+1V3zUx0l3bmRHaO1awfJaEBO48oR7IAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},f={src:"https://assets.monica.im/home-web/_next/static/media/chatHomeViewChatPdf.abdb5d34.png",height:49,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEVAG3IiIiUiIiYhISYiIiYjIichISUiIichISQhISVmO+5iPdojIychISYMGABtRPNuRfnGkZtEAAAAEXRSTlMBYVXBbFyfRzocDzR7lyrCWFRjKIEAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA6SURBVHicHcZbEoAgDATBCeSxARXvf1qr7K+GLqmBTveZBeVgV/af9lnIAGzAXkAM1nmfqFuwUYT4ACp6AT+HF8K4AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},y={src:"https://assets.monica.im/home-web/_next/static/media/chatHomeViewHumanize.8ad61fbb.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEVMaXEhISUhISYhIiUgICQkITITEx8fISIjIyNzR/chISUhISdnQeZtQvNjP9whISeTvaQDAAAAEHRSTlMAknVYZRwKOiwVVLNKxmHE4wy9qgAAAAlwSFlzAAALEwAACxMBAJqcGAAAADpJREFUeJwdy0kSgDAMBLGeseNsQP7/Wwp0F/waMJvCezHvp7a94JqZPkX0Ia8IuoayHJBqQy6g68svKRoBEwEVsAQAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},v={src:"https://assets.monica.im/home-web/_next/static/media/chatHomeViewMindmap.00bffdb3.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEWEQvMiIyAdHyEhISZqQ/QhIShoQvBoQOpmQOhoQexuRPwnJCwiIiUhIScwMDBKMpE7cQFxAAAAEHRSTlMBFUCBEi8oobyIYDR1kgoXHEx+CAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADZJREFUeJw1ykcSwCAQxEDNJpLh/8/l4ELXFryqY/65UQ2tXCJaKTNF9PlTjHePadu3AXEknQsf/gEB7xJRFgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},w={src:"https://assets.monica.im/home-web/_next/static/media/chatHomeViewPodcast.12ffbea5.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEUjJCAiJB1MaXEkJCUlJSYmJSdnQOlHAH9eQNFLNJBpQesVIABzRf9wRv6+hQ47AAAADnRSTlNeWQA1dWaTAilPZjt686XENVYAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA4SURBVHicFcbJEcAwDAOxJSVLvtJ/uxnjBdohwo1JSEykQBlocK8GL1UvkafqZGCt71sy7bn3dP8dLgEK+3gRBAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},C={src:"https://assets.monica.im/home-web/_next/static/media/chatHomeViewTranslate.6518081d.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEVMaXEmJiYmJiZoQOtfPdZnQOodIhklJSNlQOMkJCJNOLErJTAnJyclJSZoQOolJSUmJiYkJSBnQOioj9JWAAAAE3RSTlMAppZMLrgcUh1DDA8tR5B7Y8aWqgtePQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAD1JREFUeJwdyEcOwCAMAMEFbNyAlP8/NlLmOKQPTwvwV1WiBwwdYIYfPTIL0hF59p/crUP0Xe1qC8JqMecHOYgBl0COR5sAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},b={src:"https://assets.monica.im/home-web/_next/static/media/chatHomeViewWrite.cd578584.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEVMaXEmJh4gICEhISUYGxUjIighISEhISUfICAhISM3K2EhISUjHSN6Rfw5LGYgICh8Sf9dP9BDFDB5AAAAEnRSTlMAC2CbI21EjVVMisoVJO0/fV2UXZECAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOElEQVR4nAXBhwGAMAzAMCfN7KDw/7NIADsbQGJ1KuzhmpJNOFTeJPR81DJivgcvsGeWDwGsuwx+MD0BZeKG9wwAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},S={src:"https://assets.monica.im/home-web/_next/static/media/chatPdfDark.32fba472.png",height:49,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEW9qd7d3ODd3d7c3ODe4Nvf3+Pb297d3eGpn+bb29+chvWZf/ydhPt0p6LXAAAADXRSTlMBXjpuIVGdRBDBNFjCfNQS1wAAAAlwSFlzAAALEwAACxMBAJqcGAAAADdJREFUeJwdyrkRwDAQA7El75Nk91+vx8oQAHLsBWRH7B6YAEXnRcYuLAAVnH+qWO+TqjYcLJkPHuwA1zaduesAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},I={src:"https://assets.monica.im/home-web/_next/static/media/fullPage.381e2227.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAHlBMVEUgIhxmQOojIyiRSP96Sf9nQOpmQOgiIiVnQOtoQOuyuQf5AAAACnRSTlMxHFwBEXtRlk/29QMFsAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADJJREFUeJwFwYcBACAMwzBntMD/DyMRTHcFx2TexU40s0AitbRSAuyMEpv7JviAdovJBxwgAMeEl479AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},_={src:"https://assets.monica.im/home-web/_next/static/media/fullPageDark.adf83dda.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEXe3t2XgfhtSP6Zf/jk5OiEXf+Yf/iWf/fY2Nvb292Xf/mYgPiZgfn8fislAAAADXRSTlMxUQEaXhF4IleWgPZlcgpgjwAAAAlwSFlzAAALEwAACxMBAJqcGAAAADRJREFUeJwFwYkBADAIArED1H7779sEU7QUOBvPE1V27giws7rpXrEBzY1dhd6YfSBSU/gDHvAA20qt/ZgAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},T={src:"https://assets.monica.im/home-web/_next/static/media/grammarly.d7da1107.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEX////v7++Kioq9rPbo6Oj39vrAwMCTk5OhifKjpJ/s6PyagPG3pvLl5eVObSxvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAANklEQVR4nCWJyREAIBDCgL08+2/XUXklAdzu7ptIVamUCJK4S1WHGV4Zcw6k1Fdr9m6L+HDtACZDAO7nEIo5AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},k={src:"https://assets.monica.im/home-web/_next/static/media/grammarlyDark.035c7faf.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEVMaXHa2tvOxere3t7a2tqXf/eQefSbg/mYgPff4Nibg/iWfvVmuZYiAAAADHRSTlMAhhIaS3ELdKBqqGuWmBRqAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAMklEQVR4nB3JSQ4AMAgCQATtYv//30bmQAiAMiLDEhSJkREXVQAlqlte9jnb91urXCY+GHcAtApCLWsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},E={src:"https://assets.monica.im/home-web/_next/static/media/humanizeDark.c2cc1541.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEXo6OjV1d3c297b297Eu+a2p+vc3Nzc3N/b2t7b297b293b297d3d2Xf/iehPugiPTf3+JIziJWAAAAEXRSTlMBKGNuGRA0V5V4irNESsZhxKv7WpMAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA7SURBVHicHYtRDsAgCMUeIDxQN3f/0y7YpF9NgctoZdIW4e/xVUXgcVX7HIzIIolISUMnzSFZve7Z8w8tiQFG0UTKDAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},M={src:"https://assets.monica.im/home-web/_next/static/media/memo.4a55a5f6.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEUlJiNMaXElJSUlJSQmJiYiIiImJicmJiZsQvprQfprQ/AlJSUbIQuTvJJtAAAADXRSTlM8AHpykw6IM0QwyWQXAFtOkgAAAAlwSFlzAAALEwAACxMBAJqcGAAAADVJREFUeJwdyMkNADAMAjCgJOm1/7xV87MMHmf6EOW4N1zA4Joc+Ni7oT/qAXqsTLkQAgnFAydNAOjiljdXAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},x={src:"https://assets.monica.im/home-web/_next/static/media/memoDark.0c67e1f8.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEXd3dza2tpMaXHl6tva2drb29uSefzd3d3l5eXb29s6AP+iifuhifm5re2YhEQsAAAADnRSTlM6ewARcog5kJhjDdm5O2CuUsgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA1SURBVHicLchRDoAgEEPB15ZlQb3/eU3Qv8ng3VW9DZ0kDchzehw89/Xhn2E4WKrSgggb5QUh7wDPP4pXrAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},B={src:"https://assets.monica.im/home-web/_next/static/media/mindmapDark.e2b1135a.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEVMaXGWfPaYgfqYgPfc3N/b296cgf/e3t6di/Lc3NyZgvrb2+Dc3OHb297a2t2Qc/mQdfpCvJI5AAAAEXRSTlMALKG8L4McFQ1AiH80dZJYaLZWV+YAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA3SURBVHicNcq5AcAgDANAATaSeLP/tKm4+oCnNHnuafQKrliEamFEEGrXudPo4+3x+eQxAImkfiyqAWblPDuCAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},D={src:"https://assets.monica.im/home-web/_next/static/media/podcastDark.8a1d421f.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEXd3dvg4dhMaXHa2trg49fa2dqYf/f///+givazpuiXf/eNcP6hhv+aMFD4AAAADXRSTlNdNwB1WGeTASlPZnrzZ3/LjgAAAAlwSFlzAAALEwAACxMBAJqcGAAAADZJREFUeJwVxrcRwEAQA7Elz73rv16NEIGxQB5MQGAUCYSguDcLqOz+o1C3Qjj3ezvNeJ2zPB8ZRwDv3X4GOwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},L={src:"https://assets.monica.im/home-web/_next/static/media/read.455690c1.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEUWFjshISYmJiZ1RcAcHCogISQhISciIiUhISUhISVmP+drQO4jIygjIieZ8zLZAAAADnRSTlMBixkJEUtkdIGYpC0us938yl8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAA2SURBVHicLcZBEoAgDATB2Q2QRPH/37Uo7VODTdiQLal6ooEWu07WZOef4EtcN9n51Am2B8ELIV0BBAb4uC0AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},R={src:"https://assets.monica.im/home-web/_next/static/media/readDark.89548a28.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEXPuNzc3ODc3N/g4OLd3eHb296Dc+zd3d/f3+KZf/ne3uOXgPWYgfXb2d5V+mzmAAAADnRSTlMBkxIah3UKS2QtLqOks/L/ILEAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA5SURBVHicLclZCoAwEETB19OzJFHvf10R/CsosGkbSimlBgW5OEkGazj1o/lqTd+bUj3V1wY7AngBH5gA9cHEbCgAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},U={src:"https://assets.monica.im/home-web/_next/static/media/toolbox.fc93deec.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEUcHxUjIykbHxciIiYkJCwjIychIScgISBXOLtnQOxZOcBvRf92R/+qXv8hISZMaXFx146TAAAAEHRSTlNnV0okPl2RfIyKRGCBG58Az8oaIwAAAAlwSFlzAAALEwAACxMBAJqcGAAAADlJREFUeJwVy7cRACAMALF3JrP/thydGmEhIhJGoiJKUgmQhddobZTjrN4XH3vOjWNHVfUY9/+w+wAmAQE/N+cPdQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},P={src:"https://assets.monica.im/home-web/_next/static/media/toolboxDark.d373c460.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEXa2d3h49vj5trc3N7b29/i5OPb2+Pc296nlfGZgfmSdv9VJf+Pc/lMaXGlkvCikOwFszTIAAAAEHRSTlNXZUoklnc+XYyKgRtgAERFWA4AVwAAAAlwSFlzAAALEwAACxMBAJqcGAAAADpJREFUeJwVy8cRgEAQBLGetWch/2wp9BfeAO2EDExBhiRFUvmM8WZRWnMuFZX7nJ2Fh5lZOPf/7fcDJfIBODwSiLcAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},F={src:"https://assets.monica.im/home-web/_next/static/media/translateDark.fe9ddc22.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEVMaXGXgPiYf/fd3dvCvuDf4dne3t7b29qZg/Tb29re4N6Xf/egjPWZgfba2trX19fk5OSXf/Z/f/+Xf/Xhce1kAAAAFHRSTlMAvUy6Dx+eUh1Fb5AzKkIzjpYIqOi61skAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA8SURBVHicHcjHEcAgEACxBS4SHfrv1TPWUzxRQzwh7restA21VHAnRhlTBSRYs+WfdLtgW4r1diBdFNUPPVcBnFv+p2oAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},O={src:"https://assets.monica.im/home-web/_next/static/media/writeDark.de5e76fb.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEVMaXHg5Nve3uHHwefd393a293e3+Hc297b29/T09fb293Eveahi/R1RP+CY//d3d+XfPnOyuEvBKxvAAAAEnRSTlMAI36KWGhDTZQP0O1dGn3DL4+o0UUpAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOUlEQVR4nBXIxw0AMQzEQEpeBV/uv9qDXsQQYHcxybdaw5DPSwd5Nhn3hQ4j1/MRAjuXojdgVWXwAy2WAT0c/iuxAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},N={src:"https://assets.monica.im/home-web/_next/static/media/writingAgent.767ce605.png",height:72,width:72,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEUiIiYiIidpQe8hISUhIilqQu0fICEnJCpMaXEgISJnQOlrQ/BmQuoiIiZnQegiIigqJzyJX6MqAAAAEXRSTlOCm5A4FYNMIgBFHVckjKdwVft1tZsAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA6SURBVHicJcjHDYBADADB9TlfAPqvFiHmOVQcOFGYaLeKkTQ0SaLc9fxje/h3Pce6MMlyH5sKieWzXjGuAXSyjDfQAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},V={src:"https://assets.monica.im/home-web/_next/static/media/writingAgentDark.2fe5e88e.png",height:72,width:72,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEXc3N/b3NyVffjZ2N/c3Nyagvmbgvvd2+JMaXHb29/c3N/Z2duPdfuagvaXgPfi5tja2t3KFtUVAAAAEXRSTlOARZBQFYQgIgCWOENQXqdITHQWjmcAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA5SURBVHicFci3EcAwDACxp5gpp/2n9QklKG1oLaxHZNpINmySZKD0jGCx/JzEuh+ss9xXUF+/l0f9LRUBZQNk5R4AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},Q={src:"https://assets.monica.im/home-web/_next/static/media/fillAiArt.b7aae22f.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEUeJi4fJS4gJy8WFj8fJS0hJS0gJi4fJC0dJS0fJi0fJS4dJC/QRuohAAAADHRSTlNYT/4B0SjxM0SLlHArPH2uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAN0lEQVR4nBXHQRKAMAwDsbWdJin8/78MuokM0p4wbvetAx257iLvdVnIbqVArpMA0++iZ8jwNx8i1QDvrvi4/wAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},z={src:"https://assets.monica.im/home-web/_next/static/media/fillAiArtDark.4d50977f.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEXd3d3b29vV1dXZ2dnd3d3h4eHc3Nzc3Nzb29ve3t7a2tro6OjCG8ZJAAAAC3RSTlNYTgEq9Pw7jsvacDPlbW8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAA1SURBVHicBcGJAcAgDAOxs50Hyv77VsJBmphUde0NlPXODipt3xbq1/IBvRMbSH1COzgA4x8i5ADr3BQl5gAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},H={src:"https://assets.monica.im/home-web/_next/static/media/fillAudioDark.df9ddb59.png",height:32,width:32,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAHlBMVEX////a2tzb293i4uTl5ejf39/c3N7a2t3a2trg4ONcmVcmAAAACnRSTlMBaJi8lCd1pRxLEVR3WwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAC5JREFUeJxFi8kNADAMwiDk3H/hqo+mvCzZAACJu6A7A+iRmaahLLNKfVi18bsfHPgAzeFa2KEAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},W={src:"https://assets.monica.im/home-web/_next/static/media/fillAudioIcon.69dcdf5b.png",height:32,width:32,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAIVBMVEUAAC0iIiUhISYkJCcjIygmJiYhISUiIiUiIiYkJCQjIyiga5QQAAAAC3RSTlMBaJiUsifFdaUcS0C8YVoAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAvSURBVHicRYvJDQAwDMIgd7L/wFUfTXlZsgEAEndOVTrQYyI2jcgSqYwPqzZ+9wMg6ADp2/NS2QAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},G={src:"https://assets.monica.im/home-web/_next/static/media/fillChat.d7d225d9.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEUjJSoeLCwhIiYfJi4bGx8fJi4gJSwiJy9NTVCOjpEfJi4iIygfJS0eJS0fJi82Njr4YaXRAAAAD3RSTlP+Af5d/muwkv79O/d7IlBOr6IyAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAOElEQVR4nBXGxxHAMAwEsT0mUaJD/916jBeQvColtDAocbBhcBJ271hc0G/bnwkLDg4wKfSk+y19JEABFYMEaMoAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},j={src:"https://assets.monica.im/home-web/_next/static/media/fillChatDark.5127eb6a.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEXa2t3d3eF/f4Hd3d3a2t7a2t3d3d9MaXHk5Ofb297V1dW6urzZ2dnb29/s7PDKys2srK+7u72gFRJTAAAADnRSTlP7ef07Z7CSAP5cBvoiUPWk1GYAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA7SURBVHicJcZBEoAgDATBEQK7QY36/89aln1qpBwjltCscg3RDVDJVrS71fzyXPsfY3eybBNinRF5SC9ATQHPgR8CpwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},J={src:"https://assets.monica.im/home-web/_next/static/media/fillDiscover.2125775b.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEUhKDAjIyMfJS4fJS4gJi4fJS4eJjAeIyweJy8fJS0fJS4gJS6YV5cfAAAADHRSTlP+Am2y8oo5JFua1sfwPAKTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAMUlEQVR4nEXLuRGAMAwAMPlJDGH/fak4eknEXvcVIRIqTHOOlKwoJfXsVkY/yB9//QUZNACw6VEvfwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},K={src:"https://assets.monica.im/home-web/_next/static/media/fillDiscoverDark.e278f865.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEXh4eXd3eDb297d3eHb29/Y2NjX195MaXHd3eDc3N/c3N/b293a2t3a2t7Z2d3a2t7x8fTp6eyKVWnxAAAAEHRSTlP9OZaHsgYkAG31W8fY1KVkaPoNqAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADpJREFUeJw1y8cNgEAQBME+bi1Gms0/WcSDfxWZax+nJ1mMZE4A96OiYKfJqOlYPUbQV7fqw5ox5+8vQAQB1I+tqlcAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},q={src:"https://assets.monica.im/home-web/_next/static/media/fillVideo.c69e5595.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEUiIicYGCkpKQAiIiYiIiYdHSkhISUiIiYiIiUiIiYhISYhISTYpJBxAAAADHRSTlP+CgGc7xbG59I4gE3lkb8/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAANUlEQVR4nC3LSRIAIAwCQSDRLP7/v5YLpz4wEElKwooIn4MwnFl+wFFPDusjS1RPv2dx3HwDGYwAurpFeDUAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},X={src:"https://assets.monica.im/home-web/_next/static/media/fillVideoDark.3e8199b2.png",height:32,width:32,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAALVBMVEXc3NzR0dGwsLDi4uLb29vf39/a2trc3Nza2tra2trd3d3a2trd3d3b29vt7e1ZdffUAAAADnRSTlP9CwH+7J8WlNTIN8RMcgMh5CAAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA6SURBVHicLctBDoAwDANB23ESWqD/f25VxG2k1UIkKQmPbd9F5EJE5HUAIIDZP7J74aT5DnsUIda3byQTAQgbyLAcAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},Z={src:"https://assets.monica.im/home-web/_next/static/media/lineAiArt.18619025.png",height:40,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEUjIychISYjIyZMaXEjIyYnJyoiIiUiIiYkJCciIiQiIicjIyYhISYhISaskbofAAAADnRSTlNSWzkAZhCRniYw3XdxtV/RJOAAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA3SURBVHicBcGJAcAwCAOxM4ZAnu6/biUcaDwm1nvFGbi9XBhy5dwykqOzC7FXOcX+TqIOHCCFfypPARWhIvydAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},Y={src:"https://assets.monica.im/home-web/_next/static/media/lineAiArtDark.46c6cf67.png",height:40,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEXd3d3d3d3b29tMaXHe3t7X19fb29vb29vc3Nzc3Nzh4eHc3Nzb29vb29tJlmgBAAAADnRSTlNTWzkAZhCRniYv3XdxtSBuxcUAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA3SURBVHicBcGJAcAwCAOxM4ZAnu6/biUcaDwm1nvFGbi9XBhy5dwykqOzC7FXOcX+TkIHDpDCPypDARQQO5UuAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},$={src:"https://assets.monica.im/home-web/_next/static/media/lineAudioDark.a7146adc.png",height:32,width:32,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAFVBMVEVMaXHc3N3e3uLd3d7g4OLa2t3d3eAkLztYAAAAB3RSTlMAKHw2ZVcQ8agVjAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAC5JREFUeJxFi0EOACAMwroB/v/JZsYopyYtABKzVbYWUJ10QcuJ1R+eOnFNfO8bFPoAkx+WKD0AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},ee={src:"https://assets.monica.im/home-web/_next/static/media/lineAudioIcon.fa74f143.png",height:32,width:32,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAGFBMVEUjIyYhISdMaXEeHh4lJSUkJCoiIiUgICbk3sSVAAAACHRSTlM0eAAQIVtYVoEKLH8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAuSURBVHicRYtbCgAwDMKibdf733gU9vjRgBHbMOGgijBOdSuN0FqauvCmL5/7BhWoAJm6OMnoAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},et={src:"https://assets.monica.im/home-web/_next/static/media/lineChat.798aaebb.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAG1BMVEVMaXEhISUhISUhISYiIiUhISMjIyUgICMkJCSab7nOAAAACXRSTlMAUJB8YxM+HzGbJeAzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAM0lEQVR4nB3KuRHAQAwDsSWp5/qv2CNnCADITgNJt9w8AyiUyKR9eLv742Ihj+Tcq6qBDxY7AJ9RhzrFAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},ei={src:"https://assets.monica.im/home-web/_next/static/media/lineChatDark.7cc6fb7b.png",height:48,width:49,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAIVBMVEXc3N7b297c3N/u7u7e3uFMaXHb297b297a2t7d3d/f3+Ga34giAAAAC3RSTlNOkGMCFgB5PoAtVlBpt5UAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA2SURBVHicJcbBAcAwCAOxM8aQZP+B+6heIn7SdMicbtRcxQ5DvZydFkVu3z92pkALOsFU1cYfJdQA+UxgYeQAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},ea={src:"https://assets.monica.im/home-web/_next/static/media/lineDiscover.33d613a0.png",height:40,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAGFBMVEUiIiYzMzMhISUiIiYiIiYjIygjIyYlJSUuTPlzAAAACHRSTlOKAVt2GCNsPf02wi8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAxSURBVHicNcu5EQAgDASxvcem/44JGEIFQjJYQqRdhKPJWcMMpEDz4D0ZxYhtg/j9AhTQAJN1+3rSAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},eo={src:"https://assets.monica.im/home-web/_next/static/media/lineDiscoverDark.31e63d75.png",height:40,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAG1BMVEXc3ODMzMza2t3b29/b297b297X193Z2eHi4ubABxb7AAAACXRSTlOKAVsid2wWPXQ4Kl6jAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAMklEQVR4nDXLuRHAMAwEsb2HlPqvWIHHIQIgGSwhmh2Eq/SMIYG7wN4PntOoRsymiL8/FagAma/JzpMAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},es={src:"https://assets.monica.im/home-web/_next/static/media/lineVideo.68f44a4f.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAG1BMVEUbGy4iIiUhISYhISYnJx8hISUhISUiIiQhISYYFGS6AAAACXRSTlMBHIdVDZy7PmsDUc5PAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAL0lEQVR4nDWLyQ0AMAyDsJM03X/iqtcPCwOSlECU7VJi7TXGg2n6Q9VT3XHPkCdfFE0AmvGU1HsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},en={src:"https://assets.monica.im/home-web/_next/static/media/lineVideoDark.74258475.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEXS0tLg4OPb29/e3uHc3N/Z2dnd3eDa2t/b293g4OPa2t/e3t5Qk8DfAAAADHRSTlMBHIdZuwuWSmugOxPHRE+pAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAM0lEQVR4nDWLwQ3AIAzEfFeSAN1/3woKP0u24ZUUQKXtVJACntbwhm7mhTGOqll/zPoDPhqgAMQrU2yrAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},er=i(88882),el=i(56607),ed=i(92235),ec=i(60445),eh=i(76469),eg=i(7046),ep=i(2525),eA=i(73047),em=i(91433),eu=i(92020),ef=i(38172),ey=i(10148),ev=i(90180),ew=i(37949),eC=i(67061);class eb{get S(){return er.S.Global.controllers.mainNavController}get PracticalToolCardS(){return er.S.Global.modules.ChatBox.ChatHomeView.PracticalToolCard}get homeSidebarCollapsed(){return this.isHomeSidebarAutoCollapsed||ev.A.homeSidebarManuallyCollapsed}get finalViewType(){return"desktop-home"===el.o.entryType?"medium":"sidebar"===eC.L.mainWindowMode?"large"===this._viewType?"medium":this._viewType:ev.A.mainNavManuallyCollapsed&&"large"===this._viewType?"medium":this._viewType}get allTools(){return(0,eg.Z)([...this.popularToolList,...this.pinnedTools,...this.topNavItems],"key")}get pinnedTools(){let e=this.popularToolList.find(e=>"in_app"===e.jumpType&&"memo"===e.jumpLink);return ev.A.pinnedTools?ev.A.pinnedTools.flatMap(e=>{let t=this.popularToolList.find(t=>t.key===e);return t?[t]:[]}):e?[e]:[]}get topNavItems(){var e,t;return[{jumpType:"in_app",key:"chat",title:this.S.chat,icon:(0,n.Q)(et),iconDark:(0,n.Q)(ei),activeIcon:(0,n.Q)(G),activeIconDark:(0,n.Q)(j),jumpLink:"chat"},{jumpType:"in_app",key:"image",icon:(0,n.Q)(Z),hasNewFeature:null===(e=ey.E.imageDisplayDialogController)||void 0===e?void 0:e.hotDotVisible,iconDark:(0,n.Q)(Y),activeIcon:(0,n.Q)(Q),activeIconDark:(0,n.Q)(z),title:this.S.art,jumpLink:"image"},{jumpType:"in_app",key:"video",icon:(0,n.Q)(es),hasNewFeature:null===(t=ey.E.videoDisplayDialogController)||void 0===t?void 0:t.hotDotVisible,iconDark:(0,n.Q)(en),activeIcon:(0,n.Q)(q),activeIconDark:(0,n.Q)(X),title:this.S.video,jumpLink:"video"},{jumpType:"in_app",key:"audio",icon:(0,n.Q)(ee),iconDark:(0,n.Q)($),activeIcon:(0,n.Q)(W),activeIconDark:(0,n.Q)(H),title:this.S.audio,jumpLink:"audio"},{jumpType:"in_app",key:"discover",title:this.S.discover,icon:(0,n.Q)(ea),iconDark:(0,n.Q)(eo),activeIcon:(0,n.Q)(J),activeIconDark:(0,n.Q)(K),jumpLink:"discover"}]}get popularToolList(){return[{jumpType:"browser",icon:(0,n.Q)(I),iconDark:(0,n.Q)(_),key:"full_page",title:this.PracticalToolCardS.fullPage,jumpLink:ed.m.genFullUrl(ec.Cl.monicaWeb),tag:["recommend"]},{jumpType:"in_app",icon:(0,n.Q)(b),iconDark:(0,n.Q)(O),key:"write",title:this.PracticalToolCardS.writing,tag:["recommend"],jumpLink:"write"},{jumpType:"in_app",icon:(0,n.Q)(T),iconDark:(0,n.Q)(k),key:"grammarly",title:this.PracticalToolCardS.grammarly,tag:["recommend"],jumpLink:"openGrammarlyTab"},{jumpType:"in_app",icon:(0,n.Q)(C),iconDark:(0,n.Q)(F),key:"translate",title:this.PracticalToolCardS.translate,tag:["recommend"],jumpLink:"translate"},{jumpType:"browser",icon:(0,n.Q)(u),iconDark:(0,n.Q)(r),key:"ai_detector",title:this.PracticalToolCardS.AiDetector,jumpLink:ed.m.genFullUrl(ec.oo.aiContentDetector),tag:["recommend"]},{jumpType:"browser",icon:(0,n.Q)(f),iconDark:(0,n.Q)(S),key:"chat_pdf",title:this.PracticalToolCardS.chatPDF,jumpLink:ed.m.genFullUrl(ec.Cl.docChat),tag:["recommend"]},{jumpType:"browser",icon:(0,n.Q)(v),iconDark:(0,n.Q)(B),key:"ai_mind_map",title:this.PracticalToolCardS.aiMindMap,jumpLink:ed.m.genFullUrl(ec.oo.aiMindMapMaker),tag:["recommend"]},{jumpType:"in_app",icon:(0,n.Q)(c),iconDark:(0,n.Q)(h),key:"search",title:this.PracticalToolCardS.aiSearch,tag:["recommend"],jumpLink:"search"},{jumpType:"in_app",icon:(0,n.Q)(A),iconDark:(0,n.Q)(m),key:"bots",title:this.PracticalToolCardS.bots,tag:["recommend"],jumpLink:"bots"},{jumpType:"in_app",icon:(0,n.Q)(L),iconDark:(0,n.Q)(R),key:"reading",title:this.PracticalToolCardS.reading,tag:["recommend"],jumpLink:"reading"},{jumpLink:"memo",jumpType:"in_app",icon:(0,n.Q)(M),iconDark:(0,n.Q)(x),key:"memo",title:this.PracticalToolCardS.memo,tag:["recommend"]},{jumpType:"browser",icon:(0,n.Q)(y),iconDark:(0,n.Q)(E),key:"ai_humanizer",title:this.PracticalToolCardS.aiHumanizer,jumpLink:ed.m.genFullUrl(ec.oo.aiTextHumanizer),tag:["recommend"]},{jumpType:"in_app",icon:(0,n.Q)(U),iconDark:(0,n.Q)(P),key:"tool_box",title:this.PracticalToolCardS.toolbox,tag:["recommend"],jumpLink:"toolkit"},{jumpType:"in_app",icon:(0,n.Q)(N),iconDark:(0,n.Q)(V),key:"writing_agent",title:this.PracticalToolCardS.writingAgent,tag:["recommend"],jumpLink:"openBot:".concat(em.tW.writingAgent)},{jumpType:"browser",icon:(0,n.Q)(g),iconDark:(0,n.Q)(p),key:"batch_processor",title:this.PracticalToolCardS.batchProcessor,tag:["recommend"],jumpLink:ed.m.genFullUrl(ec.oo.smartFill)},{jumpType:"browser",icon:(0,n.Q)(w),iconDark:(0,n.Q)(D),key:"podcast",title:this.PracticalToolCardS.podcast,tag:["recommend"],jumpLink:ed.m.genFullUrl(ec.oo.aiPodcast)},{jumpType:"browser",icon:(0,n.Q)(l),iconDark:(0,n.Q)(d),key:"ai_form",title:this.PracticalToolCardS.aiForm,jumpLink:"".concat(ed.m.genFullUrl(ec.oo.aiForm),"?source=tools"),tag:["recommend"]}]}get showSidebarFoldBtn(){return"horizontal"===eC.L.mainWindowMode&&this.homeSidebarCollapsed&&("bots"===this.activeTabKey||"chat"===this.activeTabKey)}onTabChange(e,t){let{saveFrom:i=!0,keepBeforeForm:a=!1,saveToUrl:o=!0}=t||{};if(this.activeTabKey===e)return;let s=this.activeTabKey;this.activeTabKey=e;let n=this.tabs.find(t=>t.key===e);n&&(n.hasOpened=!0,i?n.from=s:a||(n.from=void 0)),this.eventEmitter.emit("tabChange",{key:e}),o&&setTimeout(()=>{this.eventEmitter.emit("saveChatPageParams",{})},50)}onBack(e){let t=this.tabs.find(t=>t.key===e);(null==t?void 0:t.from)&&this.onTabChange(t.from,{saveFrom:!1,keepBeforeForm:!0})}async togglePin(e){let t=this.isPinned(e);eu.ll.update({pinnedTools:t?this.pinnedTools.filter(t=>t.key!==e).map(e=>e.key):[e,...this.pinnedTools.map(e=>e.key)]})}isPinned(e){return this.pinnedTools.some(t=>t.key===e)}updateViewTypeByPageWidth(){let e="horizontal"===eC.L.mainWindowMode?660:430,t="horizontal"===eC.L.mainWindowMode?880:660;if(ew.w.sidebarWidth<e)this._viewType="small";else if(ew.w.sidebarWidth<t)this._viewType="medium";else{if(ev.A.mainNavManuallyCollapsed)return;this._viewType="large"}}updateHomeSidebarCollapsed(){("large"!==this.finalViewType||this.isHomeSidebarAutoCollapsed)&&(this.isHomeSidebarAutoCollapsed=ew.w.sidebarWidth<660)}startDrag(e,t){this.currentDragKey=e,this.dragScene=t}onDrop(e){let t=this.allTools.find(e=>e.key===this.currentDragKey);if(!t)throw this.currentDragKey=null,Error("drag key not found");let i=this.currentDragKey||"",a=this.pinnedTools.findIndex(e=>e.key===i),o=this.pinnedTools.findIndex(t=>t.key===e),s=(0,ep.Z)(this.pinnedTools);-1!==a&&s.splice(a,1),-1===o?s.push(t):s.splice(o,0,t),eu.ll.set("pinnedTools",s.map(e=>e.key)),this.currentDragKey=null}toggleManuallyCollapse(e){eu.ll.setUiFlag("mainNavManuallyCollapsed",e),e?this._viewType="medium":this._viewType="large"}isOpenBotAction(e){return e.startsWith("openBot:")}createUserBehaviorEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";ef.W.createUserBehaviorEvent({eventName:"navigation_menu_click",extData:{type:e,triggerMode:t},source:el.o.platform})}constructor(){(0,a._)(this,"eventEmitter",new eh.v),(0,a._)(this,"dragScene",void 0),(0,a._)(this,"webSettingClicked",!1),(0,a._)(this,"activeTabKey","chat"),(0,a._)(this,"tabs",[{key:"chat",title:()=>this.S.chat,hasOpened:!0},{key:"search",title:()=>this.S.search},{key:"artist",title:()=>this.S.art},{key:"discover",title:()=>this.S.discover},{key:"memo",title:()=>this.S.memo},{key:"bots",title:()=>this.S.bot},{key:"reading",title:()=>this.S.read},{key:"write",title:()=>this.S.write},{key:"translate",title:()=>this.S.translate},{key:"toolkit",title:()=>this.S.toolkit},{key:"image",title:()=>this.S.image},{key:"video",title:()=>this.S.video},{key:"audio",title:()=>this.S.audio}]),(0,a._)(this,"_viewType","medium"),(0,a._)(this,"currentDragKey",null),(0,a._)(this,"isHomeSidebarAutoCollapsed",!1),(0,eA.rC)(this)}}(0,o.gn)([s.SB],eb.prototype,"activeTabKey",void 0),(0,o.gn)([s.SB],eb.prototype,"tabs",void 0),(0,o.gn)([s.SB],eb.prototype,"_viewType",void 0),(0,o.gn)([s.SB],eb.prototype,"currentDragKey",void 0),(0,o.gn)([s.SB],eb.prototype,"isHomeSidebarAutoCollapsed",void 0),(0,o.gn)([s.Fl],eb.prototype,"S",null),(0,o.gn)([s.Fl],eb.prototype,"PracticalToolCardS",null),(0,o.gn)([s.Fl],eb.prototype,"homeSidebarCollapsed",null),(0,o.gn)([s.Fl],eb.prototype,"finalViewType",null),(0,o.gn)([s.Fl],eb.prototype,"allTools",null),(0,o.gn)([s.Fl],eb.prototype,"pinnedTools",null),(0,o.gn)([s.Fl],eb.prototype,"topNavItems",null),(0,o.gn)([s.Fl],eb.prototype,"popularToolList",null),(0,o.gn)([s.Fl],eb.prototype,"showSidebarFoldBtn",null);let eS=new eb},37949:function(e,t,i){"use strict";i.d(t,{w:function(){return J}});var a=i(66084),o=i(52921),s=i(34491),n=i(22046),r=i(25902),l=i(62659),d=i(92020),c=i(38172),h=i(24900),g=i(44469),p=i(91433),A=i(46756),m=i(56607),u=i(77099),f=i(28901),y=i(88882),v=i(92235),w=i(92347),C=i(12596),b=i(76469),S=i(40245),I=i(58756),_=i(70151),T=i(73047);i(75087);var k=i(25449),E=i(63869),M=i(82152),x=i(1),B=i(90180);class D{async ensureSidePanelLoaded(){return new Promise(e=>{if(this.sidePanelOpened)e(null);else{let t=(0,T.U5)(()=>this.sidePanelOpened,i=>{i&&(e(null),t())})}})}async openSidePanel(){if(this.sidePanelOpened)return!0;let e=await x.d.sendMessage({name:"openSidePanel",data:{}});return e?await this.ensureSidePanelLoaded():B.A.rawChromeSidePanelEnabled=!1,e}async closeSidePanel(){await x.d.sendMessage({name:"closeSidePanel",data:{}})}async toggleSidePanel(){let e=!0;return this.sidePanelOpened?this.closeSidePanel():e=await this.openSidePanel(),e}constructor(){(0,a._)(this,"sidePanelOpened",!1),(0,T.rC)(this),m.o.isExtension&&M.a.getOpen().then(e=>{this.sidePanelOpened=e})}}(0,o.gn)([s.SB],D.prototype,"sidePanelOpened",void 0);let L=new D;var R=i(44795),U=i(1396),P=i(45476),F=i(18508),O=i(18245),N=i(18312),V=i(90230),Q=i(47720),z=i(66928),H=i(25813),W=i(67061);let G="right";class j{get canOpenBotsDrawer(){if(!W.L.isSidebarShowed)return!1;if(m.o.isExtension&&document.activeElement){var e;let t=!1;if(m.o.withMonicaPrefix("content-root")===document.activeElement.id?t=!0:(null===(e=this.getShadowRoot())||void 0===e?void 0:e.contains(document.activeElement))&&(t=!0),!t)return!1}return"chat"===N.J.activeTabKey||"artist"===N.J.activeTabKey||"bots"===N.J.activeTabKey}get sidebarWidth(){if("ext-sidebar"===m.o.entryType){var e;return(null===(e=this.resizableController.data)||void 0===e?void 0:e.width)||0}return this.windowWidth}get isHorizontal(){return"desktop-home"===m.o.entryType&&this.sidebarWidth>800||("web-home"===m.o.entryType||"ext-chat-page"===m.o.entryType)&&this.sidebarWidth>1100}get isSidebarRenderLeft(){return"sidebar"===W.L.mainWindowMode&&"left"===this.sidebarPosition&&!B.A.chromeSidePanelEnabled}get isSidebarEntryBtnRenderLeft(){return"left"===B.A.finalSidebarEntryBtnPosition}onAppViewCreated(){U.Mp.initBotItems(),H.m.initToolkitList(),r.G.getCachedAgentDiscoverFeeds(),k.promotionController.loadActivityConfig(),m.o.isExtension&&l.g.listAllUrl({forceFetch:!0}),d.ll.get("userJobTitleFetched").then(e=>{e||c.W.getUserJobTitle().then(e=>{let{jobTitleKey:t}=e;t&&d.ll.set("userJobTitle",t),d.ll.set("userJobTitleFetched",!0)})}),E.i7.getImageGallery()}initServiceEventListeners(){"sidebar"===W.L.mainWindowMode&&(d.ll.get("sidebarPosition").then(e=>{this.sidebarPosition=e||G}),d.ll.on("configChange",e=>{void 0!==e.sidebarPosition&&(this.sidebarPosition=e.sidebarPosition||G)})),h.Tn.on("templateListChange",e=>{this.templates=e.templateList,this.templatesLoading=!1}),window.addEventListener("resize",()=>{m.o.isDesktop?this.visible&&this.eventEmitter.emit("resize"):"horizontal"===W.L.mainWindowMode&&this.eventEmitter.emit("resize"),this.windowWidth=window.innerWidth}),m.o.isExtension&&g.T3.on("continueInChat",async e=>{"hidden"!==document.visibilityState&&(await U.Mp.beforeContinueInChat()).continueInChat(e)}),c.W.on("isExceededDeviceLimit",()=>{let e=this.visible?"mainWindow":"dialogRoot";W.L.allowPopup&&this.views.openDeviceExceededLimitDialog({insertTarget:e})}),c.W.on("userInfoChange",e=>{if(!e)for(let e=0;e<U.Mp.botItems.length;e++){let t=U.Mp.botItems[e];t.controller.resetOnLogout(),t.uid!==p.Z9.monica&&(t.hasOpened=!1),this.logoutAutoRedirect&&N.J.onTabChange("chat")}})}markLogoutWithoutRedirect(){this.logoutAutoRedirect=!1}async saveChatPageParams(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("more"!==N.J.activeTabKey){var t,i,a,o,s,n,r;let l=u.l.getPageType();if(!l)return;let d="",c=!1;if("memo"===N.J.activeTabKey)d=u.l.createPageParamsUrl({tab:"memo",memoId:V.a.activeMemoId},l);else if("chat"===N.J.activeTabKey){let e=U.Mp.getActiveBotItemController(),n="";if(e instanceof P._?n=(null==e?void 0:e.showHomeView)?"":null==e?void 0:e.conversationId:e instanceof F.o&&(n=e.messageList.length>0?e.taskId:""),d=n?u.l.createPageParamsUrl({tab:"chat",convId:n,botName:null==e?void 0:null===(t=e.botData.botItem)||void 0===t?void 0:t.name,botUid:null==e?void 0:null===(i=e.botData.botItem)||void 0===i?void 0:i.uid},l):u.l.createPageParamsUrl({tab:"chat",botName:null==e?void 0:null===(a=e.botData.botItem)||void 0===a?void 0:a.name,botUid:null==e?void 0:null===(o=e.botData.botItem)||void 0===o?void 0:o.uid},l),n){c=!0;let t=(e instanceof P._?e.conversationInfo:null)||await A.y.getConversationById(n);f.x.updateTDK({title:[null==t?void 0:t.title,"Monica"].filter(Boolean).join(" - ")})}else!(null==e?void 0:e.botData.isMonicaBot)&&(null==e?void 0:e.botData.botItem)&&(c=!0,f.x.updateTDK({title:(0,y.x)(y.S.Global.controllers.mainWindowController.Tdk.chatBotTitle,{botName:null==e?void 0:null===(s=e.botData.botItem)||void 0===s?void 0:s.name})}))}else d=u.l.createPageParamsUrl({tab:N.J.activeTabKey},l);if(e||history.replaceState({},"",d),!c){let e=(null===(n=N.J.allTools.find(e=>e.key===N.J.activeTabKey))||void 0===n?void 0:n.title)||(null===(r=N.J.tabs.find(e=>e.key===N.J.activeTabKey))||void 0===r?void 0:r.title());e?f.x.updateTDK({title:"".concat(e," - Monica")}):f.x.updateTDK({title:"Monica"})}}}async fetchTemplates(){if(this.templates.length>0)return;let e=await h.Tn.getComposeTemplates();0!==e.length&&(this.templates=e,this.templatesLoading=!1)}findTemplate(e){return this.templates.find(t=>t.key===e)}async toggleVisible(){this.visible?this.hide():this.show()}async show(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N.J.activeTabKey;B.A.chromeSidePanelEnabled&&"ext-side-panel"!==m.o.entryType&&(await L.openSidePanel().catch(e=>{console.log(e)}),x.d.sendMessage({name:"pingSidePanel",data:{}}).then(()=>{x.d.sendMessage({name:"changeActiveTab",data:t})})),this.visible=!0,this.firstOpenTime||(this.isFirstOpen=!0,this.firstOpenTime=Date.now(),this.hasOpened=!0),N.J.onTabChange(t),this.afterVisibilityChange(),Q.serverConfigController.loadStaticConfig(z.BO.MainWindowFirstScreen),Q.serverConfigController.loadStaticConfig(z.BO.ChatHomeView,"web-home"===m.o.entryType),null===(e=U.Mp.getActiveBotItemController())||void 0===e||e.focusPrimaryInput()}hide(){var e;B.A.chromeSidePanelEnabled&&L.closeSidePanel(),null===(e=U.Mp.getMonicaChatController())||void 0===e||e.artifactManager.close(),this.visible=!1,this.isFirstOpen=!1,this.afterVisibilityChange()}getShortcutRecognitionResult(e){let t="sidebar"===W.L.mainWindowMode;return this.checkSoftMonicaShortcut(e)?"openMonica":this.canOpenBotsDrawer&&B.A.isShortCutTriggered(e,"switchBot")?"switchBot":t&&B.A.isShortCutTriggered(e,"quickAsk")?"quickAsk":this.canOpenBotsDrawer&&B.A.isShortCutTriggered(e,"newChat")?"newChat":this.canOpenBotsDrawer&&U.Mp.currentBotId===p.Z9.monica&&B.A.isShortCutTriggered(e,"incognitoChat")?"incognitoChat":t&&B.A.isShortCutTriggered(e,"takeScreenshot")?"takeScreenshot":t&&B.A.isShortCutTriggered(e,"screenshotRecognition")?"screenshotRecognition":t&&B.A.isShortCutTriggered(e,"webTranslation")?"webTranslation":t&&B.A.isShortCutTriggered(e,"reading")?"reading":null}checkSoftMonicaShortcut(e){if(!B.A.softKeyboardShortcutsEnabled||"ext-sidebar"===m.o.entryType)return!1;let t=v.m.getDefaultShortcutKey();return!!((0,_.P6)("mod+".concat(t),e)||(0,_.P6)("ctrl+".concat(t),e))}screenCapture(e,t){t||(this.screenshotTriggerId=v.m.genId()),this.runCapture({inChatBox:e,triggerId:this.screenshotTriggerId})}getShadowRoot(){return this.shadowRoot?this.shadowRoot:document}setViews(e){this.views=e}calcViewMaxWith(e){let t=B.A.contentWidthMode,i=80;return"sidebar"===W.L.mainWindowMode&&(t=w.Ni.Full,i=32),{"--monica-chat-max-width":t===w.Ni.Full?"max(100% - ".concat(i,"px, ").concat(e,")"):e}}openFullScreen(){var e,t,i;let a=!(arguments.length>0)||void 0===arguments[0]||arguments[0],o=N.J.activeTabKey;if("memo"===o)g.T3.openMonicaChatTabPageV2({tab:"memo",memoId:V.a.activeMemoId});else if("chat"===o){let i=U.Mp.getActiveChatBotController();g.T3.openMonicaChatTabPageV2({isIncognitoMode:B.A.isIncognitoMode?"1":"0",tab:"chat",convId:(null==i?void 0:i.showHomeView)?void 0:null==i?void 0:i.conversationId,botName:null==i?void 0:null===(e=i.botData.botItem)||void 0===e?void 0:e.name,botUid:null==i?void 0:null===(t=i.botData.botItem)||void 0===t?void 0:t.uid,q:null==i?void 0:i.content})}else g.T3.openMonicaChatTabPageV2({tab:o});a&&(this.hide(),null===(i=U.Mp.getActiveChatBotController())||void 0===i||i.newConversation())}afterVisibilityChange(){this.eventEmitter.emit("tabChange")}genAppsUrl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={...t};return m.o.isExtension&&(i.extId=S.O.getExtensionId()),v.m.genUrl("".concat(v.m.getWebOrigin()).concat(e),i)}constructor(){(0,a._)(this,"views",void 0),(0,a._)(this,"visible",!1),(0,a._)(this,"sidebarPosition",void 0),(0,a._)(this,"templatesLoading",!0),(0,a._)(this,"templates",[]),(0,a._)(this,"isFirstOpen",!1),(0,a._)(this,"hasOpened",!1),(0,a._)(this,"windowWidth",1920),(0,a._)(this,"desktopAutoUpgrade",{updateReady:!1,updateRecommended:!1,handleUpdate:()=>{}}),(0,a._)(this,"dispatchedResizeByMainWindow",!1),(0,a._)(this,"shadowRoot",null),(0,a._)(this,"resizableController",new C.S),(0,a._)(this,"eventEmitter",new b.v),(0,a._)(this,"screenshotTriggerId",""),(0,a._)(this,"firstOpenTime",0),(0,a._)(this,"logoutAutoRedirect",!0),(0,a._)(this,"runCapture",(0,R.c)({name:"screenshot",channels:["extensionContent","desktop"],handler:async e=>{let{inChatBox:t,triggerId:i}=e;if(m.o.isDesktop){I.y.getService().captureScreen(i,"sidebar"===W.L.mainWindowMode?"sidebar":"window");return}if("horizontal"===W.L.mainWindowMode)return;let a=!1;this.visible&&t&&(a=!0,this.visible=!1),new this.views.Screenshot({disabledTools:[],scene:t?"chat":"screenshot",captureVisible:()=>new Promise(e=>{setTimeout(async()=>{e(await g.T3.captureVisibleTab())},50)}),onClose:()=>{a&&(this.visible=!0)},onChatAction:async e=>{await this.show("chat"),this.screenshotToMonica({dataUrl:e})},onMemoAction:async e=>{await this.show("memo"),this.screenshotToMemo({dataUrl:e})},onCopyAction:async e=>{t&&(await this.show("chat"),this.screenshotToMonica({dataUrl:e}))}}).captureArea()}})),(0,a._)(this,"screenshotToMemo",(0,R.c)({name:"sendScreenshotToMemo",channels:["extensionSidePanel","extensionContent","desktop"],handler:async e=>{let{dataUrl:t}=e,i=v.m.dataURLtoFile(t,Date.now().toString());this.views.memoUploadController.imageUploadVisible=!0,this.views.memoUploadController.handleUploadFile([i])}})),(0,a._)(this,"screenshotToMonica",(0,R.c)({name:"sendScreenshotToChat",channels:["extensionSidePanel","extensionContent","desktop"],handler:async e=>{let{dataUrl:t}=e,i=U.Mp.getActiveChatBotController();(null==i?void 0:i.botData.uiOptions.allowChatFile)||U.Mp.openBot(p.Z9.monica),null==(i=U.Mp.getActiveChatBotController())||i.handleImageChatUpload(v.m.dataURLtoFile(t,"unnamed.png"),"screen_shot")}})),(0,T.rC)(this),n.S.isRunInServerSide||(this.windowWidth=window.innerWidth),O.K.getMainWindowIsOpen=()=>this.visible}}(0,o.gn)([s.SB],j.prototype,"visible",void 0),(0,o.gn)([s.SB],j.prototype,"sidebarPosition",void 0),(0,o.gn)([s.SB],j.prototype,"templatesLoading",void 0),(0,o.gn)([s.SB],j.prototype,"templates",void 0),(0,o.gn)([s.SB],j.prototype,"isFirstOpen",void 0),(0,o.gn)([s.SB],j.prototype,"hasOpened",void 0),(0,o.gn)([s.SB],j.prototype,"windowWidth",void 0),(0,o.gn)([s.SB],j.prototype,"desktopAutoUpgrade",void 0),(0,o.gn)([s.SB],j.prototype,"dispatchedResizeByMainWindow",void 0),(0,o.gn)([T.Fl],j.prototype,"canOpenBotsDrawer",null),(0,o.gn)([T.Fl],j.prototype,"sidebarWidth",null),(0,o.gn)([T.Fl],j.prototype,"isHorizontal",null),(0,o.gn)([T.Fl],j.prototype,"isSidebarRenderLeft",null),(0,o.gn)([T.Fl],j.prototype,"isSidebarEntryBtnRenderLeft",null);let J=new j},90230:function(e,t,i){"use strict";i.d(t,{a:function(){return E}});var a=i(66084),o=i(52921),s=i(71576),n=i(34491),r=i(5857),l=i(38795),d=i(11502),c=i(94037),h=i(44469),g=i(92020),p=i(92235),A=i(60445),m=i(88882),u=i(56607),f=i(77099),y=i(95782),v=i(73047),w=i(514),C=i(90180),b=i(18312),S=i(37949),I=i(15851),_=i(33381),T=i(67061);class k{get trimmedSearchValue(){return this.searchValue.trim()}get allTagsRelationsWithLabel(){return Object.keys(this.allTagsRelations).reduce((e,t)=>{let i=this.allTagsRelations[t]||[];return e[t]=i.map(e=>this.tags.find(t=>t.id===e)||{id:e,label:""}),e},{})}get memoRenderList(){return this.trimmedSearchValue?this.searchResults||[]:this.memoDataSources.map(e=>({item:e,highlight:{}})).sort((e,t)=>{if(("complete"===e.item.status||!e.item.status)&&("complete"===t.item.status||!t.item.status)){let i=new Date(e.item.updatedAt).getTime();return new Date(t.item.updatedAt).getTime()-i}return 0})}get memoHasMore(){return this.trimmedSearchValue?this.searchHasMore:this.hasMore}get sel(){return this.memoDataSources.find(e=>e.uid===this.activeMemoId)}get memoViewType(){return"horizontal"===T.L.mainWindowMode?"grid"===C.A._memoListType?"grid":"horizontalList":"list"}setMode(e){this.mode=e}exitSelectMode(){this.mode="normal",this.selectMemos=[]}toggleSelectMemo(e){this.selectMemos.some(t=>t.uid===e.uid)?this.selectMemos=E.selectMemos.filter(t=>t.uid!==e.uid):this.addSelectMemo(e)}addSelectMemo(e){this.setMode("select"),this.selectMemos.push(e),this.sendEvent("memo_action_click",{button:"memo_card_select"})}toggle(e){this.setMode("select"),this.selectMemos.push(e)}setViews(e){this.views=e}init(){l.R.getAll().then(e=>{this.tags=e.tagList||[]}),l.R.on("memoListChange",e=>{(null==e?void 0:e.length)&&(this.memoDataSources=[...e,...this.memoDataSources].filter((e,t,i)=>i.findIndex(t=>t.uid===e.uid)===t))}),l.R.on("tagListChange",e=>{this.tags=e||[]})}sendEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{source:i,...a}=t;d.M.createUserBehaviorEvent({eventName:e,source:i,extData:a})}updateMemoPublic(e,t){let i=this.memoDataSources.find(t=>t.uid===e);i&&"publicShare"in i&&(i.publicShare=t)}async fetchMemoList(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.searchResults=null,"loadMore"===e&&this.refreshing)return;let i=this.listRefreshFlag+=1;try{"refresh"===e&&(this.loading=!0,this.refreshing=!0);let a=await l.R.list(e,{offset:"refresh"===e?0:this.memoDataSources.length,limit:this.getLimit("refresh"===e?"refresh":"add"),types:this.selectTypes,tags:this.selectTags},t,e=>{this.updateMemoTagsRelations(e)});if(0===this.memoDataSources.length&&this.updateMemoTagsRelations(a.items),i!==this.listRefreshFlag)return;a&&("refresh"===e?this.memoDataSources=a.items:this.memoDataSources=this.memoDataSources.concat(...a.items).filter((e,t,i)=>i.findIndex(t=>t.uid===e.uid)===t),this.hasMore=a.hasMore)}catch(e){console.error(e)}finally{this.loading=!1,this.refreshing=!1}}async fetchSearchList(e){if("loadMore"===e&&this.searchRefreshing)return;let t=this.searchRefreshFlag+=1;try{var i;if("refresh"===e&&(this.loading=!0,this.searchResults=[],this.searchRefreshing=!0),!this.searchResults)return;let a=await l.R.search({offset:(null===(i=this.searchResults)||void 0===i?void 0:i.length)||0,limit:this.getLimit("refresh"===e?"refresh":"add"),keyword:this.trimmedSearchValue});if(t!==this.searchRefreshFlag)return;this.updateMemoTagsRelations(a.items.map(e=>e.item)),a&&(this.searchResults.push(...a.items),this.searchHasMore=a.hasMore)}catch(e){console.error(e)}finally{this.loading=!1,this.searchRefreshing=!1}}getMemoList(e){this.trimmedSearchValue?this.fetchSearchList(e):this.fetchMemoList(e)}async delete(e){if(this.deleteMemoRelations(e),await l.R.delete({uid:e}),this.memoDataSources=this.memoDataSources.filter(t=>t.uid!==e),this.searchResults&&(this.searchResults=this.searchResults.filter(t=>t.item.uid!==e)),this.activeMemoId===e&&this.memoDataSources[0]){var t;this.openEditor((null===(t=this.memoDataSources[0])||void 0===t?void 0:t.uid)||"")}this.selectMemos.length&&(this.selectMemos=this.selectMemos.filter(t=>t.uid!==e)),c.$.deleteDB("memo_".concat(e))}async batchDelete(){let e=this.selectMemos.map(e=>e.uid);if(this.batchDeleteMemoRelations(e),await l.R.batchDelete({uids:e}),this.selectMemos=[],this.memoDataSources=this.memoDataSources.filter(t=>!e.includes(t.uid)),this.searchResults&&(this.searchResults=this.searchResults.filter(t=>!e.includes(t.item.uid))),e.includes(this.activeMemoId)&&this.memoDataSources[0]){var t;this.openEditor((null===(t=this.memoDataSources[0])||void 0===t?void 0:t.uid)||"")}e.map(e=>{c.$.deleteDB("memo_".concat(e))})}updateMemoTagsRelations(e){e.forEach(e=>{let t="tags"in e&&e.tags||[];this.allTagsRelations[e.uid]=t.map(e=>e.id)}),this.allTagsRelations={...this.allTagsRelations}}updateTagInMemoRelations(e,t){this.allTagsRelations={...this.allTagsRelations,[e]:t}}deleteMemoRelations(e){delete this.allTagsRelations[e],this.allTagsRelations={...this.allTagsRelations}}batchDeleteMemoRelations(e){e.forEach(e=>{delete this.allTagsRelations[e]}),this.allTagsRelations={...this.allTagsRelations}}deleteTagInRelations(e){this.allTagsRelations=Object.keys(this.allTagsRelations).reduce((t,i)=>(t[i]=this.allTagsRelations[i].filter(t=>t!==e),t),{})}deleteTagInMemoRelations(e,t){this.allTagsRelations={...this.allTagsRelations,[e]:(this.allTagsRelations[e]||[]).filter(e=>e!==t)}}addTagInMemoRelations(e,t){this.allTagsRelations={...this.allTagsRelations,[e]:[...new Set([...this.allTagsRelations[e]||[],t])]}}async deleteTag(e){this.deleteTagInRelations(e),this.selectTags=this.selectTags.filter(t=>t!==e),await l.R.deleteTag(e),l.R.getTagList()}async deleteMemoTag(e,t){this.deleteTagInMemoRelations(e,t);try{await l.R.deleteMemoTag(e,t)}catch(i){throw this.addTagInMemoRelations(e,t),i}}async batchEditMemoTags(e,t){this.updateTagInMemoRelations(e,t.map(e=>e.id)),await l.R.batchEditMemoTags(e,t),l.R.getTagList()}async summaryImage(e){await l.R.summaryImage(e)}async summaryImageStatus(e){return await l.R.summaryImageStatus({uid:e})}async createFromEmbed(e){let{uid:t,embedData:i}=e;return await l.R.createFromEmbed({uid:t||p.m.genId(),embedData:i})}async createTextMemo(e){let{uid:t,content:i,description:a,title:o,plainText:s,isMarkdown:n}=e;return await l.R.create({uid:t||p.m.genId(),content:i||"",description:a||"",title:o||"",plainText:s||"",isMarkdown:n})}async handleAddEmptyMemo(){window.open("".concat(p.m.getWebOrigin()+A.By.memoDetailNew))}handleCancelSummaryImage(e){this.views.openConfirm({insertTarget:"mainWindow",content:m.S.Global.modules.MainWindow.MemoV2.MemoItem.cancelMemo,cancelBtnType:"gray",onOk:async()=>(this.memoDataSources=this.memoDataSources.filter(t=>t.uid!==e),await l.R.delete({uid:e},!0),!0)})}handleRetrySummaryImage(e){let t=this.memoDataSources.find(t=>t.uid===e);t&&this.summaryImage(t)}closeEditor(){if(this.activeMemoId="",u.o.isWeb){let e=f.l.createPageParamsUrl({tab:"memo",memoId:void 0},"home");history.replaceState({},"",e)}}openEditor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];this.activeMemoId=e;let a=new w.w(this,e,t);return t?a.editorLoading=!1:indexedDB.databases().then(t=>{t.find(t=>t.name===e||t.name==="memo_".concat(e))&&(a.editorLoading=!1)}),this.noteEditorController=a,!t&&i&&this.noteEditorController.initNotInfo(),S.w.saveChatPageParams(),a}handleMemoClick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("other"===T.L.mainWindowMode||i){h.T3.openMonicaChatTabPageV2({tab:"memo",memoId:e});return}if(u.o.isWeb&&"web-home"!==u.o.entryType){window.open(p.m.genFullUrl("".concat(p.m.genUrl(A.Cl.monicaWebTabs,{tab:"memo"}),"/").concat(e)));return}if(t&&b.J.onTabChange("memo"),this.activeMemoId===e){this.refreshKey=this.refreshKey+=1;return}this.openEditor(e)}async addMemoWithContent(e,t){var i;let{title:a,content:o,summary:s,plainText:n}=e,r=p.m.genId(),d={status:"complete",createdAt:Date.now(),uid:r,updatedAt:Date.now(),userId:(null===(i=_.userController.userInfo)||void 0===i?void 0:i.id)||0,noteType:"common",description:{type:"common",summary:s,title:a},publicShare:!1,shareUid:"",title:a};this.memoDataSources.unshift(d);let c=this.openEditor(r,!1,!1),h=l.R.createWithoutConvert({uid:r,content:o,description:JSON.stringify({type:"common",summary:s,title:a}),plainText:n,title:a,state:t}).then(()=>{c.initNotInfo()}).finally(()=>{this.createPromiseMap.delete(r)});this.createPromiseMap.set(r,h)}async addMemoInSplitWindowMode(){var e;let t=p.m.genId(),i={status:"complete",createdAt:Date.now(),uid:t,updatedAt:Date.now(),userId:(null===(e=_.userController.userInfo)||void 0===e?void 0:e.id)||0,noteType:"common",description:{type:"common",summary:"",title:""},publicShare:!1,shareUid:"",title:""};this.memoDataSources.unshift(i);let a=this.openEditor(t,!0),o=l.R.create({uid:t,content:"",description:"",plainText:"",title:""}).then(()=>{a.initNotInfo()}).finally(()=>{this.createPromiseMap.delete(t)});this.createPromiseMap.set(t,o)}saveToMemoSuccess(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.M.defaultInsertTarget,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3)||void 0===arguments[3]||arguments[3],{close:o}=I.M.success((0,s.jsx)(y.Z,{S:a?m.S.Global.controllers.memoController.viewDetails:m.S.Global.controllers.memoController.saveSuccess,components:{link:t=>(0,s.jsx)(r.z,{style:{display:"inline-block"},type:"linkPrimary",onClick:()=>{S.w.show("memo"),this.handleMemoClick(e,!0,i),o()},children:t})}}),t)}toggleListType(){let e="grid"===C.A._memoListType?"list":"grid";this.setListType(e)}async setListType(e){if(C.A._memoListType=e,g.ll.update({memoListType:e}),"list"===e?(this.activeMemoId=this.memoRenderList[0].item.uid,this.openEditor(this.memoRenderList[0].item.uid)):this.activeMemoId="",u.o.isWeb){let e=f.l.createPageParamsUrl({tab:"memo",memoId:this.activeMemoId},"home");history.replaceState(null,"",e)}}getLimit(e){if("refresh"===e){let e=window.innerWidth;return Math.max(20,Math.ceil(Math.fround(window.innerHeight/100)*Math.fround(e/280)))}return 20}constructor(){(0,a._)(this,"views",void 0),(0,a._)(this,"forceAddNoteFilterType",!1),(0,a._)(this,"listRefreshFlag",1),(0,a._)(this,"refreshing",!1),(0,a._)(this,"searchRefreshing",!1),(0,a._)(this,"searchRefreshFlag",1),(0,a._)(this,"hasMore",!0),(0,a._)(this,"searchHasMore",!0),(0,a._)(this,"memoDataSources",[]),(0,a._)(this,"searchResults",null),(0,a._)(this,"loading",!0),(0,a._)(this,"searchValue",""),(0,a._)(this,"mode","normal"),(0,a._)(this,"activeMemoId",""),(0,a._)(this,"noteEditorController",null),(0,a._)(this,"shortcut",""),(0,a._)(this,"createPromiseMap",new Map),(0,a._)(this,"tags",[]),(0,a._)(this,"selectMemos",[]),(0,a._)(this,"allTagsRelations",{}),(0,a._)(this,"selectTags",[]),(0,a._)(this,"selectTypes",["all"]),(0,a._)(this,"refreshKey",1),(0,v.rC)(this)}}(0,o.gn)([n.SB],k.prototype,"hasMore",void 0),(0,o.gn)([n.SB],k.prototype,"searchHasMore",void 0),(0,o.gn)([n.SB],k.prototype,"memoDataSources",void 0),(0,o.gn)([n.SB],k.prototype,"searchResults",void 0),(0,o.gn)([n.SB],k.prototype,"loading",void 0),(0,o.gn)([n.SB],k.prototype,"searchValue",void 0),(0,o.gn)([n.SB],k.prototype,"mode",void 0),(0,o.gn)([n.SB],k.prototype,"activeMemoId",void 0),(0,o.gn)([n.SB],k.prototype,"noteEditorController",void 0),(0,o.gn)([n.SB],k.prototype,"shortcut",void 0),(0,o.gn)([n.SB],k.prototype,"createPromiseMap",void 0),(0,o.gn)([n.SB],k.prototype,"tags",void 0),(0,o.gn)([n.SB],k.prototype,"selectMemos",void 0),(0,o.gn)([n.SB],k.prototype,"allTagsRelations",void 0),(0,o.gn)([n.SB],k.prototype,"selectTags",void 0),(0,o.gn)([n.SB],k.prototype,"selectTypes",void 0),(0,o.gn)([n.SB],k.prototype,"refreshKey",void 0),(0,o.gn)([v.Fl],k.prototype,"trimmedSearchValue",null),(0,o.gn)([v.Fl],k.prototype,"allTagsRelationsWithLabel",null),(0,o.gn)([v.Fl],k.prototype,"memoRenderList",null),(0,o.gn)([v.Fl],k.prototype,"memoHasMore",null),(0,o.gn)([v.Fl],k.prototype,"sel",null),(0,o.gn)([v.Fl],k.prototype,"memoViewType",null);let E=new k},32930:function(e,t,i){"use strict";i.d(t,{S:function(){return r}});var a=i(52921),o=i(73047),s=i(47720);class n{get allModelList(){return s.serverConfigController.getStaticConfig("allModelList")||[]}get allModelListByUseModel(){return new Map(this.allModelList.map(e=>[e.useModel,e]))}get allModelListByKey(){return new Map(this.allModelList.map(e=>[e.key,e]))}getModelItem(e){return this.allModelListByKey.has(e)?this.allModelListByKey.get(e)||null:this.allModelListByUseModel.has(e)&&this.allModelListByUseModel.get(e)||null}checkIsAdvancedModel(e){let t=this.getModelItem(e);return(null==t?void 0:t.usageModule)==="genius_bot"||(null==t?void 0:t.usageModule)==="credits"}checkIsStandardModel(e){return!this.checkIsAdvancedModel(e)}constructor(){(0,o.LO)(this)}}(0,a.gn)([o.Fl],n.prototype,"allModelList",null),(0,a.gn)([o.Fl],n.prototype,"allModelListByUseModel",null),(0,a.gn)([o.Fl],n.prototype,"allModelListByKey",null);let r=new n},69761:function(e,t,i){"use strict";i.d(t,{f:function(){return h}});var a=i(66084),o=i(52921),s=i(34491),n=i(88882),r=i(73047),l=i(90180),d=i(47720);class c{get sceneList(){return[{id:this.autoSelectSceneId,name:n.S.Global.modules.MainWindow.MonicaTranslateView.TranslateSceneContent.autoSelect},...d.serverConfigController.getStaticConfig("professionTranslateFeatureList")||[]]}get professionTranslateEngineList(){var e;return null!==(e=d.serverConfigController.getStaticConfig("professionTranslateEngineList"))&&void 0!==e?e:{parallelTranslateEngine:[{id:"deepl",name:"DeepL",icon:"https://assets.monica.im/assets/img/translate_deepl.png",costCredits:"0.1",engineType:"api"},{id:"openai",name:"OpenAI",icon:"https://assets.monica.im/assets/png/gpt.png",costCredits:"0.5",engineType:"ai"},{id:"claude",name:"Claude",icon:"https://assets.monica.im/assets/img/apps_avatar/claude-star-100x100.png",costCredits:"0.5",engineType:"ai"}],translateEngine:[{id:"gemini-1.5-flash-8b",name:"Gemini 1.5 Flash-8B",icon:"https://assets.monica.im/assets/png/gemini.png",costCredits:"1",engineType:"ai",isAdvanced:!1},{id:"gpt-4o-mini",name:"GPT-4o mini",icon:"https://assets.monica.im/assets/png/gpt.png",costCredits:"1",engineType:"ai",isAdvanced:!1},{id:"claude-3.5-haiku",name:"Claude 3.5 Haiku",icon:"https://assets.monica.im/assets/img/apps_avatar/claude-star-100x100.png",costCredits:"1",engineType:"ai",isAdvanced:!1},{id:"gpt-4o",name:"GPT-4o",icon:"https://assets.monica.im/assets/png/gpt.png",costCredits:"1",engineType:"ai",isAdvanced:!0},{id:"claude-3.5-sonnet",name:"Claude 3.5 Sonnet",icon:"https://assets.monica.im/assets/img/apps_avatar/claude-star-100x100.png",costCredits:"1",engineType:"ai",isAdvanced:!0}]}}get webpageTranslationEngineList(){var e;return[...this.freeEngineList,...(null===(e=this.professionTranslateEngineList)||void 0===e?void 0:e.parallelTranslateEngine)||[]]}get translateEngineList(){var e;return[...this.freeEngineList,...(null===(e=this.professionTranslateEngineList)||void 0===e?void 0:e.translateEngine)||[]]}get freeEngineList(){return[{id:"google",name:n.S.Global.modules.MainWindow.MonicaTranslateView.TranslateEngineContent.googleTranslate,icon:"https://assets.monica.im/assets/img/translate_google.png"},{id:"bing",name:n.S.Global.modules.MainWindow.MonicaTranslateView.TranslateEngineContent.microsoftTranslate,icon:"https://assets.monica.im/assets/img/translate_bing.png"}]}allowApplySceneTranslation(e){return!this.isBasicEngine(e)&&!this.isFreeEngine(e)&&"deepl"!==e}isFreeEngine(e){return["google","bing"].includes(e)}isBasicEngine(e){return this.translateEngineList.some(t=>t.id===e&&!t.isAdvanced)&&!this.isFreeEngine(e)}isAdvancedEngine(e){return!this.isFreeEngine(e)&&!this.isBasicEngine(e)}getSceneId(){var e;let t=l.A.translationScene;if(t&&t!==this.autoSelectSceneId)return t;if(t=this.defaultSceneId,(null===(e=window)||void 0===e?void 0:e.location)&&this.sceneList.length){let e=window.location.href;for(let i of this.sceneList)if(i.id&&i.matchUrls){for(let a of i.matchUrls)if(new RegExp(a).test(e)){t=i.id;break}}}return t}constructor(){(0,a._)(this,"defaultSceneId","general"),(0,a._)(this,"autoSelectSceneId","auto-select"),(0,a._)(this,"webTranslationToastShowed",!1),(0,a._)(this,"webTranslationErrorReported",!1),(0,a._)(this,"webTranslationConfigSetting",""),(0,a._)(this,"webTranslationUpgradeDialogVisible",!1),(0,a._)(this,"webTranslationAutoTrigger",!1),(0,a._)(this,"webTranslationSettingOpen",!1),(0,a._)(this,"webTranslationTranslating",!1),(0,r.rC)(this)}}(0,o.gn)([s.SB],c.prototype,"webTranslationSettingOpen",void 0),(0,o.gn)([s.SB],c.prototype,"webTranslationTranslating",void 0),(0,o.gn)([r.Fl],c.prototype,"sceneList",null),(0,o.gn)([r.Fl],c.prototype,"professionTranslateEngineList",null),(0,o.gn)([r.Fl],c.prototype,"webpageTranslationEngineList",null),(0,o.gn)([r.Fl],c.prototype,"translateEngineList",null),(0,o.gn)([r.Fl],c.prototype,"freeEngineList",null);let h=new c},90974:function(e,t,i){"use strict";i.d(t,{j:function(){return y}});var a=i(66084),o=i(52921),s=i(34491),n=i(44469),r=i(11502),l=i(92235),d=i(28901);let c=i(88575).c.getLogger("ChatBox"),h=["SCRIPT","STYLE","NOSCRIPT","IFRAME","OBJECT","EMBED","CANVAS","SVG","IMG","MONICA-TRANSLATE-WRAPPER","MONICA-TRANSLATE"];class g{static parse(){let e=(function(){let e;let t=document.body,i=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,{acceptNode:e=>{var t;let i=e.parentElement;return h.includes((null==i?void 0:i.tagName)||"")?NodeFilter.FILTER_REJECT:(null===(t=e.textContent)||void 0===t?void 0:t.trim())?i&&(!d.x.checkVisibility(i,{checkOpacity:!0,checkVisibilityCSS:!0})||function(e){let t=getComputedStyle(e);return"absolute"===t.position&&"1px"===t.width&&"1px"===t.height&&"0px"===t.padding&&"-1px"===t.margin&&"nowrap"===t.whiteSpace&&"0px"===t.borderWidth}(i))?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}),a=[];for(;e=i.nextNode();)a.push(e);return a})().reduce((e,t,i)=>{let a=(t.textContent||"").replace(/\s+/g," ");if(!a.trim())return e;let o=e[e.length-1];return[...e,{text:a,start:0===i?0:o.start+o.text.length,node:t}]},[]);return{content:e.map(e=>e.text||"").join(" ").replace(/\s+/g," "),domPositions:e}}highlight(e,t){this.timerId&&(clearTimeout(this.timerId),this.removeHighlight());let i=t;i||(i=g.parse());let{domPositions:a,content:o}=i,s=this.getPositionsByChunkFromContent(e,o),n=this.getNodesByPositions(s,a);if(0===n.length)return c.warn("No highlight nodes found."),!1;let r=[];return n.forEach(e=>{let t=e.parentElement;for(;t&&(t.nodeType!==NodeFilter.SHOW_ELEMENT||"MONICA-TRANSLATABLE"===t.tagName);)t=t.parentElement;let i=t&&d.x.checkVisibility(t,{checkOpacity:!0,checkVisibilityCSS:!0});t&&!r.includes(t)&&i&&r.push(t)}),this.highlightDoms.forEach(e=>{e.classList.remove(this.highlightClassName)}),r.forEach(e=>{e.classList.add(this.highlightClassName)}),(r.filter(e=>{let{bottom:t}=e.getBoundingClientRect();return!function(e){if("sticky"===window.getComputedStyle(e).position)return!0;let t=e.parentElement;for(;t;){if("sticky"===window.getComputedStyle(t).position)return!0;t=t.parentElement}return!1}(e)&&t>0}).sort((e,t)=>e.getBoundingClientRect().top-t.getBoundingClientRect().top)[0]||r[0]).scrollIntoView({block:"center",behavior:"smooth"}),this.highlightDoms=r,this.timerId=setTimeout(()=>{this.removeHighlight()},2e3),!!r.length}removeHighlight(){this.highlightDoms.forEach(e=>{e.classList.remove(this.highlightClassName)}),this.highlightDoms=[],this.timerId=null}injectStyle(){if(!document.getElementById(this.highlightStyleId)){let e=document.createElement("style");e.id=this.highlightStyleId,e.innerHTML="\n        .".concat(this.highlightClassName," {\n          animation: fadeInOut 1.5s ease-in-out;\n        }\n\n        @keyframes fadeInOut {\n          0%, 100% { background-color: transparent; }\n          30%, 70% { background-color: rgba(2, 118, 255, 0.20); }\n        }\n      "),document.head.appendChild(e)}}getPositionsByChunkFromContent(e,t){let i=[],a=0,o=0,s=e;for(;s.length>0&&a<t.length&&o<3;){let e=this.longestCommonSubstring(s,t.substring(a));if(!e.trim())break;let n=t.indexOf(e,a),r=n+e.length;i.push({start:n,end:r}),a=r,s=s.replace(e,""),o++}return i}getNodesByPositions(e,t){let i=[];for(let{start:a,end:o}of e){let e=t.filter(e=>this.isPositionInRange({start:e.start,end:e.start+e.text.length},{start:a,end:o}));i.push(...e.flatMap(e=>i.includes(e.node)?[]:e.node))}return i}longestCommonSubstring(e,t){let i=e.length,a=t.length,o=Array(a+1).fill(0),s=0,n=0;for(let r=1;r<=i;r++){let i=0;for(let l=1;l<=a;l++){let a=o[l];e[r-1]===t[l-1]?(o[l]=i+1,o[l]>s&&(s=o[l],n=r)):o[l]=0,i=a}}return e.substring(n-s,n)}isPositionInRange(e,t){return e.start>=t.start&&e.start<=t.end||e.end>=t.start&&e.end<=t.end}constructor(){(0,a._)(this,"highlightClassName","monica-reading-highlight"),(0,a._)(this,"highlightStyleId","monica-reading-highlight-style"),(0,a._)(this,"highlightDoms",[]),(0,a._)(this,"timerId",null)}}var p=i(1340),A=i(73047);let m={noHttp:()=>!["http:","https:"].includes(window.location.protocol)};var u=i(44795);class f{get showReadBlock(){var e;return this.visible&&(null===(e=this.activeTabContent)||void 0===e?void 0:e.isReadable)}initHelpers(e,t){this.pdfJsHelper=new e,this.ReadabilityHelperClass=t}async triggerTabReadingPage(e){this.show();let t=e;t||(t=await n.T3.getActiveTabId());let i=await this.getPageSimpleData({});i&&(this.activeTabContent={tabId:t,...i})}show(){this.visible=!0}hide(){this.visible=!1}constructor(){(0,a._)(this,"pdfJsHelper",void 0),(0,a._)(this,"ReadabilityHelperClass",void 0),(0,a._)(this,"autoTrigger",!1),(0,a._)(this,"contentRootInited",!1),(0,a._)(this,"activeTabId",null),(0,a._)(this,"activeTabContent",null),(0,a._)(this,"visible",!0),(0,a._)(this,"getPageSimpleData",(0,u.c)({name:"getPageSimpleData",channels:["extensionContent"],handler:async()=>{if(l.m.isLocalFile(window.location.href))return{isReadable:!0,title:decodeURIComponent(window.location.href.split("/").pop()||""),url:window.location.href,isPdf:!0,extensionInjected:!0};if(!this.pdfJsHelper)throw Error("DependencyError: need to init pdfJsHelper");return await this.pdfJsHelper.isValidPdf()?{isReadable:!0,title:document.title||window.location.href,url:location.href,isPdf:!0,extensionInjected:!0}:{isReadable:function(){for(let[e,t]of Object.entries(m))if(t())return!1;let{content:e}=g.parse();return e.length>2500}(),title:document.title,url:location.href,extensionInjected:!0,isPdf:!1}}})),(0,a._)(this,"getContentForReading",(0,u.c)({name:"getContentForReading",channels:["extensionContent"],handler:async()=>{let e=l.m.getCurrentSiteFavicon();if(!this.contentRootInited)throw{error:"CONTENT_NOT_READY"};if(!this.pdfJsHelper||!this.ReadabilityHelperClass)throw Error("DependencyError: need to init pdfJsHelper and readability helper");if(l.m.isLocalFile(window.location.href)){let t=await r.M.proxyFetch(window.location.href,{resolveType:"blob"}),{text:i}=await this.pdfJsHelper.parsePdfContent(t);return{content:i,fullContent:i,title:document.title||"",fromReadingPdf:!0,favicon:e,url:window.location.href,readabilityContent:i,tabInfo:{title:document.title,url:location.href}}}if(await this.pdfJsHelper.isValidPdf()){let{text:t}=await this.pdfJsHelper.parsePdfContent(window.location.href);return{content:t,fullContent:t,title:document.title||"",fromReadingPdf:!0,favicon:e,url:window.location.href,readabilityContent:t,tabInfo:{title:document.title,url:location.href}}}let t=new this.ReadabilityHelperClass({document}),{title:i,thumbnail:a,images:o,fullContent:s,content:n}=await t.parse(),{content:d}=g.parse();return{title:i,content:d,fullContent:s,url:window.location.href,tabInfo:{title:document.title,url:location.href},thumbnail:a,images:o,readabilityContent:n,favicon:e}}})),(0,a._)(this,"throttleTriggerTabReadingPage",(0,p.Z)(this.triggerTabReadingPage,1e3)),(0,A.rC)(this)}}(0,o.gn)([s.SB],f.prototype,"activeTabId",void 0),(0,o.gn)([s.SB],f.prototype,"activeTabContent",void 0),(0,o.gn)([s.SB],f.prototype,"visible",void 0),(0,o.gn)([A.Fl],f.prototype,"showReadBlock",null);let y=new f},19613:function(e,t,i){"use strict";i.d(t,{w:function(){return h}});var a=i(66084),o=i(52921),s=i(34491),n=i(92020),r=i(73047),l=i(90180),d=i(25813);class c{setViews(e){this.views=e}async init(e){n.ll.get("sidebarEntryBtnBottom").then(e=>{e&&this.sidebarEntryBtn.setBottomPercent(e)}),this.initFinished||(this.rootContainer=e,this.initFinished=!0)}getRootContainer(){return this.rootContainer}updateRootContainer(e){this.rootContainer=e}isInRootElement(e){return e===this.rootContainer||this.rootContainer.contains(e)}constructor(){(0,a._)(this,"views",void 0),(0,a._)(this,"floatButtonClosed",!1),(0,a._)(this,"clipboardText",""),(0,a._)(this,"sidebarEntryBtn",{ready:!1,visible:!0,hovered:!1,isDragging:!1,tempDisable:!1,bottomPercent:.25,isCloseInThisSession:!1,settingPanelVisible:!1,settingGuideVisible:!1,setHovered:(e,t)=>{e&&this.timer&&(clearTimeout(this.timer),this.timer=null),this.sidebarEntryBtn.hovered=e,t&&(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{this.sidebarEntryBtn.hovered=!1,this.timer=null},3e3)),e&&d.m.refreshToolkitList()},setBottomPercent:e=>{this.sidebarEntryBtn.bottomPercent=e},setVisibility:e=>{this.sidebarEntryBtn.visible!==e&&(this.sidebarEntryBtn.visible=e)},setTempDisable:e=>{this.sidebarEntryBtn.tempDisable!==e&&(this.sidebarEntryBtn.tempDisable=e)},setReadyState:e=>{this.sidebarEntryBtn.ready!==e&&(this.sidebarEntryBtn.ready=e)},setDraggingState:e=>{this.sidebarEntryBtn.isDragging=e},setSettingPanelVisible:e=>{this.sidebarEntryBtn.settingPanelVisible=e},setSettingGuideVisible:e=>{this.sidebarEntryBtn.settingGuideVisible=e},getVisible:()=>!!l.A.sidebarEntryBtnVisible&&!this.sidebarEntryBtn.isCloseInThisSession&&!l.A.sidebarEntryBtnDisabledHosts[window.location.host]&&this.sidebarEntryBtn.visible,getHovered:()=>!!this.sidebarEntryBtn.isDragging||this.sidebarEntryBtn.hovered,closeInThisSession(){this.isCloseInThisSession=!0}}),(0,a._)(this,"timer",null),(0,a._)(this,"rootContainer",void 0),(0,a._)(this,"initFinished",!1),(0,r.rC)(this)}}(0,o.gn)([s.SB],c.prototype,"floatButtonClosed",void 0),(0,o.gn)([s.SB],c.prototype,"clipboardText",void 0),(0,o.gn)([s.SB],c.prototype,"sidebarEntryBtn",void 0);let h=new c},72891:function(e,t,i){"use strict";i.d(t,{D:function(){return er}});var a=i(52921),o=i(4461),s={src:"https://assets.monica.im/home-web/_next/static/media/deepseek.fcf3af51.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEX8/Pq1wv7j6P/o6Ojt7e2gsf77+/f7+/v09fdMaXHn5+329vb////J0v98kv7q7/+Vp/9Qbv5JaP7riqcwAAAADHRSTlP3/PwtLPux7rQALLYyYuf7AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPUlEQVR4nCXKQRKAIAwEwQGCJLgB9f+PtUrP3cR08Bm0IUnDONSvLPuAXM9aG8iad9H4qFc59udG2Alu8QJMrQITB9VjdgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},n={src:"https://assets.monica.im/home-web/_next/static/media/hailuo.d93a86b7.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEXm6un/7ebVP6D/4bX49/tMaXH4xtP1+fr5/v/9xMPxs9T//fv/59H40N/8yPPyn7b/6Nvyssz+8+f5i4tlxKNaAAAAC3RSTlMs/vn57AD+s/b8/qbswIYAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA/SURBVHicNcs5FoAwDANRAU4kYzthuf9deSnopviDBkpEAywywwDG8WwehPJyr9KKd94lMLzPfXDhfg4D/v0DSNQCBhWk3pcAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},r={src:"https://assets.monica.im/home-web/_next/static/media/pika.849b62a8.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAQlBMVEUDBAS+ubOFgn6BfXkFBQYFCwsBAgIGBgcMDRJMaXEFCwscGxoAAAD49e7///ybl5JpZmMuLSvf2tOdnJrBvbdVU1DpeLtFAAAADHRSTlP3+f757C3ssywALPlSmn/gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPUlEQVR4nDXLWw6AIAxFwaOCLXpb8LX/rZqY+D9DcwPzRi2SVDZM9HmXwXFGxANcGZkDbEz9XmT4+uHK319PuQI79HrwbQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},l={src:"https://assets.monica.im/home-web/_next/static/media/pixverse.776e48e5.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAASFBMVEUDBAQgDg5+PlmUgssDBAQBAgJ4RIQFAwMJCwxMaXELCxHZYEI/GwsRERcLERECAgMQDxaDZa+uUmJKIiSXTIOradyqXJ3gbprfQa2PAAAAD3RSTlOz/fn57PT9+ywALf7+LC1LQtI/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQElEQVR4nCXLRwLAIAgAwTWCYBqWlP//NIfMfaiOGV5ZxdIe4hDL2FKARrnGNEXbXZ53KrTce0ng0ixCTv5+1A9OxgJEFa9bdwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},d={src:"https://assets.monica.im/home-web/_next/static/media/claude_haiku_round.59e8cb71.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEX09/jvx7vn5+3t7fPrualMaXH5+vz5/Pzpr5zn5Ob7+fj///765uD88u3z0sfhlXvgjnPbfF7Zd1e+S2JlAAAAC3RSTlOz/Cws/ADs9v4s9qhfhZEAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA8SURBVHicJctJDoAwDACxacmqpGX5/2MR4m6jiTuHktbdZRNKQqLA17juaMfXPp/YDjUkpGBafTj5e+oLQxsB4CCNrXkAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},c=i(45973),h={src:"https://assets.monica.im/home-web/_next/static/media/dalle3.4832cde8.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAflBMVEVMaXGxpU546ayL/PLac193562DzFd12261qVB79+zA/rq2+buYZphaYNyTZaR87rF334R+9taXvVbUlk3pg0nCcXuh/N7l8Y3i/5VlVsvgiEje8paA8purwlnTpFKC/9OLxFSw8sa0/92W/+bl/62kcJa/dI5nY858Y8zffVPPLkK7AAAAGnRSTlMALPz6+yv7/Pf88ysr+/Pss7CzrvSwr/ezs1/SF3QAAAAJcEhZcwAACxMAAAsTAQCanBgAAABGSURBVHicBcEFAoAgAASwQzrtArv//0I3gBdSVATg+STFrAjKNZObWmporTMVYwNKz/1mjKE7THrD08KaK/kvOMAOvR8dfn2nA+9HBHMeAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},g={src:"https://assets.monica.im/home-web/_next/static/media/flux.32e02a20.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEUBAQEFBQUAAAAODg5MaXFzc3MAAAABAQFcXFwAAAAdHR0bGxsAAAAoKChCQkJ6enqwsLDNf5P1AAAADHRSTlP3LC38AP0ss/7s4MimQ6dtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAO0lEQVR4nCXLQRIAIQgEsVZRoGrA/f9rPWzuwY6DD2OmqpQHF3ev5aDo2AXU7fgKvHdEtHNSknJi4+8PQUYB0tNk1RYAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},p=i(13845),A=i(64723),m=i(46342),u={src:"https://assets.monica.im/home-web/_next/static/media/grok_round.6d3bdef0.png",height:66,width:66,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAQlBMVEXr7O6EhIW5ubmjo6P4+fns7OyVlZX+/v/09fZMaXGioqL///98fHzOzs7////u7u7f3993d3dmZmf19fW+vr7W1tYZ/H1oAAAADnRSTlMu/Pn+6+v+9LEA+az5/kbycpwAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA/SURBVHicNctJDoAgEEXBhwLdOHxaxPtf1cTEXW2Khps5DbJ6qIBrGTU9O3ZfPca0D6rTcG1rOuRQFKcy/P0FVlECXoUCVb4AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},f={src:"https://assets.monica.im/home-web/_next/static/media/kling.25ff7c6b.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAS1BMVEUAAAQADBgABCwBAgoAFEsADy8DO0gAAwsAAAJMaXEAImEAEk8VuGQCPYgAJ2sAIm4AAgcBAgcGfcoGfMoADSkW780IRFgdNR9ks0kaisCrAAAAFXRSTlP+/f2ws/r+8CwALOz5+S0strb+/izniUjKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQElEQVR4nAXBCRIAEQwAwQkhgr3L8f+Xbjd+aZCnOGcLOWMFTX18B5EkezExjMnakogc7+hJKUbOoVW83IhW/wFOIAIgDZcU/gAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},y={src:"https://assets.monica.im/home-web/_next/static/media/llama3_round.51fc3b14.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAP1BMVEXX3OPl6ez9+PTa6PRrsPjx8fFJmvHr7/NMaXH19vbd6fXw9/z9/v2CwPvB4f3k7/ePz/9spuxYm+2ny/Ps8vZr8n0DAAAAC3RSTlMstrH0/rP59wDs9ATZOHcAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA9SURBVHicBcGJAYAwCACxq0IB6a/7z2qCo2aKQ2RmBlyj7i7jws4np4nxyOj77Te66px1KUTLbAFOMSv4D0wRAhpfoIf3AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},v={src:"https://assets.monica.im/home-web/_next/static/media/sd3.517e25bd.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEX09vf5+vrn5+1MaXH4+fni5ejLr//Ajf/1e3f////98fbx5v//1MrZw//l1f6vbv4r2XGOAAAACXRSTlOz9iwA7Cz9/fnsOyZPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOUlEQVR4nEXLSRKAQAgEwQJmwAaX///W8OQ9k9iY4YEvSVoOqhoJbJ5syTDddZ1toMw5mh+Hf33HCzJ9AWbMp55YAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},w=i(88882),C=i(92235),b=i(73047),S={src:"https://assets.monica.im/home-web/_next/static/media/android_round.234dfb3d.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEXm6ezg9+nZ9uT+9vx22Z1MaXH4+fn++v729fcsxWf4+fr/9vz+///0//lU0IVe04sWvleF3acO2tUqAAAADHRSTlMs/v62/ADs9rL87LVAt0/PAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAO0lEQVR4nAXBiQHAIAgEwdWgBwn49N9sZhi45AyY2VpO8LQIS0e119olVNfslvCMcyIdZvVeLwwe6WP8RMkB8yKRknEAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},I={src:"https://assets.monica.im/home-web/_next/static/media/apple_round.81c698c7.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEXl5evx8vOsrKxvb2/y8vTy8/OdnZ319fb7/PxMaXHAwMDi6OguLi7////5+fgKCgo9PT0wMDCHh4cRERECjcYUAAAADXRSTlMssPz8s7b88/QA+S3+Fe1pSgAAAAlwSFlzAAALEwAACxMBAJqcGAAAADxJREFUeJwFwYkBgCAMBMHlTaJeAO2/V2cIumkQ3CZVc+i63l1V8DxrTRme+1tNTtF8TlMHU6YMguE+iB9PMAIuya1wYQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},_={src:"https://assets.monica.im/home-web/_next/static/media/chrome_round.3786ffbc.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAARVBMVEXk5eTz/P3t35g+pVP5+/39wSXpVD/7///3+P1MaXHydTn2mpD2mpX///b+8vBppvCVzp/y/vb/4JE0pFWkdE2wszJvmPd0GQBDAAAADXRSTlMstv757P399rIA+f7+FpVPAQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAEBJREFUeJwdxlsSQDAQRcETRu4M8hLsf6mq9FcTJCkRYPU4q4HXnPNeHPX7bdsl1Gf742Odz1YcbPSlGAQuOfEBTqwCPzPeDO0AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},T={src:"https://assets.monica.im/home-web/_next/static/media/edge_round.ba15fdd5.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAV1BMVEX//f617vD6+fn8+/r49/abtNNl25bi5er39fdMaXH6+foASppVvuMzkNfi6OgXu8H////3/f+o0u/G+M7m+epFd60AZcQNptImz2xprd6Mp85wz8gAesyrcd/CAAAAEHRSTlP2/uzstvz8LLIA7P75+S3+NUnpcgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAENJREFUeJwdy0kSgCAMAMEBgQTXAO76/3daZd+bLApBMrM350ovqI3HkkyhvtdzNqDud0srqE3DFk0RX2osnZAl/P0DYQwCq1KA9DwAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},k={src:"https://assets.monica.im/home-web/_next/static/media/vsc_round.09290a73.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAP1BMVEXz9/v19fXi5efi6Ojn5+35+vloq+z+/Pv29vZMaXFCerj6/P/i4uj+//9Vhr3g6PDe6fdLic9mmtSmx+yWttmYK0DaAAAADXRSTlP8siwtLOz89rQA/vktyY/XlAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAEBJREFUeJwlylsOgCAMRNEpFtqqw0v2v1ZC/LvJuYgkMNfAlUkwK4RPuwsF1mddBQZrdXwnhOjjkP7zi1CHeYoNR/MCB3CpwPYAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},E={src:"https://assets.monica.im/home-web/_next/static/media/windows_round.39fa14c5.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAALVBMVEXq6uv29/n+/Pb9/fpYlP9MaXEQZv/v8PXd6//0/P8rd/7///8/hP9mnf9Dh//nhYFnAAAACHRSTlMs8LL2/AD5tsb67bAAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA0SURBVHicPYtRCgAgCMWemqVm3f+4UZB/g21QDBKGAjSnOwHsbWU3hli0DJMH+0Kpiv9+ADLrAWk5vPHNAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},M={src:"https://assets.monica.im/home-web/_next/static/media/facebook.389721a8.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEUvZ/gqY/aFpfkuZ/lMaXFvlvcuYvMtYPMoYvMuaPMmY/wzafclZP/s8f69zvymvvsePVI4AAAAC3RSTlOz9v3sAPksLSws+sgfZF8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAA6SURBVHicJctJDgAhDMRAJ4RNaeD/v0XM3OpgEw0zZtCLMlUGqK5dBZZr+0p78A/Iz3HB+ONOzLe3uDwoAagVL9arAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},x={src:"https://assets.monica.im/home-web/_next/static/media/gmail.26096287.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAASFBMVEX3+Pno6OjhZV2KzJv5+vpMaXGKuPzn6ez//f/29/f9vFf///70XVP+in9xw45yp/ivzv+rKT2trdb1qaWi3rCw3Ir/8JPDdggxXea7AAAAC3RSTlOzLfn57AD8LPb4+T3OA2sAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA9SURBVHicNctJEoAgEATBQoEZbBZ3//9TD4b3TJJRCpYIUZKiwTHJlxt832p9LsfzaK13hzVL8wn24cDfX06TAirfm0/jAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},B={src:"https://assets.monica.im/home-web/_next/static/media/linkedIn.735b459a.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEUIZcIJace40+3u9PoLZb9MaXEKZsKWveQLZ8AJZ8cJaMQJbM+pyuqFs+EVbcXJ3fJnn9n3IT9YAAAAC3RSTlP6sf3+LAC2+yzss0ERhQ0AAAAJcEhZcwAACxMAAAsTAQCanBgAAAA4SURBVHicRctJDsAgDMBAJywBZSn/f23VA+rZY8aaMNegbwffHXF7mrpAWYQCVJ7M4kuh5vLju784ywGWsoOiIgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},D={src:"https://assets.monica.im/home-web/_next/static/media/outlook.f3e1931a.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAATlBMVEX//fxVy/S72/Lw7e3++/f5+fn29/r19fbk6OtMaXEMjtzV8fwnmdru6Ojv9/lssuP+///m9fzJ5foQf8ZBm94wkNv3/f8ZkNJZpePP6flcRqfgAAAAEHRSTlP2/PwstOz7sywA/P7+Lez5MaluUAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAENJREFUeJwVy0kWwCAIBNHWqIBmADHD/U+ax64WvyBMDWUTcNVmT2WQ5rUnJWDe602GiM97Bkgv9z5L4DHsPCBMiP0HWuUCjB4j3mcAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},L={src:"https://assets.monica.im/home-web/_next/static/media/twitter.d89d613b.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEUbGxscHBxYWFgbGxtMaXEcHBwZGRkbGxtCQkIXFxcnJydoaGh0dHQn/6pxAAAACXRSTlP8LPzsALG29Pm/i5I+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAANklEQVR4nDXLwREAIAgEsQVEPLT/en04/hOGTZg2sEAijJR7LyWlPlsqSuzTKlKr3ZVY6OHfLzAGAVl+OKXzAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},R={src:"https://assets.monica.im/home-web/_next/static/media/email.d506281e.png",height:40,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAAP1BMVEX378P58MLSrZb27cL67eHx7Lvw9/P68sX788Pz6L5JldzB2OK81uD78sT//dH3+9yUxd3189Pl7erWxeAqk9tFKhFtAAAADXRSTlP8Wf1Z/hr9z3H++/z8iiiZmwAAAAlwSFlzAAALEwAACxMBAJqcGAAAADpJREFUeJwty0EOgCAMBdFR0YLwCyr3Pytp4u5lkuE0AWxkl4Qb2etIKdDv+e09Shvv9QRQKW7817EAO8oB48aYuVYAAAAASUVORK5CYII=",blurWidth:8,blurHeight:7},U={src:"https://assets.monica.im/home-web/_next/static/media/models.6dea0979.png",height:40,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAYFBMVEXf1bnp08f23t323ePm4crm3L+xqZLj2bvj2b7r4saz0/iZyfna0LXSx6379fXp28rX3t1fW1Hy6djgx7rq5s/h7fft4sp7d3AzNThCQD7jkXXy7+Xag5D27+KVvOSDvPpRgCGcAAAAFXRSTlP+/v7+/v7+U/Do/v7n8f////////40KDxeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARElEQVR4nAXBBwKAIAwEsFOBtg72dP7/lyagw0BXJuyhB78WgRltvN+mgNCbLx7QLtVoH0BNp7P3nCExuWuxAmIFZKYffw0DY8ElvX4AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},P={src:"https://assets.monica.im/home-web/_next/static/media/planCardGoogle.5f1bacbe.png",height:40,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEXv7+/28/T29/f5n5Ps7Ozv7+/+//7s7Ov39/fu7u7r9veV0aTV4Pi/6bqHs/f/wXvS2YOBu/H8vrDBv+o9gdQRAAAACnRSTlP+////U1P//ujxSPzI2AAAAAlwSFlzAAALEwAACxMBAJqcGAAAADxJREFUeJwly0kCgCAMBMFOgEkAFZf//9UD9ypaJ4JeSTcJT3ArRQah9X6HgtB9PpcCbMw5jI3Nk7p7+wE07wGC9JU+xwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},F={src:"https://assets.monica.im/home-web/_next/static/media/socials.7641e959.png",height:40,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAASFBMVEXf9P3P4vrU7P01OkCFtv/O5f3T7P3H3vPM5PonJydCi/+52f3N5frR6P7n//+r0/+1ydxum+Ll/P9jof9ke6RtnOZreIRIT1bfsFKIAAAADHRSTlOhNpv9+zaa/On9+/SBl8YSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOklEQVR4nCXLyRHAIAwAseU0zhhD7v475YH+IrRu1luhupiJRxjH++sE7vyofsDIZ0oT4iUm4pWyV1hCVQIPT6FPDwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:7},O=i(60927),N=i(91263),V=i(49881),Q=i(69131),z=i(24455),H=i(95269),W=i(13203),G=i(30408),j=i(10023),J=i(4176),K=i(27411),q=i(3415),X=i(19072),Z=i(36129),Y=i(59847),$=i(71110),ee=i(38679),et=i(2180),ei=i(54596),ea=i(10103),eo=i(47720),es=i(87393);class en{get S(){return w.S.Global.controllers.planController.planTextController}get basicModels(){return[{icon:(0,o.Q)(A.Z),name:"GPT-4o mini"},{icon:(0,o.Q)(d),name:"Claude 3.5 Haiku"},{icon:(0,o.Q)(s),name:"DeepSeek V3 & R1"}]}get advanceModels(){return[{icon:m.Z,name:"o3 & o4-mini",tip:this.S.gptTip},{icon:c.Z,name:"Claude 3.7 Sonnet",tip:this.S.claudeTip},{icon:p.Z,name:"Gemini 2.5 Pro"},{icon:y,name:"Llama 3.1 405B"},{icon:u,name:"Grok 3"}]}get advanceModelsForBenefits(){return[{name:"OpenAI o1",icon:m.Z,tip:this.S.limitedTip},{name:"GPT-4o",icon:m.Z},{name:"Claude 3.5 Sonnet",icon:c.Z},{name:"Gemini 1.5 Pro",icon:p.Z}]}get imageModels(){return[{icon:v,name:"SDXL & SD3"},{icon:h,name:"Dall-E 3"},{icon:g,name:"Flux Pro & Dev"},{icon:l,name:"Pixverse"},{icon:f,name:"Kling"},{icon:n,name:"Hailuo"},{icon:r,name:"Pika"}]}get enhanceApps(){return[{name:"Gmail",icon:x},{name:"Outlook",icon:D},{name:"Facebook",icon:M},{name:"X",icon:L},{name:"LinkedIn",icon:B}]}get allPlatforms(){let e="Edge"===C.m.getBrowserName();return[{name:(0,w.x)(this.S.ext,{platform:e?"Edge":"Chrome"}),icon:e?T:_},{name:"Windows",icon:E},{name:"iOS & macOS",icon:I},{name:"Android",icon:S},{key:"vscode",name:(0,w.x)(this.S.ext,{platform:"VS Code"}),icon:k}]}get recommendPlanPlatforms(){return"elite"===eo.serverConfigController.recommendPlan.version?this.allPlatforms:this.allPlatforms.filter(e=>"vscode"!==e.key)}get featAiChat(){return{title:this.S.aiChat,list:[{iconPic:U,name:this.S.basicModel},{icon:"searchTool",iconBg:"#D2EFBE",iconColor:"#548631",name:this.S.webAccess},{icon:"a36",iconBg:"#EEE8FF",iconColor:"#7A5ACB",name:this.S.callSkill},{icon:"appStar",iconBg:"#CEE5FB",iconColor:"#1B76CB",name:this.S.compareAnswer}]}}get featAiArt(){return{title:this.S.aiImage,list:[{icon:"chatInputV2Draw",iconBg:"#D2EFBE",iconColor:"#548631",name:this.S.genImage},{icon:"FileVideoIcon",iconBg:"#CEE5FB",iconColor:"#1B76CB",name:this.S.genVideo},{icon:"a104",iconBg:"#FDDEEE",iconColor:"#AC4F7F",name:this.S.imgAnimator},{icon:"imageGenerator",iconBg:"#EEE8FF",iconColor:"#7A5ACB",name:this.S.imgTool}]}}get featAiWrite(){return{title:this.S.aiWrite,list:[{icon:"navWrite",iconBg:"#CEE5FB",iconColor:"#1B76CB",name:this.S.smartWrite},{icon:"a06",iconBg:"#FDDEEE",iconColor:"#AC4F7F",name:this.S.smartReply},{icon:"a23",iconBg:"#F8EFC3",iconColor:"#887725",name:this.S.grammar},{icon:"MindMapIcon",iconBg:"#EEE8FF",iconColor:"#7A5ACB",name:this.S.mindmap}]}}get featAiSummary(){return{title:this.S.aiSummary,list:[{icon:"pdfLine",iconBg:"#D2EFBE",iconColor:"#548631",name:"ChatPDF"},{icon:"searchVideo",iconBg:"#EEE8FF",iconColor:"#7A5ACB",name:this.S.videoSummary},{icon:"baseInfo",iconBg:"#F8EFC3",iconColor:"#887725",name:this.S.fileSummary},{icon:"a120",iconBg:"#CEE5FB",iconColor:"#1B76CB",name:this.S.webSummary}]}}get featAiTranslate(){return{title:this.S.aiTranslate,list:[{icon:"translation",iconBg:"#CEE5FB",iconColor:"#1B76CB",name:this.S.textTranslate},{icon:"2-em268k3m",iconBg:"#FDDEEE",iconColor:"#AC4F7F",name:this.S.webTranslate},{icon:"a85-e5ao0a96",iconBg:"#EEE8FF",iconColor:"#7A5ACB",name:this.S.pdfTranslate}]}}get featEnhance(){return{title:this.S.enhance,list:[{iconPic:P,name:this.S.searchEnhance},{iconPic:R,name:this.S.emailEnhance},{iconPic:F,name:this.S.writeEnhance},"elite"===eo.serverConfigController.recommendPlan.version?{icon:"terminal",iconBg:"#EEE8FF",iconColor:"#7A5ACB",name:"Monica Code"}:null]}}get benefitText(){return{modelDesc:this.S.advancedModelDesc,modelTip:"GPT-4o, o1, o3-mini, GPT-4o mini, Claude 3.5 Sonnet V2, Claude 3.5 Haiku, Gemini 2.0 Pro, Gemini 2.0 Flash, DeepSeek V3, DeepSeek R1, Mistral-7b, Llama 3.3 70B, Llama 3.1 405B, Llama 3 8B",aiArtDesc:this.S.aiArtDesc,aiArtTip:"Stable Diffusion XL 1.0, Stable Diffusion 3.5, Flux Schnell 1.0, Flux Dev 1.0, Flux Pro 1.0, Kling, Hailuo, Pixverse, Pika, Dall-E 3, Playground V2.5, Ideogram V2, Recraft V3 Raw, Imagen 3, SVD, Runway Gen-3"}}get planBenefits(){return[{key:"ai-chat",title:"elite"===eo.serverConfigController.recommendPlan.version?this.S.unlimitedChat:this.S.proChat,desc:this.benefitText.modelDesc,tip:this.benefitText.modelTip,icons:[{name:"gpt4",icon:K.Z},{name:"claude3",icon:Q.Z},{name:"gemini",icon:j.Z},{name:"llama",icon:Z.Z},{name:"deepseek",icon:s,style:{padding:"5px"}}]},{key:"ai-artist",title:this.S.aiArtist,desc:this.benefitText.aiArtDesc,tip:this.benefitText.aiArtTip,icons:[{name:"sd3",icon:$.Z},{name:"dalle3",icon:z.Z},{name:"flux",icon:G.Z},{name:"kling",icon:q.Z},{name:"hailuo",icon:ea.Z}]},{key:"ai-platform",title:this.S.crossPlatforms,icons:[{name:"extension",icon:"Edge"===C.m.getBrowserName()?H.Z:V.Z},{name:"windows",icon:et.Z},{name:"apple",icon:N.Z,style:es.C.isDark?{filter:"invert(100%)"}:{}},{name:"android",icon:O.Z},"elite"===eo.serverConfigController.recommendPlan.version?{name:"vscode",icon:ee.Z}:null]},{key:"ai-enhance",title:this.S.enhance,icons:[{name:"gmail",icon:J.Z},{name:"outlook",icon:Y.Z},{name:"x",icon:ei.Z},{name:"facebook",icon:W.Z},{name:"linkedin",icon:X.Z}]},{key:"ai-file",title:this.S.unlimitedPdf},{key:"ai-summary",title:this.S.unlimitedSummary}]}constructor(){(0,b.rC)(this)}}(0,a.gn)([b.Fl],en.prototype,"S",null),(0,a.gn)([b.Fl],en.prototype,"basicModels",null),(0,a.gn)([b.Fl],en.prototype,"advanceModels",null),(0,a.gn)([b.Fl],en.prototype,"advanceModelsForBenefits",null),(0,a.gn)([b.Fl],en.prototype,"imageModels",null),(0,a.gn)([b.Fl],en.prototype,"enhanceApps",null),(0,a.gn)([b.Fl],en.prototype,"allPlatforms",null),(0,a.gn)([b.Fl],en.prototype,"recommendPlanPlatforms",null),(0,a.gn)([b.Fl],en.prototype,"featAiChat",null),(0,a.gn)([b.Fl],en.prototype,"featAiArt",null),(0,a.gn)([b.Fl],en.prototype,"featAiWrite",null),(0,a.gn)([b.Fl],en.prototype,"featAiSummary",null),(0,a.gn)([b.Fl],en.prototype,"featAiTranslate",null),(0,a.gn)([b.Fl],en.prototype,"featEnhance",null),(0,a.gn)([b.Fl],en.prototype,"benefitText",null),(0,a.gn)([b.Fl],en.prototype,"planBenefits",null);let er=new en},47549:function(e,t,i){"use strict";i.d(t,{Y:function(){return l}});var a=i(66084),o=i(52921),s=i(34491),n=i(73047),r=i(41884);class l{get pageSize(){return this.outputList.length}get activeOutput(){return this.outputList[this.page]||null}get windowItem(){return this.windowId?r.E.getWindowItem(this.windowId):null}get windowItemPosition(){return this.windowItem?{clientX:this.windowItem.layoutManager.left,clientY:this.windowItem.layoutManager.top}:null}get windowItemSize(){return this.windowItem?{width:this.windowItem.layoutManager.width,height:this.windowItem.layoutManager.height}:null}get panelVisible(){return!!this.windowItem}updateOutput(e,t){let i=this.outputList.findIndex(t=>t.taskId===e);if(-1!==i){let e=this.outputList[i];this.outputList[i]={...e,...t}}}handleCloseClick(){var e;this.windowId&&(null===(e=this.windowItem)||void 0===e||e.layoutManager.destroy(),r.E.disposeWindow(this.windowId),this.restQuickPanel())}restQuickPanel(){this.windowId=null,this.outputList=[],this.page=0}constructor(){(0,a._)(this,"scrollContainer",null),(0,a._)(this,"pinned",!1),(0,a._)(this,"outputList",[]),(0,a._)(this,"windowId",null),(0,a._)(this,"page",0),(0,a._)(this,"position",null),(0,a._)(this,"size",null),(0,n.rC)(this)}}(0,o.gn)([s.SB],l.prototype,"pinned",void 0),(0,o.gn)([s.SB],l.prototype,"outputList",void 0),(0,o.gn)([s.SB],l.prototype,"windowId",void 0),(0,o.gn)([s.SB],l.prototype,"page",void 0),(0,o.gn)([s.SB],l.prototype,"position",void 0),(0,o.gn)([s.SB],l.prototype,"size",void 0),(0,o.gn)([n.Fl],l.prototype,"pageSize",null),(0,o.gn)([n.Fl],l.prototype,"activeOutput",null),(0,o.gn)([n.Fl],l.prototype,"windowItem",null),(0,o.gn)([n.Fl],l.prototype,"windowItemPosition",null),(0,o.gn)([n.Fl],l.prototype,"windowItemSize",null),(0,o.gn)([n.Fl],l.prototype,"panelVisible",null)},51832:function(e,t,i){"use strict";i.d(t,{recommendPlanController:function(){return p}});var a=i(66084),o=i(52921),s=i(34491),n=i(79424),r=i(73047),l=i(82417),d=i(25449),c=i(47720),h=i(33381);class g{get allRecommendPlans(){if(h.userController.isFreeUser&&(l.abTestController.experiment.hitMonthlyPlan||"basic"===c.serverConfigController.recommendPlan.version)&&"year"===c.serverConfigController.recommendPlan.interval){let e=e=>e.version===c.serverConfigController.recommendPlan.version&&"month"===e.interval,t=c.serverConfigController.planList.find(e)||c.serverConfigController.defaultPlanList.find(e);return[c.serverConfigController.recommendPlan,t]}return h.userController.isVipUser?[c.serverConfigController.getPlan("elite_yearly")]:[c.serverConfigController.recommendPlan]}get activePlan(){return this.allRecommendPlans.find(e=>e.key===this.activePlanKey)||c.serverConfigController.recommendPlan}get subscribeBtnText(){return h.userController.canResubscribe?d.promotionController.S.activeNow:(this.activePlan.trialDay||0)>0&&h.userController.canTrial?d.promotionController.freeTrial:d.promotionController.S.upgradeNow}get hasTrialPlan(){return h.userController.canTrial&&this.allRecommendPlans.find(e=>e.trialDay&&e.trialDay>0)}initPlanKey(){var e;this.activePlanKey=(null===(e=(0,n.Z)(this.allRecommendPlans))||void 0===e?void 0:e.key)||c.serverConfigController.recommendPlan.key}setActivePlan(e){this.activePlanKey=e}constructor(){(0,a._)(this,"activePlanKey",void 0),(0,r.rC)(this)}}(0,o.gn)([s.SB],g.prototype,"activePlanKey",void 0),(0,o.gn)([r.Fl],g.prototype,"allRecommendPlans",null),(0,o.gn)([r.Fl],g.prototype,"activePlan",null),(0,o.gn)([r.Fl],g.prototype,"subscribeBtnText",null),(0,o.gn)([r.Fl],g.prototype,"hasTrialPlan",null);let p=new g},38299:function(e,t,i){"use strict";i.d(t,{N:function(){return b}});var a=i(66084),o=i(52921),s=i(34491),n=i(1159),r=i(44469),l=i(88575),d=i(76469),c=i(56607),h=i(82498);let g=["direction","boxSizing","width","height","overflowX","overflowY","overflowWrap","overflowAnchor","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","fontKerning","textRendering","lineHeight","fontFamily","textAlign","textTransform","textIndent","textOverflow","textDecoration","textUnderlinePosition","letterSpacing","wordSpacing","tabSize","writingMode","MozTabSize","textAlignLast","-webkit-text-emphasis-style","-webkit-text-emphasis-position","-webkit-text-security","-webkit-font-smoothing","transform"],p=function(e){if(e.isConnected)return!0;if(e.parentNode){let t=e.parentNode;for(;t&&t!=document.documentElement;)t=t.parentNode;return t==document.documentElement}return!1};function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0;if(!e)return A(document.activeElement||document.documentElement,t,i);if(!p(e))return{top:0,left:0,height:0,node:e};if(~["CANVAS","IFRAME"].indexOf(e.nodeName)||i&&i.checkTabIndex&&null!=e.getAttribute("tabindex")){let t=e.getBoundingClientRect();return{top:t.top,left:t.left,height:t.height,node:e}}if(i&&i.absolute){let a=JSON.parse(JSON.stringify(i));a.absolute=!1;let o=A(e,t,a),s=e.getBoundingClientRect();return{top:s.top+o.top,left:s.left+o.left,height:o.height,node:o.node}}let a=~["INPUT","TEXTAREA"].indexOf(e.nodeName);if(null==t||!a){if(a){if("number"==typeof e.selectionStart){let t=e.selectionDirection;return t||(t=e.selectionStart>=e.selectionEnd?"backward":"forward"),A(e,"forward"==t?e.selectionEnd:e.selectionStart,i)}return A(e,t||e.value.length,i)}if(window.getSelection().rangeCount){let t=window.getSelection(),a=t.getRangeAt(0).cloneRange();t.getRangeAt(0).commonAncestorContainer==(t.extentNode||t.focusNode).parentNode&&(a.setStart(t.focusNode,t.focusOffset),a.setEndAfter(a.startContainer)),a.collapse(a.startOffset===t.focusOffset&&a.startContainer==t.focusNode);let o=a.getBoundingClientRect(),s=parseInt(1==a.startContainer.nodeType?window.getComputedStyle(a.startContainer).lineHeight:window.getComputedStyle(a.startContainer.parentNode).lineHeight),n=!0;for(let e in o)0==o[e]||isNaN(o[e])||(n=!1);let r=!1;if(n&&(1==a.commonAncestorContainer.nodeType&&~["true","plaintext-only"].indexOf(a.commonAncestorContainer.getAttribute("contenteditable"))||null!=a.commonAncestorContainer.innerText&&a.commonAncestorContainer.innerText.length)?(~["true","plaintext-only"].indexOf(a.commonAncestorContainer.getAttribute("contenteditable"))&&null==document.activeElement.firstChild?(document.activeElement.innerHTML="<br>",a.setStart(document.activeElement.firstChild,0),a.setEnd(a.startContainer,0),r=!0):a.setEndAfter(a.startContainer),o=a.getBoundingClientRect(),s=parseInt(window.getComputedStyle(a.startContainer).lineHeight),null===a.startContainer.firstChild&&(o=a.startContainer.getBoundingClientRect(),s=parseInt(window.getComputedStyle(a.startContainer).lineHeight))):n&&(a.setStart(document.activeElement,0),a.setEndAfter(document.activeElement),o=document.activeElement.getBoundingClientRect(),s=parseInt(window.getComputedStyle(a.startContainer).lineHeight)),isNaN(s)){let e=a.startContainer;1!=a.startContainer.nodeType&&(e=e.parentNode);let t=e.style.lineHeight;e.style.lineHeight="1em",s=parseInt(window.getComputedStyle(e).lineHeight),e.style.lineHeight=null!=t?t:"","string"!=typeof e.getAttribute("style")||e.getAttribute("style").length||e.removeAttribute("style")}let l=e.getBoundingClientRect(),d={top:o.top-l.top,left:o.left-l.left,height:s,node:a.startContainer};return i&&i.withScrolls&&(e.scrollLeft&&(d.left=d.left+e.scrollLeft),e.scrollHeight&&(d.top=d.top+e.scrollTop)),r&&(d.node=document.activeElement,document.activeElement.removeChild(document.activeElement.firstChild)),d}return{top:0,left:0,height:0,node:e}}let o=document.createElement("div"),s=o.style,n=window.getComputedStyle(e),r="INPUT"===e.nodeName;i&&i.nextToParent?e.parentNode.appendChild(o):document.body.appendChild(o),i&&i.applyClass&&("string"==typeof i.applyClass||i.applyClass instanceof String)&&(o.className=i.applyClass),s.all="initial",s.whiteSpace="pre-wrap",r||(s.textOverflow="clip",s.wordWrap="break-word"),g.forEach(function(e){if(r&&"lineHeight"===e){if("border-box"===n.boxSizing){let e=parseInt(n.height),t=parseInt(n.paddingTop)+parseInt(n.paddingBottom)+parseInt(n.borderTopWidth)+parseInt(n.borderBottomWidth),i=t+parseInt(n.lineHeight);e>i?s.lineHeight="".concat(e-t,"px"):e===i?s.lineHeight=n.lineHeight:s.lineHeight=0}else s.lineHeight=n.lineHeight}else s[e]=n[e]}),s.position="fixed",s.visibility="hidden",s.overflowY=s.overflowX=s.overflow="overlay",r&&(s.whiteSpace="pre");let l="";l=e.value,r&&"password"==e.getAttribute("type")&&(l=l.split("").map(function(e){return/Edge|EdgA/.test(navigator.userAgent)||null!=window.mozInnerScreenX?"●":"•"}).join("")),o.appendChild(document.createTextNode(l.substr(0,t))),s.overflowY=s.overflowX=s.overflow="overlay";let d=document.createElement("span");d.style.all="unset",d.style.lineHeight="1em",o.appendChild(d),d.appendChild(document.createTextNode(l.substr(t,1024)||".")),1==d.textContent.length&&(d.fontFamily="monospace");let c={top:d.offsetTop+parseInt(n.borderTopWidth),left:d.offsetLeft+parseInt(n.borderLeftWidth),height:parseInt(getComputedStyle(d).lineHeight),node:e};return d.textContent="",/Edge|EdgA/.test(navigator.userAgent)&&r&&o.scrollWidth>o.clientWidth&&(c.left+=e.scrollWidth-o.scrollWidth),o.parentNode.removeChild(o),i&&i.withScrolls||(e.scrollLeft&&(c.left=c.left-e.scrollLeft),e.scrollHeight&&(c.top=c.top-e.scrollTop)),c}let m=l.c.getLogger("SelectionController");class u{getSelectionRect(e){if(!e.collapsed){let t=e.getBoundingClientRect();if(0!==t.width||0!==t.height)return t}let t=e.startContainer;if(t instanceof HTMLElement){let i=t.childNodes[e.startOffset];if(i&&this.isBasicInput(i)){let e=this.getSelectionRectForBasicInputV2(i);return e.left=Math.round(e.left),e.right=Math.round(e.right),e.top=Math.round(e.top),e.bottom=Math.round(e.bottom),e.width=Math.round(e.width),e.height=Math.round(e.height),m.debug("selection rect:",{width:e.width,height:e.height,left:e.left,top:e.top}),e}}return null}getSelectedText(e){let t;let{startContainer:i,endContainer:a,commonAncestorContainer:o,startOffset:s,endOffset:n}=e;if(o.nodeType===Node.TEXT_NODE){let e=A(o.parentElement);return e.selectable?p(e.whiteSpaceType,o.textContent.slice(s,n).trim()):""}if(i instanceof HTMLElement){let e=i.childNodes[s];if(e&&this.isBasicInput(e)){if(!A(e).selectable)return"";let{selectionStart:t,selectionEnd:i}=e;return e.value.slice(t,i).trim()}}let r=[],l=!1,d=!1,c=(t,i)=>{t.nodeType===Node.TEXT_NODE?function(t,i){function a(e){return p(i.whiteSpaceType,e)}t===e.startContainer&&(l=!0),l&&t.nodeType===Node.TEXT_NODE&&i.selectable&&(t===e.startContainer&&t===e.endContainer?r.push({content:a(t.textContent.slice(e.startOffset,e.endOffset))}):t===e.startContainer?r.push({content:a(t.textContent.slice(e.startOffset))}):t===e.endContainer?r.push({content:a(t.textContent.slice(0,e.endOffset))}):r.push({content:a(t.textContent)})),t===e.endContainer&&(d=!0)}(t,i):t.nodeType===Node.ELEMENT_NODE&&function(t){var i;if(t===e.startContainer&&(l=!0),t===e.endContainer){d=!0;return}let a=A(t);for(let e of(a.selectable&&r.push({content:" "}),t.childNodes))if(c(e,a),d)break;a.selectable&&((i=a.style,"BR"!==t.tagName&&i.display.startsWith("inline"))?r.push({content:" "}):r.push({content:"\n"}))}(t)};if(t=o instanceof HTMLElement?A(o):A(o.parentElement),a===o&&i!==a&&a.contains(i)){if(window&&window.getSelection&&"function"==typeof window.getSelection){var h,g;let e=null===(g=window)||void 0===g?void 0:null===(h=g.getSelection())||void 0===h?void 0:h.toString();if(e)return e}c(i,t)}else c(o,t);return r.map(e=>e.content).join("").trim().split("\n").map(e=>e.trim()).join("\n").replace(/\n\n+/g,"\n\n").replace(/  +/g," ");function p(e,t){return"normal"===e?t.split("\n").map(e=>e.trim()).join(""):"keepNewLine"===e?t.split("\n").map(e=>e.trim()).join("\n"):t}function A(e){let t;let i=getComputedStyle(e),a=window.location.host.includes("mail.yahoo.com");return"SCRIPT"!==e.tagName&&"STYLE"!==e.tagName&&(a||"none"!==i.userSelect)&&"0"!==i.opacity&&"none"!==i.display&&"hidden"!==i.visibility?(t="pre-line"===i.whiteSpace?"keepNewLine":i.whiteSpace.startsWith("pre")||"break-spaces"===i.whiteSpace?"keepNewLineAndSpace":"normal",{style:i,selectable:!0,whiteSpaceType:t}):{style:i,selectable:!1,whiteSpaceType:"normal"}}}isBasicInput(e){return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement}getSelectionRectForBasicInputV2(e){let t=e.getBoundingClientRect(),i=e.selectionStart,a=e.selectionEnd-1,o=e.scrollTop,s=e.value,n=new h.f,{measureText:r}=n.loadElement(e,e.value),l=r(i),d=r(a),c=l.top===d.top;if(m.debug({onlyOneLine:c,a:l,b:d,elRect:t}),c)return n.destroy(),{left:t.left+l.left,right:t.left+d.left,top:t.top+l.top-o,bottom:t.top+d.bottom,width:d.left-l.left,height:d.bottom-l.top};let g="",p="",A=i,u=i;for(let e=i;e<=a;e++){let t=s[e];"\n"===t||e===a?(p.length>g.length&&(g=p,A=u),p="",u=e+1):p+=t}let f=r(A),y=r(A+g.length);if(f.top!==y.top)return n.destroy(),{left:t.left,right:t.right,top:t.top+l.top-o,bottom:t.top+d.bottom,width:t.width,height:d.bottom-l.top};let v=Math.min(l.left,d.left,f.left,y.left),w=Math.max(l.left,d.left,f.left,y.left);return n.destroy(),{left:t.left+v,right:t.left+w,top:t.top+l.top-o,bottom:t.top+d.bottom,width:w-v,height:d.bottom-l.top}}getSelectionRectForBasicInput(e){let t=e.getBoundingClientRect(),i=e.selectionStart,a=e.selectionEnd,o=e.value,s=A(e,i),n=A(e,a);if(s.top===n.top)return{left:t.left+s.left,right:t.left+n.left,top:t.top+s.top,bottom:t.top+n.top+n.height,width:n.left-s.left,height:s.height};let r="",l="",d=i,c=i;for(let e=i;e<=a;e++){let t=o[e];"\n"===t||e===a?(l.length>r.length&&(r=l,d=c),l="",c=e+1):l+=t}let h=A(e,d),g=A(e,d+r.length);if(h.top!==g.top)return{left:t.left,right:t.right,top:t.top+s.top,bottom:t.top+n.top+n.height,width:t.width,height:n.top-s.top+s.height};let p=Math.min(s.left,n.left,h.left,g.left),m=Math.max(s.left,n.left,h.left,g.left);return{left:t.left+p,right:t.left+m,top:t.top+s.top,bottom:t.top+n.top+n.height,width:m-p,height:n.top-s.top+s.height}}}var f=i(71528),y=i(20978),v=i(73047);let w=l.c.getLogger("SelectionController");class C extends d.v{init(e){this.initFinished||(this.rootContainer=e,w.debug("editableController init"),this.addGlobalListeners(),this.initFinished=!0)}setSelectedText(e){e?(this.selectedText=e,this.selectionType="inPage"):(this.selectedText=null,this.selectionType="none")}updateRootContainer(e){this.rootContainer=e}clearSelection(){this.markNoSelection("none")}tempLockClearSelection(){w.log("clear selection locked"),this.clearSelectionLocked=!0,this.selectionLockTimeout&&clearTimeout(this.selectionLockTimeout),this.selectionLockTimeout=setTimeout(()=>{w.log("locked released"),this.clearSelectionLocked=!1,this.selectionLockTimeout=null},100)}getSelectionRect(){return this.currentRange?this.selectionHelper.getSelectionRect(this.currentRange):null}getSelectedContext(){if(!this.selectedNode)return"";let[e,t]=this.selectedNode;if(!e&&!t)return"";let i=this.getElementContextText(e||t);return"".concat(document.title," ").concat(i)}sendSelectionChangeEvent(e){this.emit("selectionChange",{start:null,end:null,range:null,type:"none",text:e})}getElementContextText(e){let t="",i=null;i=e instanceof Element?e:e.parentElement;let a=e=>{let t="";for(let i=0;i<e.childNodes.length;i++){let o=e.childNodes[i];"SCRIPT"!==o.nodeName&&"STYLE"!==o.nodeName&&(o.nodeType===Node.TEXT_NODE?t+=o.textContent||"":o.nodeType===Node.ELEMENT_NODE&&(t+=a(o)))}return t};for(;i;){let e=a(i);if(e.length<=1e3){if(e.length<500)t=e,i=i.parentElement;else{t=e;break}}else{t=e.substring(0,1e3);break}}return t}addGlobalListeners(){let{listenerManager:e}=this,t=(0,y.Z)(()=>{w.log("window sel change"),this.handleSelectionChange()},10);e.addDocumentEventListener("selectionchange",t),n.h.on("targetInput",t),e.addDocumentEventListener("click",e=>{this.isInRootElement(e.target)||t()})}isInRootElement(e){var t;return e===this.rootContainer||(null===(t=this.rootContainer)||void 0===t?void 0:t.contains(e))}handleSelectionChange(){var e;let t=this.getSelectedNode();if(w.debug("handle selection change",t),!t){if(this.clearSelectionLocked)return;this.markNoSelection("none");return}let[i,a,o]=t;if(null===(e=this.rootContainer)||void 0===e?void 0:e.contains(i)){this.markNoSelection("inMonica");return}let s=this.getSelectedText(o);if(w.debug("selected text",JSON.stringify(s)),!s){if(this.emit("caretChange",{end:a}),this.clearSelectionLocked)return;this.markNoSelection("none");return}this.selectedText=s,this.selectionType="inPage",this.selectedNode=[i,a],this.currentRange=o,w.debug("[[selected text]]:"),w.debug(this.selectedText),w.debug(this.selectedText.length),this.emitSelectionChange()}emitSelectionChange(){let e=this.selectedNode;this.emit("selectionChange",{start:e?e[0]:null,end:e?e[1]:null,range:this.currentRange,type:this.selectionType,text:this.selectedText}),c.o.isExtension&&("none"===this.selectionType&&r.T3.markSelectionChange(null),"inPage"===this.selectionType&&r.T3.markSelectionChange(this.selectedText))}getSelectedText(e){return new u().getSelectedText(e)}getSelectedNode(){let e=getSelection();if(w.debug(e),!e||0===e.rangeCount)return null;let t=e.getRangeAt(0);return[t.startContainer.childNodes[t.startOffset]||t.startContainer,t.endContainer.childNodes[t.endOffset]||t.endContainer,t]}markNoSelection(e){w.debug("mark no selection",e);let t=this.selectionType;this.selectionType=e,"none"===e&&(this.selectedNode=null,this.currentRange=null,this.selectedText=null),t!==e&&this.emitSelectionChange()}constructor(){super(),(0,a._)(this,"selectionType","none"),(0,a._)(this,"selectedText",null),(0,a._)(this,"currentRange",null),(0,a._)(this,"selectedNode",null),(0,a._)(this,"rootContainer",void 0),(0,a._)(this,"initFinished",!1),(0,a._)(this,"listenerManager",new f.M),(0,a._)(this,"clearSelectionLocked",!1),(0,a._)(this,"selectionLockTimeout",null),(0,a._)(this,"selectionHelper",new u),(0,v.rC)(this)}}(0,o.gn)([s.SB],C.prototype,"selectionType",void 0),(0,o.gn)([s.SB],C.prototype,"selectedText",void 0);let b=new C},25813:function(e,t,i){"use strict";i.d(t,{m:function(){return d}});var a=i(66084),o=i(52921),s=i(73047),n=i(90122),r=i(47720);class l{get toolListData(){return r.serverConfigController.getStaticConfig("toolConfig")||null}get tools(){var e;return(null===(e=this.toolListData)||void 0===e?void 0:e.toolList)||[]}async initToolkitList(){var e;let t=(null===(e=this.toolListData)||void 0===e?void 0:e.categoryList)||[];t&&this.updateTabs(t)}async refreshToolkitList(){var e;if(this.refreshed)return;this.refreshed=!0;let t=(null===(e=this.toolListData)||void 0===e?void 0:e.categoryList)||[];t&&this.updateTabs(t)}updateTabs(e){let t=e.map(e=>({key:e.key,toolTypeList:e.toolTypeList,name:()=>e.name}));this.tabManager.setTabItems(t),t.length>0&&!this.tabManager.activeTabKey&&this.tabManager.setActiveTabKey(t[0].key)}constructor(){(0,a._)(this,"tabManager",new n.P({defaultActiveTabKey:"",tabItems:[]})),(0,a._)(this,"refreshed",!1),(0,s.rC)(this)}}(0,o.gn)([s.Fl],l.prototype,"toolListData",null),(0,o.gn)([s.Fl],l.prototype,"tools",null);let d=new l},2439:function(e,t,i){"use strict";i.d(t,{j:function(){return w}});var a=i(66084),o=i(52921),s=i(34491),n=i(88882),r=i(92235),l=i(60445),d=i(73047),c=i(78148),h=i(72796),g=i(11502),p=i(62659),A=i(37949),m=i(90230),u=i(87393),f=i(15851),y=i(33381);class v{get S(){return n.S.Global.controllers.webPageMarkController}get currentColorNumber(){var e,t;return null!==(t=null===(e=this.currentMark)||void 0===e?void 0:e.color)&&void 0!==t?t:0}get currentColor(){return h.d.colorMap[this.currentColorNumber]}get usedViewInMemo(){return this.markIdsViewInMemo.length>0}createMark(e){if(g.M.createUserBehaviorEvent({eventName:"quick_action_click",extData:{module:"mark",actionsId:"delete"}}),!y.userController.hasCachedUserInfo){window.open(r.m.genFullUrl(l.Cl.login));return}let t=Math.max(h.d.getNumberByColor(this.selectedColor),0),i=this.webPageMarkHelper.drawMark(e,t,e=>{let t=this.markList.find(e=>e.uid===a.uid);t&&(t.noteUid=e,this.markList=[...this.markList],p.g.create(t).catch(e=>{let i=this.markList.findIndex(e=>e.uid===t.uid);return this.markList.splice(i,1),f.M.error(this.S.createFailed),Promise.reject(e)}))});if(!i){f.M.error(this.S.createFailed);return}let{mark:a}=i;this.markList.push(a)}async deleteMark(e){g.M.createUserBehaviorEvent({eventName:"quick_action_click",extData:{module:"mark",actionsId:"delete"}}),-1!==this.markList.findIndex(t=>t.uid===e)&&(this.webPageMarkHelper.deleteMark(e),p.g.delete(e),this.closeTools())}setMarkClickHandler(e){this.webPageMarkHelper.onClickMark=e}init(){var e=this;this.webPageMarkHelper.init();let t=function(){var t,i;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];w.collectText();let o=window.location.href.split("#")[0];e.markList=a.filter(e=>e.url===o),null===(t=e.markList)||void 0===t||t.forEach(t=>{t.uid&&e.webPageMarkHelper.renderMark(t)}),e.currentMark=null!==(i=e.markList.find(t=>{var i;return t.uid===(null===(i=e.currentMark)||void 0===i?void 0:i.uid)}))&&void 0!==i?i:null};p.g.listAllUrl().then(e=>{if(t(null!=e?e:[]),null==e?void 0:e.length){let t=window.location.href.split("#")[0];this.markList=e.filter(e=>e.url===t),this.markList.length&&p.g.listAllUrl({forceFetch:!0})}}),p.g.on("markListChange",e=>{t(null!=e?e:[])}),p.g.listMarkIdsViewedInMemo().then(e=>{this.markIdsViewInMemo=null!=e?e:[]}),p.g.on("markIdsViewedInMemoChange",e=>{this.markIdsViewInMemo=null!=e?e:[]}),setTimeout(()=>{t(w.markList)},3e3)}getTransparent(){return u.C.isDark?{normal:"3D",hover:"73"}:{normal:"72",hover:"B2"}}updateCurrentMarkColor(e){if(!this.currentMark)return;let t=this.getTransparent();p.g.update({uid:this.currentMark.uid,color:e,comment:this.currentMark.comment}),this.webPageMarkHelper.updateMarkColor(this.currentMark.uid,"".concat(h.d.colorMap[e]).concat(t.hover)),this.selectedColor=h.d.colorMap[e]}findMarkByUid(e){return this.markList.find(t=>t.uid===e)}collectText(){this.webPageMarkHelper.collectText()}openTools(e,t,i){var a,o;let s=this.findMarkByUid(e);s&&(this.anchor=t,this.offset=i,this.visible?e!==(null===(a=this.currentMark)||void 0===a?void 0:a.uid)&&this.updatePosition():(this.visible=!0,this.updatePosition()),this.currentMark=s,this.highlightCurrentMark(),null===(o=this.afterOpenTools)||void 0===o||o.call(this))}closeTools(){var e;this.anchor=void 0,this.offset={left:0,top:0},this.visible=!1,this.resetCurrentMarkColor(),this.currentMark=null,null===(e=this.afterCloseTools)||void 0===e||e.call(this)}resetCurrentMarkColor(){if(!this.currentMark)return;let e=this.getTransparent(),t="".concat(h.d.colorMap[this.currentColorNumber].slice(0,7)).concat(e.normal);this.webPageMarkHelper.updateMarkColor(this.currentMark.uid,t)}highlightCurrentMark(){if(!this.currentMark)return;let e=this.getTransparent(),t="".concat(h.d.colorMap[this.currentColorNumber].slice(0,7)).concat(e.hover);this.webPageMarkHelper.updateMarkColor(this.currentMark.uid,t)}scheduleUpdatePosition(){if(this.isUpdatingPosition)return;this.canScheduleUpdatePosition=!0,this.isUpdatingPosition=!0,setTimeout(()=>{this.canScheduleUpdatePosition=!1},this.updatePositionDelay);let e=()=>{if(!this.visible||!this.canScheduleUpdatePosition){this.isUpdatingPosition=!1;return}this.updatePosition()&&requestAnimationFrame(e)};e()}constructor(){(0,a._)(this,"visible",!1),(0,a._)(this,"currentMark",null),(0,a._)(this,"markList",[]),(0,a._)(this,"markIdsViewInMemo",[]),(0,a._)(this,"currentSpan",null),(0,a._)(this,"anchor",void 0),(0,a._)(this,"offset",{left:0,top:0}),(0,a._)(this,"updatePositionDelay",100),(0,a._)(this,"openToolTimer",null),(0,a._)(this,"position",{left:0,top:0}),(0,a._)(this,"selectedColor",""),(0,a._)(this,"webPageMarkHelper",new h.d),(0,a._)(this,"canScheduleUpdatePosition",!0),(0,a._)(this,"isUpdatingPosition",!1),(0,a._)(this,"afterOpenTools",void 0),(0,a._)(this,"afterCloseTools",void 0),(0,a._)(this,"handleSelectMark",e=>{let t=e.target,{clientX:i,clientY:a}=e,o=t.dataset.id;if(!o)return;this.currentSpan=t;let s=t.getBoundingClientRect(),n={left:i-s.left,top:a-s.top};this.updateToolsFromMouse(o,t,n)}),(0,a._)(this,"updateToolsFromMouse",(e,t,i)=>{var a,o;g.M.createUserBehaviorEvent({eventName:"quick_action_click",extData:{module:"mark",actionsId:"delete"}}),e&&((null===(a=this.currentMark)||void 0===a?void 0:a.uid)&&this.currentMark.uid!==e&&this.resetCurrentMarkColor(),e!==(null===(o=this.currentMark)||void 0===o?void 0:o.uid)&&this.openTools(e,t,i))}),(0,a._)(this,"handleUnselectMark",e=>{var t;let i=e.target.dataset.id;i&&i===(null===(t=this.currentMark)||void 0===t?void 0:t.uid)&&(this.currentSpan=null,this.resetCurrentMarkColor(),this.closeTools())}),(0,a._)(this,"handleClickComment",e=>{if(g.M.createUserBehaviorEvent({eventName:"quick_action_click",extData:{module:"mark",actionsId:"comment"}}),y.userController.checkLogin(),!this.currentMark)return;let{clientX:t,clientY:i}=e,a=document.documentElement.getBoundingClientRect(),o=document.body.getBoundingClientRect(),s=o.top-a.top,n=o.left-a.left,r=document.documentElement.scrollTop,l=document.documentElement.scrollLeft,{width:d=0,height:h=0}=c.liteWindowController.addCommentManger.size,{clientWidth:p,clientHeight:A}=document.documentElement,m=i+8,u=t+8;c.liteWindowController.addCommentManger.show({uid:this.currentMark.uid,pos:{top:(m+h>A?A-h:m)+r-s,left:(u+d>p?p-d:u)+l-n}})}),(0,a._)(this,"viewInMemo",()=>{if(g.M.createUserBehaviorEvent({eventName:"quick_action_click",extData:{module:"mark",actionsId:"view"}}),!this.currentMark)return;A.w.show("memo");let e=this.currentMark.noteUid||this.currentMark.uid;m.a.handleMemoClick(e,!0),p.g.markAsViewedInMemo(e)}),(0,a._)(this,"updatePosition",()=>{let{anchor:e,offset:t}=this;if(!e)return!1;let i=e.getBoundingClientRect();return this.position={left:i.left+t.left+8,top:i.top+t.top+8},!0}),(0,d.rC)(this)}}(0,a._)(v,"markClass","monica-mark"),(0,o.gn)([s.SB],v.prototype,"visible",void 0),(0,o.gn)([s.SB],v.prototype,"currentMark",void 0),(0,o.gn)([s.SB],v.prototype,"markList",void 0),(0,o.gn)([s.SB],v.prototype,"markIdsViewInMemo",void 0),(0,o.gn)([d.Fl],v.prototype,"S",null),(0,o.gn)([s.SB],v.prototype,"position",void 0),(0,o.gn)([d.Fl],v.prototype,"currentColorNumber",null),(0,o.gn)([d.Fl],v.prototype,"currentColor",null),(0,o.gn)([d.Fl],v.prototype,"usedViewInMemo",null),(0,o.gn)([s.SB],v.prototype,"selectedColor",void 0);let w=new v},99778:function(e,t,i){"use strict";i.d(t,{Q:function(){return h}});var a=i(66084),o=i(52921),s=i(34491),n=i(90180),r=i(70174),l=i(88882),d=i(73047);class c{get S(){return l.S.Global.controllers.writeConfigController}get writeCompose(){let{auto:e,length:t,format:i,tone:a}=l.S.Global.services.monicaService;return{length:[{key:"auto",name:e},{key:"short",name:t.short},{key:"medium",name:t.medium},{key:"long",name:t.long}],format:[{uid:"text",key:"text",name:e,quantity:"some",isSystem:!0},{uid:"email",key:"email",name:i.email,quantity:"an",isSystem:!0},{uid:"message",key:"message",name:i.message,quantity:"a",isSystem:!0},{uid:"comment",key:"comment",name:i.comment,quantity:"a",isSystem:!0},{uid:"paragraph",key:"paragraph",name:i.paragraph,quantity:"a",isSystem:!0},{uid:"article",key:"article",name:i.article,isSystem:!0,quantity:"an"},{uid:"blog post",key:"blog post",name:i.blogPost,quantity:"a",isSystem:!0},{uid:"ideas",key:"ideas",name:i.ideas,quantity:"few",isSystem:!0},{uid:"outline",key:"outline",name:i.outline,isSystem:!0,quantity:"an"},{uid:"twitter",key:"twitter",name:i.twitter,isSystem:!0,quantity:"a"}],tone:[{uid:"auto",key:"auto",name:e,isSystem:!0},{uid:"amicable",isSystem:!0,key:"amicable",name:a.amicable},{uid:"casual",isSystem:!0,key:"casual",name:a.casual},{uid:"friendly",isSystem:!0,key:"friendly",name:a.friendly},{uid:"professional",isSystem:!0,key:"professional",name:a.professional},{uid:"witty",isSystem:!0,key:"witty",name:a.witty},{uid:"funny",isSystem:!0,key:"funny",name:a.funny},{uid:"formal",isSystem:!0,key:"formal",name:a.formal}]}}get allWriteCompose(){return{...this.writeCompose,tone:[...this.writeCompose.tone,...this.customToneList],format:[...this.writeCompose.format,...n.A.customFormat.map(e=>({uid:e.id,key:e.name,name:e.name,isSystem:!1}))]}}get quickCompose(){return{length:[{key:"auto",name:this.S.auto},{key:"short",name:this.S.short},{key:"medium",name:this.S.medium},{key:"long",name:this.S.long}],formality:[{key:"auto",name:this.S.auto},{key:"casual",name:this.S.casual},{key:"neutral",name:this.S.neutral},{key:"professional",name:this.S.professional}],format:[{uid:"text",key:"text",name:this.S.auto,isSystem:!0},{uid:"email",key:"email",name:this.S.email,isSystem:!0},{uid:"message",key:"message",name:this.S.message,isSystem:!0},{uid:"comment",key:"comment",name:this.S.comment,isSystem:!0},{uid:"paragraph",key:"paragraph",name:this.S.paragraph,isSystem:!0},{uid:"article",key:"article",name:this.S.article,isSystem:!0},{uid:"blog post",key:"blog post",name:this.S.blogPost,isSystem:!0},{uid:"ideas",key:"ideas",name:this.S.ideas,isSystem:!0},{uid:"outline",key:"outline",name:this.S.outline,isSystem:!0},{uid:"twitter",key:"twitter",name:this.S.twitter,isSystem:!0},{uid:"reddit",key:"reddit",name:this.S.reddit,isSystem:!0},{uid:"facebook",key:"facebook",name:this.S.facebook,isSystem:!0},{uid:"linkedin",key:"linkedin",name:this.S.linkedin,isSystem:!0}],tone:[{uid:"auto",isSystem:!0,key:"auto",name:this.S.auto},{uid:"enthusiastic",isSystem:!0,key:"enthusiastic",name:this.S.enthusiastic},{uid:"humorous",isSystem:!0,key:"humorous",name:this.S.humorous},{uid:"concerned",isSystem:!0,key:"concerned",name:this.S.concerned},{uid:"humble",isSystem:!0,key:"humble",name:this.S.humble},{uid:"optimistic",isSystem:!0,key:"optimistic",name:this.S.optimistic},{uid:"empathetic",isSystem:!0,key:"empathetic",name:this.S.empathetic},{uid:"candid",isSystem:!0,key:"candid",name:this.S.candid},{uid:"sincere",isSystem:!0,key:"sincere",name:this.S.sincere}]}}get allQuickCompose(){return{...this.quickCompose,tone:[...this.quickCompose.tone,...this.customToneList],format:[...this.quickCompose.format,...n.A.customFormat.map(e=>({uid:e.id,key:e.name,name:e.name,isSystem:!1}))]}}async init(){if(this.initialized)return;this.initialized=!0,r.v.on("storageChange",e=>{void 0!==e.customToneListV2&&(this.customToneList=e.customToneListV2||[])});let e=await r.v.fetchToneList();this.customToneList=e}constructor(){(0,a._)(this,"customToneList",[]),(0,a._)(this,"initialized",!1),(0,d.rC)(this)}}(0,o.gn)([s.SB],c.prototype,"customToneList",void 0),(0,o.gn)([d.Fl],c.prototype,"S",null),(0,o.gn)([d.Fl],c.prototype,"writeCompose",null),(0,o.gn)([d.Fl],c.prototype,"allWriteCompose",null),(0,o.gn)([d.Fl],c.prototype,"quickCompose",null),(0,o.gn)([d.Fl],c.prototype,"allQuickCompose",null);let h=new c},82498:function(e,t,i){"use strict";i.d(t,{f:function(){return s}});var a=i(66084),o=i(27544);class s{measureText(e,t,i){let a=this.domMeasurement.getStyle(e,"display"),o=this.domMeasurement.getCssText(e);return this.mirrorTextNode.style.cssText=o,"inline"===a&&(this.mirrorTextNode.style.textAlign="initial"),this.mirrorTextNode.innerHTML=t.split("").map(e=>"<span>".concat(e,"</span>")).join(""),this.doMeasureText({element:e,display:a,text:t,index:i})}loadElement(e,t){let i=this.domMeasurement.getStyle(e,"display"),a=parseFloat(this.domMeasurement.getStyle(e,"width")),o=this.domMeasurement.getScrollbarWidth(e),s=this.domMeasurement.getCssText(e);return s+="; height: auto; max-height: none; width: ".concat(a-o,"px; overflow: hidden;"),"inline"===i&&(s+="; text-align: initial"),this.mirrorTextNode.style.cssText=s,this.mirrorTextNode.innerHTML=t.split("").map(e=>"<span>".concat(e,"</span>")).join(""),{measureText:a=>this.doMeasureText({element:e,display:i,text:t,index:a})}}loadSimpleElement(e,t){let i=this.domMeasurement.getStyle(e,"display"),a=parseFloat(this.domMeasurement.getStyle(e,"width")),o=this.domMeasurement.getScrollbarWidth(e),s=this.domMeasurement.getCssText(e);return s+="; height: auto; max-height: none; width: ".concat(a-o,"px; overflow: hidden;"),"inline"===i&&(s+="; text-align: initial"),this.mirrorTextNode.style.cssText=s,this.mirrorTextNode.innerHTML=t,{doMeasure:(e,t)=>{let{left:i,top:a}=this.mirrorTextNode.getBoundingClientRect(),o=this.mirrorTextNode.firstChild||this.mirrorTextNode.childNodes[0],s=document.createRange();s.setStart(o,e),s.setEnd(o,e+t);let n=s.getBoundingClientRect(),r=n.left-i,l=n.top-a;return{width:n.width,height:n.height,left:r,right:r+n.width,top:l,bottom:l+n.height,deviation:0}}}}destroy(){this.mirrorContainer.remove()}doMeasureText(e){let{element:t,display:i,index:a,text:o}=e;if(a<0||a>o.length-1)throw Error("char indexing(index: ".concat(a,")overflowed, allowed range:0 - ").concat(o.length-1));let{offsetLeft:s,offsetTop:n,offsetHeight:r,offsetWidth:l}=this.mirrorTextNode.querySelector("span:nth-child(".concat(a+1,")")),d=0;if("inline"===i){let e=this.mirrorTextNode.querySelector("span:nth-child(1)");e&&(d=e.offsetTop)}let c=n,h=s;return"\n"===o[a]&&a===o.length-1&&(c+=parseFloat(this.domMeasurement.getStyle(t,"line-height")),h=0),{left:h,right:h+l,top:c,bottom:c+r,width:l,height:r,deviation:d}}initMirrorTextarea(){let e=document.createElement("div");this.mirrorContainer=e,e.setAttribute("contenteditable","false"),e.style.position="absolute",e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",document.body.appendChild(e);let t=e.shadowRoot||e.attachShadow({mode:"open"});if(!this.mirrorTextNode){let e=document.createElement("div");e.className="mirror-text-container",t.appendChild(e),this.mirrorTextNode=e,this.mirrorTextNode.style.display="block"}}constructor(){if((0,a._)(this,"mirrorTextNode",void 0),(0,a._)(this,"domMeasurement",new o.L),(0,a._)(this,"mirrorContainer",void 0),!document)throw Error("TextareaMeasurement can only be run under DOM environment");this.initMirrorTextarea()}}},15065:function(e,t,i){"use strict";i.d(t,{v:function(){return n}});var a=i(66084),o=i(56607),s=i(92235);class n{async doSearch(e){let t={sites:[],question:e};if(o.o.isWeb)return t;let i=await this.searchGoogle(e);if(t.sites=i,0===t.sites.length){let i=await this.searchBing(e);t.sites=i}return t}async searchGoogle(e){let t=encodeURI(e),i=s.m.genId(),a=!1;setTimeout(()=>{a=!0,this.abort(i)},this.maxTimeOut);try{let e=await this.fetch("https://www.google.com/search?q=".concat(t,"&sourceid=chrome&ie=UTF-8"),{resolveType:"text",taskId:i});return this.parseGooglePage(e)}catch(e){var o;return null===(o=this.onError)||void 0===o||o.call(this,"google",a?"timeout":s.m.formatMonicaSdkError(e)),[]}}async searchBing(e){let t=encodeURI(e),i=s.m.genId(),a=!1;setTimeout(()=>{a=!0,this.abort(i)},this.maxTimeOut);try{let e=await this.fetch("https://www.bing.com/search?q=".concat(t),{resolveType:"text",taskId:i});return this.parseBingPage(e)}catch(e){var o;return null===(o=this.onError)||void 0===o||o.call(this,"google",a?"timeout":s.m.formatMonicaSdkError(e)),[]}}parseGooglePage(e){let t=[];return new DOMParser().parseFromString(e,"text/html").querySelectorAll("#search a").forEach(e=>{var i,a,o,s,n;let r=e.href,l=null==e?void 0:null===(a=e.querySelector("h3"))||void 0===a?void 0:null===(i=a.textContent)||void 0===i?void 0:i.trim(),d=null==e?void 0:null===(o=e.querySelector("img"))||void 0===o?void 0:o.src,c=null==e?void 0:null===(s=e.querySelector(".VuuXrf"))||void 0===s?void 0:s.textContent;if(r&&l&&c){let i=null===(n=e.parentElement)||void 0===n?void 0:n.parentElement,a=(null==i?void 0:i.textContent)||"",o=e=>{let i=e.parentElement;if(i){let e=i.textContent||"";if(null==e?void 0:e.startsWith(a)){let s=e.replace(a,"")||"";s.length>10?t.push({url:r,title:l,favicon:d,websiteName:this.filterWebsiteName(c),snippet:s}):o(i)}}};i&&o(i)}}),t}parseBingPage(e){let t=[],i=new DOMParser().parseFromString(e,"text/html").querySelector("#b_results");return null==i||i.childNodes.forEach(e=>{if(e instanceof HTMLElement){var i,a,o,s,n,r;let l=e.querySelector(".b_title")||e.querySelector("h2")||e.querySelector("h1"),d=null==l?void 0:null===(i=l.querySelector("a"))||void 0===i?void 0:i.href,c=null==l?void 0:null===(a=l.textContent)||void 0===a?void 0:a.trim();if(d&&c){let i=e.querySelector(".tilk"),a=(null==i?void 0:null===(o=i.querySelector(".tptt"))||void 0===o?void 0:o.textContent)||new URL(d).hostname||"",l=null==i?void 0:null===(n=i.querySelector('[data-class="rms_img"]'))||void 0===n?void 0:null===(s=n.attributes.getNamedItem("data-src"))||void 0===s?void 0:s.value,h=e.querySelector(".b_algoSlug")||e.querySelector(".b_caption")||e,g=(((null==h?void 0:null===(r=h.textContent)||void 0===r?void 0:r.length)||0)>0?h:e).textContent||"";t.push({url:d,title:c,favicon:l,websiteName:this.filterWebsiteName(a),snippet:g})}}}),t}filterWebsiteName(e){let t=new RegExp("(".concat(".com|.net|.org|.gov|.edu|.mil|.int|.io|.co|.xyz|.info|.biz|.mobi|.name|.pro|.aero|.coop|.jobs|.museum|.travel",")$"));return e.replace(t,"")}constructor(e,t,i){(0,a._)(this,"fetch",void 0),(0,a._)(this,"abort",void 0),(0,a._)(this,"onError",void 0),(0,a._)(this,"maxTimeOut",void 0),this.fetch=e,this.abort=t,this.onError=i,this.maxTimeOut=3e3}}},72796:function(e,t,i){"use strict";i.d(t,{d:function(){return g}});var a=i(66084),o=i(71576),s=i(90230),n=i(2439),r=i(46731),l=i(28901),d=i(71528),c=i(27243);let h=/\s+/gm;class g{static htmlToText(e){let t=p("<div/>");t.innerHTML=e;let i="";return A(t,e=>{i+=e.nodeValue}),i.trimStart().replace(h," ")}get range(){var e;return null===(e=this.selection)||void 0===e?void 0:e.getRangeAt(0)}init(){}getPageUrl(e){let t=window.location.href.split("#")[0];if(e){let i="";if(e.length>100){let t=e.slice(0,40),a=e.slice(-40);i="".concat(encodeURIComponent(t),",").concat(encodeURIComponent(a))}else i=encodeURIComponent(e);return"".concat(t,"#:~:text=").concat(i)}return t}drawMark(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;this.collectText(),this.getSelection();let a=this.extractTextAndHtml();if(a.error)return null;this.paintUnderline(a.text,a.nth,e,t);let o={type:"mark",title:document.title,url:this.getPageUrl(a.text),content:a.text,color:t,markId:e,baseUrl:window.location.href};return s.a.createFromEmbed({uid:e,embedData:o}).then(e=>{i(e.item.uid)}),{mark:{uid:e,url:this.getPageUrl(),content:a.html,nth:a.nth,color:t,comment:""},text:a.text,html:a.html}}updateMarkColor(e,t){document.querySelectorAll(".monica-mark-".concat(e)).forEach(e=>{e.style.backgroundColor=t})}deleteMark(e){document.querySelectorAll(".monica-mark-".concat(e)).forEach(e=>{e.parentElement&&(e.parentElement.insertBefore(e.firstChild,e),e.remove())}),document.querySelectorAll(".monica-mark-comment-".concat(e)).forEach(e=>{e.remove()})}getSelection(){this.selection=window.getSelection()}extractTextAndHtml(){let e={text:"",html:"",error:null,nth:0};if(!this.selectionContainsText)return e.error=Error("No text selected"),e;let t=this.range;return t?this.rangeIsMarkable(t)?(e.html=this.rangeToHtml(t),e.text=g.htmlToText(e.html),e.nth=this.findNthInBody(e.text,t.endContainer,t.endOffset)):e.error=Error("Range is not markable"):e.error=Error("No range found"),e}addWrapper(e,t,i){var a;if(e.nodeValue.replace(/\s/g,"").length<=0)return null;let o="".concat(g.colorMap[i],"72"),s=p('<span data-id="'.concat(t,'" class="monica-mark monica-mark-').concat(t,'" style="background-color: ').concat(o,'; cursor: pointer; "/>'));return null===(a=e.parentNode)||void 0===a||a.insertBefore(s,e),s.append(e),s}paintUnderline(e,t,i,a){let o=this.seekText(e,t);if(!o)return null;let{startNode:s,endNode:n,startOffset:r,endOffset:l,commonAncestor:d}=o,c=null;if(s===n){let e=s.splitText(r).splitText(l-r).previousSibling;if(!e)return null;c=this.addWrapper(e,i,a)}else{let e=s.splitText(r),t=n.splitText(l).previousSibling,o=!1;A(d,s=>(o||s!==e||(o=!0),!o||((s.nodeValue||"").replace(h," ").length>0&&(c=this.addWrapper(s,i,a)),s!==t||(o=!1,!1))))}return c}selectionContainsText(){var e,t;return null!==(t=null===(e=this.selection)||void 0===e?void 0:e.toString().length)&&void 0!==t&&t}rangeIsMarkable(e){return!e.collapsed}rangeToHtml(e){let t=p("<div/>");return t.append(e.cloneContents()),t.querySelectorAll("script").forEach(e=>e.remove()),t.innerHTML}findNthInBody(e,t,i){let a="";return A(document.body,e=>{let o=e.nodeValue||"";if(e===t)return o=o.slice(0,i),a+=o,!1;a+=o},t),a=a.replace(h," "),this.findIndexes(e,a).length}findIndexes(e,t){let i=[],a=t.indexOf(e);for(;-1!==a;)i.push(a),a=t.indexOf(e,a+1);return i}collectText(){this.allText="",this.allTextMeta=[];let e=!1;A(document.body,t=>{if(t.nodeType===Node.TEXT_NODE){let i=(t.nodeValue||"").replace(h," ");i.length>0&&(/^\s$/m.test(i)?e||(this.allText+=" ",e=!0):(e&&(i=i.trimStart()),this.allTextMeta.push({offset:this.allText.length,textNode:t,length:i.length}),this.allText+=i,e=/\s$/m.test(i)))}})}seekText(e,t){let i=this.findIndexes(e,this.allText),a=-1;if(i.length>=t?a=i[t-1]:i.length>0&&(a=i[i.length-1]),-1===a)return null;let o=a+e.length-1,s=this.allTextMeta.length,n=null,r=null,l=-1,d=-1,c=null,h=null;for(let t=0;t<s;t++){let i=this.allTextMeta[t];if((a===i.offset||a>i.offset&&(t===s-1||a<this.allTextMeta[t+1].offset))&&(n=i.textNode,c=i),o===i.offset||o>i.offset&&(t===s-1||o<this.allTextMeta[t+1].offset)){if(r=i.textNode,h=i,!c)throw Error("startTextMeta is undefined");let t=this.calcOffset(e,a,c,o,h);l=t.startOffset,d=t.endOffset;break}}if(!n||!r)return null;let g=this.findCommonAncestor(n,r);return g?{startNode:n,endNode:r,startIndex:a,endIndex:o,startOffset:l,endOffset:d,text:e,commonAncestor:g}:null}calcOffset(e,t,i,a,o){let s={startOffset:0,endOffset:0},n=i.textNode.nodeValue||"";if(i===o){for(t-=i.offset;t<n.length;t++)if(0===n.slice(t).replace(h," ").indexOf(e)){s.startOffset=t;break}if(void 0!==s.startOffset){for(t=s.startOffset+e.length;t<=n.length;t++)if(n.slice(s.startOffset,t).replace(h," ").indexOf(e)>-1){s.endOffset=t;break}}}else{let r=e.slice(0,i.offset+i.length-t);for(t-=i.offset;t<=n.length-r.length;t++)if(0===n.slice(t).replace(h," ").indexOf(r)){s.startOffset=t;break}if(void 0!==s.startOffset){for(n=o.textNode.nodeValue||"",r=e.slice(e.length-(a-o.offset+1)),t=a-o.offset+1;t<=n.length;t++)if(n.slice(0,t).replace(h," ").indexOf(r)>-1){s.endOffset=t;break}}}return s}findCommonAncestor(e,t){let i=e;for(;i;){if(i.contains(t))return i;i=i.parentNode}return null}renderMark(e){let t;if(!e.content||void 0===e.nth||!e.uid||void 0===e.color)return;let i=document.querySelectorAll(".monica-mark-".concat(e.uid));if(!(t=0===i.length?this.paintUnderline(g.htmlToText(e.content),e.nth,e.uid,e.color):i[i.length-1]))return;let a="monica-mark-comment-".concat(e.uid),s=document.querySelector(".".concat(a));if(e.comment){var d;if(s)return;let i=(0,o.jsx)("span",{style:{width:16,height:16,display:"inline-flex",justifyContent:"center",alignItems:"center",position:"relative",top:-2,cursor:"pointer"},onClick:i=>{n.j.currentMark=e,n.j.currentSpan=t,n.j.handleClickComment(i.nativeEvent)},children:(0,o.jsx)(r.J,{name:"reversedMessage",color:"var(--theme-icon-secondary)",size:14,style:{}})}),h=document.createElement("span");h.classList.add("monica-mark-comment"),h.classList.add(a),h.style.position="relative",h.addEventListener("mousemove",l.x.stopPropagation),h.addEventListener("mouseover",l.x.stopPropagation),null===(d=t.parentNode)||void 0===d||d.insertBefore(h,t.nextSibling),(0,c.createRoot)(h).render(i)}else null==s||s.remove()}constructor(){(0,a._)(this,"allText",""),(0,a._)(this,"allTextMeta",[]),(0,a._)(this,"selection",null),(0,a._)(this,"listenerManager",new d.M),(0,a._)(this,"onClickMark",void 0)}}function p(e){let t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}function A(e,t,i){if(e.nodeType===Node.TEXT_NODE&&(!1===t(e)||i&&e===i))return!1;if(e.nodeType===Node.ELEMENT_NODE&&!g.skipList.includes(e.nodeName.toLowerCase()))for(let a=0;a<e.childNodes.length;a++){let o=e.childNodes[a];if(!1===A(o,t)||i&&o===i)return!1}return!0}(0,a._)(g,"skipList","applet,area,base,basefont,bdo,button,frame,frameset,iframe,head,hr,img,input,link,map,meta,noframes,noscript,optgroup,option,param,script,select,style,textarea,title".split(",")),(0,a._)(g,"colorMap",{1:"#FAFF0A",2:"#7CFF58",3:"#57F5FF",4:"#FF7CF0",5:"#B066FF"}),(0,a._)(g,"defaultColor",g.colorMap[1]),(0,a._)(g,"getColorByNumber",e=>void 0!==e?g.colorMap[e]:g.defaultColor),(0,a._)(g,"getNumberByColor",e=>{var t,i;return parseInt(null!==(i=null===(t=Object.keys(g.colorMap).find(t=>g.colorMap[parseInt(t)]===e))||void 0===t?void 0:t[0])&&void 0!==i?i:"1")})},58351:function(e,t,i){"use strict";i.d(t,{y:function(){return l}});var a=i(92235),o=i(87393),s=i(47701),n=i(38172);class r{allowPreview(e){return["tsx","html","json","mermaid","plantuml","svg","tsx/react","code.tsx","markdown"].includes(e)}chatArtifactData2ServerArtifactData(e){let{artifact:t,conversationId:i,replyId:a}=e,{content:o,id:s,name:n,type:r}=t;return{artifactId:s,artifactName:n,artifactType:r,chatItemId:a,conversationId:i,isFavorite:!1,isPublished:!1,content:o,createdAt:new Date().toISOString()}}serverArtifactData2ChatArtifactData(e){return{id:e.artifactId,name:e.artifactName,type:e.artifactType,content:e.content||""}}shouldRenderRawContent(e){return"mermaid"===e||"plantuml"===e||"svg"===e}async downloadArtifact(e,t){let{content:i,name:r,type:l}=e,d="",c=l;switch(l){case"html":d="text/html";break;case"json":d="application/json";break;case"markdown":d="text/markdown",c="md";break;case"svg":case"mermaid":d="image/svg+xml",c="svg";break;case"tsx":d="text/plain",c="tsx";break;case"plantuml":d="image/png",c="png"}let h="".concat(r,".").concat(c),g=a.m.createFile(i,h,d);if("mermaid"===l){let{svg:e}=await t.genMermaidSvg(i,{isDark:o.C.isDark});g=a.m.createFile(e,h,d)}else if("plantuml"===l){let{url:e}=t.genPlantuml(i,{isDark:o.C.isDark}),a=await fetch(e).then(e=>e.blob());g=new File([a],h,{type:d})}let p=URL.createObjectURL(g);a.m.downloadFile(p,h),URL.revokeObjectURL(p),n.W.createUserBehaviorEvent({eventName:s.R.UserEvent.DOWNLOAD})}}let l=new r},919:function(e,t,i){"use strict";i.d(t,{Qp:function(){return y}});var a=i(92235),o=i(51018),s=i(939);let n=function(e,t,i,a,o){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=!1;if(i&&(l=i(e,t,o,s,r)),!l&&e.children&&e.children.length>0){let t=s+1;e.children.forEach((o,s)=>{n(o,e,i,a,!1,t,s)})}a&&a(e,t,o,s,r)},r=e=>{let t=e=>{e.childNodes.forEach(e=>{1===e.nodeType&&(e.classList.contains("ql-formula")?e.parentNode.removeChild(e):t(e))})};t(e)},l=null,d=e=>{l||(l=document.createElement("div")),l.innerHTML=e;let t=l.childNodes,i="";for(let e=0;e<t.length;e++){let a=t[e];1===a.nodeType?(r(a),"p"===a.tagName.toLowerCase()?i+="".concat(a.textContent,"\n"):i+=a.textContent):3===a.nodeType&&(i+=a.nodeValue)}return i.replace(/\n$/,"")},c=e=>e.richText?d(e.text):e.text,h=e=>{let t=(e.children||[]).find(e=>"text"===e.type);return(t=t||e.children[0])?void 0!==t.value?t.value:h(t):""},g=e=>Array(e).fill("#").join(""),p=e=>"".concat(Array(e-6).fill("   ").join(""),"*"),A=e=>{let t="";return n(e,null,(e,i,a,o)=>{let s=o+1;s<=6?t+=g(s):t+=p(s),t+=" ".concat(c(e.data));let n=e.data.generalization;if(Array.isArray(n))t+=n.map(e=>" [".concat(c(e),"]"));else if(n&&n.text){let e=c(n);t+=" [".concat(e,"]")}t+="\n\n",e.data.note&&(t+="".concat(e.data.note,"\n\n"))},()=>{},!0),t},m=e=>{let t=[],i=(e,t)=>{for(let a=0;a<e.length;a++){let o=e[a],s={data:{text:h(o)}};if(s.children=[],t.push(s),o.children.length>1)for(let e=1;e<o.children.length;e++){let t=o.children[e];"list"===t.type&&i(t.children,s.children)}}};return i(e.children,t),t},u=e=>{let t=(0,s.V)(e),i={children:[]},a=[i.children],o=i.children,n=[-1],r=-1;for(let e=0;e<t.children.length;e++){let i=t.children[e];if("heading"===i.type){if(!i.children[0])continue;let e={data:{text:h(i)}};if(e.children=[],i.depth>r)o.push(e),a.push(e.children),o=e.children,n.push(i.depth),r=i.depth;else if(i.depth===r)a.pop(),o=a[a.length-1],n.pop(),r=n[n.length-1],o.push(e),a.push(e.children),o=e.children,n.push(i.depth),r=i.depth;else for(;n.length;)if(a.pop(),o=a[a.length-1],n.pop(),(r=n[n.length-1])<i.depth){o.push(e),a.push(e.children),o=e.children,n.push(i.depth),r=i.depth;break}}else"list"===i.type&&o.push(...m(i))}return i.children[0]};class f{markdownTo(e){return u(e)}toMarkdown(e){return A(e)}genNodeId(e,t){let i=0,a=(e,o)=>(e.data.uid||(e.data.uid="".concat(t,"_").concat(i,"_").concat(o)),e.children&&(i+=1,e.children=e.children.map((e,t)=>a(e,t))),e);return a(e,0)}getNodeByUid(e,t){if(e.data.uid===t)return e;if(e.children)for(let i of e.children){let e=this.getNodeByUid(i,t);if(e)return e}return null}getNodeTextChains(e){let t=[],i=e;for(;i;){let e=i.nodeData.data.text;e&&t.unshift(e),i=i.parent}return t}mergeNodes(e,t,i){if(!function e(a){if(a.data.uid===i)return a.children=[],function e(t,i){if(t.children||(t.children=[]),i.children)for(let a of i.children){let i=t.children.findIndex(e=>e.data.uid===a.data.uid);if(-1!==i){let o=t.children[i];o.data.text!==a.data.text?t.children[i]=a:e(o,a)}else t.children.push(a)}}(a,t),!0;if(a.children){for(let t of a.children)if(e(t))return!0}return!1}(e))throw Error("Target node with UID ".concat(i," not found"));return e}createMindMapAgentStatus(e){return{text:JSON.stringify({md:this.toMarkdown(e),original_text:""}),type:"mind_map",uid:a.m.genShortId()}}getMidMapDataFromReply(e){let t=(e.agentStatus||[]).find(e=>"mind_map"===e.type);return this.getMidMapDataFromAgentStatus(t)}getMidMapDataFromAgentStatus(e){return e?this.parseMidMapNodeFromText(e.text):null}parseMidMapNodeFromText(e){try{let{md:t}=o.c.parsePartialJson(e);if(t)return this.markdownTo(t);return null}catch(e){return null}}continueInChatWithMindMap(e,t){return(e.data.agentStatus||[]).push(this.createMindMapAgentStatus(t)),e}isMindMapReply(e){return!!(e.data.agentStatus||[]).find(e=>"mind_map"===e.type)}}let y=new f},82715:function(e,t,i){"use strict";i.d(t,{L:function(){return n}});var a=i(92235),o=i(59133);class s{async translatePage(e,t,i,s){let n=this.getNeedTranslateParagraphs(e).map(e=>{let{id:a,sourceText:o}=e;return{text:o,from:t,to:i,id:a,htmlStr:"",detectLang:t}});return await o.Q.priorityFreeTranslate({paragraphs:n,taskUid:a.m.genId(),originTitle:document.title,originUrl:location.href,sourceLang:t,toLang:i},t=>{(!s||s())&&t.forEach(t=>{let{result:i,id:a,error:o}=t,s=e.paragraphs.find(e=>{let{id:t}=e;return t===a});s&&!o&&(s.translateResult=i)})}),{paragraphs:n}}getNeedTranslateParagraphs(e){let t=[];return e.paragraphs.filter(e=>!e.translateResult).forEach(e=>{t.push(e)}),t}}let n=new s},92849:function(e,t,i){"use strict";i.d(t,{translateHelper:function(){return z}});var a,o,s=i(66084),n=i(52921),r=i(71576),l=i(34491),d=i(90180),c=i(33381),h=i(1159),g=i(92020),p=i(59133),A=i(5431),m=i(76469),u=i(31640),f=i(88882),y=i(56607),v=i(92235),w=i(28901),C=i(77233),b=i(71749),S=i(70151),I=i(1340),_=i(73047),T=i(27243),k=i(69761),E=i(44795),M=i(95782),x=i(46731),B=i(18245),D=i(11502);(a=o||(o={})).CUSTOM_ATTR_PREFIX="monica-translate",a.CUSTOM_ATTR={TRANSLATABLE_NODE_PARENT_EL:"".concat(a.CUSTOM_ATTR_PREFIX,"-translatable-node-parent-el"),EXCLUDE_EL:"".concat(a.CUSTOM_ATTR_PREFIX,"-exclude-el"),INJECT_STYLE_EL:"".concat(a.CUSTOM_ATTR_PREFIX,"-inject-style-el"),NO_TRANSLATE_EL:"".concat(a.CUSTOM_ATTR_PREFIX,"-no-translate-el")},a.CUSTOM_ATTR_VALUE="m",a.TRANSLATABLE_NODE_WRAPPER_TAG="".concat(a.CUSTOM_ATTR_PREFIX,"-translatable"),a.TRANSLATABLE_ORIGIN_TEXT_NODE_WRAPPER_TAG="".concat(a.CUSTOM_ATTR_PREFIX,"-origin-text"),a.TRANSLATE_EL_TAG="".concat(a.CUSTOM_ATTR_PREFIX,"-translate"),a.TRANSLATE_EL_WRAPPER_TAG="".concat(a.CUSTOM_ATTR_PREFIX,"-translate-wrapper"),a.SPACE_EL_TAG="".concat(a.CUSTOM_ATTR_PREFIX,"-space"),a.PLACEHOLDER_TAG_FOR_WRAPPER="mw",a.PLACEHOLDER_TAG_FOR_TRANSLATABLE_EL="mt",a.PLACEHOLDER_TAG_FOR_UNTRANSLATABLE_EL="mu",a.LOADING_EL_CLASS="".concat(a.CUSTOM_ATTR_PREFIX,"-translate-loading-spinner"),a.DASHED_THEME_CLASS="".concat(a.CUSTOM_ATTR_PREFIX,"-translate-theme-dashed"),a.WEAK_THEME_CLASS="".concat(a.CUSTOM_ATTR_PREFIX,"-translate-theme-weak"),a.HIDE_THEME_CLASS="".concat(a.CUSTOM_ATTR_PREFIX,"-translate-hide"),a.TRANSLATABLE_FREE_API_ERROR="".concat(a.CUSTOM_ATTR_PREFIX,"-free-api-error"),a.TRANSLATABLE_CREDIT_ERROR="".concat(a.CUSTOM_ATTR_PREFIX,"-credit-error"),a.LINE_BREAK_PLACEHOLDER="18-10249",a.TAG_PLACEHOLDER="18-10248";class L extends l.PN{get S(){return f.S.Global.controllers.translateHelper}onViewCreate(){k.f.webTranslationErrorReported||(k.f.webTranslationErrorReported=!0,this.createUserBehaviorEvent("show"))}onViewDestroy(){}getClassName(e){return"".concat(o.CUSTOM_ATTR_PREFIX,"-").concat(e)}handleBuyNow(){B.K.handleCreditsNotEnough({module:"credits",source:this.source}),this.createUserBehaviorEvent("click","extract_pack")}handleRetry(){var e,t;null===(e=(t=this.props).onRetry)||void 0===e||e.call(t),this.createUserBehaviorEvent("click","retry")}handleSwitch(){B.K.handleCreditsNotEnough({featureName:"aiTranslate",module:"credits",source:this.source}),this.createUserBehaviorEvent("click","translate_service")}createUserBehaviorEvent(e,t){D.M.createUserBehaviorEvent({eventName:"translate_page_".concat(e),extData:{page:"web_translate_error",button:t}})}formatEngineName(e){return"openai"===e?"OpenAI":"deepl"===e?"DeepL":v.m.capitalize(null!=e?e:"openAI")}constructor(...e){super(...e),(0,s._)(this,"props",void 0),(0,s._)(this,"someState",!0),(0,s._)(this,"source","web_translate_error_switch_service")}}(0,n.gn)([l.SB],L.prototype,"someState",void 0),(0,n.gn)([l.Fl],L.prototype,"S",null);let R="\n.".concat(o.CUSTOM_ATTR_PREFIX,"-error-notice {\n  font-size: 13px;\n  display: inline-flex;\n  gap: 4px;\n  line-height: 20px !important;\n  white-space: pre-wrap !important;\n  color: #EA3639 !important;\n  flex-wrap: wrap;\n  align-items: center;\n  cursor: default;\n}\n\n.").concat(o.CUSTOM_ATTR_PREFIX,"-warning-icon {\n\n}\n\n.").concat(o.CUSTOM_ATTR_PREFIX,"-btn-wrapper {\n  display: inline-flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.").concat(o.CUSTOM_ATTR_PREFIX,"-btn {\n  color: #1E6FFF !important;\n  display: inline-flex;\n  align-items: center;\n  cursor: pointer;\n}\n.").concat(o.CUSTOM_ATTR_PREFIX,"-btn:hover {\n  opacity: 0.7;\n}\n\n\n\n\n"),U=l._Y.createComponent("ErrorNotice",L,e=>{let{errorType:t,apiType:i,errorMsg:a}=e.props;return(0,r.jsxs)("span",{className:e.getClassName("error-notice"),onClick:e=>{e.stopPropagation(),e.nativeEvent.stopPropagation()},onMouseDown:e=>{e.stopPropagation(),e.nativeEvent.stopPropagation()},children:[(0,r.jsx)("style",{children:R}),(0,r.jsx)(x.J,{className:e.getClassName("warning-icon"),name:"warning",size:16,color:"#EA3639"}),(()=>{if("freeApiError"===t)return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:(0,r.jsx)(M.Z,{S:(0,f.x)(e.S.freeApiError,{api:"google"===i?e.S.googleError:e.S.bingError}),components:{span:t=>(0,r.jsx)("span",{className:e.getClassName("error-type"),children:t})}})}),(0,r.jsxs)("span",{className:e.getClassName("btn-wrapper"),children:[(0,r.jsxs)("span",{onClick:()=>{e.handleSwitch()},className:e.getClassName("btn"),children:[(0,r.jsx)(x.J,{name:"a181",size:14,color:"#1E6FFF"}),e.S.switchNow]}),(0,r.jsxs)("span",{onClick:()=>{e.handleRetry()},className:e.getClassName("btn"),children:[(0,r.jsx)(x.J,{name:"refresh",size:14,color:"#1E6FFF"}),e.S.retry]})]})]});if("aiApiError"===t){let t=null==a?void 0:a.includes("network");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:(0,r.jsx)(M.Z,{S:(0,f.x)(a&&!t?a:e.S.aiApiError,{engine:e.formatEngineName(i)}),components:{span:t=>(0,r.jsx)("span",{className:e.getClassName("error-type"),children:t})}})}),(0,r.jsx)("span",{className:e.getClassName("btn-wrapper"),children:(0,r.jsxs)("span",{onClick:()=>{e.handleRetry()},className:e.getClassName("btn"),children:[(0,r.jsx)(x.J,{name:"refresh",size:14,color:"#1E6FFF"}),e.S.retry]})})]})}return"creditError"===t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:(0,r.jsx)(M.Z,{S:(0,f.x)(e.S.creditError,{reason:e.S.credit}),components:{span:t=>(0,r.jsx)("span",{className:e.getClassName("error-type"),children:t})}})}),(0,r.jsxs)("span",{onClick:()=>{e.handleBuyNow()},className:e.getClassName("btn"),children:[(0,r.jsx)(x.J,{name:"a181",size:14,color:"#1E6FFF"}),e.S.buyNow]})]}):null})()]})}),P=(e,t)=>{let i=[];function a(e){[...document.querySelectorAll(e)].reduce((e,i)=>{let a=getComputedStyle(i)[t];return a&&e.push({value:a,el:i}),e},[]).forEach(e=>{let{value:a,el:o}=e;o.style[t]="unset",i.push(()=>{o.style[t]=a})})}return"string"==typeof e?a(e):e.forEach(e=>{a(e)}),()=>{i.forEach(e=>{e()})}},F={area:"all",mode:"dynamic",containerSelectors:[],blockUrls:["googleads.g.doubleclick.net","s1.hdslb.com","oapi.dingtalk.com","login.dingtalk.com","imasdk.googleapis.com","acdn.adnxs.com","pos.baidu.com","js-sec.indexww.com","g.alicdn.com","ads.pubmatic.com","challenges.cloudflare.com","accounts.google.com","images-na.ssl-images-amazon.com","tpc.googlesyndication.com","js.stripe.com","acdn.adnxs-simple.com","s.union.360.cn","s.amazon-adsystem.com","www.recaptcha.net","s7.addthis.com","z.moatads.com","https://www.marketwatch.com/static_html/daa-min.html","tr.snapchat.com","ct.pinterest.com","*.moatads.com","secure-us.imrworldwide.com","static.noeyeon.click","widgets.outbrain.com","www.dianomi.com/smartads.epl","secure-assets.rubiconproject.com","eus.rubiconproject.com","eus.rubiconproject.com","i.liadm.com","eb2.3lift.com"],excludeTags:["TITLE","SCRIPT","STYLE","TEXTAREA","SVG","svg","G","TEXT","NOSCRIPT","INPUT","BASE","SELECT","OPTION","IMG","SUB","SUP","HR","PRE","CODE","KBD","WBR","TT","RT","RP","META","MATH","TTS-SENTENCE","AIO-CODE"],excludeSelectors:[],specialRules:[{matches:["*://*/*.txt","file://*/*.txt"],selectors:["body"],excludeTags:["TITLE","SCRIPT","STYLE","TEXTAREA","SVG","svg","G","TEXT","NOSCRIPT","INPUT","BUTTON","BASE","SELECT","OPTION","IMG","SUB","SUP","HR","CODE","KBD","WBR","TT","RT","RP","META","ASIDE","FOOTER","MATH","TTS-SENTENCE"]},{matches:["mail.jabber.org","antirez.com"],excludeTags:["TITLE","SCRIPT","STYLE","TEXTAREA","SVG","svg","INPUT","LABEL","IMG","SUB","SUP","BR","CODE","KBD","WBR","TT"]},{matches:"*.wikipedia.org",excludeSelectors:[".mw-editsection",".mw-cite-backlink","#mw-panel-toc"]},{matches:["x.com","twitter.com","mobile.twitter.com","tweetdeck.twitter.com","https://platform.twitter.com/embed*"],selectors:['[data-testid="tweetText"]',".tweet-text",".js-quoted-tweet-text","[data-testid='card.layoutSmall.detail'] > div:nth-child(2)","[data-testid='developerBuiltCardContainer'] > div:nth-child(2)","[data-testid='card.layoutLarge.detail'] > div:nth-child(2)","[data-testid='cellInnerDiv'] div[data-testid='UserCell'] > div> div:nth-child(2)","[data-testid='UserDescription']","[data-testid='HoverCard'] div[dir=auto]"],excludeSelectors:[],attachEffect:e=>{let t=P("[data-testid=tweetText]","webkitLineClamp");return()=>{e&&e(),t()}}},{matches:["stackoverflow.com","*.stackexchange.com","superuser.com","askubuntu.com","serverfault.com"],excludeSelectors:["a.comment-user","span.comment-date","div.s-prose.js-post-body + div",".bottom-notice","div[data-campaign-name=stk]"]},{matches:"developer.apple.com/documentation/*",selectors:[".container","h3.title","div.content"]},{matches:"news.ycombinator.com",selectors:[".titleline > a",".comment > .commtext",".toptext","a.hn-item-title",".hn-comment-text",".hn-story-title"],excludeSelectors:[".reply"]},{matches:["*.quora.com","quora.com"],additionalSelectors:[".puppeteer_test_question_title","p.q-text"]},{matches:["old.reddit.com/*/.compact","old.reddit.com/.compact","www.reddit.com/*/.compact","www.reddit.com/.compact"],selectors:[".title > a",".usertext-body"]},{matches:"old.reddit.com",selectors:["p.title > a","[role=main] .md-container"]},{matches:["https://www.reddit.com/r/*/comments/*/*","https://www.reddit.com/","https://www.reddit.com/hot/","https://www.reddit.com/new/","https://www.reddit.com/top/","https://www.reddit.com/search/"],excludeMatches:["https://www.reddit.com/r/*/wiki/*"],selectors:["h1",".PostHeader__post-title-line","[data-click-id=body] h3","[data-click-id=background] h3","[data-testid=comment]","[data-adclicklocation='title']","[data-adclicklocation=media]",".PostContent",".post-content",".Comment__body","faceplate-batch .md",".RichTextJSON-root","div[slot=title]","div[slot=text-body]"],attachEffect(e){let t=P([".feed-card-text-preview.text-ellipsis","[data-testid=post-title-text]","[data-testid=post-title]"],"webkitLineClamp");return()=>{e&&e(),t()}},extraStyleAttributes:{visibility:"visible"}},{matches:"www.reddit.com",selectors:["h1",".PostHeader__post-title-line","[data-click-id=body] h3","[data-click-id=background] h3","[data-testid=comment]","[data-adclicklocation='title']","[data-adclicklocation=media]",".PostContent",".post-content",".Comment__body","faceplate-batch .md","div[slot=title]","div[slot=text-body]"],excludeMatches:["https://www.reddit.com/r/*/wiki/*","https://www.reddit.com/settings/*"],attachEffect(e){let t=P(".feed-card-text-preview.text-ellipsis","webkitLineClamp");return()=>{e&&e(),t()}},extraStyleAttributes:{visibility:"visible"}},{matches:"www.reuters.com/",excludeSelectors:["header"]},{matches:"github.com",excludeMatches:["https://github.com/*/*/settings","https://github.com/settings/*","https://github.com/sponsors/*"],selectors:[".markdown-title",".markdown-body",".Layout-sidebar p","div > span.search-match","li.repo-list-item p","#responsive-meta-container p","article p","div.repo-description p","[itemprop=description]"],excludeSelectors:[".css-truncate","[data-test-selector='commit-tease-commit-message']","[data-test-selector='create-branch.developmentForm']","div.js-details-container.Details","div.Box-header.position-relative","div.blob-wrapper-embedded","div.Box.Box--condensed.my-2","div.jp-CodeCell",'[aria-label="Account"] .markdown-title',".sr-only"]},{matches:"notebooks.githubusercontent.com",excludeSelectors:["div.jp-CodeCell"]},{matches:"www.facebook.com",selectors:["div[dir=auto][style]","div[dir=auto][class]","span[lang]"],excludeSelectors:["[role=button]"]},{matches:"m.youtube.com",selectors:[".comment-text",".media-item-headline",".slim-video-information-title",".caption-window",".caption-visual-line"]},{matches:"www.youtube.com",selectors:["yt-formatted-string[slot=content].ytd-comment-renderer","yt-formatted-string.ytd-video-renderer","h1 > yt-formatted-string.ytd-watch-metadata","yt-formatted-string#video-title","span#video-title","a#video-title","yt-formatted-string.ytd-transcript-segment-renderer","#description-inline-expander > yt-attributed-string > span","ytd-notification-renderer .message",".caption-window",".caption-visual-line"],excludeSelectors:["[class^='lln-']"],attachEffect:e=>{let t=["#video-title.ytd-rich-grid-media","#video-title.ytd-video-renderer","#video-title.ytd-reel-item-renderer",".yt-lockup-metadata-view-model-wiz__title","#description-text.ytd-video-renderer","#body-text.ytd-display-ad-renderer","#video-title",".title-text.ytd-display-ad-renderer"],i=P(t,"webkitLineClamp"),a=P(t,"maxHeight");return()=>{e&&e(),i(),a()}}},{matches:"https://www.instagram.com/*",selectors:["h1"]},{matches:"1paragraph.app",selectors:["#book"]},{matches:"https://poeditor.com/projects/*",selectors:[".comment-body",".reference_language .source-string"]},{matches:["*.substack.com","newsletter.rootsofprogress.org"],selectors:[".post-preview-title",".post-preview-description",".post",".comment-body"],excludeSelectors:[".captioned-button-wrap",".subscription-widget-wrap",".tweet-header",".tweet-link-bottom",".expanded-link",".meta-subheader"]},{matches:["seekingalpha.com/article/*","seekingalpha.com/news/*"],selectors:["[data-test-id=card-container]","[data-test-id=comments-section]"],excludeSelectors:["[data-test-id=post-page-meta]","header > div:first-child"]},{matches:"hn.algolia.com",selectors:[".Story_title > a:first-child",".Story_comment > span"]},{matches:"read.readwise.io",selectors:["div[class^='_titleRow_']","div[class^='_description_']","#document-text-content"]},{matches:["www.inoreader.com","*.inoreader.com"],selectors:[".article_header_title",".article_title_link",".article_content",".article_magazine_title_link"]},{matches:"*.ideas.aha.io",excludeSelectors:[".comment-header",".vote-status",".idea-meta",".filters-title",".ideas-showing-count",".my-ideas-filters-wrapper",".statuses-filters-wrapper",".categories-filters-wrapper","[class^='attachment']","span[class^='attachment-name']"]},{matches:["scholar.google.com","scholar.google.com.hk"],selectors:["h3 a[data-clk]","div.gs_rs","td a.gsc_a_at","td div.gs_gray:last-of-type","div.gsc_oci_value"]},{matches:"mail.google.com",selectors:["h2[data-thread-perm-id]","span[data-thread-id]","div[data-message-id] div[class='']"]},{matches:["docs.google.com/document/d/*/edit"],translateFallback:()=>{let e=v.m.setUrlParams({monicaAutoTranslate:"1"},location.href.replace("/edit","/mobilebasic"));window.open(e,"_blank")},attachEffect(e){let t=P(".navigation-item","height");return()=>{e&&e(),t()}}},{matches:["docs.google.com"],attachEffect(e){let t=P(".navigation-item","height");return()=>{e&&e(),t()}}},{matches:"outlook.live.com",excludeSelectors:[".jHAG3.XG5Jd",".OZZZK",".lDdSm"],selectors:["[role=region]"]},{matches:"www.producthunt.com",excludeMatches:"https://www.producthunt.com/stories/*",selectors:["h2","div[class^='styles_htmlText__']","[class^='styles_tagline']","a[href^='/discussions/'].fontWeight-600","button[class^='styles_textButton'] > div > span","h5 + p"],excludeTags:["TITLE","SCRIPT","STYLE","TEXTAREA","SVG","svg","INPUT","LABEL","IMG","SUB","SUP","BR","CODE","KBD","WBR","TT"]},{matches:"*.gitbook.io",additionalSelectors:["main"]},{matches:"arxiv.org",additionalSelectors:["h1","blockquote.abstract"],excludeSelectors:[".desktop_header"]},{matches:"https://discord.com/channels/*",selectors:["li[id^=chat-messages] div[id^=message-content]","h3[data-text-variant='heading-lg/semibold']","section[aria-label='Search Results'] div[id^=message-content]"],excludeSelectors:["#channels","div[class^='repliedTextContent']","div[class^='repliedTextPreview']","div[class^='messageAttachment']","div[class^='repliedMessage']","div[class^='reactionTooltip']","div[class*='isSystemMessage']","div[class^='avatarWrapper']","div[class^='container'] [class^='topLine']","div[class^='container'] [class^='bottomLine']","div[class^='container'] [class^='children'] button[class^='component']","div[class^='userPopoutOverlayBackground'] [class^='userTagNoNickname']","div[class^='userPopoutOverlayBackgound'] [class^='userTagNoNickname']","span[class^='botTag']","h3[class^='header']","h2[class^='forumPostTitle']","[class^='title'][aria-label='Channel header']","div[class^='unreadPill']","div[class^='sectionHeader']","article[class^=embedWrapper] [class^=anchor]","article[class^=embedWrapper] [class^=embedProvider]","article[class^=embedWrapper] [class^=embedFooter]","[data-list-item-id^='members'] [class^='username']","[data-list-item-id^='forum-channel-list'] div[class^='tagsContainer']","li[class^='containerDefault'] div[class^='channelInfo']","li[class^='card'] div[class^='tags']","li[class^='card'] div[class^='footer']"]},{matches:"web.telegram.org/z/*",selectors:[".text-content",".message",".reply-markup-button-text",".bot-commands-list-element-description"]},{matches:["web.telegram.org/k/*","web.telegram.org/k/"],selectors:[".message",".reply-markup-button-text",".bot-commands-list-element-description"]},{matches:"gist.github.com",selectors:[".markdown-body",".readme"]},{matches:"lobste.rs",excludeMatches:["https://lobste.rs/about","https://lobste.rs/chat"],selectors:[".u-repost-of",".comment_text"]},{matches:"*.slack.com",selectors:[".p-rich_text_block"]},{matches:"1paragraph.app",additionalSelectors:["#book"]},{matches:"www.artstation.com/artwork/*",selectors:[".project-description","div.project-comment-text"]},{matches:"www.artstation.com/learning/courses/*",additionalSelectors:["footer.learning-course-description.ng-star-inserted > span"],excludeSelectors:[".learning-card-meta"]},{matches:["https://www.artstation.com/blogs","https://www.artstation.com/blogs/*"],additionalSelectors:[".comment-item-body"],excludeSelectors:["blog-card-thumbnail","blog-card-header",".blog-card-author",".blog-card-meta",".blog-view-header",".blog-grid-title",".post-meta-header"]},{matches:"www.figma.com/community/*",excludeSelectors:["div[class*='metadataRight']","div[class*='commentMetaAndOptions']"]},{matches:"www.google.*/search*",excludeSelectors:["a h3 + div","div#sfooter","a[role=presentation] > div > div:first-child",".b5ZQcf",".CEMjEf","#oFNiHe","#result-stats"],attachEffect(e){let t=P(".VwiC3b.yXK7lf.lVm3ye.r025kc.hJNv6b.Hdw6tb","webkitLineClamp");return()=>{e&&e(),t()}}},{matches:"lowendtalk.com",selectors:["[role=heading]","h1",".userContent"]},{matches:"www.linkedin.com/jobs/*",selectors:["#job-details > span"]},{matches:"www.linkedin.com",additionalSelectors:["span.break-words > span > span[dir=ltr]"]},{matches:"www.indiehackers.com",selectors:[".content","h1",".feed-item__title-link"]},{matches:"libreddit.de",selectors:["h2.post_title",".comment_body > .md"]},{matches:["*.notion.site/*"],attachEffect(e){let t=document.querySelectorAll("[data-content-editable-root=true]"),i=[];return t.forEach(e=>{e.removeAttribute("data-content-editable-root"),i.push(()=>{e.setAttribute("data-content-editable-root","true")})}),()=>{e&&e(),i.forEach(e=>{e()})}},extraStyleAttributes:{visibility:"visible"}},{matches:"www.newyorker.com",additionalSelectors:["h1","[data-testid=SummaryItemHed]"]},{matches:"start.me",selectors:[".rss-article__title",".rss-articles-list__article-link",".rss-showcase__title",".rss-showcase__text"]},{matches:"www.scmp.com",additionalSelectors:[".info__subHeadline",".section-content h2"]},{matches:["mastodon.social","mastodon.online","kolektiva.social","indieweb.social","mastodon.world","infosec.exchange"],selectors:["div.status__content__text"]},{matches:"www.cnbc.com",additionalSelectors:["div.RenderKeyPoints-list"]},{matches:"app.daily.dev",selectors:["h1",".typo-body","article h3","[class^=markdown_markdown]"]},{matches:"www.aljazeera.com",additionalSelectors:["h1",".article__subhead"]},{matches:["*.pornhub.com","pornhub.com"],excludeMatches:["*.pornhub.com/insights/*","pornhub.com/insights/*"],selectors:[".title >a",".title > span",".thumbnailTitle",".commentMessage > span","h1.floatLeft",".commentText"]},{matches:["weibo.com"],selectors:["div[class^='detail_wbtext']"]},{matches:["medium.com","*.medium.com"],selectors:["article section","h2","[aria-hidden='false'] pre","article p"],excludeSelectors:["[aria-label='Post Preview Reading Time']"]},{matches:"*.fandom.com",additionalSelectors:[".mcf-card-article__title"]},{matches:["www.washingtonpost.com"],additionalSelectors:["[data-qa='article-body']"]},{matches:"www.amazon.com",selectors:["h1","h2 > a > span","[data-a-expander-name='book_description_expander'] > div","[data-feature-name='editorialReviews']",'[data-a-expander-name="review_text_read_more"] > div > span','[data-feature-name="featurebullets"]','[data-feature-name="aplus"']},{matches:"marketplace.visualstudio.com",additionalExcludeSelectors:[".core-info-second-row",".core-info-third-row",".meta-data-list",".item-title",".breadcrumb",".itemDetails-right",".ux-user-name",".ux-updated-date",".ux-item-second-row-wrapper",".stats-and-offer",".header-container"]},{matches:"www.bloomberg.com",excludeSelectors:[".ticker-bar"]},{matches:"xueshu.baidu.com"},{matches:["*.annas-archive.org","annas-archive.org"],selectors:["h3.text-xl.font-bold","div[class='truncate text-sm']"]},{matches:["explainshell.com"],selectors:["[class='help-box']"]},{matches:"play.google.com",additionalSelectors:["header[data-review-id] + div"]},{matches:["www.tumblr.com"],selectors:["article h1","article > header + div","[data-testid=notes-root] p","div.k31gt","p","article ul","article h2","article h3","article h4","article h5","article h6","article blockquote","article ol"],excludeSelectors:["div.fAAi8","div.wvu3V"]},{matches:["mail.qq.com/cgi-bin/frame_html"],selectors:["#thisiddoesnotexists"]},{matches:"www.foxnews.com",excludeSelectors:[".components-MessageDetails-index__message-details-wrapper","div[class^=SlideDown__container]",".components-MessageActions-index__messageActionsWrapper","span[data-openweb-allow-amp]","div.spcv_typing-users"]},{matches:"opennet.ru",excludeTags:["TITLE","SCRIPT","STYLE","TEXTAREA","SVG","svg","NOSCRIPT","INPUT","BUTTON","BASE","LABEL","SELECT","OPTION","IMG","SUB","SUP","HR","PRE","CODE","KBD","WBR","TT","RT","RP","META"]},{matches:["www.construct.net"],excludeMatches:["preview.construct.net","editor.construct.net"],additionalSelectors:["aside","div.manualContent"],additionalExcludeSelectors:["div.topNav","div.usernameLink","ul.authorDetails","ul.tagViewer","ul.breadCrumbNav","ul.subForumForums","ul.postTools","li.comment ul.controls","div.forumTopNavWrap","div.downloadWrap","div.articleLeftMenu","div.usernameTextWrap","div.favouriteWrap","div.bannerWrapper","div.viewAddonRightMenu","div.extendedMenu.addonsSubMenu","#BottomLinks.bottomLinks","div#LeftSide.leftSide","div#BottomWrap.bottomWrap","div.courseListWrap div.overview","div.conversationControls","div.contentWrapper h1","div.conversationControls","td.location a#LocationLink","#TopLevelComments .topBar","#TopLevelComments .controls",".tagViewWrap",".changeCount",".otherStats",".FilterMenu",".mobileTopicStats",".forumControlsWrapper",".forumsBottomNavWrap",".breadCrumbNav",".favouriteWrap",".usernameLink",".followWrapper",".blogPostStats",".manualContent dl dt"]},{matches:"getpocket.com",selectors:["h2","div.excerpt p","article","h1"]},{matches:"*.fandom.com",additionalExcludeSelectors:["header.fandom-community-header","div.ph-registration-buttons"]},{matches:"https://you.com/search",excludeSelectors:["div.hpIWZO"]},{matches:"auth0.openai.com",excludeSelectors:["form","header > h1"]},{matches:"chat.openai.com",excludeSelectors:["div.absolute.bottom-0.left-0.w-full","h1","div#headlessui-portal-root"]},{matches:"glasp.co",excludeSelectors:[".home_overview_list_content_wrapper"]},{matches:"developer.chrome.com",excludeSelectors:["web-tabs","ul.code-sections--summary"]},{matches:"https://rarbg.to/*",selectors:["#news_content","#top_news > table > tbody > tr > td:nth-child(1) > table > tbody > tr > td > table > tbody > tr > td","#top_news > table > tbody > tr > td > table > tbody > tr > td > h2","body > table > tbody > tr > td > div > table > tbody > tr > td > b","#newsRight > table> tbody > tr > td:nth-child(2) > table > tbody > tr:nth-child(2) > td","#newsRight > table > tbody > tr > td:nth-child(2) > table > tbody > tr > td > span > b"]},{matches:["developer.android.google.cn","developer.android.com"],additionalSelectors:["aside","google-codelab-step"]},{matches:"https://apps.microsoft.com/store/detail/*",additionalSelectors:["pre"]},{matches:"gitlab.com",excludeSelectors:[".tree-content-holder","nav",".home-panel-metadata","div[data-testid=project_topic_list]",".commit"]},{matches:"www.newthingsunderthesun.com",additionalSelectors:["[translate=no]"]},{matches:"https://www.tiktok.com/*/video/*",selectors:["[data-e2e^=comment-level]","[data-e2e=browse-video-desc] > span"]},{matches:"www.rfc-editor.org",excludeTags:["TITLE","SCRIPT","STYLE","TEXTAREA","SVG","svg","NOSCRIPT","INPUT","BUTTON","BASE","SELECT","OPTION","IMG","SUB","SUP","HR","CODE","KBD","WBR","TT","RT","RP","META","ASIDE","FOOTER","MATH"]},{matches:"https://steamcommunity.com/app/*",excludeSelectors:[".forum_paging",".forum_topic_reply_count",".forum_topic_lastpost",".forum_topic_award_count",".discussion_search_pagingcontrols"]},{matches:"store.steampowered.com/app/*",selectors:[".game_description_snippet",".game_area_description","#earlyAccessHeader","[id^='ReviewContent'] .content"],excludeSelectors:["#global_actions","#store_controls","#foryou_tab","[class*=persona]","[class*=game_title_area]","a.btn_medium",".persona_name",".hours.ellipsis",".checkcol",".postedDate",".dev_row .summary",".already_in_library",".game_header_image_ctn .grid_content",".ds_flag.ds_wishlist_flag",".early_access_review.tooltip",".communitylink_achievement_images",".user_reviews_summary_row.summary",".review_award_ctn",".add_to_wishlist_area",".next_in_queue_content",".glance_tags.popular_tags",".game_purchase_action",".vote_button_ctn","#VoteUpDownBtnCtn","#footer","#ViewAllReviewssummary"],additionalSelectors:[".game_page_autocollapse_ctn iframe"]},{matches:"https://www.nature.com/articles/*",excludeSelectors:[".c-header",".c-recommendations-header",".c-recommendations-list-container",".c-article-references__links",".c-article-identifiers",".c-article-author-list",".c-article-metrics-bar__wrapper",".c-article__pill-button","#author-information-content","#article-info-section"]},{matches:"https://www.webofscience.com/wos/woscc/summary/*",excludeSelectors:[".summary-left-panel",".authors","app-summary-authors + div"]},{matches:["appleinsider.com"],excludeSelectors:["#topic-nav"]},{matches:["https://crates.io/search*"],selectors:["div[class^=_description-box] div[class^=_description]"]},{matches:"https://www.lookintobitcoin.com/charts/*",excludeSelectors:["svg"]},{matches:"https://pkg.go.dev/std",selectors:["td.UnitDirectories-desktopSynopsis"]},{matches:"https://pkg.go.dev/*",selectors:["div.UnitDetails p"]},{matches:["https://www.explainpaper.com/reader*"],selectors:[".leading-relaxed",".chat-messages p",".text-sm"]},{matches:"https://colab.research.google.com/*",excludeSelectors:["code","view-line"]},{matches:"wandb.ai",additionalSelectors:[".report-page-top"]},{matches:"paulgraham.com",additionalSelectors:["font[face=verdana]"]},{matches:"https://*.zendesk.com/agent/*",selectors:["[data-test-id*=subject]",".zd-comment",".title"]},{matches:"webmail.migadu.com",selectors:[".bodyText"]},{matches:"thehackernews.com",excludeSelectors:["span#blog-pager-older-link","span.h-datetime"],additionalSelectors:[".pop-title"]},{matches:"cs.brown.edu",excludeSelectors:[".SCodeFlow"]},{matches:"chat.google.com",selectors:["[jsname=bgckF]","[dir=ltr]"]},{matches:"https://www.fiverr.com/inbox/*",selectors:[".message-body"]},{matches:["jira.*.com/browse/*","jira.*.com/projects/*"],selectors:["[id=descriptionmodule]","[id=summary-val]","div.action-body","td.stsummary"]},{matches:["*.aha.io"],selectors:["[tabindex='0']","div.user-content","div.comments__body","span.name"]},{matches:"thehill.com",excludeSelectors:["div.featured-cards__byline","div.list-item__meta",".tags__item","div.extended-scroll__header",".submitted-by",".site-header--has-alert-banner",".homepage__container__opinion__item__byline",".homepage__container__header",".archive__item__meta"]},{matches:"manpages.ubuntu.com",selectors:["pre"]},{matches:"www.spiedigitallibrary.org",excludeTags:["TITLE","SCRIPT","STYLE","TEXTAREA","SVG","svg","G","NOSCRIPT","INPUT","BUTTON","BASE","SELECT","OPTION","IMG","SUB","SUP","HR","PRE","CODE","KBD","WBR","TT","RT","RP","META","ASIDE","FOOTER","MATH","TTS-SENTENCE","AIO-CODE"]},{matches:"www.promptingguide.ai",selectors:["article","li"]},{matches:"ground.news"},{matches:"*.ietf.org/doc/html/*",additionalSelectors:["pre"]}],keepStyleSelectors:["SUB","SUP","PRE","CODE","MATH","AIO-CODE"]};class O{addEventListener(e,t){let i=e=>{t(e)};return this.events.push({type:e,listener:i}),this.document.body.addEventListener(e,i)}observe(e){this.observer||(this.observer=e,this.observer.observe(this.document.body,{subtree:!0,childList:!0,attributes:!0}))}destroy(){this.events.forEach(e=>{let{type:t,listener:i}=e;this.document.removeEventListener(t,i)})}constructor(e){(0,s._)(this,"document",void 0),(0,s._)(this,"events",void 0),(0,s._)(this,"observer",void 0),this.document=e,this.events=[],this.observer=null}}class N{init(){this.check(),this.observer=new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{"IFRAME"===e.nodeName&&this.check()})})}),this.observer.observe(document.body,{subtree:!0,childList:!0,attributes:!1})}check(){let e=this.getAllDocuments(),t=[...e],i=[];[...this.documents.keys()].forEach(a=>{e.includes(a)?t=t.filter(e=>e!==a):(i.push(this.documents.get(a)),this.documents.delete(a))}),i.forEach(e=>{e.destroy()}),t.forEach(e=>{let t=new O(e);this.documents.set(e,t),this.options.bindEvents(t)})}observe(e){[...this.documents.keys()].forEach(t=>{let i=this.documents.get(t);null==i||i.observe(e)})}getDocuments(){return[...this.documents.keys()]}getAllDocuments(){let e=document.querySelectorAll("iframe"),t=[document];return e.forEach(e=>{try{var i;let a=e.contentDocument||(null===(i=e.contentWindow)||void 0===i?void 0:i.document);a&&t.push(a)}catch(e){}}),t}constructor(e){(0,s._)(this,"options",void 0),(0,s._)(this,"documents",void 0),(0,s._)(this,"observer",void 0),this.options=e,this.documents=new Map,this.observer=null}}var V=i(10076);class Q extends m.v{static createElement(e,t){var i;let a=document.createElement(e);return(i=t.config.extraStyleAttributes)&&Object.entries(i).forEach(e=>{let[t,i]=e;a.style[t]=i}),a}get sourceLang(){return"auto"===this.sourceComposeLang?k.f.isFreeEngine(d.A.translationEngine)?A.k.AUTO_DETECT_LANG:"auto":u.q.standardizeLocale(u.q.getLocaleByComposeLanguage(this.sourceComposeLang))}get targetLang(){return u.q.standardizeLocale(u.q.getLocaleByComposeLanguage(d.A.finalTranslationTargetRespondLanguage))}get S(){return f.S.Global.controllers.botController}get enableParallelTranslation(){return!!y.o.isExtension&&!this.isBlockCurPage}get parallelTranslationBtnDefaultVisible(){if(!this.enableParallelTranslation)return!1;let e=!1===u.q.compareLocale(this.pageLang||"",this.targetLang),t=this.parallelTranslation.autoShow;return e&&t&&!this.disableTranslateCurSite}get autoTranslateByCheckSite(){let e=location.hostname,{autoTranslateHosts:t}=this.parallelTranslation;return!!t.includes(e)}get disableTranslateCurSite(){let e=location.hostname,{disableTranslateHosts:t}=this.parallelTranslation;return!!t.includes(e)}get isSameLang(){return u.q.compareLocale(this.pageLang||"",this.targetLang)}get parallelShortcutValue(){return this.parallelTranslation.parallelShortcutValue||V.hx.shortcutCtr}get parallelTranslateStyle(){return this.parallelTranslation.onlyShowTranslation?V.wx.default:this.parallelTranslation.parallelTranslateStyle||V.wx.underline}get parallelTranslateStyleColor(){return this.parallelTranslation.onlyShowTranslation||this.parallelTranslateStyle!==V.wx.customColor?null:this.parallelTranslation.parallelTranslateStyleColor}get enabledParallelShortcutValue(){return this.parallelTranslation.parallelShortcutEnable?this.parallelShortcutValue:null}init(){v.m.onDOMReady(()=>{this.checkIsBlockPage(),y.o.isExtension&&this.iframeManager.init(),Promise.all([this.detectPageLang(),this.initParallelTranslationData()]).then(()=>{let e=new URLSearchParams(location.search);e.get("monicaAutoParallelShowAll")&&g.ll.set("parallelOnlyShowTranslation",!1),e.get("monicaAutoTranslate")&&this.tryAutoTranslate(!0)})})}async afterToggleTranslateConfig(){"translated"===this.parallelTranslation.translateStatus&&(this.toggleRenderType("original"),this.parallelTranslation.settingsPanelVisible=!1,await this.doTranslate(),this.parallelTranslation.translateStatus="translated")}async doTranslate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e&&this.reset)return;this.reset=!1;let t=this.getContext();if(t.config.translateFallback){t.config.translateFallback();return}let i=this.getContainers(t);this.markContainersExcludeEl(t,i),this.attachEffect(t);let{inViewportParagraphs:a,outViewportParagraphs:o}=await this.getParagraphs(t,i);e||this.translateDocumentTileIfNeed(),await this.translateParagraphs(a,t),this.addIntersectionObserver(o,t),this.addMutationObserver(),this.setRenderType("translated")}toggleRenderType(e){"original"===e?this.doReset():this.doTranslate()}updateTaskUid(){this.taskUid=v.m.genId()}async detectTextLang(e){if(y.o.isSafariExtension)return"";let t="en";try{if(RegExp("^[\\u3040-\\u30FF0-9\\s\\p{P}]+$","gu").test(e))t="ja";else if(RegExp("^[\\u4E00-\\u9FFF0-9\\s\\p{P}]+$","gu").test(e))t="zh";else if(RegExp("^[\\uac00-\\ud7ff0-9\\s\\p{P}]+$","gu").test(e))t="ko";else if(RegExp("^[a-zA-Z0-9\\s\\p{P}]+$","gu").test(e))t="en";else{let{languages:i}=await b.b.getBrowser().i18n.detectLanguage(e);i.length&&(t=i.sort((e,t)=>t.percentage-e.percentage)[0].language)}return u.q.standardizeLocale("zh"===t?"zh_CN":t)}catch(e){return u.q.standardizeLocale("zh"===t?"zh_CN":t)}}setRenderType(e){e!==this.renderType&&(this.renderType=e)}addEventListeners(e){e.addEventListener("mousemove",t=>{this.mouseX=t.clientX,this.mouseY=t.clientY,this.mouseMoveInDocument=e.document}),e.addEventListener("mousemove",(0,I.Z)(()=>{if(this.enabledParallelShortcutValue===V.hx.shortcutDirect){let t=this.getTargetTextNode(e.document);t&&setTimeout(()=>{let i=this.getTargetTextNode(e.document);if(i===t){let e=!1;for(let[t]of this.commonElMap)if(t.contains(i)){e=!0;break}e||this.translateByTextNode(i)}},500)}},200));let t=null,i=i=>{if(this.enabledParallelShortcutValue&&this.enabledParallelShortcutValue!==V.hx.shortcutDirect){let a=V.Tl[this.enabledParallelShortcutValue];if((0,S.P6)(a,i)){let a=this.fetchMatchNodeAndParagraph(e.document);if(!a)return;let{paragraph:o,textNode:s}=a,n=()=>{if(t=null,o){this.cleanParagraphsEffect([o]);return}this.translateByTextNode(s)};t={callBackNow:()=>{n()},key:i.key}}else t&&(t=null)}};e.addEventListener("keydown",e=>{if(this.enabledParallelShortcutValue)switch(this.enabledParallelShortcutValue){case V.hx.shortcutCtr:case V.hx.shortcutOption:case V.hx.shortcutShift:i(e)}}),e.addEventListener("keyup",e=>{(this.enabledParallelShortcutValue&&V.hx.shortcutCtr===this.enabledParallelShortcutValue||V.hx.shortcutOption===this.enabledParallelShortcutValue||V.hx.shortcutShift===this.enabledParallelShortcutValue)&&t&&t.key===e.key&&t.callBackNow()})}async translateDocumentTileIfNeed(){if(!document.title)return;this.originDocumentTitle||(this.originDocumentTitle=document.title);let e=await z.detectTextLang(this.originDocumentTitle);if(e===this.targetLang){document.title=this.originDocumentTitle;return}await p.Q.webpageTranslate({taskUid:v.m.genShortId(),paragraphs:[{id:v.m.genId(),text:this.originDocumentTitle.substring(0,300),detectLang:e}],originTitle:document.title,originUrl:location.href,sourceLang:this.sourceLang,toLang:this.targetLang,useEngine:d.A.translationEngine||k.f.freeEngineList[0].id,translateFeature:{translateScene:k.f.getSceneId()},isFreeUser:c.userController.isFreeUser},e=>{e[0].result&&(document.title=e[0].result)})}initParallelTranslationData(){return g.ll.on("configChange",e=>{let{parallelTranslationAutoShow:t,parallelTranslationAutoTranslateHosts:i,parallelTranslationAutoTranslateLocales:a,parallelTranslationDisableTranslateHosts:o,translationTargetLanguage:s,parallelOnlyShowTranslation:n,parallelShortcutValue:r,parallelShortcutEnable:l,parallelTranslateStyle:d,parallelTranslateStyleColor:c}=e;void 0!==t&&(this.parallelTranslation.autoShow=t),void 0!==i&&(this.parallelTranslation.autoTranslateHosts=i),void 0!==a&&(this.parallelTranslation.autoTranslateLocales=a),void 0!==o&&(this.parallelTranslation.disableTranslateHosts=o),void 0!==n&&(this.parallelTranslation.onlyShowTranslation=n,this.applyOnlyShowTranslation(),this.applyTranslationStyle()),void 0!==r&&(this.parallelTranslation.parallelShortcutValue=r),void 0!==l&&(this.parallelTranslation.parallelShortcutEnable=l),void 0!==d&&(this.parallelTranslation.parallelTranslateStyle=d,this.applyTranslationStyle()),void 0!==c&&(this.parallelTranslation.parallelTranslateStyleColor=c,this.applyTranslationStyle()),void 0!==s&&setTimeout(()=>{this.afterToggleTranslateConfig()})}),this.pageLang?this.tryAutoTranslate():this.on("pageLangDetected",()=>{this.tryAutoTranslate()}),g.ll.getAll().then(e=>{let{parallelTranslationAutoShow:t,parallelTranslationAutoTranslateHosts:i,parallelTranslationAutoTranslateLocales:a,parallelTranslationDisableTranslateHosts:o,parallelTranslationApplyDashedTheme:s,parallelOnlyShowTranslation:n,parallelShortcutValue:r,parallelShortcutEnable:l,parallelTranslateStyle:d,parallelTranslateStyleColor:c}=e;this.parallelTranslation={...this.parallelTranslation,autoShow:t,autoTranslateHosts:i,autoTranslateLocales:a,disableTranslateHosts:o,onlyShowTranslation:n,parallelShortcutValue:r,parallelShortcutEnable:l,parallelTranslateStyle:d,parallelTranslateStyleColor:c},s&&(g.ll.set("parallelTranslateStyle",V.wx.underline),g.ll.set("parallelTranslationApplyDashedTheme",!1)),this.tryAutoTranslate()})}tryAutoTranslate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("waiting"!==this.parallelTranslation.translateStatus||this.isBlockCurPage)return;if(e){k.f.webTranslationAutoTrigger=!0,this.translate({});return}let{autoTranslateHosts:t,disableTranslateHosts:i,autoTranslateLocales:a}=this.parallelTranslation;if(i.includes(location.hostname))return;if(t.includes(location.hostname)){k.f.webTranslationAutoTrigger=!0,this.translate({});return}let o=this.pageLang;o&&a.includes(o)&&(k.f.webTranslationAutoTrigger=!0,this.translate({}))}doReset(){this.cleanAllElEffect(this.translatableParagraphs||[]),this.translatableParagraphs=[],this.originDocumentTitle&&(document.title=this.originDocumentTitle),this.intersectionObserverList.forEach(e=>{e.disconnect()}),this.intersectionObserverList=[],this.removeInjectCSS(),this.removeMutationObserver(),this.setLineClampDispose&&this.setLineClampDispose(),this.commonElMap.clear(),this.setRenderType("original"),this.reset=!0}addMutationObserver(){if(this.mutationObserver)return;let e=new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{e.nodeName.indexOf(o.CUSTOM_ATTR_PREFIX.toUpperCase())>-1||e.nodeType!==Node.ELEMENT_NODE||this.mutationObserverThrottleCall()}),"attributes"===e.type&&"style"===e.attributeName&&"none"!==getComputedStyle(e.target).display&&this.mutationObserverThrottleCall()})});this.iframeManager.check(),this.iframeManager.observe(e),this.mutationObserver=e}removeMutationObserver(){var e;null===(e=this.mutationObserver)||void 0===e||e.disconnect(),this.mutationObserver=null}async detectPageLang(){let e=async t=>{if(this.pageLang){this.emit("pageLangDetected",this.pageLang);return}if(t>3)return;await v.m.delay(1e3*t);let i=await this.detectTextLang(document.body.innerText);this.pageLang=i,e(t+1)};e(0)}addIntersectionObserver(e,t){e.forEach(e=>{let i=new IntersectionObserver((i,a)=>{i.some(e=>e.intersectionRatio>0&&(a.disconnect(),!0))&&(this.intersectionObserverParagraphList.push(e),this.intersectionObserverTriggerCall(t))});i.observe(e.commonParentEl),this.intersectionObserverList.push(i)})}attachEffect(e){e.config.attachEffect&&(this.setLineClampDispose=e.config.attachEffect(this.setLineClampDispose))}retryFailParagraphs(e){("freeApiError"===e||"aiApiError"===e)&&(this.doReset(),setTimeout(()=>{this.doTranslate()},0))}showTranslateError(e,t){let{translateEl:i,text:a,apiType:o,error:s}=t;a.length<this.minShowErrorWorldLen||(0,T.createRoot)(i).render((0,r.jsx)(U,{errorType:e,errorMsg:s,apiType:o,onRetry:()=>{this.retryFailParagraphs(e)}}))}async translateParagraphs(e,t){this.injectCSS(),k.f.webTranslationTranslating=!0,e.forEach(e=>{let{replaceTagHtmlList:i,commonParentEl:a,isBreakByBrTag:s}=e;if(s)return;let n="",r=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,e=>{if(this.isMarkAttr(e,o.CUSTOM_ATTR.EXCLUDE_EL)&&t.config.keepStyleSelectors.includes(e.tagName)){let t=i.length;return i.push(e.outerHTML),n+="".concat(o.TAG_PLACEHOLDER,"-").concat(t),NodeFilter.FILTER_REJECT}return e.nodeName===o.TRANSLATABLE_NODE_WRAPPER_TAG.toUpperCase()?(n+=" ".concat(e.innerText||e.textContent||""),NodeFilter.FILTER_REJECT):NodeFilter.FILTER_ACCEPT}),l=r.nextNode();for(;l;)l=r.nextNode();let d=n||e.text;e.text=d.trim().replace(/\n/g,o.LINE_BREAK_PLACEHOLDER),RegExp("".concat(o.TAG_PLACEHOLDER),"gi").test(e.text)&&(e.text="".concat(e.text,"."))}),this.paragraphsToElement(e),await p.Q.webpageTranslate({taskUid:v.m.genShortId(),paragraphs:e.map(e=>{let{id:t,text:i,detectLang:a}=e;return{id:t,text:i,detectLang:a}}),originTitle:document.title,originUrl:location.href,sourceLang:this.sourceLang,toLang:this.targetLang,useEngine:d.A.translationEngine||k.f.freeEngineList[0].id,translateFeature:{translateScene:k.f.getSceneId()},isFreeUser:c.userController.isFreeUser},t=>{let i=this.mergeResults(t,e),a=[];for(let e of i)this.targetLang===e.detectLang?a.push(e):(requestAnimationFrame(()=>{let{replaceTagHtmlList:t,errorType:i}=e,a=e.result;if(t.forEach((e,t)=>{a=a.replace("".concat(o.TAG_PLACEHOLDER,"-").concat(t),e)}),e.translateEl.classList.remove(o.LOADING_EL_CLASS),i&&"ignoreError"!==i){this.showTranslateError(i,e);return}e.translateEl.innerHTML=w.x.escapeHTML(a.replaceAll(o.LINE_BREAK_PLACEHOLDER,"\n"))}),this.translatableParagraphs.push(e));this.cleanParagraphsEffect(a),this.applyTranslationStyle(),this.applyOnlyShowTranslation()}),setTimeout(()=>{k.f.webTranslationTranslating=!1},0)}mergeResults(e,t){let i=[];return e.forEach(e=>{let a=t.find(t=>t.id===e.id);a&&i.push({...a,...e})}),[...i]}async getParagraphs(e,t){let i=this.createTextNodeWrapperEls(t),a=this.createParagraphs(i);a=await this.processShouldTranslate(a),a=this.mergeParagraphs(a),a=this.processIsNeedNewLine(a),a=await this.processDetectedLang(a);let{inViewportParagraphs:o,outViewportParagraphs:s}=await this.processParagraphsIsInViewport(e,a);return{inViewportParagraphs:o,outViewportParagraphs:s}}async processParagraphsIsInViewport(e,t){let{config:{mode:i}}=e;if("all"===i)return Promise.resolve({inViewportParagraphs:[...t],outViewportParagraphs:[]});let a=[],o=[];return await Promise.all(t.map(async e=>{await w.x.checkElIsInViewport(e.commonParentEl)?a.push(e):o.push(e)})),{inViewportParagraphs:a,outViewportParagraphs:o}}createTextNodeWrapperEls(e){let t=[],i=[];e.forEach(e=>{let t=e.ownerDocument.createTreeWalker(e,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,e=>e.nodeType===Node.ELEMENT_NODE?this.isMarkAttr(e,o.CUSTOM_ATTR.EXCLUDE_EL)||h.h.isInMonicaRoot(e)||e.nodeName.indexOf(o.CUSTOM_ATTR_PREFIX.toUpperCase())>-1?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT),a=t.nextNode();for(;a;){var s;(null===(s=a.textContent)||void 0===s?void 0:s.trim())&&i.push(a),a=t.nextNode()}});let a=this.getContext();return i.forEach(e=>{if(!e.parentElement||!w.x.checkVisibility(e.parentElement))return;let i=Q.createElement(o.TRANSLATABLE_ORIGIN_TEXT_NODE_WRAPPER_TAG,a);e.after(i),i.append(e);let s=this.createTranslatableNodeWrapper(i);t.push(s)}),t}async translateByTextNode(e){let t=this.findTextNodeParentEl(e,this.getBlockParentEl(e)),i=this.getContext(),a=this.getContainers(i);this.markContainersExcludeEl(i,a),this.attachEffect(i);let{inViewportParagraphs:o,outViewportParagraphs:s}=await this.getParagraphs(i,[t]);await this.translateParagraphs(o,i),this.addIntersectionObserver(s,i)}createParagraphs(e){let t=[];for(let i of e){try{if(!i.checkVisibility())continue}catch(e){}let e=this.findTextNodeParentEl(i,this.getBlockParentEl(i)),a=t.find(t=>t.commonParentEl===e);if(a)a.textNodeWrapperEls.push(i),a.text+=" ".concat(i.innerText||i.textContent||"");else{let a=i.innerText||i.textContent,{translateEl:s,wrapperEl:n}=this.createTranslateEl();this.setAttr(e,o.CUSTOM_ATTR.TRANSLATABLE_NODE_PARENT_EL);let r={id:v.m.genId(),commonParentEl:e,textNodeWrapperEls:[i],text:a,translateEl:s,translateElWrapper:n,isNeedNewLine:!1,isBreakByBrTag:!1,replaceTagHtmlList:[],detectLang:""};t.push(r),this.commonElMap.has(e)||this.commonElMap.set(e,r)}}return[...t]}async processShouldTranslate(e){let t=[],i=e.map(async e=>{e.text=e.text.trim(),e.text=e.text.replace(/\n/g,""),await this.shouldTranslate(e)&&t.push(e)});return await Promise.all(i),this.cleanParagraphsEffect(e.filter(e=>!t.includes(e))),[...t]}cleanParagraphsEffect(e){e.forEach(e=>{let{commonParentEl:t,textNodeWrapperEls:i,translateElWrapper:a}=e;this.removeAllCustomAttr(t),a.remove(),i.forEach(e=>{var t;let i=null===(t=e.firstChild)||void 0===t?void 0:t.firstChild;e.after(i),e.remove()});let s="[".concat(o.CUSTOM_ATTR.EXCLUDE_EL,"=").concat(o.CUSTOM_ATTR_VALUE,"]");t.querySelectorAll(s).forEach(e=>{this.removeAllCustomAttr(e)}),this.commonElMap.has(t)&&this.commonElMap.delete(t)})}cleanAllElEffect(e){let t="[".concat(o.CUSTOM_ATTR.TRANSLATABLE_NODE_PARENT_EL,"=").concat(o.CUSTOM_ATTR_VALUE,"]"),i=this.iframeManager.getDocuments();i.forEach(e=>{e.body.querySelectorAll(t).forEach(e=>{this.removeAllCustomAttr(e)});let i="[".concat(o.CUSTOM_ATTR.EXCLUDE_EL,"=").concat(o.CUSTOM_ATTR_VALUE,"]");e.body.querySelectorAll(i).forEach(e=>{this.removeAllCustomAttr(e)});let a=o.TRANSLATABLE_NODE_WRAPPER_TAG;e.body.querySelectorAll(a).forEach(e=>{var t;let i=null===(t=e.firstChild)||void 0===t?void 0:t.firstChild;e.after(i),e.remove()})}),e.forEach(e=>{let{translateElWrapper:t}=e;t.remove()}),i.forEach(e=>{e.body.querySelectorAll(o.TRANSLATE_EL_WRAPPER_TAG).forEach(e=>{e.remove()})})}async shouldTranslate(e){if(!this.textIsValid(e.text))return!1;let t=await this.detectTextLang(e.text);return!t||t!==this.targetLang}textIsValid(e){let t=e.trim();return!!t&&!(/^(?:https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(t)||/^[0-9]*$/.test(t))&&!(t.length<2)}mergeParagraphs(e){let t=[];e.forEach(e=>{let i="[".concat(o.CUSTOM_ATTR.TRANSLATABLE_NODE_PARENT_EL,"=").concat(o.CUSTOM_ATTR_VALUE,"]");e.commonParentEl.querySelector(i)?(e.textNodeWrapperEls.forEach(i=>{let{translateEl:a,wrapperEl:s}=this.createTranslateEl();this.setAttr(i,o.CUSTOM_ATTR.TRANSLATABLE_NODE_PARENT_EL),t.push({...e,id:v.m.genId(),text:i.innerText||i.textContent||"",textNodeWrapperEls:[i],translateEl:a,translateElWrapper:s,commonParentEl:i})}),this.removeAllCustomAttr(e.commonParentEl)):t.push(e)});let i=[],a=(e,t)=>{if(0===e.length)return;let{translateEl:a,wrapperEl:o}=this.createTranslateEl(),s=Q.createElement("div",this.getContext());e.forEach(e=>{s.appendChild(e.cloneNode(!0))}),i.push({...t,id:v.m.genId(),text:s.innerText.trim().replace(/\n/g,""),textNodeWrapperEls:e,translateEl:a,translateElWrapper:o,isBreakByBrTag:!0})};return t.forEach(e=>{let t=e.commonParentEl.querySelectorAll("br");if(t.length>0){let i=0,{textNodeWrapperEls:o}=e;for(;i<t.length;){let s=t[i],n=[];o.forEach(e=>{e.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_FOLLOWING&&n.push(e)}),o=o.filter(e=>!n.includes(e)),a(n,e),i+=1}a(o,e)}else i.push(e)}),[...i]}paragraphsToElement(e){e.forEach(e=>{let{isNeedNewLine:t,commonParentEl:i,translateElWrapper:a,translateEl:o,textNodeWrapperEls:s,isBreakByBrTag:n}=e;if(n){this.parallelTranslation.onlyShowTranslation||(a.style.display="block",a.style.margin="8px 0"),s[s.length-1].appendChild(a);return}this.parallelTranslation.onlyShowTranslation||(t?(a.style.display="block",a.style.margin="8px 0"):(o.before(this.createSpaceEl()),o.after(this.createSpaceEl()))),s.length>1?i.appendChild(a):s[0].appendChild(a)})}processIsNeedNewLine(e){return e.forEach(e=>{if(e.isBreakByBrTag)return;let t=!1;if(this.isBlockEl(e.commonParentEl)){let i=this.getBlockParentEl(e.commonParentEl);t=!0;let{display:a,flexDirection:o}=window.getComputedStyle(i);"flex"===a&&"row"===o&&(t=!1)}let i=e.text,a=i.split(" ").length,o=i.length,s=i.split("\n").length;a<5&&o<32&&s<2&&(t=!1),(a>5||o>32||s>=2)&&(t=!0),e.isNeedNewLine=t}),[...e]}async processDetectedLang(e){return await Promise.all(e.map(async e=>{let t=await z.detectTextLang(e.text);return e.detectLang=t,e}))}findTextNodeParentEl(e,t){var i,a;let o=e.parentElement;return"BODY"===o.tagName?o:t===o?t:(null===(i=t.textContent)||void 0===i?void 0:i.trim())===(null===(a=o.textContent)||void 0===a?void 0:a.trim())?o:this.findTextNodeParentEl(o,t)}getBlockParentEl(e){if("BODY"===e.tagName)return e;let t=e.parentElement;return t?this.isBlockEl(t)||"BODY"===t.tagName?t:this.getBlockParentEl(t):e}isInlineEl(e){let{display:t}=window.getComputedStyle(e);return!!["inline"].includes(t)}isBlockEl(e){return!this.isInlineEl(e)}createSpaceEl(){let e=Q.createElement(o.SPACE_EL_TAG,this.getContext());return e.innerHTML="&nbsp;",e}createTranslateEl(){let e=this.getContext(),t=Q.createElement(o.TRANSLATE_EL_WRAPPER_TAG,e),i=Q.createElement(o.TRANSLATE_EL_TAG,e);return i.classList.add(o.LOADING_EL_CLASS),t.appendChild(i),{wrapperEl:t,translateEl:i}}createTranslatableNodeWrapper(e){let t=Q.createElement(o.TRANSLATABLE_NODE_WRAPPER_TAG,this.getContext());return e.after(t),t.appendChild(e),t}getContainers(e){let{config:{area:t,containerSelectors:i}}=e;if("all"===t)return this.iframeManager.getDocuments().map(e=>e.body);let a=document.body,o=[],s=this.getElementsBySelectors(a,i);return 0===(o=o.concat(...s)).length&&(o=[a]),o}markContainersExcludeEl(e,t){if(t.forEach(t=>{this.markExcludeEl(e,t)}),["www.notion.so","x.com","www.reddit.com"].includes(window.location.host)){let e=document.querySelector("div[contentEditable=true]");e&&this.setAttr(e,o.CUSTOM_ATTR.EXCLUDE_EL)}}markExcludeEl(e,t){let{excludeTags:i,excludeSelectors:a}=e.config;i.concat(a).forEach(e=>{(null==t?void 0:t.querySelectorAll(e)).forEach(e=>{this.setAttr(e,o.CUSTOM_ATTR.EXCLUDE_EL)})})}getElementsBySelectors(e,t){let i=[];return t.forEach(t=>{let a=e.querySelector(t);a&&i.push(a)}),i}getContext(){let e=document.location.href;if(this.urlContextCache[e])return this.urlContextCache[e];let t={config:F},{specialRules:i}=F,a=i.find(t=>{let{matches:i,excludeMatches:a}=t;return this.checkUrlIsMatched(e,a)||this.checkUrlIsMatched(e,i)});if(a){let{excludeTags:e,additionalExcludeTags:i,additionalSelectors:o,excludeSelectors:s,additionalExcludeSelectors:n,selectors:r,attachEffect:l,extraStyleAttributes:d,translateFallback:c}=a;(null==r?void 0:r.length)&&(t.config.containerSelectors=r),(null==o?void 0:o.length)&&(t.config.containerSelectors=t.config.containerSelectors.concat(o)),(null==e?void 0:e.length)&&(t.config.excludeTags=e),(null==i?void 0:i.length)&&(t.config.excludeTags=t.config.excludeTags.concat(i)),(null==s?void 0:s.length)&&(t.config.excludeSelectors=s),(null==n?void 0:n.length)&&(t.config.excludeSelectors=t.config.excludeSelectors.concat(n)),l&&(t.config.attachEffect=l),d&&(t.config.extraStyleAttributes=d),c&&(t.config.translateFallback=c)}return this.urlContextCache[e]=t,t}isMarkAttr(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.CUSTOM_ATTR_VALUE;return e.getAttribute(t)===i}setAttr(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.CUSTOM_ATTR_VALUE;e.setAttribute(t,i)}removeAttr(e,t){e.removeAttribute(t)}removeAllCustomAttr(e){Array.from(e.attributes).forEach(t=>{let{name:i}=t;i.startsWith(o.CUSTOM_ATTR_PREFIX)&&this.removeAttr(e,i)}),e.classList.forEach(t=>{t.startsWith(o.CUSTOM_ATTR_PREFIX)&&e.classList.remove(t)})}checkUrlIsMatched(e,t){let i=["*://*/*","*","*://*"],a="monica.im",o=[];if(!e||!t||!(o="string"==typeof t?[t]:[...t]).length)return!1;if(o.some(e=>i.includes(e)))return!0;try{let t=new URL(e);t.hash="",t.search="";let s=t.href,n=t.hostname;return o.some(e=>{let t;if(e===n||i.includes(e))return!0;if(!e.includes("*")&&e.includes("://")){let t=new URL(e);return"/"!==t.pathname||e.endsWith("/")?this.isTwoUrlMatched(s,e):t.hostname===n}let o=e;if(e.includes("://")){let t=e.split("://"),i=t[0];"*"===i&&t.length>1&&(i="*",e="https://".concat(t[1]))}else t="*",e="https://".concat(e);let r=e.replace(/\*/g,a),l=new URL(r),d=l.hostname,c=l.pathname;"/"===c&&o.replace("://","").includes("/")&&(c="/*");let h=this.makeRegExp("".concat(t,":"),d.replaceAll(a,"*"),c.replaceAll(a,"*"));if(h){let e=new URL(s);return e.port="",h.test(e.href)}return!1})}catch(e){return!1}}makeRegExp(e,t,i){let a=t,o="^";return"*:"===e?o+="(http:|https:|file:)":o+=e,o+="//",a&&("file:"===e||("*"===a?o+="[^/]+?":(a.match(/^\*\./)&&(o+="[^/]*?",a=a.substring(2)),o+=a.replace(/\./g,"\\.").replace(/\*/g,"[^/]*")))),i?"*"===i||"/*"===i?o+="(/.*)?":i.includes("*")?o+=i.replace(/\*/g,".*?")+"/?":o+=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):o+="/?",new RegExp(o+="$")}isTwoUrlMatched(e,t){let i=new URL(e),a=new URL(t);return i.hostname===a.hostname&&i.pathname===a.pathname&&i.protocol===a.protocol&&i.port===a.port}injectCSS(){this.iframeManager.getDocuments().forEach(e=>{if(e.querySelector("[".concat(o.CUSTOM_ATTR.INJECT_STYLE_EL,"]")))return;let t=e.createElement("style");this.setAttr(t,o.CUSTOM_ATTR.INJECT_STYLE_EL),t.innerText="\n        .".concat(o.LOADING_EL_CLASS," {\n          width: 12px;\n          height: 12px;\n          vertical-align: middle;\n          display: inline-block;\n          margin: 0 4px;\n          border: 2px solid #3872e0;\n          border-top-color: rgba(0, 0, 0, 0.1);\n          border-right-color: rgba(0, 0, 0, 0.1);\n          border-bottom-color: rgba(0, 0, 0, 0.1);\n          border-radius: 100%;\n          animation: monica-translate-loading-circle-animation infinite 0.75s linear;\n        }\n        @keyframes monica-translate-loading-circle-animation {\n          0% {\n            transform: rotate(0);\n          }\n          100% {\n            transform: rotate(360deg);\n          }\n        }\n        .").concat(o.DASHED_THEME_CLASS," {\n          background-repeat: repeat-x;\n          background: linear-gradient( to right, #5083e4 0%, #5083e4 50%, transparent 50%, transparent 100% ) repeat-x left bottom;\n          background-size: 8px 2px;\n          padding-bottom: 2px;\n        }\n  \n        .").concat(o.WEAK_THEME_CLASS," {\n          opacity: 0.5;\n        }\n        .").concat(o.HIDE_THEME_CLASS," {\n          display: none;\n        }\n  \n  \n  \n  \n      "),e.head.appendChild(t)})}removeInjectCSS(){let e="[".concat(o.CUSTOM_ATTR.INJECT_STYLE_EL,"=").concat(o.CUSTOM_ATTR_VALUE,"]");this.iframeManager.getDocuments().forEach(t=>{t.querySelectorAll(e).forEach(e=>{e.remove()})})}checkIsBlockPage(){let e=this.getContext(),t=-1===location.protocol.indexOf("http"),i=this.checkUrlIsMatched(location.href,e.config.blockUrls);this.isBlockCurPage=t||i}applyTranslationStyle(){this.translatableParagraphs.forEach(e=>{let t=e.translateEl;if(!e.errorType)switch(this.parallelTranslateStyleColor?t.style.color=this.parallelTranslateStyleColor:t.style.color="",this.parallelTranslateStyle){case V.wx.underline:t.classList.add(o.DASHED_THEME_CLASS),t.classList.remove(o.WEAK_THEME_CLASS);return;case V.wx.weak:t.classList.add(o.WEAK_THEME_CLASS),t.classList.remove(o.DASHED_THEME_CLASS);return;case V.wx.default:default:t.classList.remove(o.WEAK_THEME_CLASS),t.classList.remove(o.DASHED_THEME_CLASS)}})}applyOnlyShowTranslation(){this.translatableParagraphs.forEach(e=>{let t=e.textNodeWrapperEls,i=e.commonParentEl;if(e.errorType)return;let a="[".concat(o.CUSTOM_ATTR.EXCLUDE_EL,"=").concat(o.CUSTOM_ATTR_VALUE,"]:not(").concat(o.TRANSLATE_EL_WRAPPER_TAG," *)");i.querySelectorAll(a).forEach(e=>{this.parallelTranslation.onlyShowTranslation?e.classList.add(o.HIDE_THEME_CLASS):e.classList.remove(o.HIDE_THEME_CLASS)}),t.forEach(e=>{e.querySelectorAll(o.TRANSLATABLE_ORIGIN_TEXT_NODE_WRAPPER_TAG).forEach(e=>{e&&(this.parallelTranslation.onlyShowTranslation?e.style.setProperty("display","none","important"):e.style.setProperty("display","unset"))})})})}constructor(){super(),(0,s._)(this,"pageLang",null),(0,s._)(this,"sourceComposeLang","auto"),(0,s._)(this,"isMacOS",v.m.isMacOS()),(0,s._)(this,"originDocumentTitle",""),(0,s._)(this,"reset",!1),(0,s._)(this,"renderType","original"),(0,s._)(this,"isBlockCurPage",!1),(0,s._)(this,"localeList",[]),(0,s._)(this,"parallelTranslation",{settingsPanelVisible:!1,translateStatus:"waiting",isDislike:!1,autoShow:!1,autoTranslateHosts:[],autoTranslateLocales:[],disableTranslateHosts:[],sameLangHintVisible:!1,onlyShowTranslation:!1,parallelShortcutEnable:!1,parallelShortcutValue:null,parallelTranslateStyle:null,parallelTranslateStyleColor:null}),(0,s._)(this,"mouseX",0),(0,s._)(this,"mouseY",0),(0,s._)(this,"mouseMoveInDocument",null),(0,s._)(this,"minShowErrorWorldLen",50),(0,s._)(this,"keydownHelper",new C.T),(0,s._)(this,"taskUid",v.m.genId()),(0,s._)(this,"translatableParagraphs",[]),(0,s._)(this,"intersectionObserverList",[]),(0,s._)(this,"intersectionObserverParagraphList",[]),(0,s._)(this,"intersectionObserverTriggerConfig",{defaultWaitTime:2e3,minWaitTime:300,textThreshold:50}),(0,s._)(this,"intersectionObserverTriggerStartTime",null),(0,s._)(this,"intersectionObserverTriggerTimer",null),(0,s._)(this,"intersectionObserverTriggerCall",e=>{let{defaultWaitTime:t,minWaitTime:i,textThreshold:a}=this.intersectionObserverTriggerConfig,o=Date.now(),s=this.intersectionObserverParagraphList.reduce((e,t)=>e+t.text.length,0)>=a,n=()=>{this.translateParagraphs(this.intersectionObserverParagraphList,e),this.intersectionObserverParagraphList=[],this.intersectionObserverTriggerStartTime=null,this.intersectionObserverTriggerTimer&&(clearTimeout(this.intersectionObserverTriggerTimer),this.intersectionObserverTriggerTimer=null)};if(!this.intersectionObserverTriggerStartTime){this.intersectionObserverTriggerStartTime=Date.now(),this.intersectionObserverTriggerTimer=setTimeout(()=>{n()},s?i:t);return}let r=o-this.intersectionObserverTriggerStartTime;if(r>t){n();return}if(s){let e=i-r;e>0?(this.intersectionObserverTriggerTimer&&(clearTimeout(this.intersectionObserverTriggerTimer),this.intersectionObserverTriggerTimer=null),this.intersectionObserverTriggerTimer=setTimeout(()=>{n()},e)):n()}}),(0,s._)(this,"mutationObserver",null),(0,s._)(this,"mutationObserverThrottleCall",(0,I.Z)(()=>{this.doTranslate(!0)},1e3,{trailing:!0})),(0,s._)(this,"setLineClampDispose",null),(0,s._)(this,"commonElMap",new Map),(0,s._)(this,"iframeManager",new N({bindEvents:e=>{this.addEventListeners(e)}})),(0,s._)(this,"translate",(0,E.c)({name:"webTranslate",channels:["extensionContent"],handler:async()=>{"translating"!==this.parallelTranslation.translateStatus&&("waiting"===this.parallelTranslation.translateStatus?(this.parallelTranslation.translateStatus="translating",await this.doTranslate(),this.parallelTranslation.translateStatus="translated"):this.toggleRenderType("translated"===this.renderType?"original":"translated"))}})),(0,s._)(this,"getTargetTextNode",e=>{let t=(this.mouseMoveInDocument||e).caretRangeFromPoint(this.mouseX,this.mouseY);if(t){let e=t.startContainer;if(e.nodeType===Node.TEXT_NODE)return e}}),(0,s._)(this,"fetchMatchNodeAndParagraph",e=>{let t=null,i=this.getTargetTextNode(e);if(!i)return null;for(let[e,a]of this.commonElMap)if(e.contains(i)){t=a;break}return{paragraph:t,textNode:i}}),(0,s._)(this,"urlContextCache",{}),(0,_.rC)(this)}}(0,n.gn)([l.SB],Q.prototype,"pageLang",void 0),(0,n.gn)([l.SB],Q.prototype,"sourceComposeLang",void 0),(0,n.gn)([l.SB],Q.prototype,"isMacOS",void 0),(0,n.gn)([l.SB],Q.prototype,"originDocumentTitle",void 0),(0,n.gn)([l.SB],Q.prototype,"reset",void 0),(0,n.gn)([_.Fl],Q.prototype,"sourceLang",null),(0,n.gn)([_.Fl],Q.prototype,"targetLang",null),(0,n.gn)([_.Fl],Q.prototype,"S",null),(0,n.gn)([l.SB],Q.prototype,"renderType",void 0),(0,n.gn)([l.SB],Q.prototype,"isBlockCurPage",void 0),(0,n.gn)([l.SB],Q.prototype,"localeList",void 0),(0,n.gn)([l.SB],Q.prototype,"parallelTranslation",void 0),(0,n.gn)([l.SB],Q.prototype,"mouseX",void 0),(0,n.gn)([l.SB],Q.prototype,"mouseY",void 0),(0,n.gn)([l.SB],Q.prototype,"mouseMoveInDocument",void 0),(0,n.gn)([l.SB],Q.prototype,"minShowErrorWorldLen",void 0),(0,n.gn)([_.Fl],Q.prototype,"enableParallelTranslation",null),(0,n.gn)([_.Fl],Q.prototype,"parallelTranslationBtnDefaultVisible",null),(0,n.gn)([_.Fl],Q.prototype,"autoTranslateByCheckSite",null),(0,n.gn)([_.Fl],Q.prototype,"disableTranslateCurSite",null),(0,n.gn)([_.Fl],Q.prototype,"isSameLang",null),(0,n.gn)([_.Fl],Q.prototype,"parallelShortcutValue",null),(0,n.gn)([_.Fl],Q.prototype,"parallelTranslateStyle",null),(0,n.gn)([_.Fl],Q.prototype,"parallelTranslateStyleColor",null),(0,n.gn)([_.Fl],Q.prototype,"enabledParallelShortcutValue",null);let z=new Q},10076:function(e,t,i){"use strict";var a,o,s,n;i.d(t,{Tl:function(){return r},hx:function(){return a},wx:function(){return o}}),(s=a||(a={})).shortcutCtr="shortcutCtr",s.shortcutShift="shortcutShift",s.shortcutOption="shortcutOption",s.shortcutDirect="shortcutDirect",(n=o||(o={})).default="default",n.underline="underline",n.weak="weak",n.customColor="customColor";let r={shortcutCtr:"Control",shortcutOption:"Option",shortcutShift:"Shift"}},7318:function(e,t,i){"use strict";i.d(t,{O:function(){return tC}});var a=i(71576),o=i(34491),s=i(4461),n=i(68104),r=i(82005),l=i(5857),d=i(66084),c=i(52921),h=i(11502),g=i(88882),p=i(73047),A=i(54560);class m extends o.PN{get S(){return g.S.Global.components.ProPromotion.UpgradeNowButton}onViewCreate(){this.createUserBehaviorEvent("show")}onViewDestroy(){}handleClick(){var e,t;A.u.gotoPricingForSubscribe({source:"pro_plus_promotion"}),this.createUserBehaviorEvent("click"),null===(e=(t=this.props).onClick)||void 0===e||e.call(t)}async createUserBehaviorEvent(e){await h.M.createUserBehaviorEvent({eventName:"upgrade_popup_".concat(e),extData:{detail:this.props.source}})}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"planList",[]),(0,d._)(this,"discountInfo",null),(0,d._)(this,"planKey",null)}}(0,c.gn)([o.SB],m.prototype,"planList",void 0),(0,c.gn)([o.SB],m.prototype,"discountInfo",void 0),(0,c.gn)([o.SB],m.prototype,"planKey",void 0),(0,c.gn)([p.Fl],m.prototype,"S",null);let u=o._Y.createComponent("UpgradeNowButton",m,e=>(0,a.jsx)(l.z,{className:"upgrade-now-button--lTCMG",size:"large",type:"primary",icon:"\uD83D\uDE80",onClick:e.handleClick.bind(e),children:e.S.upgradeNow}));var f={src:"https://assets.monica.im/home-web/_next/static/media/pro-plus-promotion.2a562160.png",height:361,width:620,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAM1BMVEX36fzZwv785/vLov/47P399P7w3Pv97f3+9v367u/Vt//808jcyOjCs93PyNWurLLgzPqUJU3nAAAACnRSTlP8////9v///ub+vjPaMAAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAACxJREFUeJwVwYkRACAIBLEF50Tx7b9axwSACDXM8p4tUUramoj6OcI9YnS1BxNGAOamJkUnAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:5};class y extends o.PN{get S(){return g.S.Global.components.ProPromotion.HitLimitAlert}onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"source","pro_plus_hit_limit_dialog"),(0,d._)(this,"someState",!0)}}(0,c.gn)([o.SB],y.prototype,"someState",void 0),(0,c.gn)([p.Fl],y.prototype,"S",null);let v=o._Y.createComponent("HitLimitAlert",y,e=>(0,a.jsxs)(n.u,{className:"hit-limit-alert--A36j5",fixed:"dialogRoot"===e.props.insertTarget,onDispose:e.props.onDisposed,width:350,closeOnMaskClick:!1,children:[(0,a.jsx)("header",{className:"header--sZiNo",children:e.S.title}),(0,a.jsx)("div",{className:"banner--hhLZa",children:(0,a.jsx)(s.E,{src:f,alt:""})}),(0,a.jsxs)("div",{className:"content--LI26P",children:[(0,a.jsx)("div",{className:"msg--olp_f",children:e.S.msg}),(0,a.jsx)("div",{className:"sub-msg--YwAWw",children:e.S.subMsg}),(0,a.jsx)("div",{className:"desc--wxTqg",children:e.S.desc})]}),(0,a.jsx)("footer",{className:"footer--fpAGH",children:(0,a.jsx)(u,{onClick:e.props.onDisposed,source:e.source})})]})),w=r.t.createOpener(v,{singleton:!0});var C=i(27181),b=i(49712),S=i(61658),I=i(58812);class _ extends o.PN{constructor(...e){super(...e),(0,d._)(this,"props",void 0)}}var T=JSON.parse('{"fill":"none","content":"\\n<g clip-path=\\"url(#clip0_3362_31656)\\">\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M15.2262 2.16655C15.46 1.90558 15.4853 1.50757 15.267 1.21655C15.0185 0.885177 14.5484 0.81802 14.217 1.06655L12.5503 2.31655C12.3615 2.45819 12.2503 2.68048 12.2503 2.91655C12.2503 3.15262 12.3615 3.37491 12.5503 3.51655L14.217 4.76655C14.5484 5.01508 15.0185 4.94792 15.267 4.61655C15.4853 4.32553 15.46 3.92751 15.2262 3.66655H15.5003C16.9271 3.66655 18.0837 4.82315 18.0837 6.24988V7.91655C18.0837 8.33076 18.4194 8.66655 18.8337 8.66655C19.2479 8.66655 19.5837 8.33076 19.5837 7.91655V6.24988C19.5837 3.99472 17.7555 2.16655 15.5003 2.16655H15.2262ZM6.13557 5.08321L10.6984 5.08321C11.3718 5.08321 11.9225 5.0832 12.3701 5.11977C12.8333 5.15762 13.2517 5.23835 13.6425 5.43744C14.254 5.74903 14.7512 6.24622 15.0628 6.85775C15.2619 7.24849 15.3426 7.66688 15.3804 8.13015C15.417 8.57771 15.417 9.12842 15.417 9.80179V14.3646C15.417 15.038 15.417 15.5887 15.3804 16.0363C15.3426 16.4995 15.2619 16.9179 15.0628 17.3087C14.7512 17.9202 14.254 18.4174 13.6425 18.729C13.2517 18.9281 12.8333 19.0088 12.3701 19.0467C11.9225 19.0832 11.3718 19.0832 10.6984 19.0832H6.13557C5.46219 19.0832 4.91149 19.0832 4.46392 19.0467C4.00066 19.0088 3.58226 18.9281 3.19152 18.729C2.58 18.4174 2.08281 17.9202 1.77122 17.3087C1.57213 16.9179 1.49139 16.4995 1.45354 16.0363C1.41698 15.5887 1.41698 15.038 1.41699 14.3646L1.41699 9.8018C1.41698 9.12842 1.41698 8.57771 1.45354 8.13015C1.49139 7.66688 1.57213 7.24849 1.77122 6.85775C2.08281 6.24622 2.58 5.74903 3.19152 5.43744C3.58226 5.23835 4.00066 5.15762 4.46392 5.11977C4.91149 5.0832 5.4622 5.08321 6.13557 5.08321ZM4.58607 6.61478C4.21557 6.64506 4.01655 6.70056 3.87251 6.77395C3.54323 6.94173 3.27551 7.20945 3.10773 7.53873C3.03434 7.68277 2.97883 7.88179 2.94856 8.25229C2.91758 8.63155 2.91699 9.12077 2.91699 9.83321L2.91699 14.3332C2.91699 15.0457 2.91758 15.5349 2.94856 15.9141C2.97883 16.2846 3.03434 16.4837 3.10773 16.6277C3.27551 16.957 3.54323 17.2247 3.87251 17.3925C4.01655 17.4659 4.21557 17.5214 4.58607 17.5516C4.96533 17.5826 5.45455 17.5832 6.16699 17.5832H10.667C11.3794 17.5832 11.8687 17.5826 12.2479 17.5516C12.6184 17.5214 12.8174 17.4659 12.9615 17.3925C13.2908 17.2247 13.5585 16.957 13.7263 16.6277C13.7996 16.4837 13.8552 16.2846 13.8854 15.9141C13.9164 15.5349 13.917 15.0457 13.917 14.3332V9.83321C13.917 9.12077 13.9164 8.63155 13.8854 8.25229C13.8552 7.88179 13.7996 7.68277 13.7263 7.53873C13.5585 7.20945 13.2908 6.94173 12.9615 6.77395C12.8174 6.70056 12.6184 6.64506 12.2479 6.61478C11.8687 6.5838 11.3794 6.58321 10.667 6.58321L6.16699 6.58321C5.45455 6.58321 4.96533 6.5838 4.58607 6.61478Z\\" fill=\\"#222226\\"/>\\n</g>\\n<defs>\\n<clipPath id=\\"clip0_3362_31656\\">\\n<rect width=\\"20\\" height=\\"20\\" fill=\\"white\\" transform=\\"translate(0.5)\\"/>\\n</clipPath>\\n</defs>\\n\\n","viewBox":"0 0 21 20"}');let k=o._Y.createComponent("RotateLeftIcon",_,e=>(0,a.jsx)(I.s,{...e.props,name:"RotateLeftIcon",iconData:T}));class E extends o.PN{constructor(...e){super(...e),(0,d._)(this,"props",void 0)}}var M=JSON.parse('{"fill":"none","content":"\\n<g clip-path=\\"url(#clip0_3362_31659)\\">\\n<path d=\\"M7.69819 18.0609L7.3577 18.7292L7.69819 18.0609ZM6.60565 16.9684L5.9374 17.3089L6.60565 16.9684ZM18.5607 16.9684L19.2289 17.3089L18.5607 16.9684ZM17.4681 18.0609L17.8086 18.7292L17.4681 18.0609ZM17.4681 6.1059L17.8086 5.43764L17.4681 6.1059ZM18.5607 7.19844L19.2289 6.85795L18.5607 7.19844ZM7.69819 6.1059L7.3577 5.43764L7.69819 6.1059ZM6.60565 7.19844L5.9374 6.85795L6.60565 7.19844ZM7.99984 2.91675L8.44984 3.51675C8.63869 3.37511 8.74984 3.15282 8.74984 2.91675C8.74984 2.68068 8.63869 2.45839 8.44984 2.31675L7.99984 2.91675ZM1.4165 7.91675C1.4165 8.33096 1.75229 8.66675 2.1665 8.66675C2.58072 8.66675 2.9165 8.33096 2.9165 7.91675H1.4165ZM5.88317 3.56675C5.5518 3.81528 5.48464 4.28538 5.73317 4.61675C5.9817 4.94812 6.4518 5.01528 6.78317 4.76675L5.88317 3.56675ZM6.78317 1.06675C6.4518 0.81822 5.9817 0.885377 5.73317 1.21675C5.48464 1.54812 5.5518 2.01822 5.88317 2.26675L6.78317 1.06675ZM10.3332 6.58341L14.8332 6.58341V5.08341H10.3332V6.58341ZM18.0832 9.83342V14.3334L19.5832 14.3334L19.5832 9.83342L18.0832 9.83342ZM14.8332 17.5834H10.3332L10.3332 19.0834L14.8332 19.0834L14.8332 17.5834ZM7.08317 14.3334L7.08317 9.83342H5.58317V14.3334H7.08317ZM10.3332 17.5834C9.62073 17.5834 9.1315 17.5828 8.75225 17.5518C8.38175 17.5216 8.18273 17.4661 8.03869 17.3927L7.3577 18.7292C7.74844 18.9283 8.16684 19.009 8.6301 19.0469C9.08461 19.084 9.64548 19.0834 10.3332 19.0834L10.3332 17.5834ZM5.58317 14.3334C5.58317 15.0211 5.58259 15.582 5.61972 16.0365C5.65757 16.4997 5.73831 16.9181 5.9374 17.3089L7.27391 16.6279C7.20052 16.4839 7.14501 16.2848 7.11474 15.9143C7.08375 15.5351 7.08317 15.0459 7.08317 14.3334H5.58317ZM8.03869 17.3927C7.7094 17.2249 7.44169 16.9572 7.27391 16.6279L5.9374 17.3089C6.24899 17.9204 6.74617 18.4176 7.3577 18.7292L8.03869 17.3927ZM18.0832 14.3334C18.0832 15.0459 18.0826 15.5351 18.0516 15.9143C18.0213 16.2848 17.9658 16.4839 17.8924 16.6279L19.2289 17.3089C19.428 16.9181 19.5088 16.4997 19.5466 16.0365C19.5838 15.582 19.5832 15.0211 19.5832 14.3334L18.0832 14.3334ZM14.8332 19.0834C15.5209 19.0834 16.0817 19.084 16.5362 19.0469C16.9995 19.009 17.4179 18.9283 17.8086 18.7292L17.1277 17.3927C16.9836 17.4661 16.7846 17.5216 16.4141 17.5518C16.0348 17.5828 15.5456 17.5834 14.8332 17.5834L14.8332 19.0834ZM17.8924 16.6279C17.7247 16.9572 17.4569 17.2249 17.1277 17.3927L17.8086 18.7292C18.4202 18.4176 18.9174 17.9204 19.2289 17.3089L17.8924 16.6279ZM14.8332 6.58341C15.5456 6.58341 16.0348 6.584 16.4141 6.61498C16.7846 6.64526 16.9836 6.70076 17.1277 6.77415L17.8086 5.43764C17.4179 5.23855 16.9995 5.15782 16.5362 5.11997C16.0817 5.08283 15.5209 5.08341 14.8332 5.08341V6.58341ZM19.5832 9.83342C19.5832 9.14572 19.5838 8.58485 19.5466 8.13035C19.5088 7.66708 19.428 7.24869 19.2289 6.85795L17.8924 7.53893C17.9658 7.68297 18.0213 7.88199 18.0516 8.25249C18.0826 8.63175 18.0832 9.12097 18.0832 9.83342L19.5832 9.83342ZM17.1277 6.77415C17.4569 6.94193 17.7247 7.20965 17.8924 7.53893L19.2289 6.85795C18.9174 6.24642 18.4202 5.74923 17.8086 5.43764L17.1277 6.77415ZM10.3332 5.08341C9.64548 5.08341 9.08461 5.08283 8.6301 5.11997C8.16684 5.15782 7.74844 5.23855 7.3577 5.43764L8.03869 6.77415C8.18273 6.70076 8.38175 6.64526 8.75225 6.61498C9.1315 6.584 9.62073 6.58341 10.3332 6.58341V5.08341ZM7.08317 9.83342C7.08317 9.12097 7.08375 8.63175 7.11474 8.25249C7.14501 7.88199 7.20052 7.68297 7.27391 7.53893L5.9374 6.85795C5.73831 7.24869 5.65757 7.66708 5.61972 8.13035C5.58259 8.58485 5.58317 9.14572 5.58317 9.83342H7.08317ZM7.3577 5.43764C6.74617 5.74923 6.24899 6.24642 5.9374 6.85795L7.27391 7.53893C7.44169 7.20965 7.7094 6.94193 8.03869 6.77415L7.3577 5.43764ZM7.99984 2.16675L5.49984 2.16675V3.66675L7.99984 3.66675V2.16675ZM1.4165 6.25008V7.91675H2.9165V6.25008H1.4165ZM5.49984 2.16675C3.24467 2.16675 1.4165 3.99492 1.4165 6.25008H2.9165C2.9165 4.82335 4.0731 3.66675 5.49984 3.66675V2.16675ZM6.78317 4.76675L8.44984 3.51675L7.54984 2.31675L5.88317 3.56675L6.78317 4.76675ZM8.44984 2.31675L6.78317 1.06675L5.88317 2.26675L7.54984 3.51675L8.44984 2.31675Z\\" fill=\\"#222226\\"/>\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M5.73366 1.21655C5.98219 0.885177 6.45229 0.81802 6.78366 1.06655L8.45033 2.31655C8.63918 2.45819 8.75033 2.68048 8.75033 2.91655C8.75033 3.15262 8.63918 3.37491 8.45033 3.51655L6.78366 4.76655C6.45229 5.01508 5.98219 4.94792 5.73366 4.61655C5.5154 4.32553 5.54061 3.92751 5.77445 3.66655L5.50033 3.66655C4.07359 3.66655 2.91699 4.82315 2.91699 6.24988V7.91655C2.91699 8.33076 2.58121 8.66655 2.16699 8.66655C1.75278 8.66655 1.41699 8.33076 1.41699 7.91655L1.41699 6.24988C1.41699 3.99472 3.24516 2.16655 5.50033 2.16655H5.77445C5.54061 1.90558 5.5154 1.50757 5.73366 1.21655ZM10.3022 5.08321H14.8651C15.5385 5.08321 16.0892 5.0832 16.5367 5.11977C17 5.15762 17.4184 5.23835 17.8091 5.43744C18.4207 5.74903 18.9178 6.24622 19.2294 6.85775C19.4285 7.24849 19.5093 7.66688 19.5471 8.13015C19.5837 8.57771 19.5837 9.12842 19.5837 9.80179L19.5837 14.3646C19.5837 15.038 19.5837 15.5887 19.5471 16.0363C19.5093 16.4995 19.4285 16.9179 19.2294 17.3087C18.9178 17.9202 18.4207 18.4174 17.8091 18.729C17.4184 18.9281 17 19.0088 16.5367 19.0467C16.0892 19.0832 15.5385 19.0832 14.8651 19.0832L10.3022 19.0832C9.62886 19.0832 9.07815 19.0832 8.63059 19.0467C8.16733 19.0088 7.74893 18.9281 7.35819 18.729C6.74666 18.4174 6.24948 17.9202 5.93789 17.3087C5.7388 16.9179 5.65806 16.4995 5.62021 16.0363C5.58364 15.5887 5.58365 15.038 5.58366 14.3646V9.80179C5.58365 9.12842 5.58364 8.57771 5.62021 8.13015C5.65806 7.66688 5.7388 7.24849 5.93789 6.85775C6.24948 6.24622 6.74666 5.74903 7.35819 5.43744C7.74893 5.23835 8.16733 5.15762 8.63059 5.11977C9.07815 5.0832 9.62886 5.08321 10.3022 5.08321ZM8.75274 6.61478C8.38224 6.64506 8.18321 6.70056 8.03918 6.77395C7.70989 6.94173 7.44218 7.20945 7.2744 7.53873C7.20101 7.68277 7.1455 7.88179 7.11523 8.25229C7.08424 8.63155 7.08366 9.12077 7.08366 9.83321V14.3332C7.08366 15.0457 7.08424 15.5349 7.11523 15.9141C7.1455 16.2846 7.20101 16.4837 7.2744 16.6277C7.44218 16.957 7.70989 17.2247 8.03918 17.3925C8.18321 17.4659 8.38224 17.5214 8.75274 17.5516C9.13199 17.5826 9.62122 17.5832 10.3337 17.5832L14.8337 17.5832C15.5461 17.5832 16.0353 17.5826 16.4146 17.5516C16.7851 17.5214 16.9841 17.4659 17.1281 17.3925C17.4574 17.2247 17.7251 16.957 17.8929 16.6277C17.9663 16.4837 18.0218 16.2846 18.0521 15.9141C18.0831 15.5349 18.0837 15.0457 18.0837 14.3332L18.0837 9.83321C18.0837 9.12077 18.0831 8.63155 18.0521 8.25229C18.0218 7.88179 17.9663 7.68277 17.8929 7.53873C17.7251 7.20945 17.4574 6.94173 17.1281 6.77395C16.9841 6.70056 16.7851 6.64506 16.4146 6.61478C16.0353 6.5838 15.5461 6.58321 14.8337 6.58321H10.3337C9.62122 6.58321 9.13199 6.5838 8.75274 6.61478Z\\" fill=\\"#222226\\"/>\\n</g>\\n<defs>\\n<clipPath id=\\"clip0_3362_31659\\">\\n<rect width=\\"20\\" height=\\"20\\" fill=\\"white\\" transform=\\"translate(0.5)\\"/>\\n</clipPath>\\n</defs>\\n\\n","viewBox":"0 0 21 20"}');let x=o._Y.createComponent("RotateRightIcon",E,e=>(0,a.jsx)(I.s,{...e.props,name:"RotateRightIcon",iconData:M}));class B extends o.PN{constructor(...e){super(...e),(0,d._)(this,"props",void 0)}}var D=JSON.parse('{"fill":"none","content":"\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M10.5003 2.41675C6.31217 2.41675 2.91699 5.81192 2.91699 10.0001C2.91699 14.1882 6.31217 17.5834 10.5003 17.5834C14.6885 17.5834 18.0837 14.1882 18.0837 10.0001C18.0837 5.81192 14.6885 2.41675 10.5003 2.41675ZM1.41699 10.0001C1.41699 4.98349 5.48374 0.916748 10.5003 0.916748C15.5169 0.916748 19.5837 4.98349 19.5837 10.0001C19.5837 15.0167 15.5169 19.0834 10.5003 19.0834C5.48374 19.0834 1.41699 15.0167 1.41699 10.0001ZM6.41699 10.0001C6.41699 9.58587 6.75278 9.25008 7.16699 9.25008H13.8337C14.2479 9.25008 14.5837 9.58587 14.5837 10.0001C14.5837 10.4143 14.2479 10.7501 13.8337 10.7501H7.16699C6.75278 10.7501 6.41699 10.4143 6.41699 10.0001Z\\" fill=\\"#222226\\"/>\\n\\n","viewBox":"0 0 21 20"}');let L=o._Y.createComponent("MinusCircleIcon",B,e=>(0,a.jsx)(I.s,{...e.props,name:"MinusCircleIcon",iconData:D}));var R=i(36307),U=i(8042);class P extends o.PN{constructor(...e){super(...e),(0,d._)(this,"props",void 0)}}var F=JSON.parse('{"fill":"none","content":"\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M3.63617 10.5304C3.34328 10.2375 3.34328 9.76265 3.63617 9.46975L9.46951 3.63642C9.7624 3.34352 10.2373 3.34352 10.5302 3.63642C10.8231 3.92931 10.8231 4.40419 10.5302 4.69708L5.97716 9.25008H15.8332C16.2474 9.25008 16.5832 9.58587 16.5832 10.0001C16.5832 10.4143 16.2474 10.7501 15.8332 10.7501H5.97716L10.5302 15.3031C10.8231 15.596 10.8231 16.0709 10.5302 16.3637C10.2373 16.6566 9.7624 16.6566 9.46951 16.3637L3.63617 10.5304Z\\" fill=\\"#55555D\\"/>\\n\\n","viewBox":"0 0 20 20"}');let O=o._Y.createComponent("PreIcon",P,e=>(0,a.jsx)(I.s,{...e.props,name:"PreIcon",iconData:F}));var N=i(42124);class V extends o.PN{constructor(...e){super(...e),(0,d._)(this,"props",void 0)}}var Q=JSON.parse('{"fill":"none","content":"\\n<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M16.3635 9.46975C16.6564 9.76264 16.6564 10.2375 16.3635 10.5304L10.5302 16.3637C10.2373 16.6566 9.7624 16.6566 9.46951 16.3637C9.17661 16.0709 9.17661 15.596 9.46951 15.3031L14.0225 10.7501H4.1665C3.75229 10.7501 3.4165 10.4143 3.4165 10.0001C3.4165 9.58587 3.75229 9.25008 4.1665 9.25008L14.0225 9.25008L9.46951 4.69708C9.17661 4.40418 9.17661 3.92931 9.46951 3.63642C9.7624 3.34352 10.2373 3.34352 10.5302 3.63642L16.3635 9.46975Z\\" fill=\\"white\\"/>\\n\\n","viewBox":"0 0 20 20"}');let z=o._Y.createComponent("NextIcon",V,e=>(0,a.jsx)(I.s,{...e.props,name:"NextIcon",iconData:Q}));var H=i(63134),W=i(8621),G={src:"https://assets.monica.im/home-web/_next/static/media/vector.ff269813.webp",height:640,width:640,blurDataURL:"data:image/webp;base64,UklGRkwAAABXRUJQVlA4WAoAAAAQAAAABwAABwAAQUxQSAoAAAABB1CFiAhERP8DVlA4IBwAAABwAQCdASoIAAgAAkA4JZwCdAFAAAD+91ZNeHwA",blurWidth:8,blurHeight:8},j=i(92660),J=i(78716),K=i.n(J),q=i(62499),X={wrapper:"wrapper--K9pvk",cropper:"cropper--Es9BX",isMobile:"is-mobile--sn2u5",content:"content--X6kGg",origin:"origin--hnNMp",footer:"footer--rvzaV",btn:"btn--kGn5e",cancel:"cancel--iGWTh",next:"next--FYrA9",submit:"submit--k5A2E",header:"header--Uu6ZM",title:"title--jB1xj",error:"error--FyR7Z",icon:"icon--hzkek",item:"item--flip0",actions:"actions--Zb6So",disabled:"disabled--tGlyu",itemBottom:"item-bottom--uZVn0",previewText:"preview-text--wmERk",originImage:"origin-image--Yy8ii",loading:"loading--WgmX6",preview:"preview--o0kQP",previewTarget:"preview-target--KI220",full:"full--CfrMf",pre:"pre--pit6e"},Z=i(31284),Y=i(92235),$=i(96627),ee=i.n($),et=i(38172),ei=i(34889);class ea extends o.PN{get S(){return g.S.Global.components.Cropper}get loading(){return this.preLoading||this.nextLoading||this.submitLoading||this.initLoading}get imageLoading(){return this.preLoading||this.nextLoading||this.initLoading}get selectImage(){return this.props.images[this.currentIndex]}handleRotate(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading||null===(e=this.cropperIns)||void 0===e||e.rotate(t?90:-90)}handleZoom(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading||null===(e=this.cropperIns)||void 0===e||e.zoom(t?.1:-.1)}createCropper(e,t){let i=this.cropperInitDeferred=new Z.B,a=()=>{let{rangeConfig:{aspectRatioRange:a}}=this.selectImage,{min:o,max:s}=a,n=e.naturalWidth/e.height;this.cropperIns=new(ee())(e,{checkCrossOrigin:!1,viewMode:1,guides:!0,dragMode:"move",autoCropArea:.8,responsive:!0,background:!1,preview:this.previewDom,initialAspectRatio:this.getValidAspectRatio(n,a),cropBoxMovable:!0,cropBoxResizable:!0,movable:!0,data:t,cropmove:()=>{if(!this.cropperIns)return;let e=this.cropperIns.getData(),t=e.width/e.height;t<o?this.cropperIns.setData({...e,width:e.height*o}):t>s&&this.cropperIns.setData({...e,width:e.height*s})},ready:()=>{i.resolve()}})};e.complete?(a(),e.onload=null):e.onload=()=>{a(),e.onload=null}}async initCropper(e,t){this.cropperIns&&this.cropperIns.destroy(),this.createCropper(e,t),this.cropperInitDeferred&&(this.initLoading=!0,await this.cropperInitDeferred.promise,this.initLoading=!1)}async uploadFile(e){let{preSignedUrl:t,cdnUrl:i}=await ei.Gi.getS3PreSignedModuleUrl({filename:e.name,module:"chat_pdf",location:"files"});return await ei.Gi.uploadFileToS3(t,e,()=>{}),i}async handleSubmit(){var e,t;if(this.loading)return;this.submitLoading=!0,await this.saveCurrentData();let i=await Promise.all(this.imageData.map(e=>(async()=>{let t=Y.m.dataURLtoFile(e.dataUrl,e.fileName,e.imageType);return await this.uploadFile(t)})()));null===(e=(t=this.props).onSubmit)||void 0===e||e.call(t,i),this.props.onDisposed(),this.submitLoading=!1}async saveCurrentData(){if(!this.cropperIns)return;this.cropperInitDeferred&&await this.cropperInitDeferred.promise;let{rangeConfig:{sizeRange:e,aspectRatioRange:t}}=this.selectImage,{width:i,height:a}=e,{min:o,max:s}=i,{min:n,max:r}=a,l=this.cropperIns.getData(),d=l.width/l.height,c=l.width,h=l.height;c<o?h=(c=o)/d:c>s&&(h=(c=s)/d),h<n?(c=(h=n)*d)>s&&(h=(c=s)/d)<n&&et.W.createUserBehaviorEvent({eventName:"cropper_range_exception",extData:{aspectRatioRange:t,sizeRange:e}}):h>r&&(c=(h=r)*d)>s&&(h=(c=s)/d)>r&&et.W.createUserBehaviorEvent({eventName:"cropper_range_exception",extData:{aspectRatioRange:t,sizeRange:e}}),c=Math.round(c),h=Math.round(h);let g=this.cropperIns.getCroppedCanvas({width:c,height:h,imageSmoothingQuality:"high",imageSmoothingEnabled:!0}).toDataURL(),p=this.getFilenameFromUrl(this.selectImage.imageSrc),A=this.IMAGE_TYPES.png;p?A=this.getImageType(p)||A:p="".concat(Y.m.genShortId,".png"),this.imageData[this.currentIndex]={data:this.cropperIns.getData(),dataUrl:g,fileName:p,imageType:A}}async handleNext(){if(this.cropperIns&&!this.loading&&(this.nextLoading=!0,await this.saveCurrentData(),this.currentIndex<this.props.images.length-1)){this.currentIndex+=1;let e=this.imageData[this.currentIndex];setTimeout(()=>{if(this.imageDom&&(this.initCropper(this.imageDom,null==e?void 0:e.data),e)){var t;null===(t=this.cropperIns)||void 0===t||t.setData(e.data)}this.nextLoading=!1})}}async handlePre(){if(this.cropperIns&&!this.loading&&(this.preLoading=!0,await this.saveCurrentData(),this.currentIndex>0)){this.currentIndex-=1;let e=this.imageData[this.currentIndex];setTimeout(()=>{if(this.imageDom&&(this.initCropper(this.imageDom,null==e?void 0:e.data),e)){var t;null===(t=this.cropperIns)||void 0===t||t.setData(e.data)}this.preLoading=!1})}}handleClose(){var e,t;this.props.onDisposed(),null===(e=(t=this.props).onClose)||void 0===e||e.call(t)}onViewCreate(){this.imageDom&&this.initCropper(this.imageDom)}onViewDestroy(){this.cropperIns&&(this.cropperIns.destroy(),this.cropperIns=null)}getValidAspectRatio(e,t){return e>t.max||e<t.min?(t.min+t.max)/2:e}getFilenameFromUrl(e){return decodeURIComponent(new URL(e).pathname).split("/").pop()}getImageType(e){var t;let i=null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase();return i&&this.IMAGE_TYPES[i]||null}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"cropperIns",null),(0,d._)(this,"imageDom",null),(0,d._)(this,"previewDom",void 0),(0,d._)(this,"IMAGE_TYPES",{svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",webp:"image/webp"}),(0,d._)(this,"imageData",[]),(0,d._)(this,"currentIndex",0),(0,d._)(this,"preLoading",!1),(0,d._)(this,"nextLoading",!1),(0,d._)(this,"submitLoading",!1),(0,d._)(this,"initLoading",!1),(0,d._)(this,"cropperInitDeferred",null)}}(0,c.gn)([o.SB],ea.prototype,"imageData",void 0),(0,c.gn)([o.SB],ea.prototype,"currentIndex",void 0),(0,c.gn)([o.SB],ea.prototype,"preLoading",void 0),(0,c.gn)([o.SB],ea.prototype,"nextLoading",void 0),(0,c.gn)([o.SB],ea.prototype,"submitLoading",void 0),(0,c.gn)([o.SB],ea.prototype,"initLoading",void 0),(0,c.gn)([o.Fl],ea.prototype,"S",null),(0,c.gn)([o.Fl],ea.prototype,"loading",null),(0,c.gn)([o.Fl],ea.prototype,"imageLoading",null),(0,c.gn)([o.Fl],ea.prototype,"selectImage",null);let eo=o._Y.createComponent("Cropper",ea,e=>{let{canNotCloseModal:t}=e.props,{imageSrc:i}=e.selectImage;return(0,a.jsx)(n.u,{className:X.wrapper,width:702,onDispose:()=>{e.handleClose()},closeOnMaskClick:!1,closeIconVisible:!t,wrapperStyle:{zIndex:99},children:(0,a.jsxs)("div",{className:K()(X.cropper,{[X.isMobile]:W.imageController.isMobile}),[j.$A]:1,children:[(0,a.jsx)(es,{vm:e}),(0,a.jsxs)("div",{className:X.content,children:[(0,a.jsxs)("div",{className:X.item,children:[(0,a.jsxs)("div",{className:X.origin,style:{backgroundImage:"url(".concat((0,s.Q)(G),")")},children:[e.imageLoading&&(0,a.jsx)(S.g,{fullScreen:!0,wrapperClassName:X.loading}),(0,a.jsx)("img",{ref:t=>{e.imageDom=t},crossOrigin:"anonymous",src:i,alt:"Source",className:X.originImage})]}),(0,a.jsx)("div",{className:X.itemBottom,children:(0,a.jsxs)("div",{className:K()(X.actions,{[X.disabled]:e.loading}),children:[(0,a.jsx)(k,{button:!0,padding:4,onClick:()=>{e.handleRotate(!1)},title:e.S.rotateLeft,size:20,color:"var(--theme-icon-primary)"}),(0,a.jsx)(x,{button:!0,padding:4,onClick:()=>{e.handleRotate(!0)},title:e.S.rotateRight,size:20,color:"var(--theme-icon-primary)"}),(0,a.jsx)(L,{button:!0,padding:4,onClick:()=>{e.handleZoom(!1)},title:e.S.zoomIn,size:20,color:"var(--theme-icon-primary)"}),(0,a.jsx)(R.a,{button:!0,padding:4,onClick:()=>{e.handleZoom(!0)},title:e.S.zoomOut,size:20,color:"var(--theme-icon-primary)"})]})})]}),!W.imageController.isMobile&&(0,a.jsxs)("div",{className:X.item,children:[(0,a.jsx)("div",{className:X.preview,children:(0,a.jsx)("div",{ref:t=>{e.previewDom=t||void 0},className:X.previewTarget})}),(0,a.jsx)("div",{className:K()(X.itemBottom,X.previewText),children:e.S.preview})]})]}),(0,a.jsx)(en,{vm:e})]})})}),es=(0,q.Pi)(e=>{let{vm:t}=e,{errorType:i}=t.selectImage;return(0,a.jsxs)("div",{className:X.header,children:[(0,a.jsx)("div",{className:X.title,children:1===t.props.images.length?t.S.titleSingle:(0,g.x)(t.S.title,{num:t.props.images.length})}),(0,a.jsxs)("div",{className:X.error,children:[(0,a.jsx)(U.a,{className:X.icon,size:16,color:"var(--theme-function-error)"}),"size"===i&&t.S.errorSizeMsg,"ratio"===i&&t.S.errorRatioMsg]})]})}),en=(0,q.Pi)(e=>{let{vm:t}=e;return(0,a.jsxs)("div",{className:K()(X.footer,{[X.full]:t.currentIndex>0}),children:[t.currentIndex>0&&(0,a.jsx)(l.z,{onClick:()=>{t.handlePre()},type:"outline",className:K()(X.btn,X.pre),loading:t.preLoading,disabled:t.submitLoading||t.nextLoading||t.initLoading,icon:(0,a.jsx)(O,{size:20,color:"var(--theme-icon-tertiary)"}),children:t.S.pre}),!t.props.canNotCloseModal&&(0,a.jsx)(l.z,{onClick:()=>{t.handleClose()},type:"gray",className:K()(X.btn,X.cancel),icon:(0,a.jsx)(N.k,{size:20,color:"var(--theme-icon-tertiary)"}),children:t.S.cancel}),t.currentIndex<t.props.images.length-1?(0,a.jsx)(l.z,{onClick:()=>{t.handleNext()},type:"primary",className:K()(X.btn,X.next),loading:t.nextLoading,disabled:t.preLoading||t.submitLoading||t.initLoading,icon:(0,a.jsx)(z,{size:20,color:"var(--theme-icon-white-primary)"}),children:t.S.next}):(0,a.jsx)(l.z,{onClick:()=>{t.handleSubmit()},type:"primary",className:K()(X.btn,X.submit),loading:t.submitLoading,disabled:t.preLoading||t.nextLoading||t.initLoading,icon:(0,a.jsx)(H.n,{size:20,color:"var(--theme-icon-white-primary)"}),children:t.S.submit})]})}),er=r.t.createOpener(eo);var el=i(92128),ed=i(7472),ec=i(66952),eh=i(5312),eg=i(95782);class ep extends o.PN{get S(){return g.S.Global.components.Paywalls.UsageOverLimit.InstallGuideDialog}onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"someState",!0)}}(0,c.gn)([o.SB],ep.prototype,"someState",void 0),(0,c.gn)([p.Fl],ep.prototype,"S",null);let eA=o._Y.createComponent("InstallGuideDialog",ep,e=>(0,a.jsxs)(n.u,{onDispose:e.props.onDisposed,className:"install-guide-dialog--PywTV",width:410,closeOnMaskClick:!1,children:[(0,a.jsx)(ec.T,{size:32,showTitle:!0,gap:12,titleSize:24,titleClassName:"title--uiDjN"}),(0,a.jsx)(eg.Z,{className:"content--ycdm5",S:e.S.content,components:{span:e=>(0,a.jsx)("strong",{children:e})}}),(0,a.jsxs)(l.z,{type:"primary",className:"button--wGK8y",onClick:()=>{e.props.onDisposed(),window.open(Y.m.getStoreUrl())},children:[(0,a.jsx)(s.E,{alt:"",src:eh.Z,className:"img--_SI3C"}),(0,a.jsx)("span",{children:(0,a.jsx)(eg.Z,{S:e.S.add,data:{platform:"Edge"===Y.m.getBrowserName()?"Edge":"Chrome"}})})]})]})),em=r.t.createOpener(eA);var eu=i(28371),ef=i(46731),ey=i(33381),ev=i(25449);class ew extends o.PN{get S(){return g.S.Global.components.Paywalls.UsageOverLimit.InviteBtn}onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,d._)(this,"props",void 0)}}(0,c.gn)([p.Fl],ew.prototype,"S",null);let eC=o._Y.createComponent("InviteBtn",ew,e=>{let{source:t="",style:i}=e.props;return(0,a.jsx)(l.z,{type:"text",color:"primary",className:"invite-btn--J2k46",style:i,onClick:()=>{h.M.createUserBehaviorEvent({eventName:"upgrade_popup_click",extData:{detail:t,button:"invite"}}),window.open(Y.m.getInvitationLandingPageUrl(g.a.locale,{source:t}),"_blank","noreferrer noopener")},children:e.S.invite})});var eb={basicQueryCountdownDialog:"basic-query-countdown-dialog--OyeaK",header:"header--ZO0LY",title:"title--AwXFi",close:"close--Ou068",main:"main--bEu4p",mainTips:"main-tips--YrXI9",countdown:"countdown--a4eYU",countdownItem:"countdown-item--vsKk4",colon:"colon--hmmHL",getMoreTips:"get-more-tips--gJTB_",footer:"footer--N4frz"},eS=i(73361);class eI extends o.PN{get S(){return g.S.Global.components.Paywalls.BasicQueryCountdownDialog}handleCountdownFinish(){eS.gM.updateUsageInfos(["basic_query"]),this.props.onDisposed()}async handleSubscription(){h.M.createUserBehaviorEvent({eventName:"upgrade_popup_click",extData:{detail:this.defaultSource,button:"upgrade"}});let e=this.props.source||this.defaultSource;if(ey.userController.canResubscribe){await ey.userController.resubscribe(e),this.props.onDisposed();return}ey.userController.upgrade(e,this.props.botInfo,{},!0)}onViewCreate(){h.M.createUserBehaviorEvent({eventName:"upgrade_popup_show",extData:{detail:this.defaultSource}}),ey.userController.eventEmitter.listenBy(this,"markPaid",()=>{this.props.onDisposed()}),this.calcCountdown(!0),this.timer=window.setInterval(()=>{this.calcCountdown(),(this.countdown<1||this.countdown>this.maxCountdown)&&this.handleCountdownFinish()},1e3)}onViewDestroy(){window.clearInterval(this.timer)}calcCountdown(e){this.countdown=this.getSecondsUntilNextDay(),e&&(this.maxCountdown=this.countdown);let t=this.format(this.countdown);this.timeFormatObj=t}getSecondsUntilNextDay(){let e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()+1);return Math.floor((Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())-e.getTime()+1e3)/1e3)}format(e){return{HH:String(Math.floor(e/3600)).padStart(2,"0"),mm:String(Math.floor(e%3600/60)).padStart(2,"0"),ss:String(Math.floor(e%3600%60)).padStart(2,"0")}}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"timeFormatObj",null),(0,d._)(this,"countdown",0),(0,d._)(this,"maxCountdown",86400),(0,d._)(this,"timer",0),(0,d._)(this,"defaultSource","chat_query_quota_exceeded")}}(0,c.gn)([o.SB],eI.prototype,"timeFormatObj",void 0),(0,c.gn)([o.Fl],eI.prototype,"S",null);let e_=o._Y.createComponent("BasicQueryCountdownDialog",eI,e=>{var t,i,o,s;let{insertTarget:r,onDisposed:d,getRef:c,className:h,hideCloseBtn:g}=e.props;return(0,a.jsxs)(n.u,{className:K()(eb.basicQueryCountdownDialog,h),closeOnMaskClick:!0,closeIconVisible:!1,maskType:"black",onDispose:d,fixed:"dialogRoot"===r,width:350,getRef:c,children:[(0,a.jsxs)("header",{className:eb.header,children:[(0,a.jsx)("div",{className:eb.title,children:e.S.reminder}),!g&&(0,a.jsx)("span",{className:eb.close,onClick:()=>{d()},children:(0,a.jsx)(ef.J,{color:"currentColor",size:20,name:"close"})})]}),(0,a.jsxs)("main",{className:eb.main,children:[(0,a.jsx)("div",{className:eb.mainTips,children:e.S.mainTips}),(null===(t=e.timeFormatObj)||void 0===t?void 0:t.HH)&&(0,a.jsxs)("div",{className:eb.countdown,children:[(0,a.jsx)("div",{className:eb.countdownItem,children:null===(i=e.timeFormatObj)||void 0===i?void 0:i.HH}),(0,a.jsx)("span",{className:eb.colon,children:":"}),(0,a.jsx)("div",{className:eb.countdownItem,children:null===(o=e.timeFormatObj)||void 0===o?void 0:o.mm}),(0,a.jsx)("span",{className:eb.colon,children:":"}),(0,a.jsx)("div",{className:eb.countdownItem,children:null===(s=e.timeFormatObj)||void 0===s?void 0:s.ss})]}),(0,a.jsx)("div",{className:eb.getMoreTips,children:(0,a.jsx)(eg.Z,{S:e.S.getMoreQueries,components:{strong:e=>(0,a.jsx)("strong",{children:e})}})})]}),(0,a.jsxs)("footer",{className:eb.footer,children:[(0,a.jsx)(l.z,{type:"primary",size:"large",loading:ey.userController.resubscribeLoading,onClick:e.handleSubscription.bind(e),children:ev.promotionController.subscribeButtonText}),(0,a.jsx)(eC,{style:{marginTop:12},source:"chat_query_quota_exceeded"})]})]})}),eT=r.t.createOpener(e_);class ek extends o.PN{get S(){return g.S.Global.components.Paywalls.UnlimitedQueryOverLimitDialog}onViewCreate(){this.createEvent("show")}onViewDestroy(){}onClose(){this.createEvent("close"),this.props.onDisposed()}createEvent(e){h.M.createUserBehaviorEvent({eventName:"upgrade_popup_".concat(e),extData:{detail:"unlimited_query_over_limit_dialog"},source:this.props.source})}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"someState",!0)}}(0,c.gn)([o.SB],ek.prototype,"someState",void 0),(0,c.gn)([o.Fl],ek.prototype,"S",null);let eE=o._Y.createComponent("UnlimitedQueryOverLimitDialog",ek,e=>(0,a.jsxs)(n.u,{className:"unlimited-query-over-limit-dialog--LxHe4",onDispose:()=>{e.onClose()},fixed:"dialogRoot"===e.props.insertTarget,closeOnMaskClick:!1,width:328,children:[(0,a.jsx)("h2",{className:"title--IJnYl",children:e.S.title}),(0,a.jsx)("div",{className:"description--dXxFF",children:e.S.description}),(0,a.jsxs)("footer",{className:"footer--qOLdL",children:[(0,a.jsx)(l.z,{type:"lightGray",onClick:()=>{e.onClose()},children:e.S.cancel}),(0,a.jsx)(l.z,{type:"primary",onClick:()=>{e.createEvent("click"),window.open(Y.m.getFeedbackPageUrl({issueType:"unsubscribe_reason"}),"_blank"),e.props.onDisposed()},children:e.S.contactUs})]})]})),eM=r.t.createOpener(eE);var ex=i(43939),eB=i(53040),eD=i(663),eL=i(47720),eR=i(67061),eU=i(75563),eP={buyCreditsDialog:"buy-credits-dialog--hJxAJ",buyCredits:"buy-credits--mcpf5",logo:"logo--dXWSX",title:"title--PObuC",content:"content--PuYBr",productList:"product-list--uLsNc",product:"product--_TOsc",head:"head--BHBhu",credits:"credits--aN3X0",badge:"badge--xeEEs",checked:"checked--mRtQ7",info:"info--NPPHh",price:"price--Pzv2T",active:"active--rq52P",actions:"actions--lfGS8",upgradeBtn:"upgrade-btn--WKpEA",viewBtn:"view-btn--Rr1jm",closeBtn:"close-btn--lDLFQ"},eF=i(63038);class eO extends o.PN{get S(){return g.S.Global.components.Paywalls.BuyCreditsDialog}get productList(){return eL.serverConfigController.planConfigs.addons||eF.i.addons}get selectedProduct(){var e;return this.activeProduct||(null===(e=this.productList.find(e=>e.isRecommend))||void 0===e?void 0:e.key)}onViewCreate(){h.M.createUserBehaviorEvent({eventName:"buy_credits_dialog_show",source:this.props.source})}onViewDestroy(){}handleClose(){var e,t,i,a;null===(e=(t=this.props).onClose)||void 0===e||e.call(t),null===(i=(a=this.props).onDisposed)||void 0===i||i.call(a)}goBuy(){this.reportClick("buy"),eD.m.buyCredits({source:this.props.source||"buy_credits_dialog",productKey:this.selectedProduct||""})}viewAll(){this.reportClick("view_all");let e=this.props.source||"buy_credits_dialog";window.open(Y.m.getCreditsPageUrl({source:e}),"_blank","noopener")}reportShow(){h.M.createUserBehaviorEvent({eventName:"buy_credits_dialog_show",source:this.props.source})}reportClick(e){h.M.createUserBehaviorEvent({eventName:"buy_credits_dialog_show",source:this.props.source,extData:{button:e}})}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"activeProduct","")}}(0,c.gn)([o.SB],eO.prototype,"activeProduct",void 0),(0,c.gn)([p.Fl],eO.prototype,"S",null),(0,c.gn)([p.Fl],eO.prototype,"productList",null),(0,c.gn)([p.Fl],eO.prototype,"selectedProduct",null);let eN=o._Y.createComponent("BuyCreditsDialog",eO,e=>{let{insertTarget:t}=e.props;return"mainWindow"===t&&"sidebar"===eR.L.mainWindowMode&&window.innerHeight<1580?(0,a.jsx)(ex.d,{onDispose:()=>{e.handleClose()},hiddenHeader:!0,maxHeight:"".concat(790,"px"),visible:!0,style:{borderTopRightRadius:20,borderTopLeftRadius:20},children:(0,a.jsx)(eQ,{vm:e})}):(0,a.jsx)(n.u,{className:K()(eP.buyCreditsDialog,e.props.className),onDispose:()=>{e.handleClose()},width:408,style:e.props.modalStyle,closeIconVisible:!1,closeOnMaskClick:!1,fixed:"dialogRoot"===e.props.insertTarget,getRef:e.props.getRef,children:(0,a.jsx)(eQ,{vm:e})})}),eV=(0,q.Pi)(function(e){let{vm:t}=e;return(0,a.jsx)("div",{className:K()(eP.closeBtn,t.props.closeBtnClassName),onClick:()=>{t.handleClose()},children:(0,a.jsx)(ef.J,{name:"sidebarClose",size:16})})}),eQ=(0,q.Pi)(e=>{let{vm:t}=e;return(0,a.jsxs)("div",{className:eP.buyCredits,children:[(0,a.jsx)(eV,{vm:t}),(0,a.jsx)(eB.E,{className:eP.logo,src:(0,s.Q)(eU.Z),alt:""}),(0,a.jsx)("div",{className:eP.title,children:(0,a.jsx)(eg.Z,{S:t.S.title,components:{br:()=>(0,a.jsx)("br",{})}})}),(0,a.jsx)("div",{className:eP.content,children:(0,a.jsx)("div",{className:eP.productList,children:t.productList.map(e=>(0,a.jsxs)("div",{className:K()(eP.product,{[eP.active]:e.key===t.selectedProduct}),onClick:()=>{t.activeProduct=e.key},children:[(0,a.jsxs)("div",{className:eP.head,children:[(0,a.jsx)("span",{className:eP.credits,children:(0,g.x)(t.S.creditsCount,{count:e.credit})}),e.isRecommend&&(0,a.jsxs)("div",{className:eP.badge,children:[(0,a.jsx)(ef.J,{className:eP.hot,name:"hot",size:12,color:"currentColor"}),(0,a.jsx)("span",{children:t.S.popular})]}),e.key===t.selectedProduct&&(0,a.jsx)(ef.J,{className:eP.checked,name:"check-action",size:22,color:"var(--theme-icon-brand)"})]}),(0,a.jsx)("div",{className:eP.info,children:(0,g.x)(t.S.equalTo,eD.m.calcCreditFeatures(e.credit))}),(0,a.jsx)("div",{className:eP.price,children:eL.serverConfigController.genPrice(e.price)})]},e.key))})}),(0,a.jsxs)("div",{className:eP.actions,children:[(0,a.jsx)(l.z,{className:eP.upgradeBtn,type:"primary",shape:"round",size:"large",animation:"sheen",onClick:async()=>{var e,i;null===(e=(i=t.props).onClick)||void 0===e||e.call(i),t.goBuy()},children:t.S.buyNow}),(0,a.jsx)(l.z,{type:"text-primary",className:eP.viewBtn,onClick:()=>{t.viewAll()},children:t.S.viewAll})]})]})}),ez=r.t.createOpener(eN,{singleton:!0});var eH={src:"https://assets.monica.im/home-web/_next/static/media/aiModels.853853f1.png",height:48,width:128,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAMAAACZFr56AAAAM1BMVEX3+fkNDQ3l2Mw5Ozv09fIRERHk1Mju3c8oKSn19fLr9v7z9PkrKivOmYSDgoKLr+TprJGJcX8+AAAACnRSTlPf3/v/8N/7+/DwefPvzwAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAACNJREFUeJxjYOThYGPn5GZgYOZj5hXg5udiYOThYGJn4WIAAAoDALh7SG3KAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:3},eW=i(8492),eG={webTranslateUpgradeDialog:"web-translate-upgrade-dialog--p9zSl",main:"main--ngdIh",left:"left--X4y1D",right:"right--FwgZY",title:"title--PlYaF",more:"more--WZEnZ",translateExample:"translate-example--JZrHe",modelCompare:"model-compare--h70bE",modelList:"model-list--Em5hf",modelItem:"model-item--XXdVf",gptItem:"gpt-item--LAm9o",gptImage:"gpt-image--cQBGM",exampleList:"example-list--h0Rmw",exampleItem:"example-item--JB4Oj",originText:"origin-text--_F3JD",translateText:"translate-text--kw1UC",gptText:"gpt-text--uKOMP",freeText:"freeText--P_Kzm",textContent:"text-content--vOJK5",dialogWrapper:"dialog-wrapper--YkWHG"},ej=i(69761);class eJ extends o.PN{get S(){return g.S.Global.components.Paywalls.WebTranslateUpgradeDialog}get miniMode(){return this.maxWidth<this.defaultMinWidth}get exampleList(){return[{id:1,originText:"No hay mal que por bien no venga.",intelligentTrans:this.S.intelligentTrans1,basicTrans:this.S.basicTrans1},{id:2,originText:"M\xe1s vale tarde que nunca.",intelligentTrans:this.S.intelligentTrans2,basicTrans:this.S.basicTrans2},{id:3,originText:"En boca cerrada no entran moscas.",intelligentTrans:this.S.intelligentTrans3,basicTrans:this.S.basicTrans3}]}onViewCreate(){this.createUserBehaviorEvent("show"),ey.userController.eventEmitter.listenBy(this,"markPaid",()=>{var e,t;this.props.onDisposed(),null===(e=(t=this.props).onPaymentSuccessful)||void 0===e||e.call(t)}),this.maxWidth=Math.min(window.innerWidth-40,this.defaultMaxWidth),this.visible=!0,ej.f.webTranslationUpgradeDialogVisible=!0}onViewDestroy(){ey.userController.eventEmitter.stopListenBy(this),ej.f.webTranslationUpgradeDialogVisible=!1}createUserBehaviorEvent(e,t){h.M.createUserBehaviorEvent({eventName:"upgrade_popup_".concat(e),extData:{detail:"upgrade_draw",type:"ai_translate",button:t},source:this.props.source})}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"version","elite"),(0,d._)(this,"defaultMinWidth",840),(0,d._)(this,"defaultMaxWidth",1100),(0,d._)(this,"visible",!1),(0,d._)(this,"maxWidth",0)}}(0,c.gn)([o.SB],eJ.prototype,"visible",void 0),(0,c.gn)([o.SB],eJ.prototype,"maxWidth",void 0),(0,c.gn)([p.Fl],eJ.prototype,"S",null),(0,c.gn)([p.Fl],eJ.prototype,"miniMode",null),(0,c.gn)([p.Fl],eJ.prototype,"exampleList",null);let eK=o._Y.createComponent("WebTranslateUpgradeDialog",eJ,e=>{let{source:t,onDisposed:i}=e.props;return e.visible?(0,a.jsx)(n.u,{className:eG.webTranslateUpgradeDialog,wrapperClassName:eG.dialogWrapper,fixed:!0,onDispose:i,width:e.maxWidth,children:(0,a.jsxs)("main",{className:eG.main,children:[!e.miniMode&&(0,a.jsx)("div",{className:eG.left,children:(0,a.jsx)(eq,{vm:e})}),(0,a.jsxs)("div",{className:eG.right,children:[(0,a.jsx)("div",{className:eG.title,children:(0,a.jsx)(eg.Z,{S:e.S.planTitle,components:{b:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("b",{children:e}),(0,a.jsx)("br",{})]})}})}),(0,a.jsx)("div",{className:eG.more,children:e.S.moreFeatures}),(0,a.jsx)(eW.c,{type:"gpt4",source:t,onUpgradeClick:()=>{e.createUserBehaviorEvent("click","upgrade")},onViewClick:()=>{e.createUserBehaviorEvent("click","view")},showFullName:!0})]})]})}):null}),eq=(0,q.Pi)(function(e){let{vm:t}=e;return(0,a.jsxs)("div",{className:eG.translateExample,children:[(0,a.jsx)("div",{className:eG.title,children:t.S.translateCompareTitle}),(0,a.jsxs)("div",{className:eG.modelCompare,children:[(0,a.jsxs)("div",{className:eG.modelList,children:[(0,a.jsxs)("div",{className:K()(eG.modelItem,eG.gptItem),children:[(0,a.jsx)(eB.E,{src:(0,s.Q)(eH),className:eG.gptImage,alt:""}),t.S.intelligentTranslation]}),(0,a.jsx)("div",{className:eG.modelItem,children:t.S.basicTranslation})]}),(0,a.jsx)("div",{className:eG.exampleList,children:t.exampleList.map(e=>(0,a.jsxs)("div",{className:eG.exampleItem,children:[(0,a.jsxs)("div",{className:eG.originText,children:[(0,a.jsx)("span",{style:{color:"var(--theme-text-quaternary)"},children:t.S.originText}),e.originText]}),(0,a.jsxs)("div",{className:eG.translateText,children:[(0,a.jsxs)("div",{className:eG.gptText,children:[(0,a.jsx)("span",{className:eG.textContent,children:e.intelligentTrans}),(0,a.jsx)(ef.J,{name:"happyEmoji",size:20})]}),(0,a.jsxs)("div",{className:eG.freeText,children:[(0,a.jsx)("span",{className:eG.textContent,children:e.basicTrans}),(0,a.jsx)(ef.J,{name:"neutralEmoji",size:20})]})]})]},e.id))})]})]})}),eX=r.t.createOpener(eK);var eZ=i(1392),eY={translateUpgradeDialog:"translate-upgrade-dialog--f8Hfk",header:"header--UUZaw",mark:"mark--bIJwF",main:"main--pqsFC",left:"left--WI90k",upgradeCard:"upgrade-card--Nkoq3",right:"right--UQIv1",features:"features--bYzjf",featureItem:"feature-item--OTRsG",lt:"lt--dxf8P",rt:"rt--DRi6U",featureTitle:"feature-title--NnWvY",featureDesc:"feature-desc--JMBVY",plan:"plan--UFiDi",name:"name--ulU4v",discount:"discount--kQkSu",currentPrice:"current-price--xmB8Y",unit:"unit--Kj78h",originPrice:"origin-price--hal6q",trialTip:"trial-tip--BbVbD",footer:"footer--Wd_XI",hints:"hints--JyZlM",hint:"hint--_aN7y",actions:"actions--ag0tT",upgradeBtn:"upgrade-btn--qAYsp",viewBtn:"view-btn--BujHq",driver:"driver--vCuc7",title:"title--k2Wxx",translateExample:"translate-example--fWGcp",modelCompare:"model-compare--vGL1v",modelList:"model-list--yRarA",modelItem:"model-item--wOElZ",gptItem:"gpt-item--enIbG",gptImage:"gpt-image--HwfBt",exampleList:"example-list--eiJwZ",exampleItem:"example-item--xSIC0",originText:"origin-text--XiZwy",translateText:"translate-text--a6orm",gptText:"gpt-text--RHIL3",freeText:"freeText--OIX_i",textContent:"text-content--zpghJ"};class e$ extends o.PN{get S(){return g.S.Global.components.Paywalls.TranslateUpgradeDialog}get features(){return[{id:1,icon:"mPlanet",title:this.S.advancedModel,desc:this.S.advancedModelDesc},{id:2,icon:"mEarth",title:this.S.webAccess,desc:this.S.webAccessDesc},{id:3,icon:"mYoutube",title:this.S.youtubeSummary,desc:this.S.youtubeSummaryDesc},{id:4,icon:"mPen",title:this.S.createEffortlessly,desc:this.S.createEffortlesslyDesc},{id:5,icon:"fanyi3",title:this.S.translateTitle,desc:this.S.translateDesc}]}get exampleList(){return"en"===g.a.locale?[{id:4,gptModelText:this.S.gptModelText4,originText:"猫の手も借りたい",freeModelText:this.S.freeModelText4},{id:2,gptModelText:this.S.gptModelText5,originText:"井の中の蛙大海を知らず",freeModelText:this.S.freeModelText5},{id:3,gptModelText:this.S.gptModelText6,originText:"雨降って地固まる",freeModelText:this.S.freeModelText6}]:[{id:1,originText:"Let sleeping dogs lie.",gptModelText:this.S.gptModelText1,freeModelText:this.S.freeModelText1},{id:2,originText:"The ball is in your court.",gptModelText:this.S.gptModelText2,freeModelText:this.S.freeModelText2},{id:3,originText:"Don't count your chickens before they hatch.",gptModelText:this.S.gptModelText3,freeModelText:this.S.freeModelText3}]}get source(){return"translate_upgrade_dialog"}get currentFeatures(){return[1,2,3,4].flatMap(e=>this.features.find(t=>t.id===e)||[])}createUserBehaviorEvent(e,t){h.M.createUserBehaviorEvent({eventName:"translate_upgrade_popup_".concat(e),extData:{detail:"upgrade_dialog",button:t},source:this.source})}subscribe(){ey.userController.isFreeUser?A.u.gotoCheckoutForSubscribe({source:this.source,planKey:eL.serverConfigController.recommendPlan.key}):A.u.gotoPricingForSubscribe({source:this.source,planKey:eL.serverConfigController.getPlan("elite_yearly").key,autoPay:!0})}onViewCreate(){this.createUserBehaviorEvent("show"),ey.userController.eventEmitter.listenBy(this,"markPaid",()=>{this.props.onDisposed()})}onViewDestroy(){}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"version","elite"),(0,d._)(this,"someState",!1)}}(0,c.gn)([o.SB],e$.prototype,"someState",void 0),(0,c.gn)([p.Fl],e$.prototype,"S",null),(0,c.gn)([p.Fl],e$.prototype,"features",null),(0,c.gn)([p.Fl],e$.prototype,"exampleList",null);let e0=o._Y.createComponent("TranslateUpgradeDialog",e$,e=>{let{onDisposed:t}=e.props;return(0,a.jsxs)(n.u,{className:eY.translateUpgradeDialog,fixed:!0,onDispose:t,width:880,children:[(0,a.jsx)("header",{className:eY.header,children:(0,a.jsx)(eg.Z,{S:e.S.title,components:{span:e=>(0,a.jsx)("span",{className:eY.mark,children:e})}})}),(0,a.jsxs)("main",{className:eY.main,children:[(0,a.jsx)("div",{className:eY.left,children:(0,a.jsx)(e1,{vm:e})}),(0,a.jsx)(e5,{vm:e})]})]})}),e1=(0,q.Pi)(function(e){let{vm:t}=e;return(0,a.jsxs)("div",{className:eY.translateExample,children:[(0,a.jsx)("div",{className:eY.title,children:t.S.translateCompareTitle}),(0,a.jsxs)("div",{className:eY.modelCompare,children:[(0,a.jsxs)("div",{className:eY.modelList,children:[(0,a.jsxs)("div",{className:K()(eY.modelItem,eY.gptItem),children:[(0,a.jsx)(eB.E,{src:(0,s.Q)(eZ.Z),className:eY.gptImage,alt:""}),t.S.gpt4o]}),(0,a.jsx)("div",{className:eY.modelItem,children:t.S.freeModel})]}),(0,a.jsx)("div",{className:eY.exampleList,children:t.exampleList.map(e=>(0,a.jsxs)("div",{className:eY.exampleItem,children:[(0,a.jsxs)("div",{className:eY.originText,children:[(0,a.jsx)("span",{style:{color:"var(--theme-text-quaternary)"},children:t.S.originText}),e.originText]}),(0,a.jsxs)("div",{className:eY.translateText,children:[(0,a.jsxs)("div",{className:eY.gptText,children:[(0,a.jsx)("span",{className:eY.textContent,children:e.gptModelText}),(0,a.jsx)(ef.J,{name:"happyEmoji",size:20})]}),(0,a.jsxs)("div",{className:eY.freeText,children:[(0,a.jsx)("span",{className:eY.textContent,children:e.freeModelText}),(0,a.jsx)(ef.J,{name:"neutralEmoji",size:20})]})]})]},e.id))})]})]})}),e5=(0,q.Pi)(function(e){let{vm:t}=e,{monthlyDiscountPercent:i,price:o,moPrice:s,originMoPrice:n,fullName:r}=eL.serverConfigController.recommendPlan;return(0,a.jsxs)("div",{className:eY.right,children:[(0,a.jsxs)("div",{className:K()(eY.upgradeCard),children:[(0,a.jsx)("div",{className:eY.title,children:(0,g.x)(t.S.upgradeTitle,{plan:r})}),(0,a.jsx)("div",{className:eY.driver}),(0,a.jsx)("div",{className:eY.features,children:t.currentFeatures.map((e,t)=>(0,a.jsxs)("div",{className:K()(eY.featureItem),children:[(0,a.jsx)("div",{className:eY.lt,children:(0,a.jsx)(ef.J,{name:e.icon,size:16})}),(0,a.jsxs)("div",{className:eY.rt,children:[(0,a.jsx)("div",{className:eY.featureTitle,children:e.title}),(0,a.jsx)("div",{className:eY.featureDesc,children:e.desc})]})]},t))}),(0,a.jsxs)("div",{className:eY.plan,children:[(0,a.jsxs)("div",{className:eY.header,children:[(0,a.jsx)("div",{className:eY.name,children:r}),(0,a.jsx)("div",{className:eY.discount,children:(0,g.x)(t.S.discount,{discount:i})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:eY.currentPrice,children:(0,a.jsx)(eg.Z,{S:t.S.priceMonthly,components:{span:e=>(0,a.jsx)("span",{className:eY.unit,children:e})},data:{price:s}})}),(0,a.jsx)("div",{className:eY.originPrice,children:(0,a.jsx)(eg.Z,{S:t.S.priceMonthly,components:{span:e=>(0,a.jsx)("span",{children:e})},data:{price:n}})})]}),ev.promotionController.canTrial&&(0,a.jsx)("div",{className:eY.trialTip,children:(0,g.x)(t.S.trialTip,{price:o,day:eL.serverConfigController.trialDays})})]})]}),(0,a.jsxs)("div",{className:eY.footer,children:[ev.promotionController.canTrial&&(0,a.jsxs)("div",{className:eY.hints,children:[(0,a.jsxs)("div",{className:eY.hint,children:[(0,a.jsx)(ef.J,{name:"mChecked",size:16}),(0,g.x)(t.S.paymentToday,{price:ev.promotionController.trialPrice})]}),(0,a.jsxs)("div",{className:eY.hint,children:[(0,a.jsx)(ef.J,{name:"mChecked",size:16}),t.S.cancelAnytime]})]}),(0,a.jsxs)("div",{className:eY.actions,children:[(0,a.jsx)(l.z,{className:eY.upgradeBtn,type:"primary",shape:"round",size:"large",animation:"sheen",onClick:async()=>{t.createUserBehaviorEvent("click","upgrade"),t.subscribe()},children:ev.promotionController.subscribeButtonText}),(0,a.jsx)(l.z,{type:"text-primary",className:eY.viewBtn,onClick:()=>{t.createUserBehaviorEvent("click","view"),A.u.gotoPricingForSubscribe({source:t.source,hidDialog:!0})},children:t.S.viewAllPlans})]})]})]})}),e4=r.t.createOpener(e0);class e6 extends o.PN{constructor(...e){super(...e),(0,d._)(this,"props",void 0)}}var e3=JSON.parse('{"fill":"none","content":"\\n<rect x=\\"0.5\\" width=\\"28\\" height=\\"28\\" rx=\\"6\\" fill=\\"#262626\\"/>\\n<path d=\\"M9.31484 19.6293C7.97907 19.6293 6.71616 19.1106 5.79326 18.1473C4.84608 17.184 4.33606 15.9244 4.33606 14.5659C4.33606 13.2074 4.84608 11.923 5.79326 10.9844C6.74045 10.0211 7.97907 9.50238 9.31484 9.50238C10.6506 9.50238 11.9135 10.0211 12.8364 10.9844L18.0338 16.2701C18.4831 16.7271 19.0781 16.9741 19.6853 16.9741C20.3167 16.9741 20.8875 16.7147 21.3368 16.2701C21.7861 15.8132 22.0289 15.2081 22.0289 14.5906C22.0289 13.9484 21.7739 13.3679 21.3368 12.911C20.8875 12.454 20.2924 12.207 19.6853 12.207C19.0538 12.207 18.4831 12.4664 18.0338 12.911L17.5602 13.3926L15.6901 11.429L16.1637 10.9473C17.1109 9.98403 18.3495 9.46533 19.6853 9.46533C21.021 9.46533 22.284 9.98403 23.2069 10.9473C24.154 11.9106 24.6641 13.1703 24.6641 14.5288C24.6641 15.8873 24.154 17.1717 23.2069 18.1103C22.2597 19.0736 21.021 19.5923 19.6853 19.5923C18.3495 19.5923 17.0866 19.0736 16.1637 18.1103L10.9663 12.8863C10.517 12.4293 9.92201 12.1823 9.31484 12.1823C8.68339 12.1823 8.11265 12.4417 7.66334 12.8863C7.21404 13.3309 6.97117 13.9607 6.97117 14.5659C6.97117 15.2081 7.22618 15.7885 7.66334 16.2454C8.1005 16.7024 8.70767 16.9494 9.31484 16.9494C9.92201 16.9494 10.517 16.69 10.9663 16.2454L11.4399 15.7638L13.31 17.6657L12.8364 18.1473C11.9135 19.123 10.6506 19.6293 9.31484 19.6293Z\\" fill=\\"white\\"/>\\n\\n","viewBox":"0 0 29 28"}');let e2=o._Y.createComponent("UnlimitedBtnIcon",e6,e=>(0,a.jsx)(I.s,{...e.props,name:"UnlimitedBtnIcon",iconData:e3}));var e8=i(2343),e7={imageToolUpgradeDialog:"image-tool-upgrade-dialog--Jb71v",miniMode:"mini-mode--jtobk",main:"main--azHdz",right:"right--XYAwK",header:"header--Vgq6R",title:"title--NUF54",description:"description--dfDpP",left:"left--LTExU",dialogWrapper:"dialog-wrapper--Qiljq"};class e9 extends o.PN{get S(){return g.S.Global.components.Paywalls.ImageToolUpgradeDialog}get miniMode(){return this.maxWidth<this.defaultMinWidth}onViewCreate(){this.createUserBehaviorEvent("show"),ey.userController.eventEmitter.listenBy(this,"markPaid",()=>{var e,t;this.props.onDisposed(),null===(e=(t=this.props).onPaymentSuccessful)||void 0===e||e.call(t)}),this.maxWidth=Math.min(window.innerWidth-40,this.defaultMaxWidth),this.visible=!0,ej.f.webTranslationUpgradeDialogVisible=!0}onViewDestroy(){ey.userController.eventEmitter.stopListenBy(this),ej.f.webTranslationUpgradeDialogVisible=!1}createUserBehaviorEvent(e,t){h.M.createUserBehaviorEvent({eventName:"upgrade_popup_".concat(e),extData:{detail:"upgrade_draw",type:"image_tool",button:t},source:this.props.source})}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"version","elite"),(0,d._)(this,"defaultMinWidth",840),(0,d._)(this,"defaultMaxWidth",1100),(0,d._)(this,"visible",!1),(0,d._)(this,"maxWidth",0)}}(0,c.gn)([o.SB],e9.prototype,"visible",void 0),(0,c.gn)([o.SB],e9.prototype,"maxWidth",void 0),(0,c.gn)([p.Fl],e9.prototype,"S",null),(0,c.gn)([p.Fl],e9.prototype,"miniMode",null);let te=o._Y.createComponent("ImageToolUpgradeDialog",e9,e=>{let{source:t,onDisposed:i}=e.props;return e.visible?(0,a.jsxs)(n.u,{className:K()(e7.imageToolUpgradeDialog,{[e7.miniMode]:e.miniMode}),wrapperClassName:e7.dialogWrapper,fixed:!0,onDispose:i,width:e.maxWidth,children:[(0,a.jsx)(tt,{vm:e}),(0,a.jsxs)("main",{className:e7.main,children:[!e.miniMode&&(0,a.jsx)("div",{className:e7.left,children:(0,a.jsx)(e8.T,{modal:!1,insertTarget:"dialogRoot",onDisposed:()=>{},hideNoticeBtn:!0})}),(0,a.jsx)("div",{className:e7.right,children:(0,a.jsx)(eW.c,{type:"imageTool",source:t,onUpgradeClick:()=>{e.createUserBehaviorEvent("click","upgrade")},onViewClick:()=>{e.createUserBehaviorEvent("click","view")},showFullName:!0})})]})]}):null}),tt=(0,q.Pi)(e=>{let{vm:t}=e;return(0,a.jsxs)("div",{className:e7.header,children:[(0,a.jsxs)("div",{className:e7.title,children:[(0,a.jsx)(e2,{size:28}),t.S.unlimitedTitle]}),(0,a.jsx)("div",{className:e7.description,children:t.S.unlimitedDescription})]})}),ti=r.t.createOpener(te);var ta=i(53533),to=i(35850),ts={teamCreditsNotEnoughDialog:"team-credits-not-enough-dialog--XYiXK",header:"header--qaYbT",title:"title--ZdMpx",main:"main--tTlCC",desc:"desc--WtQOM",footer:"footer--xPKLD"},tn=i(18918);class tr extends o.PN{get S(){return g.S.Global.components.TeamCreditsNotEnoughDialog}get isTeamManager(){return tn.teamController.currentTeamInfo&&"member"!==tn.teamController.currentTeamInfo.roleType}onViewCreate(){}onViewDestroy(){}handleContactUs(){window.open("".concat(window.location.origin,"/mail"))}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"someState",!0)}}(0,c.gn)([o.SB],tr.prototype,"someState",void 0),(0,c.gn)([p.Fl],tr.prototype,"S",null),(0,c.gn)([p.Fl],tr.prototype,"isTeamManager",null);let tl=o._Y.createComponent("TeamCreditsNotEnoughDialog",tr,e=>(0,a.jsxs)(n.u,{className:ts.teamCreditsNotEnoughDialog,onDispose:e.props.onDisposed,width:400,children:[(0,a.jsx)("header",{className:ts.header,children:(0,a.jsx)("h5",{className:ts.title,children:e.S.title})}),(0,a.jsx)("main",{className:ts.main,children:(0,a.jsx)("div",{className:ts.desc,children:e.S.desc})}),e.isTeamManager?(0,a.jsxs)("footer",{className:ts.footer,children:[(0,a.jsx)(l.z,{type:"gray",className:ts.button,onClick:e.props.onDisposed,children:e.S.cancel}),(0,a.jsx)(l.z,{type:"default",color:"primary",className:ts.button,onClick:e.handleContactUs.bind(e),children:e.S.contactUs})]}):(0,a.jsx)("footer",{className:ts.footer,children:(0,a.jsx)(l.z,{type:"default",color:"primary",className:ts.button,onClick:e.props.onDisposed,children:e.S.gotIt})})]})),td=r.t.createOpener(tl,{singleton:!0});var tc=i(56607),th=i(60445),tg=i(37949),tp=i(28031),tA={teamLockedDialog:"team-locked-dialog--MyHUK",dialogTitle:"dialog-title--R5Ez_",dialogDesc:"dialog-desc--LP8eR",warning:"warning--LcRGq",footer:"footer--BTw1K",btn:"btn--j8zJE"};class tm extends o.PN{get S(){return g.S.Global.components.TeamLockedDialog}get days(){var e,t;let i=null===(e=ey.userController.userVipStatus)||void 0===e?void 0:e.teamLockExpires;return(null===(t=ey.userController.userVipStatus)||void 0===t?void 0:t.isLocked)?j.lT-Math.ceil(i/86400):0}onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,d._)(this,"props",void 0),(0,d._)(this,"resubscribing",!1)}}(0,c.gn)([o.SB],tm.prototype,"resubscribing",void 0),(0,c.gn)([o.Fl],tm.prototype,"S",null),(0,c.gn)([o.Fl],tm.prototype,"days",null);let tu=o._Y.createComponent("TeamLockedDialog",tm,e=>{let{insertTarget:t,onDisposed:i}=e.props,o=tn.teamController.hasManagePermission;return tc.o.isExtension&&!tg.w.visible?null:(0,a.jsxs)(n.u,{fixed:"dialogRoot"===t,width:tc.o.isExtension?360:390,onDispose:i,className:tA.teamLockedDialog,closeIconVisible:!1,closeOnMaskClick:!1,children:[(0,a.jsx)("div",{className:tA.dialogTitle,children:e.S.dialogTitle}),(0,a.jsx)("p",{className:tA.dialogDesc,children:o?e.S.dialogDescForAdmin:e.S.dialogDescForMember}),e.days>0&&(0,a.jsx)("p",{className:tA.warning,children:(0,g.x)(o?e.S.warningForAdmin:e.S.warningForMember,{days:e.days})}),(0,a.jsxs)("div",{className:tA.footer,children:[(0,a.jsx)(l.z,{type:o?"blackOutline":"primary",size:"medium",className:tA.btn,onClick:()=>{(0,tp.k)({insertTarget:t})},children:e.S.switchWorkspace}),o&&(0,a.jsx)("a",{href:Y.m.genFullUrl(Y.m.genUrl(th.Cl.team,{source:"lock",dialog:"upgrade"})),target:"_blank",children:(0,a.jsx)(l.z,{type:"primary",size:"medium",className:tA.btn,children:e.S.resubscribe})})]})]})}),tf=r.t.createOpener(tu);var ty=i(18245),tv=i(44015),tw=i(39744);let tC=()=>{ey.userController.setViews({openInstallGuideDialog:em,openLoginDialog:C.Z,openHitLimitAlertDialog:w,openUpgradeDialog:to.$,openResubscribeDialog:eu.j,openBasicQueryCountdownDialog:eT,openUnlimitedQueryOverLimitDialog:eM,openDeviceExceededLimitDialog:tw.q,openTeamLockedDialog:tf}),ty.K.setViews({openUpgradeDialog:to.$,openBuyCreditsDialog:ez,openResubscribeDialog:eu.j,openWebTranslateUpgradeDialog:eX,openQuickACtionTranslateUpgradeDialog:e4,openImageToolUpgradeDialog:ti,openTeamCreditsNotEnoughDialog:td,openSeoInstallGuideDialog:ta.A}),tv.$.setViews({openLinkCopiedDialog:b.u}),tn.teamController.setViews({openCreateTeamDialog:ed.L,openBuySeatDialog:el.M}),W.imageController.setViews({openCropper:er})}},44795:function(e,t,i){"use strict";i.d(t,{c:function(){return h}});var a=i(56607),o=i(90180),s=i(14622),n=i(14527),r=i(1),l=i(56639),d=i(55343);let c={extensionBackground:s.u,extensionContent:n.Y,extensionSidePanel:r.d,web:d.T};function h(e){let{name:t,channels:i,handler:s}=e;return i.forEach(e=>{"desktop"!==e&&c[e].addListener({name:t,handler:s})}),async function(e,d,h){let g=null!=h?h:(0,l.P)(),p={tabId:e.tabId,name:t,data:e,origin:g};if(a.o.isWeb&&i.includes("web")||a.o.isDesktop&&i.includes("desktop")||"ext-side-panel"===a.o.entryType&&i.includes("extensionSidePanel")||a.o.isBackground&&i.includes("extensionBackground"))return s(e,d,g);if("ext-sidebar"===a.o.entryType&&i.includes("extensionContent"))return o.A.chromeSidePanelEnabled&&i.includes("extensionSidePanel")?r.d.sendMessage(p):n.Y.sendMessage(p);for(let e of i)if("desktop"!==e)return c[e].sendMessage(p)}}},47701:function(e,t,i){"use strict";var a,o,s,n;i.d(t,{R:function(){return a}}),(s=(o=a||(a={})).IframeMessage||(o.IframeMessage={})).ARTIFACT="monica-artifact",s.REFRESH="monica-refresh",s.THEME_CHANGE="monica-theme-change",s.GET_USER_INFO="monica-get-user-info",s.SWITCH_TO_ADVANCED_MODEL="monica-switch-to-advanced-model",s.TRY_FIX_ERROR="monica-try-fix-error",s.GET_MODEL="monica-get-model",s.PREVIEW_MODE="monica-preview-mode",(n=o.UserEvent||(o.UserEvent={})).CREATED="artifact_created",n.COPY="artifact_copy_click",n.DOWNLOAD="artifact_download_click",n.ADVANCED_MODEL_CLICK="artifact_advanced_model_click",n.PREVIEW_DIALOG_AUTO_OPEN_SWITCH="artifact_preview_dialog_auto_open_switch",n.REFRESH="artifact_refresh_click",n.FULLSCREEN="artifact_fullscreen_click",n.CLOSE="artifact_close_click",n.PUBLISH="artifact_publish_click",n.TRY_FIX_ERROR="artifact_try_fix_error_click",n.PUBLISH_AND_COPY="artifact_publish_and_copy_click",n.COPY_SHARE_LINK="artifact_copy_share_link_click",n.VIEW_NOW="artifact_view_now_click",n.UNPUBLISHED="artifact_unpublished_click",n.SHARE_CONV="artifact_share_conv_click",n.SHARE_CONV_SHOW="artifact_share_conv_show",n.CONTINUE_IN_CHAT="artifact_share_conv_continue_in_chat_click",n.VERSION_SWITCH="artifact_version_switch",n.UNSTAR="artifact_unstar_click",n.STAR="artifact_star_click",n.WIDGET_CLOSE="artifact_widget_close_click",n.WIDGET_REFRESH="artifact_widget_refresh_click",n.PUBLISHED_ARTIFACT_CREATE="artifact_published_artifact_create_click",n.TAB_CHANGE="artifact_tab_change",n.SKILL_CARD_STAR="artifact_skill_card_star_click",n.CONVERT_TO_WIDGET="artifact_convert_to_widget_click",n.WIDGET_CONTINUE_EDIT="artifact_widget_continue_edit_click",n.WIDGET_PUBLISH="artifact_widget_publish_click",n.WIDGET_OPEN="artifact_widget_open_click",n.FULLSCREEN_PREVIEW="artifact_fullscreen_preview_click"},2343:function(e,t,i){"use strict";i.d(t,{T:function(){return T},X:function(){return k}});var a=i(71576),o=i(34491),s=i(4461),n={src:"https://assets.monica.im/home-web/_next/static/media/step1.878bc2e4.png",height:1164,width:1360,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAASFBMVEVylcJOaIeXrNHHy9d2nMdUb5mftdNskcB5nMuGn79hbKc4SleSqcmaoqrg2+MnMDqutb/FwOBgQ4s5SW23rtZHLXy6v9CHm8XxYIfhAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOUlEQVR4nDXBxwHAIAwDQAEG2XRSYP9N88od8CNFVEEkn6NzlhDWdZfSNkYLs/fnRbRq1Z8MBUlCPiwVAbb8B5S+AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:7},r={src:"https://assets.monica.im/home-web/_next/static/media/step2.c0ac7a9a.png",height:1164,width:1360,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAARVBMVEVYkKTEeoeEj6COi5xUfZGWiJd7laNRkaVglKYTFTNLgpcrQl1BcIihdXbAhYlUhpotUWvHg494T1uWgoQpPFd+T1uUdnnE3B//AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOElEQVR4nAXBhQHAMAzAMBdCxfH/p04Cdq0NQEWkZLCc0pmKYf1d6zqMGjFnRMPG8919AO6qbv4DLUMBtaV2uigAAAAASUVORK5CYII=",blurWidth:8,blurHeight:7},l={src:"https://assets.monica.im/home-web/_next/static/media/step3.125d0101.png",height:1164,width:1360,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAAM1BMVEVzt9je6/LT5/C10OHr8POFwN2/3ux5utv49/drrtJemr+ryN+jssRonrwxWIBpo8QlR3MrsTFUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAANklEQVR4nDXBxxHAMAwDMMpWId2S/afN5WEAuOoHFJJuUZFodA+po5HEeSfSzfpaE5LG3s/4AB4FAU5HNjP7AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:7},d={src:"https://assets.monica.im/home-web/_next/static/media/step4.fb5d4eec.png",height:1164,width:1360,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAAV1BMVEVcjdWDpc1Wa4pITFxoa3KMjpRYidFShtVRgs5jj9OYeW6llpRKgNOXvNdwkrZrfrFpnsMvYY9rZGBVW45bfZx3gJJmdZOTprZ/XlJyhp4pRWUlMkYWIzmZmlJ0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPElEQVR4nAXBBwKAIAwAsWOUlqG49//faYKBmiXAUs4AfZqXOA6OdXu+15+O/So1iBzcpUqI0ZPRptb0Bz79Ah0UH6WbAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:7},c=i(78716),h=i.n(c),g=i(58812),p=i(66084);class A extends o.PN{constructor(...e){super(...e),(0,p._)(this,"props",void 0)}}var m=JSON.parse('{"fill":"none","content":"\\n<g id=\\"elements\\">\\n<path id=\\"Vector 6905\\" d=\\"M1.5 11L5.91074 6.58926C6.18852 6.31148 6.32741 6.17259 6.32741 6C6.32741 5.82741 6.18852 5.68852 5.91074 5.41074L1.5 1\\" stroke=\\"white\\" stroke-width=\\"1.25\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\"/>\\n</g>\\n\\n","viewBox":"0 0 7 12"}');let u=o._Y.createComponent("ImageArrowRightIcon",A,e=>(0,a.jsx)(g.s,{...e.props,name:"ImageArrowRightIcon",iconData:m}));class f extends o.PN{constructor(...e){super(...e),(0,p._)(this,"props",void 0)}}var y=JSON.parse('{"fill":"none","content":"\\n<g id=\\"Fill/1.&#230;&#147;&#141;&#228;&#189;&#156;/&#229;&#143;&#145;&#233;&#128;&#129;\\">\\n<path id=\\"Vector 9\\" d=\\"M14.0063 3.16179L4.15735 6.70327C2.653 7.24421 1.90082 7.51468 1.87517 8.03509C1.84953 8.5555 2.57146 8.89861 4.01534 9.58483L4.01535 9.58483L8.00626 11.4816L8.00627 11.4816C8.24831 11.5966 8.36933 11.6541 8.46305 11.7463C8.55676 11.8384 8.6163 11.9585 8.73536 12.1986L10.6588 16.0769C11.3571 17.485 11.7063 18.1891 12.2225 18.1586C12.7387 18.1282 13.0026 17.3879 13.5304 15.9073L17.007 6.15426C17.7281 4.13147 18.0886 3.12007 17.5631 2.59595C17.0375 2.07183 16.0271 2.43515 14.0063 3.16179Z\\" fill=\\"#6841EA\\"/>\\n</g>\\n\\n","viewBox":"0 0 20 20"}');let v=o._Y.createComponent("SendIcon",f,e=>(0,a.jsx)(g.s,{...e.props,name:"SendIcon",iconData:y}));var w=i(68104),C=i(82005),b={onboarding:"onboarding--XbfVZ",noModal:"no-modal--UJ_Xs",content:"content--EacuL",imageList:"image-list--VIO11",image:"image--YFb4A",active:"active--P2VC6",top:"top--gW4YW",header:"header--hWsdM",title:"title--fJrf_",stepControl:"step-control--SUV8R",step:"step--L9MlF",disabled:"disabled--dblhY",desc:"desc--lcD_l",bottom:"bottom--bGiRV",mockInput:"mock-input--MyHnR",text:"text--YbpME",sendBtn:"send-btn--JkrkQ",closeBtn:"close-btn--rtscp"},S=i(52921),I=i(88882);class _ extends o.PN{get S(){return I.S.Global.modules.ImageView}get stepTexts(){return 0===this.step?{title:this.S.onboarding.step1Title,desc:this.S.onboarding.step1Desc}:1===this.step?{title:this.S.onboarding.step2Title,desc:this.S.onboarding.step2Desc}:2===this.step?{title:this.S.onboarding.step3Title,desc:this.S.onboarding.step3Desc}:{title:this.S.onboarding.step4Title,desc:this.S.onboarding.step4Desc}}onViewCreate(){}onViewDestroy(){}constructor(...e){super(...e),(0,p._)(this,"props",void 0),(0,p._)(this,"step",0)}}(0,S.gn)([o.SB],_.prototype,"step",void 0),(0,S.gn)([o.Fl],_.prototype,"S",null),(0,S.gn)([o.Fl],_.prototype,"stepTexts",null);let T=o._Y.createComponent("Onboarding",_,e=>{let{title:t,desc:i}=e.stepTexts,o=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:b.imageList,children:[n,r,l,d].map((t,i)=>(0,a.jsx)("img",{src:(0,s.Q)(t),className:h()(b.image,{[b.active]:i===e.step})},i))}),(0,a.jsxs)("div",{className:b.content,children:[(0,a.jsxs)("div",{className:b.top,children:[(0,a.jsxs)("div",{className:b.header,children:[(0,a.jsx)("div",{className:b.title,children:t}),(0,a.jsxs)("div",{className:b.stepControl,children:[(0,a.jsx)("div",{className:h()(b.step,{[b.disabled]:0===e.step}),onClick:()=>{e.step>0&&(e.step-=1)},children:(0,a.jsx)(u,{color:"currentColor",size:14,style:{transform:"rotate(180deg)"}})}),(0,a.jsx)("div",{className:h()(b.step,{[b.disabled]:3===e.step}),onClick:()=>{e.step<3&&(e.step+=1)},children:(0,a.jsx)(u,{color:"currentColor",size:14})})]})]}),(0,a.jsx)("div",{className:b.desc,children:i})]}),(0,a.jsxs)("div",{className:b.bottom,children:[1===e.step&&(0,a.jsxs)("div",{className:b.mockInput,children:[(0,a.jsx)("div",{className:b.text,children:e.S.onboarding.step2Input}),(0,a.jsx)("div",{className:b.sendBtn,children:(0,a.jsx)(v,{size:20})})]}),!e.props.hideNoticeBtn&&(0,a.jsx)("div",{className:b.closeBtn,onClick:()=>{e.props.onDisposed()},children:e.S.onboarding.confirmInformation})]})]})]});return e.props.modal?(0,a.jsx)(w.u,{width:e.props.width,style:{height:e.props.height},className:b.onboarding,closeIconVisible:!1,onDispose:e.props.onDisposed,children:o}):(0,a.jsx)("div",{className:h()(b.onboarding,b.noModal),children:o})}),k=C.t.createOpener(T,{singleton:!0})},39744:function(e,t,i){"use strict";i.d(t,{q:function(){return f}});var a=i(71576),o=i(34491),s=i(68104),n=i(5857),r=i(82005),l=i(92020),d=i(95782),c=i(66084),h=i(52921),g=i(88882),p=i(73047),A=i(38172);class m extends o.PN{get S(){return g.S.Global.modules.MainWindow.DeviceExceededLimitDialog}onViewCreate(){}onViewDestroy(){}closeAndLogout(){A.W.logout(),this.props.onDisposed()}constructor(...e){super(...e),(0,c._)(this,"props",void 0),(0,c._)(this,"someState",!0)}}(0,h.gn)([o.SB],m.prototype,"someState",void 0),(0,h.gn)([p.Fl],m.prototype,"S",null);let u=o._Y.createComponent("DeviceExceededLimitDialog",m,e=>(0,a.jsxs)(s.u,{className:"device-exceeded-limit-dialog--Wdpik",onDispose:e.closeAndLogout.bind(e),fixed:"dialogRoot"===e.props.insertTarget,closeOnMaskClick:!1,width:420,children:[(0,a.jsx)("div",{className:"title--JVeuy",children:e.S.title}),(0,a.jsx)("div",{className:"description--W7OZP",children:(0,a.jsx)("span",{children:(0,a.jsx)(d.Z,{S:e.S.description,components:{br:()=>(0,a.jsx)("br",{})}})})}),(0,a.jsxs)("div",{className:"footer--R6RBm",children:[(0,a.jsx)(n.z,{type:"primaryOutline",className:"contact-button--iryNw",onClick:()=>{l.ll.openMonicaOptionsPage({menuKey:"contactUs"}),e.closeAndLogout()},children:e.S.contactSupport}),(0,a.jsx)(n.z,{type:"primary",className:"got-button--WFSdZ",onClick:e.closeAndLogout.bind(e),children:e.S.gotIt})]})]})),f=r.t.createOpener(u,{singleton:!0})},514:function(e,t,i){"use strict";i.d(t,{w:function(){return p}});var a=i(66084),o=i(52921),s=i(34491),n=i(92235),r=i(88882),l=i(20978),d=i(73047),c=i(15851),h=i(38795),g=i(55272);class p{get noteInfo(){return this.parent.memoDataSources.find(e=>e.uid===this.docId)}async initNotInfo(){this.status="loading";try{let e=await h.R.info({uid:this.docId});if(e){this.isPublic=e.data.item.publicShare,this.shareUid=e.data.item.shareUid,this.updatedAt=e.data.item.updatedAt,this.createdAt=e.data.item.createdAt,this.memoUserId=e.data.item.userId,this.docId=e.data.item.uid,this.title=e.data.item.title;let t=(e.data.item.tags||[]).map(e=>e.id);this.parent.updateTagInMemoRelations(this.docId,t),e.data.writable?this.status="editable":e.data.readable?this.status="readonly":this.status="noAuth"}}catch(e){this.status="error"}}handleConnect(){this.editorLoading=!1}handleUpdated(e){this.handleUpdatedDebounced(e)}handleShare(){n.m.copyToClipboard(n.m.genUrl("".concat(n.m.getWebOrigin(),"/webapp/memo/detail"),{id:this.shareUid})),this.parent.sendEvent("memo_action_click",{button:"memo_header_share_link_copy",shareUid:this.shareUid}),c.M.success(r.S.Agent.AgentShare.copied)}handlePublicChange(){this.isPublic=!this.isPublic,h.R.setShareConfig({uid:this.docId,public:this.isPublic})}constructor(e,t,i=!1){(0,a._)(this,"parent",void 0),(0,a._)(this,"docId",void 0),(0,a._)(this,"isPublic",void 0),(0,a._)(this,"shareUid",void 0),(0,a._)(this,"updatedAt",void 0),(0,a._)(this,"createdAt",void 0),(0,a._)(this,"title",void 0),(0,a._)(this,"status",void 0),(0,a._)(this,"memoUserId",void 0),(0,a._)(this,"editorLoading",void 0),(0,a._)(this,"fromNewMemo",void 0),(0,a._)(this,"handleUpdatedDebounced",void 0),this.parent=e,this.docId="",this.isPublic=!0,this.shareUid="",this.updatedAt=0,this.createdAt=0,this.title="",this.status="loading",this.memoUserId=null,this.editorLoading=!0,this.fromNewMemo=!1,this.handleUpdatedDebounced=(0,l.Z)(e=>{let t=g.r.getMemoListRenderData(e),i=this.noteInfo;this.updatedAt=Date.now(),this.title=(null==i?void 0:i.title)||"",i&&((null==i?void 0:i.status)==="complete"||!i.status)&&(i.description=t,h.R.update({status:"complete",...i,updatedAt:Date.now()}))},300,{maxWait:500,trailing:!0}),(0,d.rC)(this),this.docId=t,this.fromNewMemo=i}}(0,o.gn)([s.SB],p.prototype,"docId",void 0),(0,o.gn)([s.SB],p.prototype,"isPublic",void 0),(0,o.gn)([s.SB],p.prototype,"shareUid",void 0),(0,o.gn)([s.SB],p.prototype,"updatedAt",void 0),(0,o.gn)([s.SB],p.prototype,"createdAt",void 0),(0,o.gn)([s.SB],p.prototype,"title",void 0),(0,o.gn)([s.SB],p.prototype,"status",void 0),(0,o.gn)([s.SB],p.prototype,"memoUserId",void 0),(0,o.gn)([s.SB],p.prototype,"editorLoading",void 0),(0,o.gn)([d.Fl],p.prototype,"noteInfo",null)},55272:function(e,t,i){"use strict";i.d(t,{r:function(){return n}});var a=i(39936),o=i(11985);class s{getMemoListRenderData(e){let t={type:"common",title:"",summary:""},i="";this.traverseNode(e,e=>("p"===e.type||"heading"===e.type||"listItem"===e.type||"todo"===e.type||"codeBlock"===e.type)&&(i=this.getNodeTextContent([e]),t.title=i,!0));let a=null;if(this.traverseNode(e,e=>"embed"===e.type&&(a=e.embedData,!0)),a){let e=a;if(t.type=e.type,"quickAction"===e.type)t.meta={quickActionIcon:e.icon,quickActionName:e.name},t.title=e.selectedText||t.title.trim(),t.summary=e.result;else if("imageSummary"===e.type)t.bannerImgUrl=e.url,t.summary=e.summary,t.title=o.P.shortTextForTitle(e.summary);else if("mark"===e.type){let i=[e,...e.extraEmbedMarkItems||[]];t.title=e.title.trim()||e.content||t.title.trim(),t.meta={originalUrl:e.baseUrl||e.url,firstMarkContent:i[0].content,markId:e.markId},t.summary=i.reduce((e,t)=>e+="".concat(t.content,"\n"),"")}else if("searchEnhance"===e.type)t.title=e.question||t.title.trim(),e.answer&&(t.summary=e.answer),e.suggestions&&(t.summary+=e.suggestions.map(e=>"".concat(e.question,"\n").concat(e.answer)).join("\n"));else if("translate"===e.type)t.title=t.title.trim(),t.summary=e.translatedContent;else if("twitter"===e.type)t.title=[e.userName,e.tagName].filter(e=>!!e).join("\n"),t.summary=e.articleText||"";else if("chat"===e.type)t.title=e.title||"",t.meta={chatData:{chatItems:e.chatItems,originConversationId:e.originConversationId}};else if("commonTranslate"===e.type)t.title=e.input,t.summary=e.detail,t.type="translate";else if("pdfReading"===e.type||"readingSummary"===e.type||"videoSummary"===e.type)t.title=e.originalTitle||t.title.trim(),t.summary=e.summary,t.bannerImgUrl=e.bannerImgUrl,t.meta={originalUrl:e.originalUrl};else if("quickActionTranslate"===e.type)t.title=e.input,t.summary=e.detail;else if("audioToText"===e.type){var s,n,r,l,d;t.title=e.audioName,(null===(s=e.transcription)||void 0===s?void 0:s.length)?t.summary=(null===(n=e.transcription[0])||void 0===n?void 0:n.text)||"":e.summary?e.summary.summary?t.summary=e.summary.summary:(null===(r=e.summary.reviews)||void 0===r?void 0:r.length)?t.summary=(null===(d=e.summary)||void 0===d?void 0:null===(l=d.reviews[0])||void 0===l?void 0:l.text)||"":e.summary.keywords.length&&(t.summary=e.summary.keywords.join(", ")):e.mindmap&&(t.summary=e.mindmap)}}else{let a=this.getNodeTextContent(e);t.summary=this.getNodeTextContent(e),a.startsWith(i)&&(t.summary=a.slice(i.length))}return t.bannerImgUrl||a||this.traverseNode(e,e=>"image"===e.type&&(t.bannerImgUrl=e.src,!0)),t}getNodeTextContent(e){let t="";return this.traverseNode(e,e=>(e.type&&"text"!==e.type?this.isBlock(e)&&"group"!==e.type&&(t+=" "):t+=e.text,!1)),t}getMentionContent(e){let t=[],i=0,a=!0;return this.traverseNode(e,e=>("mention"===e.type?(t.push({type:"reference",value:e.mentionId}),i=t.length):e.type&&"text"!==e.type?this.isBlock(e)&&(a||(t[i]||(t[i]={type:"string",value:""}),t[i].value+="\n"),a=!1):(t[i]||(t[i]={type:"string",value:""}),t[i].value+=e.text),!1),!0),t.filter(e=>!!e.value)}getAllEmbedTextContent(e){let t="";return this.traverseNode(e,e=>{if("embed"===e.type){let o=e.embedData;if("imageSummary"===o.type)t=[o.summary,o.ocrContent].join("\n");else if("pdfReading"===o.type||"readingSummary"===o.type||"videoSummary"===o.type)t=[o.summary,o.originalTitle].join("\n");else if("quickAction"===o.type)t=[o.name,o.selectedText,o.result].join("\n");else if("searchEnhance"===o.type){var i;t=[o.question,o.answer,null===(i=o.suggestions)||void 0===i?void 0:i.map(e=>"".concat(e.answer," ").concat(e.question))].join("\n")}else"mark"===o.type?t=[...[o,...o.extraEmbedMarkItems||[]].map(e=>e.content).filter(e=>!!e),o.baseUrl||o.url].join("\n"):"twitter"===o.type?t=[o.userName,o.tagName,o.articleText].filter(e=>!!e).join("\n"):"chat"===o.type&&(t=(o.title||"")+a.C.summaryChatItems(o.chatItems))}return!1}),t}convertEditorDataToMarkdown(e){return e.map(e=>this.convertNodeToMarkdown(e,0)).join("\n\n")}traverseNode(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let a=0;a<e.length;a++){let o=e[a];if(t(o)){if(i)continue;return!0}if("text"!==o.type&&o.type&&this.traverseNode(o.children,t,i))return!0}return!1}isBlock(e){return"text"!==e.type&&"link"!==e.type&&"mention"!==e.type}convertNodeToMarkdown(e,t){return"text"!==e.type&&e.type?"p"===e.type?e.children.map(e=>this.convertNodeToMarkdown(e,t)).join(""):"heading"===e.type?"".concat("#".repeat(e.level)," ").concat(e.children.map(e=>this.convertNodeToMarkdown(e,t)).join("")):"codeBlock"===e.type?"```"+"\n".concat(e.children.map(e=>this.convertNodeToMarkdown(e,t)).join(""),"\n")+"```":"listItem"===e.type?"".concat(e.ordered?"1.":"-"," ").concat(e.children.map(e=>this.convertNodeToMarkdown(e,t)).join("")):"quote"===e.type?"> ".concat(e.children.map(e=>this.convertNodeToMarkdown(e,t)).join("")):"todo"===e.type?"- [".concat(e.checked?"x":" ","] ").concat(e.children.map(e=>this.convertNodeToMarkdown(e,t)).join("")):"link"===e.type?"[".concat(e.children.map(e=>this.convertNodeToMarkdown(e,t)).join(""),"](").concat(e.url,")"):"embed"===e.type||"image"===e.type||"youtubeVideo"===e.type||"video"===e.type?"":"group"===e.type?e.children.map((e,i)=>0===i?this.convertNodeToMarkdown(e,t):"".concat("  ".repeat(t+1)).concat(this.convertNodeToMarkdown(e,t+1))).join("\n\n"):"":e.bold?"**".concat(e.text,"**"):e.italic?"*".concat(e.text,"*"):e.underline?"__".concat(e.text,"__"):e.code?"`".concat(e.text,"`"):e.strikethrough?"~~".concat(e.text,"~~"):e.subscript?"<sub>".concat(e.text,"</sub>"):e.superscript?"<sup>".concat(e.text,"</sup>"):e.text}}let n=new s},11985:function(e,t,i){"use strict";i.d(t,{P:function(){return h}});var a=i(67061),o=i(56607),s=i(97392);let n=null;class r{convertHtmlToMarkdown(e){return(n||((n=new s.Z).addRule("img",{filter:["img"],replacement:(e,t)=>{let i=t.getAttribute("data-src")||t.getAttribute("src")||"";return""===i||i.startsWith("data:")?"":"![".concat(t.getAttribute("alt")||"","](").concat(i,")")}}),(e=>{e.addRule("heading",{filter:["h1","h2","h3","h4","h5","h6"],replacement:(e,t)=>{let i=t.nodeName.replace("H","");return"".concat("#".repeat(+i)," ").concat(e,"\n")}})})(n)),n).turndown(e)}}var l=i(30884),d=i.n(l);class c{getSelectionRect(){if(o.o.isExtension&&"sidebar"===a.L.mainWindowMode){let e=document.getSelection();return null==e?void 0:e.getRangeAt(0).getBoundingClientRect()}let e=window.getSelection();return null==e?void 0:e.getRangeAt(0).getBoundingClientRect()}isUrl(e){return d()(e)}pipe(e){for(var t=arguments.length,i=Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];return i.reduce((e,t)=>t(e),e)}isMac(){return/macintosh|mac os x/i.test(navigator.userAgent)}displayHotkey(e){return e.replace(/mod/,this.isMac()?"command":"ctrl")}transformFileSize(e){if(0===e||null==e||"number"!=typeof e)return"0 Bytes";let t=0,i=parseFloat("".concat(e));return t=Math.floor(Math.log(i)/Math.log(1024)),(i/Math.pow(1024,t)).toFixed(2)+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][t]}downloadFile(e,t){fetch(e).then(e=>e.blob()).then(i=>{let a=document.createElement("a"),o=URL.createObjectURL(i);a.href=o,a.download=t,a.click(),window.URL.revokeObjectURL(e)})}toJS(e){return JSON.parse(JSON.stringify(e))}convertHtmlToMarkdown(e){return new r().convertHtmlToMarkdown(e)}shortTextForTitle(e){return e.length>30?"".concat(e.slice(0,30),"..."):e}}let h=new c},41884:function(e,t,i){"use strict";i.d(t,{E:function(){return h}});var a=i(66084),o=i(52921),s=i(34491),n=i(92235),r=i(73047),l=i(1340);i(75087);class d{get resizeTouchArea(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.resizeTouchArea)&&void 0!==t?t:10}get layoutStyle(){let{width:e,height:t,left:i,top:a}=this.getRect(),o={width:e,height:t};return"panel"!==this.openWindowOptions.displayMode&&(o.position="fixed",o.transform="translate(".concat(i,"px, ").concat(a,"px)"),o.zIndex=this.zIndex),this.containerCreated||(o.opacity=0),this.dragging&&(o.cursor="grabbing"),o}get containerEvents(){return{onPointerDown:this.handleContainerPointerDown.bind(this),onPointerMove:this.handleContainerPointerMove.bind(this),onPointerUp:this.handleContainerPointerUp.bind(this)}}init(e){this.options=e,e.initData&&(this.width=e.initData.width,this.height=e.initData.height),e.container&&(this.container=e.container,setTimeout(()=>{this.initWindowPosition(),this.containerCreated=!0})),window.addEventListener("resize",this.handleWindowResize)}destroy(){window.removeEventListener("resize",this.handleWindowResize),this.container=null,this.containerCreated=!1}handleContainerPointerDown(e){if(!this.container)return;this.windowId!==this.parent.activeWindowId&&(this.parent.setActiveWindowId(this.windowId),d.zIndexCounter+=1,this.zIndex=d.zIndexCounter);let t=e.target,i=!0;for(;t!==e.currentTarget;){if("false"===t.getAttribute("data-draggable")){i=!1;break}if(null===t.parentElement)break;t=t.parentElement}i&&(e.currentTarget.setPointerCapture(e.pointerId),e.stopPropagation(),e.preventDefault(),this.dragging=!0)}handleContainerPointerMove(e){if(!this.dragging||!this.container)return;let{width:t,height:i,left:a,top:o}=this.getRect(),s=e.movementX,n=e.movementY,r=a+s,l=o+n,d=window.innerWidth,c=window.innerHeight;r=Math.max(0,Math.min(r,d-t)),l=Math.max(0,Math.min(l,c-i)),this.left=r,this.top=l,r!==a&&(this.adjustMaxLeft=-1),l!==o&&(this.adjustMaxTop=-1),this.dragged=!0,e.stopPropagation()}handleContainerPointerUp(e){e.currentTarget.releasePointerCapture(e.pointerId),e.stopPropagation(),this.dragging=!1,this.emitDataChange()}handleResizeBinderPointerDown(e,t){e.stopPropagation(),e.preventDefault(),e.currentTarget.setPointerCapture(e.pointerId),this.resizing=!0}handleResizeBinderPointerUp(e,t){e.currentTarget.releasePointerCapture(e.pointerId),this.resizing=!1,this.emitDataChange()}handleResizeBinderPointerMove(e,t){if(!this.resizing||!this.container)return;let{width:i,height:a,top:o,left:s}=this.getRect();if(this.width=i,this.height=a,"bottom"===t){let t=Math.min(e.clientY,window.innerHeight);this.height=this.getHeight(t-o)}else if("top"===t){let t=Math.max(e.clientY,0),i=this.getHeight(a+o-t);this.top=o+a-i,this.height=i}else if("right"===t){let t=Math.min(e.clientX,window.innerWidth);this.width=this.getWidth(t-s)}else if("left"===t){let t=Math.max(e.clientX,0),a=this.getWidth(i+s-t);this.left=s+i-a,this.width=a}else if("topLeft"===t){let t=Math.max(e.clientY,0),n=this.getHeight(a+o-t);this.top=o+a-n,this.height=n;let r=Math.max(e.clientX,0),l=this.getWidth(i+s-r);this.left=s+i-l,this.width=l}else if("topRight"===t){let t=Math.max(e.clientY,0),i=this.getHeight(a+o-t);this.top=o+a-i,this.height=i;let n=Math.min(e.clientX,window.innerWidth);this.width=this.getWidth(n-s)}else if("bottomLeft"===t){let t=Math.min(e.clientY,window.innerHeight);this.height=this.getHeight(t-o);let a=Math.max(e.clientX,0),n=this.getWidth(i+s-a);this.left=s+i-n,this.width=n}else if("bottomRight"===t){let t=Math.min(e.clientY,window.innerHeight);this.height=this.getHeight(t-o);let i=Math.min(e.clientX,window.innerWidth);this.width=this.getWidth(i-s)}this.left!==s&&(this.adjustMaxLeft=-1),this.top!==o&&(this.adjustMaxTop=-1),this.resized=!0}handleContainerContentChange(e){if(!e||this.resized)return;let t=e.scrollHeight-e.clientHeight;t>0&&(this.height=this.getHeight(this.height+t+8),this.height+this.top>window.innerHeight&&(this.top=Math.max(0,window.innerHeight-this.height)))}getResizeBinderStyle(e){let t=this.resizeTouchArea,i={position:"absolute",zIndex:2,background:"transparent"};return"top"===e?(i.cursor="ns-resize",i.top=-t/2,i.left=0,i.right=0,i.height=t):"bottom"===e?(i.cursor="ns-resize",i.bottom=-t/2,i.left=0,i.right=0,i.height=t):"left"===e?(i.cursor="ew-resize",i.top=0,i.bottom=0,i.left=-t/2,i.width=t):"right"===e?(i.cursor="ew-resize",i.top=0,i.bottom=0,i.right=-t/2,i.width=t):"topLeft"===e?(i.cursor="nwse-resize",i.top=-t/2,i.left=-t/2,i.width=t,i.height=t):"topRight"===e?(i.cursor="nesw-resize",i.top=-t/2,i.right=-t/2,i.width=t,i.height=t):"bottomLeft"===e?(i.cursor="nesw-resize",i.bottom=-t/2,i.left=-t/2,i.width=t,i.height=t):"bottomRight"===e&&(i.cursor="nwse-resize",i.bottom=-t/2,i.right=-t/2,i.width=t,i.height=t),i}initWindowPosition(){if(!this.container)return;let{width:e,height:t}=this.getRect(),{offsetX:i=0,offsetY:a=0}=this.openWindowOptions;if(this.openWindowOptions.relativeWindowConfig||this.openWindowOptions.relativeDomConfig){let o=null,s="bottom";if(this.openWindowOptions.relativeWindowConfig){let{windowId:e,placement:t}=this.openWindowOptions.relativeWindowConfig,i=this.parent.getWindowItem(e);o=(null==i?void 0:i.layoutManager.container)||null,s=t}else if(this.openWindowOptions.relativeDomConfig){let{el:e,placement:t}=this.openWindowOptions.relativeDomConfig;o=e||null,s=t}if(o){let{width:n,height:r,top:l,left:d}=this.getElementOffsetInWindow(o);switch(s){case"top":this.left=d+(n-e)/2+i,this.top=l-t+a;break;case"bottom":this.left=d+(n-e)/2+i,this.top=l+r+a;break;case"left":this.left=d-e+i,this.top=l+(r-t)/2+a;break;case"right":this.left=d+n+i,this.top=l+(r-t)/2+a;break;case"bottomLeft":this.left=d+i,this.top=l+r+a;break;case"bottomRight":this.left=d+n-e+i,this.top=l+r+a;break;case"topLeft":this.left=d+i,this.top=l-t+a;break;case"topRight":this.left=d+n-e+i,this.top=l-t+a;break;case"center":this.left=d+(n-e)/2+i,this.top=l+(r-t)/2+a}this.left=Math.min(Math.max(0,this.left),window.innerWidth-e),this.top=Math.min(Math.max(0,this.top),window.innerHeight-t);return}}if(this.openWindowOptions.relativeMouseConfig){let{clientX:o,clientY:s,placement:n="topRight"}=this.openWindowOptions.relativeMouseConfig;"topRight"===n?(this.left=Math.min(Math.max(0,o+i),window.innerWidth-e),this.top=Math.min(Math.max(0,s+a),window.innerHeight-t)):"topLeft"===n?(this.left=Math.min(Math.max(0,o+i),window.innerWidth-e),this.top=Math.min(Math.max(0,s+a),window.innerHeight-t)):"center"===n&&(this.left=Math.min(Math.max(0,o-e/2+i),window.innerWidth-e),this.top=Math.min(Math.max(0,s-t/2+a),window.innerHeight-t));return}this.left=Math.max(0,(window.innerWidth-e)/2+i),this.top=Math.max(0,(window.innerHeight-t)/2+a)}emitDataChange(){var e,t;let i={height:this.height,width:this.width};null===(t=this.options)||void 0===t||null===(e=t.onDataChange)||void 0===e||e.call(t,i)}getElementOffsetInWindow(e){let t=e.getBoundingClientRect(),i=t.top,a=t.left;{let t=e.ownerDocument.defaultView;for(;t&&t!==t.parent;){let e=t.frameElement;if(e){let t=e.getBoundingClientRect();i+=t.top,a+=t.left}t=t.parent}}return{top:i,left:a,width:t.width,height:t.height}}adjustPosition(){this.container&&(!this.openWindowOptions.center||this.resized||this.dragged||this.initWindowPosition(),window.innerWidth-this.left<this.width?this.adjustMaxLeft=Math.max(0,window.innerWidth-this.width):this.adjustMaxLeft=-1,window.innerWidth<this.width?this.adjustMaxWidth=this.getWidth(window.innerWidth):this.adjustMaxWidth=-1,window.innerHeight-this.top<this.height?this.adjustMaxTop=Math.max(0,window.innerHeight-this.height):this.adjustMaxTop=-1,window.innerHeight<this.height?this.adjustMaxHeight=this.getHeight(window.innerHeight):this.adjustMaxHeight=-1)}getMaxSize(){var e,t;let i={width:window.innerWidth,height:window.innerHeight},a=null===(t=this.options)||void 0===t?void 0:null===(e=t.getMaxSize)||void 0===e?void 0:e.call(t);return a&&(i.width=Math.min(i.width,a.width),i.height=Math.min(i.height,a.height)),i}getMinSize(){var e,t;let i={width:150,height:150},a=null===(t=this.options)||void 0===t?void 0:null===(e=t.getMinSize)||void 0===e?void 0:e.call(t);return a&&(i.width=Math.max(i.width,a.width),i.height=Math.max(i.height,a.height)),i}getRect(){let e=this.adjustMaxLeft>=0?Math.min(this.left,this.adjustMaxLeft):this.left,t=this.adjustMaxWidth>=0?Math.min(this.width,this.adjustMaxWidth):this.width,i=this.adjustMaxTop>=0?Math.min(this.top,this.adjustMaxTop):this.top;return{width:t,height:this.adjustMaxHeight>=0?Math.min(this.height,this.adjustMaxHeight):this.height,left:e,top:i}}getHeight(e){let t=this.getMinSize(),i=this.getMaxSize();return Math.min(Math.max(e,t.height),i.height)}getWidth(e){let t=this.getMinSize(),i=this.getMaxSize();return Math.min(Math.max(e,t.width),i.width)}constructor(e,t,i){(0,a._)(this,"windowId",void 0),(0,a._)(this,"parent",void 0),(0,a._)(this,"openWindowOptions",void 0),(0,a._)(this,"container",void 0),(0,a._)(this,"options",void 0),(0,a._)(this,"containerCreated",void 0),(0,a._)(this,"resizing",void 0),(0,a._)(this,"resized",void 0),(0,a._)(this,"dragged",void 0),(0,a._)(this,"dragging",void 0),(0,a._)(this,"width",void 0),(0,a._)(this,"height",void 0),(0,a._)(this,"left",void 0),(0,a._)(this,"top",void 0),(0,a._)(this,"adjustMaxWidth",void 0),(0,a._)(this,"adjustMaxHeight",void 0),(0,a._)(this,"adjustMaxTop",void 0),(0,a._)(this,"adjustMaxLeft",void 0),(0,a._)(this,"zIndex",void 0),(0,a._)(this,"handleWindowResize",void 0),this.windowId=e,this.parent=t,this.openWindowOptions=i,this.container=null,this.options=null,this.containerCreated=!1,this.resizing=!1,this.resized=!1,this.dragged=!1,this.dragging=!1,this.width=0,this.height=0,this.left=0,this.top=0,this.adjustMaxWidth=-1,this.adjustMaxHeight=-1,this.adjustMaxTop=-1,this.adjustMaxLeft=-1,this.zIndex=d.zIndexCounter,this.handleWindowResize=(0,l.Z)(()=>{this.adjustPosition()},30,{trailing:!0}),(0,r.rC)(this)}}(0,a._)(d,"zIndexCounter",0),(0,o.gn)([s.SB],d.prototype,"containerCreated",void 0),(0,o.gn)([s.SB],d.prototype,"resizing",void 0),(0,o.gn)([s.SB],d.prototype,"resized",void 0),(0,o.gn)([s.SB],d.prototype,"dragged",void 0),(0,o.gn)([s.SB],d.prototype,"dragging",void 0),(0,o.gn)([s.SB],d.prototype,"width",void 0),(0,o.gn)([s.SB],d.prototype,"height",void 0),(0,o.gn)([s.SB],d.prototype,"left",void 0),(0,o.gn)([s.SB],d.prototype,"top",void 0),(0,o.gn)([s.SB],d.prototype,"adjustMaxWidth",void 0),(0,o.gn)([s.SB],d.prototype,"adjustMaxHeight",void 0),(0,o.gn)([s.SB],d.prototype,"adjustMaxTop",void 0),(0,o.gn)([s.SB],d.prototype,"adjustMaxLeft",void 0),(0,o.gn)([s.SB],d.prototype,"zIndex",void 0),(0,o.gn)([r.Fl],d.prototype,"resizeTouchArea",null),(0,o.gn)([r.Fl],d.prototype,"layoutStyle",null);class c{createWindow(e,t){let i=n.m.genId();return this.componentDataMap[i]={Component:e},(e,a)=>this.openWindow(i,e,t,a)}disposeWindow(e){let t=this.windowItems.findIndex(t=>t.id===e);-1!==t&&this.windowItems.splice(t,1)}disposeAllWindow(){this.windowItems=[]}getWindowItem(e){return this.windowItems.find(t=>t.id===e)||null}setActiveWindowId(e){this.activeWindowId=e}resolveOptions(e,t){return{singleton:!0,center:!0,...e||{},...t||{}}}openWindow(e,t,i,a){var o;if(!(null===(o=this.componentDataMap[e])||void 0===o?void 0:o.Component))throw Error("[Window Manager]: component id ".concat(e," not found"));let s=this.resolveOptions(i,a);if(s.singleton){let t=this.windowItems.findIndex(t=>t.compId===e);if(-1!==t){let e=this.windowItems[t].id;if(s.keepBeforeWindow||(this.windowItems.splice(t,1),s.toggle))return e}}let r=n.m.genId();return this.windowItems.push({id:r,compId:e,layoutManager:new d(r,this,s),props:{windowId:r,...t}}),r}constructor(){(0,a._)(this,"windowItems",[]),(0,a._)(this,"activeWindowId",null),(0,a._)(this,"allDirections",["left","right","top","bottom","topLeft","topRight","bottomLeft","bottomRight"]),(0,a._)(this,"componentDataMap",{}),(0,r.rC)(this)}}(0,o.gn)([s.SB],c.prototype,"windowItems",void 0),(0,o.gn)([s.SB],c.prototype,"activeWindowId",void 0);let h=new c},25902:function(e,t,i){"use strict";i.d(t,{G:function(){return d}});var a=i(83260),o=i(66084),s=i(88882),n=i(65324),r=i(55180);class l extends r.b{async onInit(){s.a.on("localeChange",()=>{this.getCachedAgentDiscoverFeeds()}),this.services.user.on("userLogout",()=>{this.storage.update({agentDiscoverFeeds:[]})})}taskMessageList(e){return n.Cb.agentApi.taskMessageList(e)}uploadFavicon(e){return n.Cb.searchAgentApi.uploadFavicon(e)}getFaviconList(e){return n.Cb.searchAgentApi.getFaviconList(e)}async getCachedAgentDiscoverFeeds(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,i=async()=>{let e=await n.Cb.agentApi.searchAgentDiscoverFeeds({offset:0,limit:15,isNew:!0});return this.storage.set("agentDiscoverFeeds",e.feeds),null==t||t(e.feeds),e.feeds},a=await this.storage.get("agentDiscoverFeeds");return a&&a.length>0?(e||i(),a):await i()}async getAgentDiscoverFeeds(e){return await n.Cb.agentApi.searchAgentDiscoverFeeds(e)}setShareConfig(e){return n.Cb.agentApi.setShareConfig(e)}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"agent",name:"AgentService"}),(0,o._)(this,"dependencies",["user"]),(0,o._)(this,"defaultStorageValues",{agentDiscoverFeeds:[]})}}let d=new a.x(l)},20549:function(e,t,i){"use strict";i.d(t,{D:function(){return l}});var a=i(83260),o=i(66084),s=i(65324),n=i(55180);class r extends n.b{async onInit(){this.storage.addChangeListener(e=>{void 0!==e.favoritedArtifacts&&this.emit("onFavoritedArtifactsChange",e.favoritedArtifacts),void 0!==e.conversationArtifactsMap&&this.emit("onConversationArtifactsMapChange",{conversationArtifactsMap:e.conversationArtifactsMap})})}async setArtifactContinueInChat(e,t){this.artifactContinueInChatData[e]=t}async getArtifactContinueInChat(e){return this.artifactContinueInChatData[e]}async setOpenArtifactData(e){this.openArtifactDataMap[e.artifact.artifactId+e.conversationId+e.itemId]=e.artifact}async getOpenArtifactData(e){return this.openArtifactDataMap[e.artifactId+e.conversationId+e.itemId]}async getArtifactDetail(e){return s.Cb.botFrameworkService.artifactSnapshotsApi.detail(e)}async getFavoritedArtifacts(e){let t=async()=>{let{data:t}=await s.Cb.botFrameworkService.artifactSnapshotsApi.list({isFavorite:!0,...e});return{list:t.data||[],total:t.total||0}},i=await this.storage.get("favoritedArtifacts");if(0===e.offset&&!e.name){var a;if(null==i?void 0:null===(a=i.list)||void 0===a?void 0:a.length)return t().then(e=>{this.storage.set("favoritedArtifacts",e)}),i;let e=await t();return this.storage.set("favoritedArtifacts",e),e}return await t()}async getFavoritedArtifactsWitchTotal(e,t){let i=async()=>{let{data:i}=await s.Cb.botFrameworkService.artifactSnapshotsApi.list({isFavorite:!0,...e}),a={data:i.data||[],total:i.total||0};return t(a),a};if(0===e.offset&&!e.name){let e=await this._fetchWithCache("favoritedArtifactsData",async()=>{try{return await i()}catch(e){return{data:[],total:0}}});return t(e),e}return await i()}async toggleFavoriteArtifact(e){let{isFavorite:t,uid:i}=e;await this.updateArtifactSnapshot({uid:i,isFavorite:t})}async togglePublishArtifact(e){await this.updateArtifactSnapshot({uid:e.uid,isPublished:e.isPublished})}async updateArtifactSnapshot(e){let{data:t}=await s.Cb.botFrameworkService.artifactSnapshotsApi.updateStatus(e),i=t.data;if(i){this.updateArtifactInStorage(i.conversationId,i);let{list:t=[],total:a}=await this.storage.get("favoritedArtifacts")||{},o=t.findIndex(e=>e.uid===i.uid);o>-1?(e.isFavorite?t[o]=i:t.splice(o,1),this.storage.set("favoritedArtifacts",{list:t,total:a})):e.isFavorite&&(t.unshift(i),this.storage.set("favoritedArtifacts",{list:t,total:a+1}))}}async syncToServer(e,t){let{artifacts:i}=e,a=await this.storage.get("conversationArtifactsMap")||{};if(1===i.length){var o;let e=i[0],n=null===(o=(a[e.conversationId]||[]).find(t=>t.artifactId===e.artifactId))||void 0===o?void 0:o.artifactUid,r=null,l=!!n&&e.conversationId;if(l){let{data:t}=await s.Cb.botFrameworkService.artifactsApi.update({...e,uid:n});r=t}else{let{data:t}=await s.Cb.botFrameworkService.artifactsApi.create(e);r=t}a[e.conversationId]||(a[e.conversationId]=[]);let d=a[e.conversationId].findIndex(e=>e.uid===r.currentSnapshotUid),c={...e,...r,createdAt:l?r.updatedAt:r.createdAt,uid:r.currentSnapshotUid,artifactUid:r.uid};-1!==d?a[e.conversationId][d]=c:a[e.conversationId].unshift(c),this.storage.set("conversationArtifactsMap",a),null==t||t([c])}else{let{data:e}=await s.Cb.botFrameworkService.artifactsApi.batchCreate({data:i}),o=e.data||[];i.forEach(e=>{o.forEach(t=>{a[e.conversationId]||(a[e.conversationId]=[]);let i=a[e.conversationId].findIndex(e=>e.uid===t.uid);-1!==i?a[e.conversationId][i]=t:a[e.conversationId].unshift(t)})}),null==t||t(o.map(e=>{let{artifactUid:t,uid:i,updatedAt:a,createdAt:o,artifactId:s}=e;return{artifactId:s,currentSnapshotUid:i,uid:t,createdAt:o,updatedAt:a}}))}this.storage.set("conversationArtifactsMap",a)}async getArtifactsInConversation(e){let t=await this.storage.get("conversationArtifactsMap")||{},i=async()=>{let{data:t}=await s.Cb.botFrameworkService.artifactSnapshotsApi.list({limit:1e4,offset:0,conversationId:e.conversationId});return t.data||[]},a=i=>{this.storage.set("conversationArtifactsMap",{...t,[e.conversationId]:i})};return t[e.conversationId]?(i().then(e=>{a(e)}),t[e.conversationId]):i().then(e=>(a(e),e))}async updateArtifact(e){return s.Cb.botFrameworkService.artifactsApi.update(e)}async updateArtifactInStorage(e,t){let i=t.uid,a=await this.storage.get("conversationArtifactsMap")||{},o=a[e]||[];if(0===o.length)o=[t];else{let a=o.findIndex(a=>a.uid===i&&a.conversationId===e&&a.chatItemId===t.chatItemId);-1!==a?o[a]=t:o.unshift(t)}a[e]=o,this.storage.set("conversationArtifactsMap",a)}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"artifact",name:"ArtifactService"}),(0,o._)(this,"dependencies",[]),(0,o._)(this,"defaultStorageValues",{favoritedArtifacts:{list:[],total:0},conversationArtifactsMap:{},artifactsVersionMap:{},favoritedArtifactsData:{total:0,data:[]}}),(0,o._)(this,"artifactContinueInChatData",{}),(0,o._)(this,"openArtifactDataMap",{})}}let l=new a.x(r)},54085:function(e,t,i){"use strict";i.d(t,{_M:function(){return r},CJ:function(){return n},HY:function(){return s}});var a={src:"https://assets.monica.im/home-web/_next/static/media/default.fb780a67.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABgJf/xAAVEAEBAAAAAAAAAAAAAAAAAAACEv/aAAgBAQABBQIlz//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABYRAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAgBAgEBPwEyX//EABgQAAIDAAAAAAAAAAAAAAAAAAABESJB/9oACAEBAAY/AnVzh//EABYQAAMAAAAAAAAAAAAAAAAAAAABkf/aAAgBAQABPyFiKH//2gAMAwEAAgADAAAAEPP/xAAXEQEAAwAAAAAAAAAAAAAAAAABABEh/9oACAEDAQE/ELwJ/8QAFREBAQAAAAAAAAAAAAAAAAAAADH/2gAIAQIBAT8Qof/EABkQAQEAAwEAAAAAAAAAAAAAAAERACExQf/aAAgBAQABPxBXogBbe8fNyrn/2Q==",blurWidth:8,blurHeight:8},o={src:"https://assets.monica.im/home-web/_next/static/media/photographic.00e569f8.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAA//aAAwDAQACEAMQAAABoIv/xAAVEAEBAAAAAAAAAAAAAAAAAAABA//aAAgBAQABBQKlQf/EABURAQEAAAAAAAAAAAAAAAAAAAAB/9oACAEDAQE/Aa//xAAWEQADAAAAAAAAAAAAAAAAAAAAERL/2gAIAQIBAT8BpH//xAAYEAACAwAAAAAAAAAAAAAAAAABEQACsf/aAAgBAQAGPwIO6Gz/xAAYEAACAwAAAAAAAAAAAAAAAAAAAREhUf/aAAgBAQABPyFCrnvR/9oADAMBAAIAAwAAABAL/8QAFREBAQAAAAAAAAAAAAAAAAAAAQD/2gAIAQMBAT8QA3//xAAVEQEBAAAAAAAAAAAAAAAAAAABAP/aAAgBAgEBPxBbQL//xAAaEAEAAQUAAAAAAAAAAAAAAAABMQAhQVFh/9oACAEBAAE/EDMYQXdBbhmv/9k=",blurWidth:8,blurHeight:8};let s=[{key:"default",model:"enhance",img:a},{key:"anime",model:"anime",img:{src:"https://assets.monica.im/home-web/_next/static/media/anime.af9b28f5.jpg",height:192,width:192,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAABmKf/xAAXEAADAQAAAAAAAAAAAAAAAAAAAQID/9oACAEBAAEFAo1pH//EABURAQEAAAAAAAAAAAAAAAAAAAAB/9oACAEDAQE/Aa//xAAXEQADAQAAAAAAAAAAAAAAAAAAAhNR/9oACAECAQE/AZJh/8QAGRAAAgMBAAAAAAAAAAAAAAAAAQIAEUEi/9oACAEBAAY/ArZs5A2f/8QAFhABAQEAAAAAAAAAAAAAAAAAAQDB/9oACAEBAAE/IVlA6C//2gAMAwEAAgADAAAAEPf/xAAXEQEAAwAAAAAAAAAAAAAAAAABABFR/9oACAEDAQE/EBYGT//EABYRAQEBAAAAAAAAAAAAAAAAAAEAMf/aAAgBAgEBPxBRV1f/xAAaEAEBAAIDAAAAAAAAAAAAAAABEQAhMYGh/9oACAEBAAE/EHT518oUlB117n//2Q==",blurWidth:8,blurHeight:8}},{key:"photographic",model:"photographic",img:o},{key:"digitalArt",model:"digital-art",img:{src:"https://assets.monica.im/home-web/_next/static/media/digitalArt.9d90c0fe.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAH/xAAVAQEBAAAAAAAAAAAAAAAAAAACA//aAAwDAQACEAMQAAABgFP/xAAVEAEBAAAAAAAAAAAAAAAAAAASIv/aAAgBAQABBQJ3/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAwEBPwF//8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAgEBPwF//8QAGRAAAQUAAAAAAAAAAAAAAAAAAQACESFh/9oACAEBAAY/ArcBkr//xAAXEAADAQAAAAAAAAAAAAAAAAAAASEx/9oACAEBAAE/IVWW5oz/2gAMAwEAAgADAAAAEPP/xAAWEQEBAQAAAAAAAAAAAAAAAAABACH/2gAIAQMBAT8QdC//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREh/9oACAECAQE/EFlP/8QAGBABAAMBAAAAAAAAAAAAAAAAAQARYUH/2gAIAQEAAT8QdEyis6O3yf/Z",blurWidth:8,blurHeight:8}},{key:"comicBook",model:"comic-book",img:{src:"https://assets.monica.im/home-web/_next/static/media/comicBook.f008363d.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAL/xAAUAQEAAAAAAAAAAAAAAAAAAAAD/9oADAMBAAIQAxAAAAGQC//EABYQAQEBAAAAAAAAAAAAAAAAAAIBA//aAAgBAQABBQJzRP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAwEBPwF//8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAgEBPwF//8QAFxAAAwEAAAAAAAAAAAAAAAAAACExYf/aAAgBAQAGPwKrD//EABgQAAIDAAAAAAAAAAAAAAAAAAERACEx/9oACAEBAAE/IQoFGxqn/9oADAMBAAIAAwAAABAL/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQAh/9oACAEDAQE/EHAv/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAgEBPxB//8QAGBABAAMBAAAAAAAAAAAAAAAAAQARMWH/2gAIAQEAAT8QEY4RrVdU15k//9k=",blurWidth:8,blurHeight:8}},{key:"fantasyArt",model:"fantasy-art",img:{src:"https://assets.monica.im/home-web/_next/static/media/fantasyArt.f641b204.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAUAQEAAAAAAAAAAAAAAAAAAAAE/9oADAMBAAIQAxAAAAGQKv8A/8QAFhABAQEAAAAAAAAAAAAAAAAAAgMA/9oACAEBAAEFAo1Q3//EABURAQEAAAAAAAAAAAAAAAAAAAAB/9oACAEDAQE/AY//xAAWEQEBAQAAAAAAAAAAAAAAAAABAgD/2gAIAQIBAT8BqR3/xAAWEAADAAAAAAAAAAAAAAAAAAAAMXH/2gAIAQEABj8CiP/EABgQAQADAQAAAAAAAAAAAAAAAAEAESEx/9oACAEBAAE/IUTcDS+s/9oADAMBAAIAAwAAABDz/8QAFxEBAQEBAAAAAAAAAAAAAAAAAREAIf/aAAgBAwEBPxAFV7Xf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAh/9oACAECAQE/EGjL/8QAGBABAQADAAAAAAAAAAAAAAAAAREAMUH/2gAIAQEAAT8QQVRKy/UN5//Z",blurWidth:8,blurHeight:8}},{key:"analogFilm",model:"analog-film",img:{src:"https://assets.monica.im/home-web/_next/static/media/analogFilm.6dc4524f.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFAABAAAAAAAAAAAAAAAAAAAAAP/EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAEIP//EABYQAAMAAAAAAAAAAAAAAAAAAAIDIf/aAAgBAQABBQIWX//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/AY//xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAECAQE/AX//xAAVEAEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAQAGPwKP/8QAFxABAQEBAAAAAAAAAAAAAAAAAREAcf/aAAgBAQABPyELCEb3f//aAAwDAQACAAMAAAAQC//EABcRAQADAAAAAAAAAAAAAAAAAAEAESH/2gAIAQMBAT8QwUT/xAAVEQEBAAAAAAAAAAAAAAAAAAARAP/aAAgBAgEBPxAL/8QAGBABAAMBAAAAAAAAAAAAAAAAAQARIWH/2gAIAQEAAT8QQCCVm8M//9k=",blurWidth:8,blurHeight:8}},{key:"neonPunk",model:"neon-punk",img:{src:"https://assets.monica.im/home-web/_next/static/media/neonPunk.d536c961.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAVAQEBAAAAAAAAAAAAAAAAAAACBP/aAAwDAQACEAMQAAABmCpf/8QAFhABAQEAAAAAAAAAAAAAAAAAAgER/9oACAEBAAEFAocP/8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAIAQMBAT8Br//EABURAQEAAAAAAAAAAAAAAAAAAAEA/9oACAECAQE/AUv/xAAXEAADAQAAAAAAAAAAAAAAAAAAAhEx/9oACAEBAAY/AsrH/8QAFxABAAMAAAAAAAAAAAAAAAAAAQARYf/aAAgBAQABPyFXoJs//9oADAMBAAIAAwAAABAH/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAwEBPxBNh//EABcRAQADAAAAAAAAAAAAAAAAAAEAEVH/2gAIAQIBAT8QBoyf/8QAFxABAQEBAAAAAAAAAAAAAAAAAVEAMf/aAAgBAQABPxCwIAUZ3f/Z",blurWidth:8,blurHeight:8}},{key:"isometric",model:"isometric",img:{src:"https://assets.monica.im/home-web/_next/static/media/isometric.2e3dcbd4.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAT/xAAVAQEBAAAAAAAAAAAAAAAAAAACBP/aAAwDAQACEAMQAAABlEZ//8QAFBABAAAAAAAAAAAAAAAAAAAAQf/aAAgBAQABBQJ//8QAFxEBAAMAAAAAAAAAAAAAAAAAAQARIf/aAAgBAwEBPwG0wn//xAAVEQEBAAAAAAAAAAAAAAAAAAABAP/aAAgBAgEBPwFb/8QAFhABAQEAAAAAAAAAAAAAAAAAEQAB/9oACAEBAAY/AjW//8QAGBAAAgMAAAAAAAAAAAAAAAAAASEAMVH/2gAIAQEAAT8hDugcU//aAAwDAQACAAMAAAAQB//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8Qewh//8QAFhEAAwAAAAAAAAAAAAAAAAAAAAER/9oACAECAQE/EGU//8QAGBABAAMBAAAAAAAAAAAAAAAAAQARUSH/2gAIAQEAAT8QCyVKPAwNn//Z",blurWidth:8,blurHeight:8}},{key:"lowPoly",model:"low-poly",img:{src:"https://assets.monica.im/home-web/_next/static/media/lowPoly.3ccc3174.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAL/xAAVAQEBAAAAAAAAAAAAAAAAAAABA//aAAwDAQACEAMQAAABgTf/xAAVEAEBAAAAAAAAAAAAAAAAAAACEf/aAAgBAQABBQIiv//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/AY//xAAYEAACAwAAAAAAAAAAAAAAAAAAAREhUf/aAAgBAQAGPwJzWH//xAAXEAEAAwAAAAAAAAAAAAAAAAABABGR/9oACAEBAAE/IaMEGp//2gAMAwEAAgADAAAAEPP/xAAVEQEBAAAAAAAAAAAAAAAAAAABAP/aAAgBAwEBPxBBC//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EJf/xAAZEAEAAgMAAAAAAAAAAAAAAAABESEAUWH/2gAIAQEAAT8QQdiHDebXXM//2Q==",blurWidth:8,blurHeight:8}},{key:"origami",model:"origami",img:{src:"https://assets.monica.im/home-web/_next/static/media/origami.24094425.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFAABAAAAAAAAAAAAAAAAAAAAAP/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAQH/xAAWEAADAAAAAAAAAAAAAAAAAAABERL/2gAIAQEAAQUChH//xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPwGv/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAgEBPwF//8QAFRABAQAAAAAAAAAAAAAAAAAAEQD/2gAIAQEABj8CC//EABgQAAIDAAAAAAAAAAAAAAAAAAERACEx/9oACAEBAAE/IQk2zs//2gAMAwEAAgADAAAAEPv/xAAWEQADAAAAAAAAAAAAAAAAAAAAATH/2gAIAQMBAT8QaH//xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAgEBPxCP/8QAGBABAQADAAAAAAAAAAAAAAAAAREAQYH/2gAIAQEAAT8Qk7Ik1A33P//Z",blurWidth:8,blurHeight:8}},{key:"lineArt",model:"line-art",img:{src:"https://assets.monica.im/home-web/_next/static/media/lineArt.4685e10d.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFAABAAAAAAAAAAAAAAAAAAAAAP/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAQP/xAAWEAADAAAAAAAAAAAAAAAAAAABAiH/2gAIAQEAAQUCgT//xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAEDAQE/AX//xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAECAQE/AX//xAAVEAEBAAAAAAAAAAAAAAAAAAAAYf/aAAgBAQAGPwKv/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEhUf/aAAgBAQABPyFwTTP/2gAMAwEAAgADAAAAEA//xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAEDAQE/EH//xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAECAQE/EH//xAAYEAEBAQEBAAAAAAAAAAAAAAABESEAwf/aAAgBAQABPxAQCsW1roHvf//Z",blurWidth:8,blurHeight:8}},{key:"cinematic",model:"cinematic",img:{src:"https://assets.monica.im/home-web/_next/static/media/cinematic.1a9d0f58.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAT/xAAVAQEBAAAAAAAAAAAAAAAAAAABA//aAAwDAQACEAMQAAABnEj/xAAWEAEBAQAAAAAAAAAAAAAAAAACAxL/2gAIAQEAAQUCmtP/xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPwGv/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAgEBPwF//8QAGRABAAIDAAAAAAAAAAAAAAAAAQACETFB/9oACAEBAAY/AhbBg12f/8QAFxABAAMAAAAAAAAAAAAAAAAAAQARMf/aAAgBAQABPyEyipBpn//aAAwDAQACAAMAAAAQD//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABYRAQEBAAAAAAAAAAAAAAAAAAEAIf/aAAgBAgEBPxBNv//EABoQAAICAwAAAAAAAAAAAAAAAAERACExQdH/2gAIAQEAAT8Q0vjUhTOHyf/Z",blurWidth:8,blurHeight:8}},{key:"threeDModel",model:"3d-model",img:{src:"https://assets.monica.im/home-web/_next/static/media/threeDModel.b5da4dcf.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAGgT//EABUQAQEAAAAAAAAAAAAAAAAAAAEh/9oACAEBAAEFAgn/xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPwGv/8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAIAQIBAT8Bj//EABYQAQEBAAAAAAAAAAAAAAAAAAERAP/aAAgBAQAGPwIsDf/EABgQAAIDAAAAAAAAAAAAAAAAAAARASFh/9oACAEBAAE/IYNyTs//2gAMAwEAAgADAAAAEA//xAAVEQEBAAAAAAAAAAAAAAAAAAAAQf/aAAgBAwEBPxCH/8QAFhEAAwAAAAAAAAAAAAAAAAAAAAEx/9oACAECAQE/EHp//8QAGhAAAgIDAAAAAAAAAAAAAAAAASERQQBhof/aAAgBAQABPxCLhCYwUVZ4N5//2Q==",blurWidth:8,blurHeight:8}},{key:"pixelArt",model:"pixel-art",img:{src:"https://assets.monica.im/home-web/_next/static/media/pixelArt.4873901f.jpg",height:96,width:96,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAL/xAAUAQEAAAAAAAAAAAAAAAAAAAAE/9oADAMBAAIQAxAAAAGwk3//xAAVEAEBAAAAAAAAAAAAAAAAAAATIv/aAAgBAQABBQKk/8QAFREBAQAAAAAAAAAAAAAAAAAAAQD/2gAIAQMBAT8BW//EABURAQEAAAAAAAAAAAAAAAAAAAEA/9oACAECAQE/AQv/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAY/Ao8P/8QAFxABAQEBAAAAAAAAAAAAAAAAAREAQf/aAAgBAQABPyGooCUDu//aAAwDAQACAAMAAAAQ/wD/xAAXEQADAQAAAAAAAAAAAAAAAAAAAREx/9oACAEDAQE/EKJKYf/EABcRAAMBAAAAAAAAAAAAAAAAAAABETH/2gAIAQIBAT8Qg27p/8QAGBABAAMBAAAAAAAAAAAAAAAAAQARQaH/2gAIAQEAAT8QRoKRVY61yf/Z",blurWidth:8,blurHeight:8}}],n=[{key:"japaneseAnime",model:"japanese_anime",img:{src:"https://assets.monica.im/home-web/_next/static/media/japanese_anime.d4228696.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAkFBMVEW6iIjClIlgZ36XdYaIZHCEjZWri5etpqjbsbTGqr1kQlisfn9cNUNOKDtxQEWpl7D94MqWgZ2wk7FhbJOnY220dVxvfYUULFLDorNYOVNcXmMzW3mVTT/Strzhu7nfxsCbj7J/k6pPX4JKQmrZsqJ2YnLvjpR+VGVZTHOEd4VBMk7Bp5T/rJZhSV/UoJ09RGMhDgOeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAASklEQVR4nAXBBQKAIAAEsKMEC7u7W///OzfMRGvn/C7YjovXfg5wa8ENl8Fggq67tSE35TBOykBDEk77roUo69gMAx9plRWR9NQPtJ0E0hkJRM0AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},{key:"realistic",model:"realistic",img:{src:"https://assets.monica.im/home-web/_next/static/media/artistStyleRealistic.f0f91e66.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAe1BMVEU5LzVRXnJ/cl3FubCzrKNvWlZJTFqCaGNFNTlQPT9DOUWGeHqYgndoUkfg2M+HiopHVUVYZHBpbXBrh552foq3mIxrZl/czMJdVl6bkY2bk4z////UxLiZjnp2XVZQakF2d16sn4yAh3PKyMJndGmjpaV5nps7U0CXoZ7V0t0/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAARklEQVR4nAXBAwLAMAAEsKtWY7b5/xcuwRusiW0YkbiSlrEJUehaOr7jU4ZSdx5ooPy88AsFyaQQ94O8JIPSPiGruh56W3+IYAPmdxeEcwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},{key:"cyberpunk",model:"cyberpunk",img:{src:"https://assets.monica.im/home-web/_next/static/media/artistStyleCyberpunk.178dbe8d.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAVFBMVEUrOTggMzM9VlhQfYsvVFwwQD0lP0InSExEanMbKClSYWtpfodOWU4RODkKEhBCST9roLAsXWtGUk8gT100b34zOjRSa3E2OC0JKCg/Y2o0LyBecn4fUjRyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQklEQVR4nAXBBwLAIAgEsFNRwL26///PJuBo19rjhSQa230NgdxDPU5cLBy6KFrSuxgXgROBIRPw3hTrDY6starNP2iZApyETyetAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},{key:"fantasyArt",model:"fantasy_art",img:{src:"https://assets.monica.im/home-web/_next/static/media/fantasy_art.86fb14eb.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAeFBMVEUhJBUaSWQXNEVygoA5SmMqLihUanAXO1kdLDhgi5lIWG5FVl1IRj42WXaylII5RDYnPDcsYmhafIohUF0tT2w2P0SIratIboNyjI42RUGYmZW9x7JhT2OPjoBXZFekeHLZrHdnPFUOFhqSdFzCq5jMmn5naW9xcFWq+d8VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARklEQVR4nAXBBQKAIAAEsEO6UbG7//9DNzBmTCZSwvtOa11lHPPYt5Ra3GESQtQl3u1ZCkUkbNgvx1WBtH7RNQo4U+QDB36GlAPMs0qMaAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},{key:"threeDAnime",model:"3d_anime",img:{src:"https://assets.monica.im/home-web/_next/static/media/3d_anime.04ff52a1.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAk1BMVEWqsb81Xo6snqyJZXtka391X4ddaXBkiLR9dKBmkLjGs76/nLa0m76aeJpfaqx3hb6IfIe5vcs0QVgsUHV0aGM8SF2HbVeal7q3t69zcpNecKONgcA2PkkrS2GMp+esydoyVl97ZHaZh5xhYGFDjcidi41PT3q+iY6ZkKSIt+PUyuCLd4+WjaRnfpxSP2OHhaOjpL76i/msAAAACXBIWXMAAAsTAAALEwEAmpwYAAAASklEQVR4nAXBBQKAIAAEsAOUsLu7W///OjckVa2E1o2IYtK0mDiCsJB03Qm4KvuZmTfgpwO9LBPCy3AY1gtH15bzYR9cmW+Grds/sLIE9BQ/V6QAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},{key:"threeDModeling",model:"3d_modeling",img:{src:"https://assets.monica.im/home-web/_next/static/media/3d_modeling.4e3b2f0f.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAALVBMVEUKAgESDgssIiE7Kik7PUOFYVl3bnQvLzQeGRlSPT1JNjFTSlBiZ3BiVVVHS1L4n/oUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAANUlEQVR4nE3EtwHAMAwDMJKqrv+f6yFLMAD447e87hE89xo5DDuXWUyDtzQjhPJSmwiwSQIPHkoA8miRnP0AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},{key:"pixelArt",model:"pixel_art",img:{src:"https://assets.monica.im/home-web/_next/static/media/pixel_art.375ac3c2.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAllBMVEUhpK1igVM3p5x1oUaCrXCQl2eRy4pHsqeErFBtp5BdvMlhuo1vlU9iqFdsbER0s4pEq2trcGCWxH1Xq6Fmx6RmbEBUpY1hjFKSrU6brou658lBa0ehvZ9iiR9pp0xauZm/1561l1bN2oqMjik4Y1SGv4D/+qbgu4K2049EucFQay/f7buRyEmvz7Zbn3gqdzkDQlpGNDa77haZAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAS0lEQVR4nAXBBQKAIAAEsBNEFOzu7vb/n3MD5xsIwHFKsc490fBIcS2tZuBTDzaUeYz9nroqC128VGmMwFEx0jrxmW6hUNLIs3XzB7njBRPBNvKkAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},{key:"comic",model:"comic",img:{src:"https://assets.monica.im/home-web/_next/static/media/artistStyleComic.35f4f249.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAgVBMVEVhZVxUWVd6VkRzPztJQkmBZ1RgRkFaT0tvi3JUSUxlXVaFdl1bOTp0YEpTeoaYpYhzp6JqYFuScld9bFyRY0Kmmnd4dGI3R1SHnozV4adoXW9Rm5y22aNLZWM9ZWmHqHlvjoNyeVeob25dd2eAgVVqBxlYk5ejdkS1vHhbV2kwbXxPWEoSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAASUlEQVR4nAXBBQKAIAAEsEMQECQUu7v+/0A3XLv5/OIt7jM91rGzcNs7y75xkM+EoS01lKxRQRPEETUpLwRyrkISUYYsQRCCsB+/dAQt8nNTAwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},{key:"oilPainting",model:"oil_painting",img:{src:"https://assets.monica.im/home-web/_next/static/media/oil_painting.45c787ee.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAclBMVEVCKxV9YD5rTjcuPk5JVE+edEgrMjZSMhQsKiQdGhtFXGFLQUBdfG3LiTXwki7zsC96cVqpjVs5JRU4JBVjPRZVRzNWTj8fT2eMdlquf0whIDI2Rkykk2PJl1jkhi/UlkxsZ0ukhV1rbl/aiTuahV7VmjigAeNzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARUlEQVR4nAXBhQGAMAADsM7dcGfY/y+SwPs7Z/FeWLe9lPM5sDgRY0ofqOMihMrQD9xOsx1hJOOEUAnVwRitNVqlAKD5AZu1A3ooIEaGAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},{key:"watercolorPainting",model:"watercolor_painting",img:{src:"https://assets.monica.im/home-web/_next/static/media/watercolor_painting.3fa37869.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAflBMVEXc0NK+n6Ld08iKenz7+/SvmpbMx6Lt7+bR0cq/rpqljZG+mZHm4NdqYlR0e36wvKbGt6zX3N/OaWiTaHa9j5C4iXyyb4bCuIq4dlzFp2Ta2sSfmo5+YGeRjZyzpJLl2dyFm4y6k2uxn7OFXzqOf5VuiXmTh3GQnY2ytKTs6dGTrS2CAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAR0lEQVR4nAXBBQKAIAAEsEO6BLu7//9BNzCZJUpJBims0Zw49J3geUEJ9KbLqh4HvM/cNtQHINyHv1aFxJo0nc4dX4wOwPIDfOQD/iK/yh8AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},{key:"coloredPencilDrawing",model:"colored_pencil_drawing",img:{src:"https://assets.monica.im/home-web/_next/static/media/colored_pencil_drawing.80ffd784.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAk1BMVEX+///b1s6srYq2uLtCXliRVi13Wkjz/P7k7PbOvLNcV1VtsspxqM10a1f6/uucvoz4+dP/8M66aELA2qIpf5fY+sqU03K2mXDD4rNfpEq77NzMbWKz4JxTKziJuYGhz6/d4LStjkuMbE6q3YQiX2X8mW/G0pRdczqZbCsveWGCTiFoVSujoKUoW4Li189DdY1+dXeClYNoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAASklEQVR4nAXBBQKAIAAEsAORsLu7W///OjcIz5GWKYEiiV1mK2BsmzwKfEDQdarLLMTD9m3uqhT0Pblaeh238RmHzgdcBELTBPkBqWgE3n5OHcoAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},{key:"movieStyle",model:"movie_style",img:{src:"https://assets.monica.im/home-web/_next/static/media/movie_style.292a19f1.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAXVBMVEUGAxIYGCdNaH1WU1QuHiNPMi1eRD8hERofKDsyLzhKWGYIChyXloyOdGi3potzW0xEW3AADy1qTENbfI+FaFuBm6VgeYeotrmZqq9ydnd9dWxJRUjez7QTCBLCq5dPelvoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQ0lEQVR4nAXBBwLAIAgEsFNBwNm92/8/swmyqsuvCFRBxF/F4MC9PRF+lFhaF3hb9uMiB+NY13QbIDSV7QwAIGFO9gNdtQKc9/0cOQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}}],r=[{key:"vivid",model:"vivid",img:a},{key:"natural",model:"natural",img:o}]},42857:function(e,t,i){"use strict";i.d(t,{d:function(){return h}});var a=i(83260),o=i(66084),s=i(3978),n=i(73361),r=i(91433),l=i(65324),d=i(55180);class c extends d.b{async onInit(){this.services.user.on("userLogout",()=>{this.storage.set("list",null),this.storage.set("taskOptionsMap",{})}),this.storage.addChangeListener(e=>{e.taskOptionsMap&&this.emit("taskOptionsChange",e.taskOptionsMap)})}async listItems(e){return l.Cb.artistBotApi.listItems(e,{ignoreGlobalErrorHandler:!0})}async deleteItem(e){return l.Cb.artistBotApi.deleteItem({uid:e})}async createGenerateImageTask(e){return s.aS.updateBotLastMsgTime(e.botUid),l.Cb.artistBotApi.createGenerateImageTask(e)}async createUpscaleImageTask(e){return s.aS.updateBotLastMsgTime(e.botUid),l.Cb.artistBotApi.createUpscaleImageTask(e)}async loopTaskStatus(e,t){let i=await l.Cb.artistBotApi.loopTaskStatus({taskUid:e});return"complete"===i.data.status&&(s.aS.updateBotLastMsgTime(t.id),n.gM.updateUsageInfos([t.usageModule])),i}async retryTask(e,t){let i=l.Cb.artistBotApi.retryTask({taskUid:e});return s.aS.updateBotLastMsgTime(t.id),n.gM.updateUsageInfos([t.usageModule]),i}async getTaskOptions(e){let t=(await this.storage.get("taskOptionsMap"))[e];if(t)return t;let i=e===r.vH.dalle3,a={imageCount:1,keepPromptAfterSending:!1,negativePrompt:"",promptStrength:7,style:"enhance"};return i&&(a.style="vivid",a.width=1024,a.height=1024,a.imageCount=1),a}async setTaskOptions(e,t){let i=await this.storage.get("taskOptionsMap");i[e]=t,await this.storage.set("taskOptionsMap",i)}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"artist",name:"ArtistService"}),(0,o._)(this,"dependencies",["user"]),(0,o._)(this,"defaultStorageValues",{list:null,taskOptionsMap:{}})}}let h=new a.x(c)},88792:function(e,t,i){"use strict";i.d(t,{y:function(){return l}});var a=i(83260),o=i(66084),s=i(65324),n=i(55180);class r extends n.b{async onInit(){}async createTranscriptionTask(e){return s.Cb.botFrameworkService.audioToolApi.createTranscriptTask(e)}async deleteTranscriptTask(e){return s.Cb.botFrameworkService.audioToolApi.deleteTranscriptTask(e)}async editAudioTranscriptItem(e){return s.Cb.botFrameworkService.audioToolApi.editTranscriptItem(e)}async editTranscriptTask(e){return s.Cb.botFrameworkService.audioToolApi.editTranscriptTask(e)}async getTranscriptionList(e){return s.Cb.botFrameworkService.audioToolApi.getTranscriptList(e)}async getTranscriptionResult(e){return s.Cb.botFrameworkService.audioToolApi.getTranscriptResult(e)}async loopTranscriptionStatus(e){return s.Cb.botFrameworkService.audioToolApi.loopTranscriptStatus(e)}async cancelTranscriptionTask(e){return s.Cb.botFrameworkService.audioToolApi.cancelTranscriptTask(e)}async retryTranscriptTask(e){return s.Cb.botFrameworkService.audioToolApi.retryTranscriptTask(e)}async fetchPodcastWithCache(){return this._fetchWithCache("podcastList",async()=>{let{data:e}=await s.Cb.botFrameworkService.podcastApi.getPodcastListV2({limit:10,offset:0});return e.infoList})}async fetchAudioListWithCache(){return this._fetchWithCache("audioList",async()=>{let{data:e}=await this.getTranscriptionList({page:1,pageSize:10});return e.tasks||[]})}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"audio",name:"AudioService"}),(0,o._)(this,"dependencies",[]),(0,o._)(this,"defaultStorageValues",{audioList:[],podcastList:[]})}}let l=new a.x(r)},46756:function(e,t,i){"use strict";i.d(t,{y:function(){return c}});var a=i(83260),o=i(66084),s=i(92235),n=i(65324),r=i(55180),l=i(74024);class d extends r.b{async onInit(){this.storage.addChangeListener(e=>{e.monicaBotConfig&&this.emit("monicaBotConfigChange",e.monicaBotConfig),e.taskListMap&&this.emit("taskListMapChange",e.taskListMap),e.recommendSkillList&&this.emit("recommendSkillListChange",e.recommendSkillList),e.notifyConfig&&this.emit("notifyConfigChange",e.notifyConfig),e.memory&&this.emit("memoryChange",e.memory),e.memoryV2&&this.emit("memoryV2Change",e.memoryV2),e.myBots&&this.emit("myBotsChange",e.myBots),e.favoriteGroupList&&this.emit("favoriteGroupListChange",e.favoriteGroupList),e.favoriteList&&this.emit("favoriteListChange",e.favoriteList)})}startLoopNotification(){this.loopNotificationFlag||(this.loopNotificationFlag=!0,this.loopGetNotifications())}async setDefaultMonicaModel(e){this.storage.set("defaultMonicaModel",e)}async getDefaultMonicaModel(){return this.storage.get("defaultMonicaModel")}async initMemoryData(){let e=await this.storage.get("lastMemoryUpdateTime"),t=Date.now();return e?t-e>36e5?this.getMemory({useCache:!0,autoUpdate:!0}):this.getMemory({cacheOnly:!0}):this.getMemory({useCache:!1})}async getMemory(e){return await this._fetchWithCache("memoryV2",async()=>{let e=await n.Cb.botFrameworkService.memoryApi.getMemoryV2({});return this.storage.set("lastMemoryUpdateTime",Date.now()),e.data||null},e)}async updateMemoryInstructionAndResponsePreference(e){let t=await this.storage.get("memoryV2");return this.storage.set("memoryV2",{instruction:e.instruction||(null==t?void 0:t.instruction),instructionUpdatedTime:e.instruction?Math.floor(Date.now()/1e3):null==t?void 0:t.instructionUpdatedTime,responsePreference:e.responsePreference||(null==t?void 0:t.responsePreference)}),await n.Cb.botFrameworkService.memoryApi.updateMemoryInstructionAndResponsePreferenceV2(e),!0}async deleteMemoryItem(e){var t;await n.Cb.botFrameworkService.memoryApi.deleteMemoryItemV2(e);let i=await this.storage.get("memoryV2");this.storage.set("memoryV2",{...i,itemList:null==i?void 0:null===(t=i.itemList)||void 0===t?void 0:t.flatMap(t=>t.id===e.itemId?[]:[t])})}async createMemoryItem(e){return n.Cb.botFrameworkService.memoryApi.addMemoryItemV2(e)}async regenerateMemorySuggestion(e){return n.Cb.botFrameworkService.memoryApi.regenerateMemorySuggestion(e)}async updateMemoryItem(e){await n.Cb.botFrameworkService.memoryApi.updateMemoryItemV2(e);let t=await this.storage.get("memoryV2");if(t){let i=t.itemList||[],a=i.findIndex(t=>t.id===e.itemId);-1!==a&&(i[a].content=e.content,i[a].updatedTime=Date.now()),this.storage.set("memoryV2",{...t,itemList:i})}}async acceptMemorySuggestion(e){return n.Cb.botFrameworkService.memoryApi.acceptMemorySuggestion(e)}async rejectMemorySuggestion(e){return n.Cb.botFrameworkService.memoryApi.rejectMemorySuggestion(e)}rejectAllMemorySuggestions(){return n.Cb.botFrameworkService.memoryApi.rejectAllMemorySuggestions()}async getMemorySuggestions(e,t,i){let a=async()=>{var a,o,s;let{data:r}=await n.Cb.botFrameworkService.memoryApi.getMemorySuggestions(e);return!e.offset&&(this.storage.set("memorySuggestions",null!==(a=r.suggestions)&&void 0!==a?a:null),(null==i?void 0:i.useCache)&&(null==t||t({list:null!==(o=r.suggestions)&&void 0!==o?o:[],total:r.total||0}))),{list:null!==(s=r.suggestions)&&void 0!==s?s:[],total:r.total||0}};if(!e.offset&&(null==i?void 0:i.useCache)){let e=await this.storage.get("memorySuggestions")||[];if(e.length>0)return a(),{list:e,total:e.length}}return await a()}async clearMemory(){await n.Cb.botFrameworkService.memoryApi.clearMemoryV2();let e=await this.storage.get("memoryV2");this.storage.set("memoryV2",{...e,itemList:[]})}async toggleMemoryItemPin(e){e.pinned?await n.Cb.botFrameworkService.memoryApi.unpinMemoryItemV2({itemId:e.id}):await n.Cb.botFrameworkService.memoryApi.pinMemoryItemV2({itemId:e.id});let t=await this.storage.get("memoryV2"),i=(null==t?void 0:t.itemList)||[];this.storage.set("memoryV2",{...t,itemList:i.map(t=>t.id===e.id?{...t,pinned:!e.pinned}:t)})}async saveBot(e){var t,i,a,o;let{data:s}=await n.Cb.botFrameworkService.customBotApi.saveBot(e),r=await this.storage.get("myBots");r||(r={list:[],total:0});let d=await this.services.user.getUserInfo({cacheOnly:!0}),c={createdAt:Date.now(),updatedAt:Date.now(),creatorInfo:{avatar:null==d?void 0:d.avatar,name:null==d?void 0:d.name,userId:null==d?void 0:d.id},userAction:{actionPinned:!1,actionAdded:!1,actionLike:!1,actionUsed:!1},hasKnowledgeBase:((null===(i=s.toolData)||void 0===i?void 0:null===(t=i.knowledgeList)||void 0===t?void 0:t.length)||0)>0,hasUserSkill:((null===(o=s.toolData)||void 0===o?void 0:null===(a=o.userSkillList)||void 0===a?void 0:a.length)||0)>0,uid:s.uid,...s,type:s.type||"chat_bot"},h=r.list.findIndex(e=>e.uid===s.uid);return -1!==h?r.list[h]=(0,l.Z)(c,s):(r.list.unshift(c),r.total+=1),this.storage.set("myBots",r),c}async saveMonicaBot(e){let t=await n.Cb.botFrameworkService.userClientConfigApi.saveMonicaConfig(e);return this.updateMonicaConfig(e),t}async getCacheFavoriteList(){return await this.storage.get("favoriteList")}async getRemoteFavoriteList(e){let t=await n.Cb.botFrameworkService.customBotApi.getConversationList({...e,isFavorite:1});return 0===e.offset&&t.data.itemsList&&this.storage.set("favoriteList",t.data.itemsList.slice(0,10)),t.data}async getConversationById(e){var t;let i=await this.storage.get("conversationList");return null==i?void 0:null===(t=i.itemsList)||void 0===t?void 0:t.find(t=>t.conversationId===e)}async getConversationList(e,t){let{useCache:i=!0,autoUpdate:a=!0,cacheOnly:o=!1}=t||{},{keyword:s,offset:r,pdfId:l,isFavorite:d,chatBotUid:c}=e,h=async()=>{let t=await n.Cb.botFrameworkService.customBotApi.getConversationList(e);if(!s&&!r&&!l&&void 0===d&&void 0===c){var i;this.setConversationList(t.data),(null===(i=t.data.itemsList)||void 0===i?void 0:i.length)&&this.emit("recentConversationChange",t.data.itemsList[0])}return t.data};if(i||o){let e=await this.storage.get("conversationList");return o||a&&h(),e}return await h()}async deleteConversation(e){this.emit("conversationChange",{type:"delete",conversationIdList:[e]}),this.storage.get("conversationList").then(async t=>{let i=[...t.itemsList||[]],a=i.findIndex(t=>t.conversationId===e);-1!==a&&(i.splice(a,1),this.setConversationList({...t,itemsList:i}))}),this.storage.get("favoriteList").then(async t=>{let i=t||[],a=i.findIndex(t=>t.conversationId===e);-1!==a&&(i.splice(a,1),this.storage.set("favoriteList",i))})}async updateConversationByLocal(e){if(!e.conversationId){globalThis.console.log("cannot get conversation id");return}this.emit("conversationChange",{type:"update",conversation:{...e}}),this.storage.get("conversationList").then(t=>{let i=t.itemsList||[],a=i.findIndex(t=>t.conversationId===e.conversationId);-1!==a?i[a]={...i[a],...e}:i.unshift({...e}),this.setConversationList({...t,itemsList:i})}),await n.Cb.botFrameworkService.customBotApi.updateConversation({conversationId:e.conversationId,title:e.title})}async refreshConversationList(){this.emit("conversationChange",{type:"refresh"})}async deleteConversationList(e){var t;let{conversationIdList:i}=e;this.emit("conversationChange",{type:"delete",conversationIdList:i});let a=await this.storage.get("conversationList"),o=null==a?void 0:null===(t=a.itemsList)||void 0===t?void 0:t.flatMap(e=>e.conversationId&&i.includes(e.conversationId)?[]:[e]);return this.setConversationList({...a,itemsList:o}),await n.Cb.taskApi.deleteConversationList(e)}async emitConvListChange(e){var t;let i=()=>{var t;(null===(t=this.lastCaller)||void 0===t?void 0:t.tabId)&&this.emit("convListChange",{...e,lastSenderTabId:this.lastCaller.tabId})};return Promise.resolve().then(()=>{i()}),null===(t=this.lastCaller)||void 0===t?void 0:t.tabId}async emitCancelLastChat(e){var t;let i=()=>{var t;(null===(t=this.lastCaller)||void 0===t?void 0:t.tabId)&&this.emit("cancelConvListChange",{...e,lastSenderTabId:this.lastCaller.tabId})};return Promise.resolve().then(()=>{i()}),null===(t=this.lastCaller)||void 0===t?void 0:t.tabId}async getBotDetail(e){return await n.Cb.botFrameworkService.customBotApi.getBotDetail(e)}async getBotEditDetail(e){return await n.Cb.botFrameworkService.customBotApi.getBotEditDetail(e)}async getMyBotList(e){let t=async()=>{let t=await n.Cb.botFrameworkService.customBotApi.listMyBots(e);return await this.storage.set("myBots",{total:t.data.total||0,list:t.data.items||[]}),{total:t.data.total||0,list:t.data.items||[]}};if(0===e.offset){let e=await this.storage.get("myBots");if(e)return t(),e}return await t()}async setSysSkills(e){let t=await this.storage.get("monicaBotConfig");t?(t.monicaSysSkillList=e,this.storage.set("monicaBotConfig",t)):this.storage.set("monicaBotConfig",{monicaSysSkillList:e}),await n.Cb.botFrameworkService.userClientConfigApi.updateMonicaSkillConfig({sysSkillList:e})}async updateMonicaConfig(e){let t=await this.storage.get("monicaBotConfig");t?(t=(0,l.Z)(t,e)).monicaUserSkillList=e.monicaUserSkillList:t=e,this.storage.set("monicaBotConfig",t)}async getMonicaBotConfig(e){return this._fetchWithCache("monicaBotConfig",async()=>(await n.Cb.botFrameworkService.userClientConfigApi.getMonicaConfig()).data,e)}async createSkill(e){return await n.Cb.botFrameworkService.botSkillApi.createSkill(e)}async updateSkill(e){return await n.Cb.botFrameworkService.botSkillApi.updateSkill(e)}async parseSchema(e){return await n.Cb.botFrameworkService.botSkillApi.parseSchema(e)}async getSkillList(){let{data:e}=await n.Cb.botFrameworkService.botSkillApi.getSkillList({});return e}async deleteSkill(e){await n.Cb.botFrameworkService.botSkillApi.removeSkill(e)}async getKnowledgeList(){let{data:e}=await n.Cb.botFrameworkService.knowledgeApi.listBases({});return e.items||[]}async createKnowledge(e,t){return n.Cb.botFrameworkService.knowledgeApi.createBase(e,t)}async updateKnowledge(e,t){return n.Cb.botFrameworkService.knowledgeApi.updateBase(e,t)}async deleteKnowledge(e,t){return n.Cb.botFrameworkService.knowledgeApi.deleteBase(e,t)}async getKnowledgeDocuments(e,t){let{data:i}=await n.Cb.botFrameworkService.knowledgeApi.listDocuments(e,t);return i.items||[]}async updateDocuments(e,t){return n.Cb.botFrameworkService.knowledgeApi.uploadDocuments(e,t)}async deleteDocuments(e){return n.Cb.botFrameworkService.knowledgeApi.deleteDocuments(e)}async getTaskListByBotUid(e,t){let{useCache:i=!0}=t||{},a=await this.storage.get("taskListMap"),o=n.Cb.botFrameworkService.botTaskApi.taskList(e).then(t=>{let{data:i}=t;return a[e.botUid]=i.list,this.storage.set("taskListMap",a),i.list});return i&&a[e.botUid]?a[e.botUid]:await o}async deleteTask(e){let{botUid:t,uid:i}=e;await n.Cb.botFrameworkService.botTaskApi.removeTask({uid:i});let a=await this.storage.get("taskListMap");a&&(a[t]=(a[t]||[]).filter(e=>e.uid!==i),await this.storage.set("taskListMap",a))}async getNotifications(){let{data:e}=await n.Cb.botFrameworkService.botTaskApi.notificationList({});return e.list||[]}async notificationMarkReadAll(){await n.Cb.botFrameworkService.botTaskApi.notificationMarkRead({}),this.emit("notificationChange",[])}async notificationMarkRead(e){await n.Cb.botFrameworkService.botTaskApi.notificationMarkReadById(e)}async savePublishStatus(e){await n.Cb.botFrameworkService.customBotApi.publishBot(e);let t=await this.storage.get("myBots");if(t){let i=t.list.findIndex(t=>t.uid===e.botData.uid);if(-1!==i){let a=e.publishState;t.list[i].isPublished=!0,t.list[i].accessByLink="access_by_link"===a,t.list[i].isPublic="every_one"===a,this.storage.set("myBots",t)}}}async genAvatar(e,t){let i=new AbortController,a=i.signal;return this.abortMap[e]=i,n.Cb.botFrameworkService.customBotApi.genAvatar(t,{abortSignal:a})}async genPrompt(e,t){let i=new AbortController,a=i.signal;return this.abortMap[e]=i,n.Cb.botFrameworkService.customBotApi.genPrompt(t,{abortSignal:a})}async cancelApi(e){let t=this.abortMap[e];t&&t.abort()}async revertBot(e){return n.Cb.botFrameworkService.customBotApi.revertBotDraft(e)}async getExploreChatBots(){return n.Cb.botFrameworkService.customBotApi.exploreChatBots({})}async deleteBot(e){let t=await n.Cb.botFrameworkService.customBotApi.deleteBot(e),i=await this.storage.get("myBots");if(i){let t=i.list.findIndex(t=>t.uid===e.uid);-1!==t&&(i.list.splice(t,1),i.total-=1,this.storage.set("myBots",i))}return t}async searchChatBots(e,t){return n.Cb.botFrameworkService.customBotApi.searchChatBots(e,t)}async optimizePrompt(e,t){let i=new AbortController,a=i.signal;return this.abortMap[e]=i,n.Cb.botFrameworkService.quickActionApi.promptOptimize(t,{abortSignal:a})}async getCodeInterpreterFile(e){return n.Cb.botFrameworkService.customBotApi.getCodeInterpreterFile(e)}async recommendTabs(e){return n.Cb.botFrameworkService.magicWandApi.recommendTabs(e)}async rerankTabs(e){return n.Cb.botFrameworkService.magicWandApi.rerankTabs(e)}async getStorageConvInfo(e){var t;return null===(t=(await this.storage.get("conversationList")).itemsList)||void 0===t?void 0:t.find(t=>t.conversationId===e)}async getConvAttachmentList(e){return n.Cb.botFrameworkService.customBotApi.convAttachmentList({conversationId:e})}async loopGetNotifications(){try{let e=await this.getNotifications();this.emit("notificationChange",e),await s.m.asyncDelay(3e5),this.loopGetNotifications(),this.loopNotificationErrorCount=0}catch(e){if(console.error(e),this.loopNotificationErrorCount++,this.loopNotificationErrorCount>5)return;await s.m.asyncDelay(5e3),this.loopGetNotifications()}}async setLastActiveConversation(e){await this.storage.set("lastActiveConversation",e)}async getLastActiveConversation(){return await this.storage.get("lastActiveConversation")}async getImBotBindCode(){return n.Cb.botFrameworkService.imBotApi.getBindCode()}async getImBotLinkedAccounts(){return n.Cb.botFrameworkService.imBotApi.linkedAccounts()}async unbindImBotAccount(e){return n.Cb.botFrameworkService.imBotApi.unbind(e)}async fetchFavoriteGroupList(e){return this._fetchWithCache("favoriteGroupList",async()=>(await n.Cb.botFrameworkService.customBotApi.collectionGroupList({})).data.groups||[],e)}async createFavoriteGroup(e){let{name:t,order:i,groupUid:a}=e,o=await this.storage.get("favoriteGroupList");return this.storage.set("favoriteGroupList",[...o||[],{order:i,name:t,uid:a}]),n.Cb.botFrameworkService.customBotApi.createCollectionGroup(e)}async moveFavoriteGroup(e,t){if(!e.conversationId||!t)return;await n.Cb.botFrameworkService.customBotApi.moveCollectionGroup({conversationId:e.conversationId,groupUid:t});let i=await this.storage.get("favoriteList"),a=i.findIndex(t=>t.conversationId===e.conversationId);-1!==a?i[a].collectionGroupUid=t:i.push({...e,collectionGroupUid:t,isFavorite:!0}),this.storage.set("favoriteList",i)}async deleteFavoriteGroup(e){if(await n.Cb.botFrameworkService.customBotApi.deleteCollectionGroup(e),!e.clearConversations){var t;null===(t=(await this.storage.get("conversationList")).itemsList)||void 0===t||t.forEach(t=>{t.collectionGroupUid===e.groupUid&&this.updateConversationByLocal({collectionGroupUid:"default",conversationId:t.conversationId})})}let i=await this.storage.get("favoriteGroupList");this.storage.set("favoriteGroupList",i.flatMap(t=>t.uid!==e.groupUid?[t]:[]))}async updateFavoriteGroup(e){let t=await this.storage.get("favoriteGroupList");return this.storage.set("favoriteGroupList",t.map(t=>t.uid===e.groupUid?{...t,...e}:t)),n.Cb.botFrameworkService.customBotApi.updateCollectionGroup(e)}async resortFavoriteGroup(e){let{groups:t}=e,i=await this.storage.get("favoriteGroupList"),a=t.flatMap(e=>{let t=i.find(t=>t.uid===e.groupUid);return t?[t]:[]});return this.storage.set("favoriteGroupList",a),n.Cb.botFrameworkService.customBotApi.resortCollectionGroup(e)}async setConversationList(e){await this.storage.set("conversationList",e)}async updateConversationInfo(e){let{conversationId:t,title:i,hasImg:a,hasDoc:o}=e;return this.updateConversationByLocal({conversationId:t,title:i,infoData:{hasImg:a,hasDoc:o,hasArtifact:!0}}),n.Cb.botFrameworkService.customBotApi.updateConversation(e)}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"botFramework",name:"BotFrameworkService"}),(0,o._)(this,"dependencies",["user"]),(0,o._)(this,"defaultStorageValues",{monicaBotConfig:null,defaultMonicaModel:null,taskListMap:{},recommendSkillList:[],conversationList:{},favoriteList:[],memory:{},memoryV2:null,notifyConfig:[],myBots:null,lastActiveConversation:null,lastMemoryUpdateTime:null,memorySuggestions:null,favoriteGroupList:[]}),(0,o._)(this,"loopNotificationFlag",!1),(0,o._)(this,"loopNotificationErrorCount",0),(0,o._)(this,"abortMap",{})}}let c=new a.x(d)},19110:function(e,t,i){"use strict";i.d(t,{Y:function(){return n},Zw:function(){return a},wX:function(){return s},yN:function(){return o}});let a={sdxl:3,sd3:24,sd3_5:65,flux_pro:42,flux_dev:24,flux_schnell:3,dalle3:30,playground2_5:6,ideogram2:80,recraft3:30,imagen3:30,flux_ultra:40,pix_ai:10,"gpt-image-1":10},o={svd:25,runway:200,minimax:200,pixverse:100,pika:30,kling:60,klingV1_6:60,veo2:240,wan2_1:200},s={cards_and_invites:6,logo:6,mobile_wallpaper:6,poster:6,sticker:6},n={image:a,imageOtherTool:24,videoTool:25,klingVideo:250}},94037:function(e,t,i){"use strict";i.d(t,{$:function(){return p}});var a=i(56607),o=i(66084),s=i(74876),n=i(55180),r=i(63647),l=i(31284);let d="updates";class c{async waitReady(){return await this._whenReady.promise}async addAutoKey(e,t){let i=s.b.decode(t),a=this.ensureTransaction(e);await r.yP(a,i)}async getAll(e,t,i){let a=this.ensureTransaction(e);return(await r.go(a,r.sc(t,i))).map(e=>s.b.encode(e))}async getLastKey(e){let t=this.ensureTransaction(e);return r.S_(t)}async count(e){let t=this.ensureTransaction(e);return r.QX(t)}async del(e,t){let i=this.ensureTransaction(e);await r.IV(i,r.UE(t,!0))}async close(){this.db.close()}async clearData(){r.Lj(this._name)}async clearTransaction(e){this._transactionMap.delete(e)}ensureTransaction(e){if(this._closeTransaction){let[e]=r.ay(this.db,[d]);return e}let t=this._transactionMap.get(e);if(!t){let[i]=r.ay(this.db,[d]);t=i,this._transactionMap.set(e,t)}return t}constructor(e){(0,o._)(this,"db",void 0),(0,o._)(this,"_whenReady",new l.B),(0,o._)(this,"_db",void 0),(0,o._)(this,"_name",void 0),(0,o._)(this,"_transactionMap",new Map),(0,o._)(this,"_closeTransaction",!1),this._name=e,this._db=r.X3(e,e=>r._w(e,[["updates",{autoIncrement:!0}],["custom"]])),this._db.then(e=>{this.db=e,this._whenReady.resolve(this)}),this._closeTransaction=a.o.isExtension}}class h extends n.b{async connectDB(e){let t=this.dbs.get(e);return t||(t=new c(e).waitReady(),this.dbs.set(e,t)),await t}async hasCache(e){return indexedDB.databases().then(t=>!!t.find(t=>t.name===e))}async addAutoKey(e,t,i){let a=await this._getDBService(e);await a.addAutoKey(t,i)}async getAll(e,t,i,a){let o=await this._getDBService(e);return await o.getAll(t,i,a)}async getLastKey(e,t){let i=await this._getDBService(e);return await i.getLastKey(t)}async count(e,t){let i=await this._getDBService(e);return await i.count(t)}async del(e,t,i){let a=await this._getDBService(e);return await a.del(t,i)}async close(e){let t=this.dbs.get(e);t&&await t}async clearData(e){let t=await this._getDBService(e);return await t.clearData()}async clearTransaction(e,t){let i=await this._getDBService(e);return await i.clearTransaction(t)}async deleteDB(e){r.Lj(e)}async onInit(){}async _getDBService(e){return await this.connectDB(e)}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"DBManager",name:"DBManagerService",storagePrefix:"DBManager"}),(0,o._)(this,"dependencies",[]),(0,o._)(this,"defaultStorageValues",{}),(0,o._)(this,"dbs",new Map)}}var g=i(83260);let p=a.o.isDesktop?new h:new g.x(h)},91990:function(e,t,i){"use strict";i.d(t,{U:function(){return o},j:function(){return a}});let a=["removeBackground","removeText","removeBrushedArea","removeObject","changeBackground","upscale"],o=[...a,"imageGenerator","imageAnimator","generateImageByScenario","editImage","template","realtimeGenerateImageByText","realtimeGenerateImageByCanvas"]},63869:function(e,t,i){"use strict";i.d(t,{i7:function(){return c}});var a=i(83260),o=i(66084),s=i(55180),n=i(92235),r=i(65324),l=JSON.parse('[{"key":"imageGenerator","seq":1,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/movie_style/image.webp","payload":{"prompt":"Blockbuster-style post-war scene","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"movie_1","video":""},{"key":"imageGenerator","seq":2,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/movie_style/wBMJb.webp","payload":{"prompt":"Movie-quality blockbuster image of a flying dragon and a castle","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"movie_2","video":""},{"key":"imageGenerator","seq":3,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/movie_style/wBTDe.webp","payload":{"prompt":"cinematic","model_type":"flux_pro","aspect_ratio":"16:9","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"movie_3","video":""},{"key":"imageGenerator","seq":4,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/movie_style/gMWLs.webp","payload":{"prompt":"fantasy full body image of an ice viking covered in snow and ice, with an enormous spiky spear and a big rectangular shield","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"movie_4","video":""},{"key":"imageAnimator","seq":5,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/video/thumb1.jpg","payload":{"prompt":"A polar bear is playing the violin in the snow","mode":"pro","model_type":"kling","duration":"5s","aspect_ratio":"16:9","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"animator_1","video":"https://assets.monica.im/assets/image_tools/gallery/media_files/video/kling_2_16:9.mp4"},{"key":"imageAnimator","seq":6,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/video/thumb2.jpg","payload":{"prompt":"An orange cat kneading dough on a cutting board, with a background of a village vegetable garden in the countryside","mode":"pro","model_type":"kling","duration":"5s","aspect_ratio":"1:1","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"animator_2","video":"https://assets.monica.im/assets/image_tools/gallery/media_files/video/k2.mp4"},{"key":"imageAnimator","seq":7,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/video/thumb3.jpg","payload":{"prompt":"A racing car speeding on the surface of the moon, space background, tilt-shift zoom","mode":"pro","model_type":"kling","duration":"5s","aspect_ratio":"1:1","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"animator_3","video":"https://assets.monica.im/assets/image_tools/gallery/media_files/video/k3.mp4"},{"key":"imageAnimator","seq":8,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/video/thumb4.jpg","payload":{"prompt":"A medieval sailing ship on the sea","mode":"pro","model_type":"kling","duration":"5s","aspect_ratio":"16:9","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"animator_4","video":"https://assets.monica.im/assets/image_tools/gallery/media_files/video/kling_5_16:9.mp4"},{"key":"imageGenerator","seq":9,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/realistic/r2.webp","payload":{"prompt":"An Asian woman, in warm light, vintage, 80s, realistic, the image is highly evocative of a story","model_type":"flux_pro","aspect_ratio":"16:9","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"realistic_2","video":""},{"key":"imageGenerator","seq":10,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/realistic/r1.webp","payload":{"prompt":"A photo of an Asian woman at home, smiling relaxed and happy, sunlight on her face, wearing cream and green colored clothing","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"realistic_1","video":""},{"key":"imageGenerator","seq":11,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/realistic/flux_23_9:16.webp","payload":{"prompt":"lovely double exposure image by blending together a stormy sea and a glass apple. The sea should serve as the underlying backdrop, with its details subtly incorporated into the glossy glass apple, sharp focus, double exposure, glossy glass apple, (translucent glass figure of an apple) (sea inside) lifeless, dead, glass apple, earthy colors, decadence, intricate design, hyper realistic, high definition, extremely detailed, dark softbox image, raytracing, cinematic, HDR, photorealistic (double exposure:1.1)","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"realistic_3","video":""},{"key":"imageGenerator","seq":12,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/realistic/flux_4_1:1.webp","payload":{"prompt":"A black and white portrait of a woman, subtle play of light and shadow, close-up photography by photographer Rogelio Reis using Leica M11","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"realistic_4","video":""},{"key":"imageGenerator","seq":13,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/oil_painting/sdxl_56_16:9.webp","payload":{"prompt":"oil painting, a group of flowers are in a glass vase, in the style of realistic watercolor paintings, charming illustrations, english painter, chromatic purity, high resolution, illustration","model_type":"sdxl","aspect_ratio":"16:9","image_style":"oil_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"oil_painting_1","video":""},{"key":"imageGenerator","seq":14,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/oil_painting/rNcw2.webp","payload":{"prompt":"Oil painting style sunset","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"oil_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"oil_painting_2","video":""},{"key":"imageGenerator","seq":15,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/oil_painting/flux_25_16:9.webp","payload":{"prompt":"Incredible attention to detail showcases the iconic figure of Jesus in the style of Leonardo da Vinci. This masterful painting captures the essence of Jesus with captivating precision and artistry. The image portrays Jesus with delicate brushstrokes and exquisite shading, illuminating his serene expression and tender eyes. Every facial feature is meticulously rendered, evoking a profound sense of divinity and wisdom. The rich colors and subtle highlights further enhance the depth and realism of the painting, emanating an undeniable aura of brilliance. This exceptional artwork immortalizes Jesus in a truly magnificent and awe-inspiring manner.","model_type":"flux_pro","aspect_ratio":"16:9","image_style":"oil_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"oil_painting_3","video":""},{"key":"imageGenerator","seq":16,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/oil_painting/sdxl_51_1:1.webp","payload":{"prompt":"decorative vase roses, in the style of intricate, delicate flower and garden paintings, pastoral charm","model_type":"sdxl","aspect_ratio":"1:1","image_style":"oil_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"oil_painting_4","video":""},{"key":"imageGenerator","seq":17,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/japanese_anime/TWYik.webp","payload":{"prompt":"2d Japanese anime animal","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"japanese_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"japanese_anime_4","video":""},{"key":"imageGenerator","seq":18,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/japanese_anime/f59zX.webp","payload":{"prompt":"2d Japanese anime animal","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"japanese_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"japanese_anime_2","video":""},{"key":"imageGenerator","seq":19,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/japanese_anime/8Bv59.webp","payload":{"prompt":"Clean scene illustration from Japanese anime","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"japanese_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"japanese_anime_3","video":""},{"key":"imageGenerator","seq":20,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/japanese_anime/flux_2_1:1.webp","payload":{"prompt":"A woman in workwear, crazy details, ultra HD quality, close-up upper body shot","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"japanese_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"japanese_anime_1","video":""},{"key":"imageGenerator","seq":21,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/fantasy_art/flux_15_1:1.webp","payload":{"prompt":"A mountain with an alien planet in the background, dark sky, night scene, hyper-realistic style","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"fantasy_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"fantasy_art_4","video":""},{"key":"imageGenerator","seq":22,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/fantasy_art/RAMIN.webp","payload":{"prompt":"fantasy","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"fantasy_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"fantasy_art_3","video":""},{"key":"imageGenerator","seq":23,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/fantasy_art/8HksQ.webp","payload":{"prompt":"Fantasy universe","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"fantasy_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"fantasy_art_2","video":""},{"key":"imageGenerator","seq":24,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/fantasy_art/lTaHi.webp","payload":{"prompt":"fantasy","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"fantasy_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"fantasy_art_1","video":""},{"key":"imageGenerator","seq":25,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/cyberpunk/zZUYQ.webp","payload":{"prompt":"Cyberpunk underwater world","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"cyberpunk","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"cyberpunk_4","video":""},{"key":"imageGenerator","seq":26,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/cyberpunk/L4bba.webp","payload":{"prompt":"Cyberpunk-style elephant","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"cyberpunk","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"cyberpunk_2","video":""},{"key":"imageGenerator","seq":27,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/cyberpunk/i7mzo.webp","payload":{"prompt":"Cyberpunk-style music stage","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"cyberpunk","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"cyberpunk_3","video":""},{"key":"imageGenerator","seq":28,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/cyberpunk/thf53.webp","payload":{"prompt":"cuberpunk","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"cyberpunk","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"cyberpunk_1","video":""},{"key":"imageGenerator","seq":29,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/3d_modeling/ZVYVi.webp","payload":{"prompt":"3D model of an ancient dragon","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"3d_modeling","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"3d_modeling_4","video":""},{"key":"imageGenerator","seq":30,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/3d_modeling/7BgIA.webp","payload":{"prompt":"3D model of a yacht","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"3d_modeling","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"3d_modeling_3","video":""},{"key":"imageGenerator","seq":31,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/3d_modeling/SqiRx.webp","payload":{"prompt":"3D model of a fighter jet","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"3d_modeling","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"3d_modeling_2","video":""},{"key":"imageGenerator","seq":32,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/3d_modeling/fFWst.webp","payload":{"prompt":"3D model of a pink fantasy castle","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"3d_modeling","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"3d_modeling_1","video":""},{"key":"imageGenerator","seq":33,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/3d_anime/qXHSD.webp","payload":{"prompt":"A cute snowman with a blue bucket on its head and a blue scarf, standing on the snow, singing with its mouth open","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"3d_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"3d_anime_1","video":""},{"key":"imageGenerator","seq":34,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/3d_anime/sdxl_3_16:9.webp","payload":{"prompt":"Felt art, Shiba Inu, subdued colors, highly detailed, outdoor background","model_type":"sdxl","aspect_ratio":"16:9","image_style":"3d_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"3d_anime_2","video":""},{"key":"imageGenerator","seq":35,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/3d_anime/aaa.webp","payload":{"prompt":"Little girl eating watermelon","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"3d_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"3d_anime_3","video":""},{"key":"imageGenerator","seq":36,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/3d_anime/zN5vm.webp","payload":{"prompt":"A corner of a caf\xe9 drawn with colored pencils","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"3d_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"3d_anime_4","video":""},{"key":"imageGenerator","seq":37,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/comic/rvHH2.webp","payload":{"prompt":"comics","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"comic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"comic_1","video":""},{"key":"imageGenerator","seq":38,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/comic/qXHSD.webp","payload":{"prompt":"midshot, (cel-shading style:1.3), centered image, ultra detailed illustration of Master chief from Halo, posing, (tetradic colors), inkpunk, (ink lines:1.1), strong outlines, art by MSchiffer, bold traces, unframed, high contrast, (cel-shaded:1.1), vector, 32k resolution, best quality, flat colors, flat lights","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"comic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"comic_2","video":""},{"key":"imageGenerator","seq":39,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/comic/bbb.webp","payload":{"prompt":"Comic-style character portrait","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"comic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"comic_3","video":""},{"key":"imageGenerator","seq":40,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/comic/BtCpk.webp","payload":{"prompt":"comics","model_type":"flux_pro","aspect_ratio":"16:9","image_style":"comic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"comic_4","video":""},{"key":"imageGenerator","seq":41,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/colored_pencil_drawing/jUVIg.webp","payload":{"prompt":"Colored pencil style city corner sketch","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"colored_pencil_drawing","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"colored_pencil_2","video":""},{"key":"imageGenerator","seq":42,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/colored_pencil_drawing/MLVYu.webp","payload":{"prompt":"Colored pencil portrait","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"colored_pencil_drawing","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"colored_pencil_1","video":""},{"key":"imageGenerator","seq":43,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/colored_pencil_drawing/owaHO.webp","payload":{"prompt":"Colored pencil beach, shells visible on the beach","model_type":"flux_pro","aspect_ratio":"16:9","image_style":"colored_pencil_drawing","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"colored_pencil_3","video":""},{"key":"imageGenerator","seq":44,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/colored_pencil_drawing/pqOEx.webp","payload":{"prompt":"Colored pencil succulent plants","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"colored_pencil_drawing","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"colored_pencil_4","video":""},{"key":"imageGenerator","seq":45,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/pixel_art/OM0zC.webp","payload":{"prompt":"In the style of Jean Giraud, in the style of Moebius in the style of HR Giger science fiction the movie, In the style of Jean Giraud, in the style of Moebius, in the style of HR Giger science fiction the movie good spaceship, background is black","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"pixel_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"pixel_art_4","video":""},{"key":"imageGenerator","seq":46,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/pixel_art/pUxRL.webp","payload":{"prompt":"A girl wearing a yellow long dress with a big sun hat facing the sunrise, the breeze lifting the hem of the dress, pixel style","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"pixel_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"pixel_art_3","video":""},{"key":"imageGenerator","seq":47,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/pixel_art/1AT84.webp","payload":{"prompt":"Pixel-style dark castle","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"pixel_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"pixel_art_2","video":""},{"key":"imageGenerator","seq":48,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/pixel_art/ZpdJy.webp","payload":{"prompt":"Pixel-style UFO","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"pixel_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"pixel_art_1","video":""},{"key":"imageGenerator","seq":49,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/watercolor_painting/353D9.webp","payload":{"prompt":"Light watercolor European vase flowers","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"watercolor_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"watercolor_1","video":""},{"key":"imageGenerator","seq":50,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/watercolor_painting/WSjOL.webp","payload":{"prompt":"Rich color vintage portrait in light watercolor","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"watercolor_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"watercolor_3","video":""},{"key":"imageGenerator","seq":51,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/watercolor_painting/playground_18_1:1.webp","payload":{"prompt":"(Anna Dittmann),(masterpiece), (best quality), (super delicate), (illustration), (extremely delicate and beautiful), Album rendering, album description , art, abstract art, geometry, clear lines, squares, bright, limited palette (1 girl) , (cute animated face: 1.3) , flat-chested, short red hair, blue eyes, short wavy hair, small bumps on face, floating black jacket, white school uniform, white beret, white beret bow, floating black feathers: 0.5,full body,dynamic angle,best quality,bowties,bright_eyes,extremely_detailed_eyes_and_face,beautiful detailed girl,Holding a paintbrush, drawing board, and easel in hand","model_type":"playground2_5","aspect_ratio":"1:1","image_style":"watercolor_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"watercolor_2","video":""},{"key":"imageGenerator","seq":52,"image":"https://assets.monica.im/assets/image_tools/gallery/media_files/watercolor_painting/pYWOn.webp","payload":{"prompt":"Light watercolor still life study","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"watercolor_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"watercolor_4","video":""},{"key":"imageGenerator","seq":53,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/fGAXb-0x1365.webp","payload":{"prompt":"fantasy full body image of an armored female knight covered in snow and ice, with a sword and rope","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_1","video":""},{"key":"generateImageByScenario","seq":54,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/MHbSl-0x1024.webp","payload":{"prompt":"A nature-inspired logo with green tones, leaf icons, and handwritten typography for an organic feel.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"logo","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_2","video":""},{"key":"imageGenerator","seq":55,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/Y8CqD-0x1365.webp","payload":{"prompt":"A cozy cafe on a city corner at midnight, raindrops sliding down large windows, warm yellow light inside illuminating a few pensive customers.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_3","video":""},{"key":"generateImageByScenario","seq":56,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/6b8i4-0x1024.webp","payload":{"prompt":"A vintage-style logo inspired by 80s neon signs, featuring bold typography and vibrant glowing colors","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"logo","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_4","video":""},{"key":"imageGenerator","seq":57,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/ZqNqA-0x768.webp","payload":{"prompt":"A sports car speeding down a desolate desert highway, kicking up dust, with police cars in hot pursuit, and a magnificent sunset in the distance.","model_type":"flux_pro","aspect_ratio":"16:9","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_5","video":""},{"key":"imageGenerator","seq":58,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/mD29f-0x1024.webp","payload":{"prompt":"On a dimly lit street, a detective in a hat and trench coat stands under a streetlamp as rain pours down, his silhouette cast on the wet sidewalk.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_6","video":""},{"key":"imageGenerator","seq":59,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/wptmz-0x1365.webp","payload":{"prompt":"A massive black obelisk stands in the center of a vast desert, surrounded by golden sand dunes under an orange-red sunset sky.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_7","video":""},{"key":"imageGenerator","seq":60,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/NGEtg-0x1024.webp","payload":{"prompt":"A grey-bearded master distiller examining whiskey between oak barrels, holding a glass sampling tube in an ancient stone-walled cellar.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_8","video":""},{"key":"imageGenerator","seq":61,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/nO4ec-0x1024.webp","payload":{"prompt":"A female artist in paint-stained overalls working on a large canvas in a spacious studio, natural light streaming through skylights.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"movie_style","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_9","video":""},{"key":"imageGenerator","seq":62,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/xBUTJ-0x768.webp","payload":{"prompt":"An African American saxophonist performing in a dimly lit jazz club, spotlight illuminating his gleaming instrument and concentrated expression, surrounded by ambient smoke.","model_type":"flux_pro","aspect_ratio":"16:9","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_10","video":""},{"key":"generateImageByScenario","seq":63,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/WVEDP-0x1024.webp","payload":{"prompt":"A dynamic logo for a sports team with bold, italicized text, aggressive animal mascots, and fiery accents.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"logo","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_11","video":""},{"key":"imageGenerator","seq":64,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/MucJj-0x1024.webp","payload":{"prompt":"A weathered farmer standing in a golden wheat field, holding freshly cut wheat stalks, backlit by the setting sun against vast farmland.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_12","video":""},{"key":"imageGenerator","seq":64.135,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/IAW6b-0x1024.webp","payload":{"prompt":"Illustrate a true-to-life image of a young Caucasian girl with freckles and auburn hair, smiling playfully while holding a bouquet of wildflowers in a meadow.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_83","video":""},{"key":"imageGenerator","seq":64.136,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/mIs53-0x1365.webp","payload":{"prompt":"Design a lifelike close-up image of a young European woman with striking green eyes and flowing blonde hair, highlighting her natural freckles and subtle smile.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_84","video":""},{"key":"imageGenerator","seq":64.137,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/Yxaxh-0x1024.webp","payload":{"prompt":"Generate a black and white close-up of a middle-aged Caucasian woman with expressive eyes and a serene smile, focusing on the subtle play of light and shadow across her face.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_85","video":""},{"key":"imageGenerator","seq":64.138,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/JMgo9-0x1024.webp","payload":{"prompt":"Design a monochrome image of a young European woman with striking features and intense eyes, capturing the contrast and shadows that enhance her natural beauty.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_86","video":""},{"key":"imageGenerator","seq":64.139,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/6GQ1e-0x1024.webp","payload":{"prompt":"A close-up portrait of an African American female artist. She has dark skin and a curly natural hairstyle. Her eyes are deep and contemplative. She\'s wearing a loose white shirt with a simple silver necklace. Soft side lighting accentuates her facial features and skin texture.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_87","video":""},{"key":"imageGenerator","seq":64.14,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/S8YbX-0x1365.webp","payload":{"prompt":"A joyful portrait of an elderly Caucasian man. He has thick white hair and a beard, with laugh lines covering his face. He\'s laughing heartily, his eyes almost closed from the laughter. He\'s wearing a plaid shirt, with a slightly blurred background suggesting a home or outdoor setting. The whole image exudes warmth and joy.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_88","video":""},{"key":"imageGenerator","seq":64.141,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/RoAKB-0x1024.webp","payload":{"prompt":"A half-body portrait of a handsome middle-aged man in his 40s. He has piercing green eyes, a chiseled jawline, and neatly trimmed stubble. His black hair is peppered with gray and well-groomed. He\'s wearing a dark gray suit jacket over a white shirt, with his tie slightly loosened. His expression is confident yet friendly, with a hint of a smile. The background is a blurred office or conference room.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_89","video":""},{"key":"imageGenerator","seq":64.142,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/ztlXK-0x1365.webp","payload":{"prompt":"A close-up portrait of a curious 6-year-old boy. He has bright brown eyes full of wonder and excitement. His face is smooth and clean, with a mischievous smile playing on his lips. His hair is tousled and sandy brown. He\'s wearing a vibrant blue T-shirt with a slightly crooked collar. The background is a blurred park or playground.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"realistic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_90","video":""},{"key":"imageGenerator","seq":65,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/n2nRR-0x1024.webp","payload":{"prompt":"A shepherd in a plaid wool coat standing on misty Scottish Highlands. He holds a crook, with a loyal sheepdog by his side. Distant mountains and lochs are barely visible through the mist. The scene is painted with soft brushstrokes and a hazy atmosphere.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"oil_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_13","video":""},{"key":"imageGenerator","seq":66,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/WEmK0-0x1365.webp","payload":{"prompt":"A majestic waterfall cascades through lush tropical rainforest. Water spray creates rainbows. Surrounding the falls are various shades of green foliage, punctuated by bright tropical flowers and colorful parrots.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"oil_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_14","video":""},{"key":"imageGenerator","seq":67,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/UPtH1-0x1024.webp","payload":{"prompt":"A samba dancer in an elaborate feathered costume dancing on the streets of Rio de Janeiro. She\'s surrounded by cheering crowds and other dancers. The background features colorful floats and twinkling lights. The entire scene exudes joy and passion.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"oil_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_15","video":""},{"key":"imageGenerator","seq":68,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/1rk9j-0x1365.webp","payload":{"prompt":"A serene Japanese garden surrounded by fiery red autumn maples. A red-lacquered wooden bridge spans a calm pond with clear reflections. A traditional Japanese pavilion is visible in the distance, with the sky a soft pink-orange.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"oil_painting","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_16","video":""},{"key":"generateImageByScenario","seq":69,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/WqDxs-0x1024.webp","payload":{"prompt":"A modern flat logo with sharp angles, monochrome colors, and an abstract icon symbolizing speed.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"logo","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_17","video":""},{"key":"generateImageByScenario","seq":70,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/mJ9KT-0x1024.webp","payload":{"prompt":"A flat design emphasizing clean lines, a unique triangular icon, and a monochrome palette.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"logo","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_18","video":""},{"key":"imageGenerator","seq":71,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/ZozeE-0x1024.webp","payload":{"prompt":"A lively Japanese summer festival scene. People in yukata stroll down lantern-decorated streets lined with stalls offering games and food. Colorful fireworks explode in the distance.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"japanese_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_19","video":""},{"key":"imageGenerator","seq":72,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/8qZVE-0x768.webp","payload":{"prompt":"A serene forest with enormous trees supporting a small treehouse. Quirky spirits and gentle forest creatures surround it. Sunlight filters through the leaves, creating a dreamy light effect.","model_type":"flux_pro","aspect_ratio":"16:9","image_style":"japanese_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_20","video":""},{"key":"imageGenerator","seq":73,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/RS88t-0x1024.webp","payload":{"prompt":"A massive humanoid robot stands amidst ruins. A young pilot is visible in the cockpit. The mecha\'s armor is detailed and battle-worn, with a smoky battlefield in the background.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"japanese_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_21","video":""},{"key":"imageGenerator","seq":74,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/Prf7N-0x1365.webp","payload":{"prompt":"A magical underwater city made of coral, shells, and glowing seaweed. Mermaids and various strange sea creatures swim through the city. Magical bubbles serve as transportation, moving between the structures.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"fantasy_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_22","video":""},{"key":"imageGenerator","seq":75,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/KE1uG-0x1024.webp","payload":{"prompt":"An endless magical library with bookshelves reaching into the clouds. Flying books soar through the air, magical candles illuminate ancient scrolls and mysterious runes. Wizards and strange creatures wander among the stacks.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"fantasy_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_23","video":""},{"key":"imageGenerator","seq":76,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/nsdtg-0x1024.webp","payload":{"prompt":"An enormous Tree of Life with a spiraling trunk reaching to the sky. Each branch represents a different world or ecosystem, from deserts to glaciers, undersea realms to volcanoes. Magical creatures inhabit the tree.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"fantasy_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_24","video":""},{"key":"imageGenerator","seq":77,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/N61Qa-0x1365.webp","payload":{"prompt":"An elegant elven castle floating above a glowing crystal forest. The castle\'s spires are made of translucent crystals, shimmering with rainbow-like light. Luminous butterflies and tiny fairies flutter around.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"fantasy_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_25","video":""},{"key":"generateImageByScenario","seq":78,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/UXA83-0x1024.webp","payload":{"prompt":"Craft a logo with sleek, sans-serif typography combined with a simple, abstract shape. Maintain a flat style with no gradients or shadows.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"logo","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_26","video":""},{"key":"imageGenerator","seq":79,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/BugzS-0x1024.webp","payload":{"prompt":"A futuristic bar where multi-armed robots serve as bartenders. Patrons sit at glowing counters, their drinks changing color based on their mood. Holographic dancers perform in mid-air, while screens on the walls display real-time global news.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"cyberpunk","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_27","video":""},{"key":"imageGenerator","seq":80,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/HcE8m-0x1365.webp","payload":{"prompt":"The interior of a massive factory where high-tech mechanical hearts are being manufactured on assembly lines. Robot workers and human engineers work side by side. At the center of the factory is a huge pulsating energy core powering the entire facility.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"cyberpunk","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_28","video":""},{"key":"imageGenerator","seq":81,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/2JHVV-0x1024.webp","payload":{"prompt":"A massive vertical city with buildings stretching from the ground up into the clouds. Floating parks and sky gardens connect different levels. Flying vehicles zip between buildings, while the lower levels are crowded with streets and neon signs.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"cyberpunk","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_29","video":""},{"key":"imageGenerator","seq":82,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/jnoeH-0x1365.webp","payload":{"prompt":"A hacker sits in a spherical workstation surrounded by holographic screens. Data streams flow around like waterfalls. His fingers dance on a virtual keyboard, eyes covered by a complex visual augmentation device.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"cyberpunk","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_30","video":""},{"key":"generateImageByScenario","seq":83,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/uoIWB-0x1024.webp","payload":{"prompt":"Create a text-only logo using cursive or handwritten-style fonts for a friendly and approachable brand aesthetic","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"logo","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_31","video":""},{"key":"imageGenerator","seq":84,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/EqLW1-0x1024.webp","payload":{"prompt":"A swarm of tiny nanomachines, each no larger than a millimeter. Individual nanomachines are hexagonal with tiny thrusters and manipulator arms. They can combine into various shapes and structures such as tools, weapons, or medical devices. A slightly larger control unit is at the center of the swarm.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"3d_modeling","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_32","video":""},{"key":"imageGenerator","seq":85,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/9Fivy-0x1024.webp","payload":{"prompt":"A futuristic submarine designed for extreme deep-sea exploration. Streamlined in shape, equipped with multiple mechanical arms and samplers. The hull is made of ultra-strong transparent material allowing 360-degree observation. Features advanced sonar systems and bioluminescence mimicking devices.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"3d_modeling","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_33","video":""},{"key":"generateImageByScenario","seq":86,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/BsTAR-0x1024.webp","payload":{"prompt":"Design a logo based on a circular shape, incorporating blue and white tones to display luxury and precision, conveying innovation and power.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"logo","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_34","video":""},{"key":"imageGenerator","seq":87,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/RzG0Z-0x1024.webp","payload":{"prompt":"A sleek, single-seat hover bike without wheels, equipped with anti-gravity thrusters. The body is made of smooth metallic material with glowing energy lines. The cockpit features holographic displays and touch-sensitive control panels.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"3d_modeling","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_35","video":""},{"key":"imageGenerator","seq":88,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/M4E5K-0x1024.webp","payload":{"prompt":"A 3D anime-style samurai character blending traditional and fantasy elements. Wearing semi-mechanized samurai armor and wielding a katana that channels elemental magic. Hair and facial features maintain anime style but with enhanced 3D details.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"3d_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_36","video":""},{"key":"imageGenerator","seq":89,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/CoIGl-0x1024.webp","payload":{"prompt":"A self-sustaining floating island. The bottom of the island has massive anti-gravity engines. On top, there\'s a miniature forest, waterfalls, and lakes. Hanging gardens and small habitat pods are on the island\'s edges. The entire ecosystem is enclosed in a transparent","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"3d_modeling","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_37","video":""},{"key":"generateImageByScenario","seq":90,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/aSzRg-0x1344.webp","payload":{"prompt":"Design an anime-style cityscape at night, with neon lights and bustling streets.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_38","video":""},{"key":"generateImageByScenario","seq":91,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/XCB3d-0x1344.webp","payload":{"prompt":"Generate a fantasy anime scene with a warrior standing on a cliff, overlooking a vast, mystical landscape.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_39","video":""},{"key":"generateImageByScenario","seq":92,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/luzxV-0x1344.webp","payload":{"prompt":"Produce an anime wallpaper of a peaceful village during cherry blossom season, with petals gently falling.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_40","video":""},{"key":"generateImageByScenario","seq":93,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/s822P-0x1344.webp","payload":{"prompt":"Illustrate an epic anime battle scene with dynamic poses and dramatic lighting.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_41","video":""},{"key":"imageGenerator","seq":94,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/oYR4L-0x1365.webp","payload":{"prompt":"A 3D anime-style fantasy pet school. Classrooms are filled with various adorable mythical creatures: baby dragons, unicorns, phoenix chicks, flying cats, etc. They\'re all wearing tiny school uniforms, attentively listening to a wise owl professor. The classroom walls are covered with magical creature charts and glittering trophies.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"3d_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_42","video":""},{"key":"generateImageByScenario","seq":95,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/mUjWk-0x1344.webp","payload":{"prompt":"Design a wallpaper capturing the beauty of a lush green forest in the heart of spring.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_43","video":""},{"key":"generateImageByScenario","seq":96,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/PCj8g-0x1344.webp","payload":{"prompt":"Generate a serene beach scene at sunset, with waves gently lapping at the shore.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_44","video":""},{"key":"generateImageByScenario","seq":97,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/ZxOvd-0x1344.webp","payload":{"prompt":"Create a portrait wallpaper of a mysterious woman with striking features and an enigmatic expression.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_45","video":""},{"key":"imageGenerator","seq":98,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/EsUqD-0x1365.webp","payload":{"prompt":"Interior of a 3D anime-style convenience store during after-school hours. Several students in uniforms are selecting snacks and drinks. The shopkeeper, a friendly middle-aged woman, smiles behind the counter. Shelves are filled with various products, and the freezer contains ice cream and cold drinks. An orange cat lazily lounges by the entrance.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"3d_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_46","video":""},{"key":"generateImageByScenario","seq":99,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/OBCaD-0x1344.webp","payload":{"prompt":"Create a vibrant abstract wallpaper with swirling colors and fluid patterns.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_47","video":""},{"key":"imageGenerator","seq":100,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/KtPro-0x1365.webp","payload":{"prompt":"A busy 3D anime-style subway station scene. The platform is filled with commuters, students, and elderly people. An anime-styled subway train is arriving at the platform, doors opening as passengers board and alight in an orderly manner. Electronic displays above show train schedules and advertisements.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"3d_anime","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_48","video":""},{"key":"generateImageByScenario","seq":101,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/8S96z-0x1344.webp","payload":{"prompt":"Illustrate a cosmic scene with bright, swirling galaxies and vivid nebulae.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_49","video":""},{"key":"generateImageByScenario","seq":102,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/KUgJB-0x1344.webp","payload":{"prompt":"Illustrate a vibrant wallpaper of tropical fish swimming in a colorful coral reef.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_50","video":""},{"key":"generateImageByScenario","seq":103,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/0AZsd-0x1344.webp","payload":{"prompt":"Produce a cozy scene of a cat curled up by a fireplace, with warm tones and a peaceful ambiance.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"mobile_wallpaper","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_51","video":""},{"key":"imageGenerator","seq":104,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/2cQeO-0x1365.webp","payload":{"prompt":"A 4-panel comic showing a superherp\'s daily life. Panel 1: A muscular superhero looking confused wlhile selecting fruits in a supermarket. Panel 2: He\'s struggling to mend his torn costume at home, pricking his finger. Panel 3:Trying to sneak into his apartment, he\'s recognized by a neighbor asking for a selfie. Panel 4: The exhausted superhero slumps on his couch, watching his heroic deeds on TV.","model_type":"ideogram2","aspect_ratio":"9:16","image_style":"comic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_52","video":""},{"key":"imageGenerator","seq":105,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/KWyFD-0x1365.webp","payload":{"prompt":"A retro-style sci-fi illustration showing a 1950s vision of a moon base. Bold lines and vibrant colors are used. The center features a massive domed structure surrounded by smaller circular pods. Astronauts in exaggerated spacesuits explore in moon buggies or tend to alien plants. Earth hangs prominently in the black sky, distant but eye-catching.","model_type":"flux_pro","aspect_ratio":"9:16","image_style":"comic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_53","video":""},{"key":"imageGenerator","seq":106,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/O49G2-0x1024.webp","payload":{"prompt":"A 6-panel comic telling the adventure of a modern girl accidentally entering a fairy tale world. Panel 1: The girl falls through a wardrobe into a magical forest. Panel 2: She meets a talking fox, looking surprised. Panel 3: They flee from an angry giant together. Panel 4: The girl helps a sad mermaid princess. Panel 5: She attends a tea party with a group of fairies. Panel 6: The girl returns to the real world, but her backpack is full of magical items.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"comic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_54","video":""},{"key":"imageGenerator","seq":107,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/gxX1R-0x1365.webp","payload":{"prompt":"A bustling comic-style illustration showing various animals during recess at a school playground. A giraffe teacher supervises the activities. Rabbits are skipping rope, an elephant plays on a seesaw (balanced by several monkeys), lions and tigers play hide-and-seek, and a flock of birds sing in a tree. In the foreground, a shy hedgehog tries to join the squirrels\' game. The whole scene is full of joy and energy, with bright colors.","model_type":"ideogram2","aspect_ratio":"9:16","image_style":"comic","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_55","video":""},{"key":"generateImageByScenario","seq":108,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/4ldmM-0x1344.webp","payload":{"prompt":"Generate a dramatic poster for a historical drama named \'Battle of the Ages\', showcasing a key battle scene. Include the tagline: \'Courage Knows No Time\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"poster","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_56","video":""},{"key":"generateImageByScenario","seq":109,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/weM4W-0x1344.webp","payload":{"prompt":"Produce a romantic movie poster set in Paris, titled \'Love in the Air\', with a couple embracing under the Eiffel Tower. Add the tagline: \'Where Hearts Find Home\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"poster","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_57","video":""},{"key":"imageGenerator","seq":110,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/kdBVg-0x768.webp","payload":{"prompt":"A close-up of the iconic colorful houses in Burano, Venice. A row of houses alternates in vibrant pink, yellow, blue, and green. Colored pencils meticulously depict the textures of the houses, including slightly weathered walls, wooden shutters, and roof tiles. Reflections in the canal are subtly visible in the foreground.","model_type":"flux_pro","aspect_ratio":"16:9","image_style":"colored_pencil_drawing","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_58","video":""},{"key":"imageGenerator","seq":111,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/Hsm8d-0x1024.webp","payload":{"prompt":"A close-up of a cut pomegranate. Vibrant red flesh and translucent seeds glisten in the sunlight. Colored pencils intricately capture the texture of the rind, the sheen of the seeds, and the juicy flesh. A few scattered seeds and some juice add liveliness to the scene.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"colored_pencil_drawing","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_59","video":""},{"key":"generateImageByScenario","seq":112,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/3CJQ2-0x1344.webp","payload":{"prompt":"Generate a vibrant poster for the sports shoes \'RunFast Pro\', showcasing design and comfort. Add the slogan: \'Step into Performance\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"poster","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_60","video":""},{"key":"generateImageByScenario","seq":113,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/jM8rF-0x1344.webp","payload":{"prompt":"Produce a fresh poster for the skincare product \'PureGlow\', featuring natural ingredients. Include the tagline: \'Nature\'s Touch for Radiant Skin\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"poster","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_61","video":""},{"key":"generateImageByScenario","seq":114,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/Oi7ez-0x1344.webp","payload":{"prompt":"Design a lively poster for the \'Summer Beats Festival\', with colorful graphics. Include the tagline: \'Feel the Rhythm of Summer\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"poster","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_62","video":""},{"key":"generateImageByScenario","seq":115,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/eGadi-0x1344.webp","payload":{"prompt":"Generate a dynamic poster for the \'Charity Run 2024\', with runners in motion. Include the tagline: \'Run for a Cause\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"poster","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_63","video":""},{"key":"generateImageByScenario","seq":116,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/Y4QNh-0x1344.webp","payload":{"prompt":"Design a bold advertising poster for the energy drink \'Power Surge\', featuring vibrant colors. Add the slogan: \'Unleash the Energy Within\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"poster","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_64","video":""},{"key":"generateImageByScenario","seq":117,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/JRCRi-0x1344.webp","payload":{"prompt":"Generate an engaging poster for the travel agency \'Wanderlust Adventures\', highlighting exotic destinations. Add the slogan: \'Discover Your Next Journey\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"poster","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_65","video":""},{"key":"generateImageByScenario","seq":118,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/WL7f7-0x1344.webp","payload":{"prompt":"Illustrate a vibrant poster for the \'Global Culture Fair\', highlighting diversity. Include the tagline: \'Experience the World\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"poster","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_66","video":""},{"key":"generateImageByScenario","seq":119,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/lYJrv-0x1024.webp","payload":{"prompt":"Generate a sticker of a historical figure in a playful caricature style, with exaggerated features.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"sticker","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_67","video":""},{"key":"generateImageByScenario","seq":120,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/HWKiY-0x1024.webp","payload":{"prompt":"Illustrate a sticker of a modern-day influencer with trendy clothing and a confident expression","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"sticker","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_68","video":""},{"key":"generateImageByScenario","seq":121,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/0KCYO-0x1024.webp","payload":{"prompt":"Create a sticker of a playful puppy with floppy ears and a wagging tail, surrounded by paw prints.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"sticker","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_69","video":""},{"key":"generateImageByScenario","seq":122,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/OmhYw-0x1024.webp","payload":{"prompt":"Design a sticker of a majestic lion with a flowing mane, depicted in a cartoon style.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"sticker","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_70","video":""},{"key":"generateImageByScenario","seq":123,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/iwzXm-0x1024.webp","payload":{"prompt":"Generate a sticker of a cute panda sitting and munching on bamboo, with a serene expression.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"sticker","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_71","video":""},{"key":"generateImageByScenario","seq":124,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/PkKs9-0x1024.webp","payload":{"prompt":"Design a sticker badge of the Colosseum, highlighting its iconic arches and ancient charm.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"sticker","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_72","video":""},{"key":"generateImageByScenario","seq":125,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/nWHwe-0x1024.webp","payload":{"prompt":"Generate a sticker badge of the Statue of Liberty, with a focus on its torch and crown.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"sticker","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_73","video":""},{"key":"generateImageByScenario","seq":126,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/3HTMd-0x1024.webp","payload":{"prompt":"Design a sticker of a steaming cup of coffee, with swirls of steam and a cozy, inviting vibe.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"sticker","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_74","video":""},{"key":"generateImageByScenario","seq":127,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/rcIwK-0x1024.webp","payload":{"prompt":"Illustrate a sticker of a classic vinyl record, with a shiny surface and a colorful label in the center.","model_type":"playground2_5","aspect_ratio":"1:1","image_scene":"sticker","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_75","video":""},{"key":"imageGenerator","seq":128,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/lHsEk-0x1024.webp","payload":{"prompt":"A bustling city skyline rendered in pixel art style. Skyscrapers with distinct outlines create a rich tapestry of varying heights and shapes. A pixelated river in the foreground reflects the city lights. The sky is dotted with stars and a crescent moon.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"pixel_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_76","video":""},{"key":"imageGenerator","seq":129,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/J9BCB-0x1024.webp","payload":{"prompt":"A classic 8-bit adventure game hero stands in the center of the frame. The hero wears green clothes and holds a sword and shield. The background is a simplified pixel forest with trees, bushes, and rocks. A status bar at the top shows health, coins, and equipment.","model_type":"flux_pro","aspect_ratio":"1:1","image_style":"pixel_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_77","video":""},{"key":"imageGenerator","seq":130,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/lBhBc-0x1365.webp","payload":{"prompt":"A vibrant pixel art farm scene. The image includes a red barn, green fields, several fruit trees, and a small pond. Pixelated animals like cows, chickens, and sheep dot the landscape. A pixel farmer is working in the field. Cotton candy-like clouds float in the sky.","model_type":"ideogram2","aspect_ratio":"9:16","image_style":"pixel_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_78","video":""},{"key":"generateImageByScenario","seq":131,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/uB3Ku-0x768.webp","payload":{"prompt":"Design a vintage-inspired birthday card with floral patterns and sepia tones. Add the text: \'Happy Birthday! Wishing You a Year Full of Joy and Happiness\'.","model_type":"playground2_5","aspect_ratio":"16:9","image_scene":"cards_and_invites","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_79","video":""},{"key":"generateImageByScenario","seq":132,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/y3yZb-0x1344.webp","payload":{"prompt":"Create a sleek and minimalist thank you card with geometric shapes and a monochrome color palette. Include the message: \'Thank You for Your Kindness\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"cards_and_invites","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_80","video":""},{"key":"generateImageByScenario","seq":133,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/8phGo-0x1344.webp","payload":{"prompt":"Generate a formal gala invitation with ornate borders and elegant script. Include the text: \'You Are Cordially Invited to Our Annual Black-Tie Gala\'.","model_type":"playground2_5","aspect_ratio":"9:16","image_scene":"cards_and_invites","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_81","video":""},{"key":"imageGenerator","seq":134,"image":"https://assets.monica.im/assets/image_tools/gallery/compress_files/7HdN6-0x1365.webp","payload":{"prompt":"A group of classic Pocket Monsters reinterpreted in pixel art style. Pikachu is at the center, surrounded by Bulbasaur, Charmander, and Squirtle. Each character maintains its iconic colors and features but is presented in a minimalist pixel form. The background is a simple pixelated grassy field.","model_type":"ideogram2","aspect_ratio":"9:16","image_style":"pixel_art","workflow_param":{"template":"","origin_url":""},"sign_url":""},"uid":"compress_files_82","video":""}]');class d extends s.b{async onInit(){this.services.user.on("userLogout",()=>{this.storage.update({imageHistoryMap:{all:[],image:[],video:[]}})}),this.storage.addChangeListener(e=>{e.imageGallery&&this.emit("imageGalleryChange",e.imageGallery),void 0!==e.scaleNoticeShowed&&this.emit("scaleNoticeShowedChange",e.scaleNoticeShowed),void 0!==e.downloadMobilePopoverShowed&&this.emit("downloadMobilePopoverShowedChange",e.downloadMobilePopoverShowed),void 0!==e.imageNewTagsMap&&this.emit("imageNewTagsMapChange",e.imageNewTagsMap)})}async markScaleNoticeShowed(){this.storage.set("scaleNoticeShowed",!0)}async markDownloadMobilePopoverShowed(){this.storage.set("downloadMobilePopoverShowed",!0)}async getAll(){return this.storage.getAll()}async generateImageByCanvas(e){return(await r.Cb.imageToolsApi.realtimeImage(e)).data}async generateImageByText(e){return(await r.Cb.imageToolsApi.realtimeImage(e)).data}async getHistoryList(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=await r.Cb.generateService.imageToolsApi.getHistoryList({offset:t,category:e,limit:this.historyLimit});if(0===i.code&&0===t){let t=await this.storage.get("imageHistoryMap");this.storage.set("imageHistoryMap",{...t,[e]:[...i.data.historyList||[]].splice(0,this.maxHistoryCacheLimit)})}return i}async deleteHistory(e){await r.Cb.generateService.imageToolsApi.deleteItem({imageToolsId:e});let t=await this.storage.get("imageHistoryMap"),i=Object.keys(t).reduce((i,a)=>(i[a]=t[a].filter(t=>t.id!==e),i),{all:[],video:[],image:[],sketch:[]});this.storage.set("imageHistoryMap",i)}async loopTaskResult(e){let{data:t}=await r.Cb.generateService.imageToolsApi.loopResult({imageToolsId:e});return t}async removeBackground(e){let{data:t}=await r.Cb.imageToolsApi.remove({taskUid:n.m.genId(),...e,taskType:"remove_bg"});return t}async replaceBackground(e){let{data:t}=await r.Cb.imageToolsApi.replaceBg({taskUid:n.m.genId(),...e,taskType:"replace_bg"});return t}async upscale(e){let{data:t}=await r.Cb.imageToolsApi.upscale({taskUid:n.m.genId(),...e,taskType:"upscale"});return t}async removeObject(e){let{data:t}=await r.Cb.imageToolsApi.inpainting({taskUid:n.m.genId(),...e});return t}async removeText(e){let{data:t}=await r.Cb.imageToolsApi.remove({taskUid:n.m.genId(),...e,taskType:"remove_text"});return t}async textToImage(e){let{data:t}=await r.Cb.generateService.imageToolsApi.textToImage({taskUid:n.m.genId(),...e,imageStyle:"auto"===e.imageStyle?void 0:e.imageStyle,taskType:"text_to_image"});return t}async textToVideo(e){let{data:t}=await r.Cb.generateService.imageToolsApi.textToVideo({taskUid:n.m.genId(),...e,taskType:"text_to_video"});return t}async imageToVideo(e){let{data:t}=await r.Cb.generateService.imageToolsApi.imageToVideo({taskUid:n.m.genId(),...e,taskType:"image_to_video"});return t}async generateImageByScenario(e){let{data:t}=await r.Cb.imageToolsApi.textToImage({taskUid:n.m.genId(),...e,imageStyle:"auto"===e.imageStyle?void 0:e.imageStyle,taskType:"text_to_image"});return t}async upgradeImageByWorkflow(e,t,i){let{data:a}=await r.Cb.generateService.imageToolsApi.workflow({...i,taskUid:n.m.genId(),originUrl:e.originUrl,extraImageUrl:e.extraImageUrl,template:t});return a}async getImageGallery(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=await this.storage.get("imageGallery");if(!this.fetchingGallery||t){this.fetchingGallery=!0;try{i.length&&(null==e||e(i)),i=(await r.Cb.generateService.imageToolsApi.getImageGallery()).data.imageToolGallery||[],this.storage.set("imageGallery",[...i||[]].splice(0,100)),null==e||e(i)}catch(e){i=l}finally{this.fetchingGallery=!1}}}async getHistoryDetail(e){var t;let i=await r.Cb.generateService.imageToolsApi.batchGetResult({idList:[e]});if(0===i.code&&(null===(t=i.data.records)||void 0===t?void 0:t.length))return i.data.records[0]}async batchGetHistoryDetails(e){var t;return(null===(t=(await r.Cb.generateService.imageToolsApi.batchGetResult({idList:e})).data)||void 0===t?void 0:t.records)||[]}async payPaddle(){await r.Cb.botFrameworkService.paddleApi.activateSubscription()}async payFastspring(){await r.Cb.vipApi.fastspringActivateSubscription()}async fetchImageNewTags(){return this._fetchWithCache("imageNewTagsMap",async()=>(await r.Cb.generateService.imageToolsApi.pageItemList({})).data.newTagInfo||{},{useCache:!0,autoUpdate:!0})}async quickApplyClick(e,t){await r.Cb.generateService.imageToolsApi.pageItemClick({key:t,type:e})}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"image",name:"imageService"}),(0,o._)(this,"maxHistoryCacheLimit",50),(0,o._)(this,"historyLimit",30),(0,o._)(this,"fetchingGallery",!1),(0,o._)(this,"dependencies",["user"]),(0,o._)(this,"defaultStorageValues",{imageHistoryMap:{all:[],image:[],video:[]},imageGallery:[],scaleNoticeShowed:!1,downloadMobilePopoverShowed:!1,imageNewTagsMap:{imageToolTemplates:[],videoPageQuickActions:[]}})}}let c=new a.x(d)},46260:function(e,t,i){"use strict";i.d(t,{D:function(){return l}});var a=i(83260),o=i(66084),s=i(65324),n=i(55180);class r extends n.b{async onInit(){}async cancelGenImageTask(e){return await s.Cb.generateService.makeItMoreApi.cancelGenImageTask(e)}async createGenImageTask(e){return s.Cb.generateService.makeItMoreApi.createGenImageTask(e)}async createTaskGenVideo(e){return s.Cb.generateService.makeItMoreApi.createTaskGenVideo(e)}async getTaskGenVideo(e){return s.Cb.generateService.makeItMoreApi.getTaskGenVideo(e)}async loopGenImageTask(e){return s.Cb.generateService.makeItMoreApi.loopGenImageTask(e)}constructor(...e){super(...e),(0,o._)(this,"dependencies",[]),(0,o._)(this,"meta",{key:"makeItMore",name:"MakeItMore",storagePrefix:"makeItMore"}),(0,o._)(this,"defaultStorageValues",{agentDiscoverFeeds:null})}}let l=new a.x(r)},38795:function(e,t,i){"use strict";i.d(t,{R:function(){return h}});var a=i(83260),o=i(66084),s=i(94037),n=i(11502),r=i(92235),l=i(65324),d=i(55180);class c extends d.b{async onInit(){this.storage.addChangeListener(e=>{e.memoList&&this.emit("memoListChange",e.memoList),e.tagList&&this.emit("tagListChange",e.tagList)}),this.services.user.on("userLogout",()=>{this.storage.get("memoList").then(e=>{null==e||e.forEach(e=>{try{s.$.deleteDB("memo_".concat(e.uid))}catch(e){}}),this.storage.set("memoList",null)})})}async getAll(){return this.storage.getAll()}async updateMemoList(e){this.storage.update({memoList:e})}async list(e,t,i,a){let{offset:o,limit:s,types:n,tags:r}=t,d=(null==n?void 0:n.length)===1&&"all"===n[0],c=d?[]:n;if("refresh"===e){let e=this.listRefreshFlag+=1,t=t=>{e===this.listRefreshFlag&&d&&(null==a||a(t||[]),this.updateMemoList(t))},n=await this.storage.get("memoList"),h=(async()=>{let e=(await l.Cb.noteApi.list({offset:o,limit:Math.max(s,(null==n?void 0:n.length)||0),types:c,tags:r})).data.items;return t(e||[]),{items:e,offset:0,hasMore:e.length>=s}})();return i&&(null==n?void 0:n.length)?{items:n||[],offset:0,hasMore:(n||[]).length>=s}:await h}let h=await l.Cb.noteApi.list({offset:o,limit:s,types:c,tags:r});return null==a||a(h.data.items||[]),h.data}async search(e){return(await l.Cb.noteApi.search(e)).data}async setShareConfig(e){return await l.Cb.noteApi.setShareConfig(e)}async info(e){return await l.Cb.noteApi.info(e)}async create(e){let{data:t}=await l.Cb.noteApi.create(e);return this.addCacheMemoItem(t.item),t}async createWithoutConvert(e){let{data:t}=await l.Cb.noteApi.createWithoutConvert(e);return this.addCacheMemoItem(t.item),t}async createFromText(e){return await this.create({uid:r.m.genId(),content:e,description:"",plainText:"",title:""})}async delete(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||await l.Cb.noteApi.delete(e);let{uid:i}=e,a=await this.storage.get("memoList");return(null==a?void 0:a.length)&&this.storage.set("memoList",a.filter(e=>e.uid!==i)),i}async batchDelete(e){let{uids:t}=e;await l.Cb.generateService.noteApi.batchDelete(e);let i=await this.storage.get("memoList");(null==i?void 0:i.length)&&this.storage.set("memoList",i.filter(e=>!t.includes(e.uid)))}async update(e){let t=await this.storage.get("memoList");if(t){let i=t.findIndex(t=>t.uid===e.uid);-1!==i&&(t[i]=e,await this.storage.set("memoList",t))}}async summaryImage(e){let{image:t,uid:i,width:a,height:o}=e,s="running";try{await l.Cb.noteApi.summaryImage({uid:i,image:t})}catch(e){s="failed"}await this.addCacheMemoItem({uid:i,url:t,width:a,height:o,status:s}),await new Promise(e=>{this.loopFetchStatus(i,()=>{e(!0)})})}async loopFetchStatus(e,t){let i=(await this.storage.get("memoList")||[]).find(t=>t.uid===e);if(!i){null==t||t();return}if("running"===i.status){let a=await this.summaryImageStatus({uid:e}),{status:o,summary:s,ocrContent:n}=a,{width:r,height:l,url:d}=i;if("complete"===o){let i=await this.createFromEmbed({uid:e,embedData:{type:"imageSummary",url:d,summary:s,ocrContent:n,width:r,height:l}});this.update({...i.item,ocrContent:n}),null==t||t()}"running"===a.status&&setTimeout(()=>{this.loopFetchStatus(e,t)},1e3),"failed"===a.status&&(this.update({...i,status:"failed"}),null==t||t())}}async summaryImageStatus(e){return(await l.Cb.noteApi.summaryImageStatus(e)).data}async createFromEmbed(e){n.M.createUserBehaviorEvent({eventName:"memo_create_from_embed",extData:{type:e.embedData.type}});let{data:t}=await l.Cb.noteApi.createFromEmbed(e);return await this.addCacheMemoItem(t.item),t}async addCacheMemoItem(e){let t=await this.storage.get("memoList")||[];if(-1!==t.findIndex(t=>t.uid===e.uid)){this.update(e);return}let i=[e,...t].slice(0,25);this.storage.set("memoList",i)}async getReadingReplyCache(e){let t=new AbortController;this.readingCacheSignalMap[e.conversationId]=t;let i=await l.Cb.taskApi.getReadingReplyCache(e,{abortSignal:t.signal});return delete this.readingCacheSignalMap[e.conversationId],i}async cancelReadingCache(e){var t;null===(t=this.readingCacheSignalMap[e])||void 0===t||t.abort()}async getVideoSummaryCache(e){return await l.Cb.youtubeSummarizeApi.getExistResult(e)}async getMemoContent(e){return l.Cb.generateService.noteApi.getContent({noteUid:e})}async updateMemoContent(e){return l.Cb.generateService.noteApi.updateContent(e)}async getTagList(){return this._fetchWithCache("tagList",async()=>(await l.Cb.generateService.noteApi.getTagList({})).data.tagList||[])}async deleteTag(e){await l.Cb.generateService.noteApi.deleteTag({tagUid:e})}async deleteMemoTag(e,t){await l.Cb.generateService.noteApi.deleteNoteTag({noteUid:e,tagUid:t})}async batchEditMemoTags(e,t){await l.Cb.generateService.noteApi.batchUpdateNoteTags({noteUid:e,tags:t})}constructor(...e){super(...e),(0,o._)(this,"dependencies",["user"]),(0,o._)(this,"meta",{key:"memo",name:"MemoService",storagePrefix:"memoV2"}),(0,o._)(this,"defaultStorageValues",{memoList:null,tagList:null}),(0,o._)(this,"readingCacheSignalMap",{}),(0,o._)(this,"listRefreshFlag",1)}}let h=new a.x(c)},24053:function(e,t,i){"use strict";i.d(t,{_:function(){return r}});var a=i(83260),o=i(66084),s=i(55180);class n extends s.b{async onInit(){this.storage.addChangeListener(e=>{void 0!==e.activeSourceLanguage&&this.emit("activeSourceLanguageChange",e.activeSourceLanguage),void 0!==e.activeResultLanguage&&this.emit("activeResultLanguageChange",e.activeResultLanguage),void 0!==e.sourceLanguages&&this.emit("sourceLanguagesChange",e.sourceLanguages),void 0!==e.resultLanguages&&this.emit("resultLanguagesChange",e.resultLanguages)}),this.services.user.on("userLogout",()=>{this.storage.update({activeSourceLanguage:"auto",activeResultLanguage:"English",sourceLanguages:[],resultLanguages:[],translateEngines:null})})}async getStorageValue(e){return this.storage.get(e)}async setStorageValue(e,t){return this.storage.set(e,t)}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"monicaTranslate",name:"MonicaTranslateService"}),(0,o._)(this,"dependencies",["user"]),(0,o._)(this,"defaultStorageValues",{activeSourceLanguage:null,activeResultLanguage:null,sourceLanguages:[],resultLanguages:[],translateEngines:null})}}let r=new a.x(n)},41602:function(e,t,i){"use strict";i.d(t,{B:function(){return l}});var a=i(83260),o=i(66084),s=i(65324),n=i(55180);class r extends n.b{async onInit(){this.storage.addChangeListener(e=>{void 0!==e.notificationData&&this.emit("notificationDataChange",e.notificationData)}),this.services.user.on("userLogout",()=>{this.storage.set("notificationData",null)})}async getNotificationData(e,t){return this._fetchWithCache("notificationData",async()=>(await s.Cb.notificationApi.list(e)).data,t)}async readNotification(e){return s.Cb.notificationApi.read(e)}async readAllNotification(e){return s.Cb.notificationApi.readAll(e)}async feedbackNotification(e){return s.Cb.notificationApi.action(e)}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"notification",name:"NotificationService"}),(0,o._)(this,"dependencies",["user"]),(0,o._)(this,"defaultStorageValues",{notificationData:null})}}let l=new a.x(r)},94223:function(e,t,i){"use strict";i.d(t,{X:function(){return h}});var a=i(83260),o=i(66084),s=i(56607),n=i(92235),r=i(65324),l=i(55180),d=i(38172);class c extends l.b{async onInit(){}async getToken(){return s.o.isDesktop?r.Cb.getAuthToken():await d.W.getToken()}async getExampleAudio(e,t){let i;let a={standard:"monica",advanced:"monicaPro",EnglishChatPartner:"englishTrainer",MockInterview:"mockInterview",SimulatedDebate:"simulateDebate",VentingCompanion:"vendingCompanion"};try{let o="https://assets.monica.im/assets/audio/realtime_scene/".concat(a[e],"-").concat(t,".mp3");i=await fetch(o).then(e=>e.blob())}catch(o){let t="https://assets.monica.im/assets/audio/realtime_scene/".concat(a[e],"-en.mp3");i=await fetch(t).then(e=>e.blob())}return n.m.blobToString(i)}async addRealtimeItemsToChat(e){let{realtimeItems:t}=e;this.emit("realtimeEnd",{realtimeItems:t})}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"realtime",name:"realtimeService"}),(0,o._)(this,"dependencies",[]),(0,o._)(this,"defaultStorageValues",{})}}let h=new a.x(c)},72142:function(e,t,i){"use strict";i.d(t,{u:function(){return g}});var a=i(83260),o=i(66084),s=i(65324),n=i(55180),r=i(93746),l=i(70460),d=i(92235);class c extends l.Z{async init(){}cancelSearchTask(e){let t=this.pendingSearchTasks[e];t&&(t.abortController.abort(),delete this.pendingSearchTasks[e])}askQuestion(e,t){let{taskId:i}=e,a=new AbortController;this.pendingSearchTasks[i]={abortController:a};let o={result:"",searchResult:{},sessionId:""},s="";this.fetchStreamApi({endpoint:"".concat(this.context.apiHost,"/search/new_search_v2"),taskInfo:{taskId:i,abortController:a,usageModules:[]},data:e,onData:e=>{if(e.error){t(null,!0,d.m.formatErrorMsg(e.error));return}if(e.sessionId){o.sessionId=e.sessionId,t(o,e.finished);return}if(e.searchResult&&(o.searchResult=e.searchResult,t(o,e.finished)),e.text){s+=e.text;try{s&&(o.result=s,t(o,e.finished))}catch(e){}}e.finished&&t(o,!0)},onAbort:()=>{console.log("on abort")}}).catch(e=>{t(null,!0,d.m.formatErrorMsg(e))})}constructor(...e){super(...e),(0,o._)(this,"pendingSearchTasks",{})}}class h extends n.b{async onInit(){this.context={apiHost:s.Xo,storage:this.storage,parent:this,services:this.services},this.searchProvider=new c(this.context)}async get(e){return await this.storage.get(e)}async set(e,t){this.storage.set(e,t)}async askQuestion(e,t){return this.searchProvider.askQuestion(e,t)}async getRelatedQuestions(e){return await s.Cb.botFrameworkService.searchApi.generateRelatedQuestions(e)}async saveAgentAnswer(e){return await s.Cb.botFrameworkService.searchApi.saveAgentAnswer(e)}async getSessionDetail(e){return await s.Cb.botFrameworkService.searchApi.getSessionDetail({sessionId:e})}async updatePrivilege(e){return await s.Cb.botFrameworkService.searchApi.updatePrivilege(e)}async manualSearchImage(e){return await s.Cb.botFrameworkService.searchApi.manualSearchImage(e)}async manualSearchVideo(e){return await s.Cb.botFrameworkService.searchApi.manualSearchVideo(e)}async fetchSessionList(e,t){let{useCache:i=!1,autoUpdate:a=!1,cacheOnly:o=!1}=t||{},{offset:n}=e,l=async()=>{let t=await s.Cb.botFrameworkService.searchApi.listSessions(e),i=t.data.sessions;return a&&0===n&&this.storage.update({sessionList:i}),t.data};if(i||o){let e=await this.storage.get("sessionList");if(o)return{total:n,sessions:e};if(e&&!(0,r.Z)(e))return a&&l(),{total:n,sessions:e}}return await l()}async searchRelatedQuery(e){return await s.Cb.botFrameworkService.searchApi.searchRelatedQuery(e)}async deleteSession(e){let t=await s.Cb.botFrameworkService.searchApi.deleteSession(e);return this.set("sessionList",[]),t}async updateSessionTitle(e){return await s.Cb.botFrameworkService.searchApi.updateSessionTitle(e)}async clearAllSessions(e){return await s.Cb.botFrameworkService.searchApi.clearAllSessions(e)}async favorSession(e){return await s.Cb.botFrameworkService.searchApi.favorSession(e)}async disfavorSession(e){return await s.Cb.botFrameworkService.searchApi.disfavorSession(e)}async toggleSessionFavorite(e){let{sessionId:t,favorite:i}=e;return i?await this.favorSession({sessionId:t}):await this.disfavorSession({sessionId:t})}cancelSearchTask(e){this.searchProvider.cancelSearchTask(e)}async queryComplete(e){return await s.Cb.botFrameworkService.searchApi.queryComplete({query:e})}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"search",name:"SearchService",storagePrefix:"search"}),(0,o._)(this,"context",void 0),(0,o._)(this,"dependencies",[]),(0,o._)(this,"defaultStorageValues",{sessionList:[],responseLanguage:"auto"}),(0,o._)(this,"searchProvider",void 0)}}let g=new a.x(h)},82152:function(e,t,i){"use strict";i.d(t,{a:function(){return c}});var a=i(83260),o=i(66084),s=i(56607),n=i(55180),r=i(1),l=i(14527);class d extends n.b{async onInit(){s.o.isExtension&&(r.d.addListener({name:"openSidePanel",handler:async(e,t)=>{try{var i;chrome.sidePanel.setOptions({path:"sidePanel.html",enabled:!0}),this.services.request.createUserBehaviorEvent({eventName:"trigger_side_panel_open"}),await chrome.sidePanel.open({tabId:null===(i=t.tab)||void 0===i?void 0:i.id})}catch(e){return console.error("open side panel failed: ",e),this.services.request.createUserBehaviorEvent({eventName:"trigger_side_panel_open"}),this.services.config.set("sidebarPosition","right"),this.services.config.set("chromeSidePanelEnabled",!1),!1}return!0}}),r.d.addListener({name:"closeSidePanel",handler:async()=>{this.open=!1,chrome.sidePanel.setOptions({path:"sidePanel.html",enabled:!1}),chrome.sidePanel.setOptions({enabled:!0,path:"sidePanel.html"})}}),s.o.isBackground&&chrome.runtime.onConnect.addListener(e=>{"sidePanel"===e.name&&(this.open=!0,this.broadcastSidePanelVisibleChange(!0),e.onDisconnect.addListener(()=>{this.open=!1,this.broadcastSidePanelVisibleChange(!1)}))}))}broadcastSidePanelVisibleChange(e){l.Y.broadcastMessage({name:"sidePanelVisibleChange",data:e})}async getOpen(){return this.open}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"sidePanel",name:"SidePanelService",storagePrefix:"sidePanel"}),(0,o._)(this,"dependencies",["request","config"]),(0,o._)(this,"defaultStorageValues",{}),(0,o._)(this,"open",!1)}}let c=new a.x(d)},5431:function(e,t,i){"use strict";var a,o;i.d(t,{k:function(){return a}}),(o=a||(a={})).AUTO_DETECT_LANG="auto-detect",o.GOOGLE_TRANSLATE_UNSUPPORTED_LANGS=["yue","ba","lzh"],o.FREE_TRANSLATE_API_DEFAULT_TIMEOUT_MS=2e3},59133:function(e,t,i){"use strict";i.d(t,{Q:function(){return f}});var a=i(83260),o=i(66084),s=i(92235),n=i(88882),r=i(31640),l=i(82270),d=i(52825),c=i(56607),h=i(96827),g=i(65324),p=i(55180),A=i(71749),m=i(5431);class u extends p.b{async aiTranslate(e,t){let{useEngine:i,sourceLang:a,paragraphs:o,toLang:d,translateFeature:c,originTitle:h,originUrl:g,taskUid:p,isFreeUser:A}=e;this.abortControllerMap[p]=new AbortController;let{result:m,paragraphGroups:u}=this.beforeTranslate({sourceLang:a,paragraphs:o,toLang:d,engine:i,scene:null==c?void 0:c.translateScene});if(!m&&!u){t([]);return}if(m.length&&t(m),!u)return;let f=(e,i)=>{let{type:a,paragraphs:o,apiType:r}=i;t(o.map(t=>({id:t.id,text:t.text,detectLang:t.detectLang,result:"",errorType:a,apiType:r,error:s.m.formatErrorMsg(e,n.S.Global.services.translateService.translationFailed)})))},y=u.length,v=e=>{y-=1;let t=[];e.forEach(e=>{let{detectLang:i,id:a,result:o,text:s,error:n}=e;n||t.push({p:{id:a,text:s,detectLang:i},cacheData:o})}),this.setTranslateToCache(t,a,d,i,null==c?void 0:c.translateScene),0===y&&this.services.credits.updateUsageInfos(["credits","basic_query","genius_bot"])},w=e.sourceLang;await Promise.all(u.map(async e=>{let o=r.q.standardizeLocale(r.q.getLocaleByComposeLanguage(d)),n=r.q.standardizeLocale(r.q.getLocaleByComposeLanguage(a));if("bing"===i||"google"===i)try{let s=await this.translateByFreeTranslateServer("bing"===i?"edge-translate-free":"google-translate-free",{fromLang:n,taskType:"translation:translate",taskUid:p,textList:e.paragraphs.map(e=>e.text),toLang:o,textType:e.textType,originUrl:g,originTitle:h,fallback:!A}),r=this.processTranslateResult({resp:s,paragraphs:e.paragraphs,sourceLang:a,toLang:d,engine:i,scene:null==c?void 0:c.translateScene});t(r)}catch(t){f(t,{type:"freeApiError",apiType:i,paragraphs:e.paragraphs})}else{let a=0,r=e.paragraphs.length;try{let s=[],d=[],h=await this.services.config.get("translationGlossaryEnabled");await this.services.monica.genTranslate({sourceLang:n,toLang:o,translateFeature:c,texts:e.paragraphs.map(e=>e.text),translateEngine:i,taskUid:p,enableGlossary:null==h||h},o=>{let{text:n,error:c,finished:h,index:g}=o;if(c){let t=e.paragraphs.filter((e,t)=>!d.includes(t));if(c===l.Eg.creditsQuotaExceed){t.length&&f(c,{type:"creditError",paragraphs:t}),v(s);return}t.length&&f(c,{type:"aiApiError",paragraphs:t,apiType:i}),v(s);return}if(h){if(v(s),a<r-1){this.sendEvent("translate_error_notice",{code:"10001",msg:"input paragraph number: ".concat(r,"; output paragraph number: ").concat(a+1),inputStr:e.paragraphs.map(e=>e.text).join("__n__")});let i=e.paragraphs.filter((e,t)=>!d.includes(t));i.length&&t(i.map(e=>({id:e.id,text:e.text,detectLang:e.detectLang,result:"",error:null})))}return}if(a>=r){this.sendEvent("translate_error_notice",{code:"10002",msg:"input paragraph number: ".concat(r,"; output paragraph number: ").concat(a+1),inputStr:e.paragraphs.map(e=>e.text).join("__n__")});return}if(g>-1&&e.paragraphs[g]){let i={error:null,detectLang:w,id:e.paragraphs[g].id,result:n,text:e.paragraphs[g].text};s.push(i),t([i]),d.push(g),a+=1}})}catch(t){console.error(t),f(s.m.formatErrorMsg(t),{type:"aiApiError",paragraphs:e.paragraphs,apiType:i})}}}))}async webpageTranslate(e,t){let{isFreeUser:i,useEngine:a}=e;i&&("google"===a||"bing"===a)?await this.freeTranslate({...e},a,t):await this.aiTranslate(e,t)}async freeTranslate(e,t,i){let{result:a,paragraphGroups:o}=this.beforeTranslate({...e,engine:t});if(!o&&!a.length){i([]);return}if(i(a),o){let{sourceLang:a,paragraphs:r,taskUid:l,toLang:d,originTitle:c,originUrl:h}=e,g=[];try{await Promise.all(o.map(async e=>{let{textType:o}=e,s=await this.translateByFreeTranslateServer("bing"===t?"edge-translate-free":"google-translate-free",{fromLang:a,taskType:"translation:translate",taskUid:l,textList:r.map(e=>e.text),toLang:d,textType:o,originUrl:h,originTitle:c,fallback:!1});g=this.processTranslateResult({resp:s,paragraphs:r,sourceLang:a,toLang:d,engine:t}),i(g)}))}catch(e){console.error(e),g.push(...r.map(i=>({id:i.id,text:i.text,detectLang:i.detectLang,result:"",apiType:t,errorType:"freeApiError",error:s.m.formatErrorMsg(e,n.S.Global.services.translateService.translationFailed)}))),i(g)}}}async priorityFreeTranslate(e,t){let{paragraphs:i,taskUid:a,originUrl:o,originTitle:s,sourceLang:n,toLang:r}=e;(!i||i.length<=0)&&t([]);let{cachedParagraphs:l,needServiceTranslateParagraphs:d}=this.tryGetCachedParagraphs({paragraphs:i,sourceLang:n,toLang:r}),c=this.getCachedResult({cachedParagraphs:l,sourceLang:n,toLang:r});if(c.length&&t(c),d.length){let e=this.mergeParagraph(d);await this.translateParagraphGroups({originTitle:s,originUrl:o,paragraphGroups:e,taskUid:a,sourceLang:n,toLang:r,callback:t})}}async cancelAiTranslate(e){var t;null===(t=this.abortControllerMap[e])||void 0===t||t.abort()}async feedbackTranslateResult(e){return g.Cb.taskApi.feedbackTranslateResult(e)}async translateByServer(e){let t=await this.getActiveTranslateServer(e);switch(t){case"edge-translate-free":case"google-translate-free":return this.translateByFreeTranslateServer(t,e);default:return this.translateByAzureTranslate(e)}}async getLocaleList(){return this.sortLocale(this.localeList)}async onInit(){this.initLocaleList(),this.initGlossaryEventListener(),await this.initStorageData(),await this.syncEdgeTranslateAuthData(),this.updateFastestFreeTranslateServer()}sendEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{source:i,...a}=t;this.services.user.createUserBehaviorEvent({eventName:e,source:i,extData:a})}initLocaleList(){let e=s.m.jsonClone(d.sC);this.localeList=[],Object.keys(e).forEach(t=>{let{locale:i,localeName:a}=e[t];this.localeList.push({locale:r.q.standardizeLocale(i),name:t,localeName:r.q.getLanguageDisplayNameByComposeLanguage(n.a.locale,t,a)})})}async initStorageData(){let{edgeTranslateAuthData:e}=await this.storage.getAll();this.edgeTranslateAuthData=e,this.storage.addChangeListener(e=>{void 0!==e.edgeTranslateAuthData&&(this.edgeTranslateAuthData=e.edgeTranslateAuthData)})}initGlossaryEventListener(){this.services.translationGlossary.on("change",e=>{void 0!==e.translationGlossaryList&&this.clearCache()}),this.services.config.on("configChange",e=>{void 0!==e.translationGlossaryEnabled&&this.clearCache()})}sortLocale(e){let t=[...e],i=[];return["id","cs","de","en","es","es-419","fr","it","nl","pt_BR","pt_PT","pl","ru","vi","tr","uk","ja","ko","ar","fa","th","hi"].forEach(e=>{let a=t.find(t=>t.locale===e),o=t.findIndex(t=>t.locale===e);a&&(i.push(a),t.splice(o,1))}),i.concat(t)}async translateByEdgeTranslate(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let a=this.normalizeCmdLocale(e,"edge-translate-free"),{textList:o,fromLang:s,toLang:n}=a,r=o.map(e=>({Text:e})),l=JSON.stringify(r),d=Date.now(),c=await this.request("".concat("https://api-edge.cognitive.microsofttranslator.com/translate","?from=").concat(s,"&to=").concat(n,"&api-version=3.0"),{headers:{accept:"*/*",authorization:"Bearer ".concat(t),"cache-control":"no-cache","content-type":"application/json",pragma:"no-cache","sec-ch-ua":'"Microsoft Edge";v="113", "Chromium";v="113", "Not-A.Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"cross-site","Referrer-Policy":"strict-origin-when-cross-origin"},body:l,method:"POST"}),h=await c.json();return i||g.Cb.parallelTranslationApi.translate({startTime:d,finishTime:Date.now(),...a,usedApiType:"edge-translate-free"}),{code:0,msg:"",data:h}}catch(t){if(this.handleFreeTranslateServerError("edge-translate-free"),"boolean"==typeof e.fallback&&!e.fallback||i)return Promise.reject(t);return this.translateByAzureTranslate(e)}}edgeTranslateAuthDataIsValid(e){if(!e)return!1;let t=Date.now();return 1e3*e.accessTokenExpiresAt-t>3e4}async syncEdgeTranslateAuthData(){setTimeout(()=>{this.syncEdgeTranslateAuthData()},3e5),await this.tryUpdateEdgeTranslateAuthData()}async tryUpdateEdgeTranslateAuthData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(!this.edgeTranslateAuthDataIsValid(this.edgeTranslateAuthData)||e)&&await this.forceUpdateEdgeTranslateAuthData()}async forceUpdateEdgeTranslateAuthData(){try{let e=await this.request("https://edge.microsoft.com/translate/auth",{headers:{accept:"*/*","cache-control":"no-cache",pragma:"no-cache","sec-ch-ua":'"Microsoft Edge";v="113", "Chromium";v="113", "Not-A.Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"cross-site","sec-mesh-client-arch":"x86_64","sec-mesh-client-edge-channel":"beta","sec-mesh-client-edge-version":"113.0.1774.23","sec-mesh-client-os":"Windows","sec-mesh-client-os-version":"10.0.19044","sec-mesh-client-webview":"0",Referer:"https://appsumo.com/","Referrer-Policy":"strict-origin-when-cross-origin"},body:null,method:"GET"}),t=await e.text(),i=this.parseJWT(t);i&&(this.edgeTranslateAuthData=i,await this.storage.set("edgeTranslateAuthData",i))}catch(e){this.edgeTranslateAuthData=null,await this.storage.set("edgeTranslateAuthData",null)}}parseJWT(e){let t=e.split(".");if(t.length<=1)throw Error("invalid token");let i=t[1];if(!i)throw Error("invalid base64 url token");return{accessToken:e,accessTokenExpiresAt:JSON.parse(decodeURIComponent(globalThis.atob(i.replace(/-/g,"+").replace(/_/g,"/")).split("").map(function(e){return"%".concat("00".concat(e.charCodeAt(0).toString(16)).slice(-2))}).join(""))).exp}}async translateByGoogleTranslate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{let i=this.normalizeCmdLocale(e,"google-translate-free"),{textList:a,fromLang:o,toLang:s}=i;a.forEach(e=>{e.replace(/\n/g,"")});let n=new URLSearchParams({client:"gtx",dt:"t",dj:"1",sl:o||"auto",tl:s,q:a.join("\n")}),r=Date.now(),l=await this.request("".concat("https://translate.googleapis.com/translate_a/single","?").concat(n.toString())),d=await l.json(),c=this.parseGoogleTranslateResult(d,s);return t||g.Cb.parallelTranslationApi.translate({startTime:r,finishTime:Date.now(),...i,usedApiType:"google-translate-free"}),{code:0,msg:"",data:c}}catch(i){if(this.handleFreeTranslateServerError("google-translate-free"),"boolean"==typeof e.fallback&&!e.fallback||t)return Promise.reject(null!=i?i:Error("unknown error"));return this.translateByAzureTranslate(e)}}parseGoogleTranslateResult(e,t){let{paragraphGroup:i,sentences:a,src:o}=e,s=[];return(a||i).reduce((e,t)=>e+t.trans,"").split("\n").forEach(e=>{s.push({detectedLanguage:{language:o,score:1},translations:[{text:e,to:t}]})}),s}translateByAzureTranslate(e){let t=this.normalizeCmdLocale(e,"azure");return g.Cb.parallelTranslationApi.translate(t)}async getActiveTranslateServer(e){if(!await this.services.user.getUserInfo({cacheOnly:!0,useCache:!0}))return"google-translate-free";let t=await this.storage.get("fastEngine")||"google-translate-free";if("google-translate-free"===t)try{let i=e.textList.join("");if(c.o.isWeb)return"google-translate-free";let{languages:a}=await A.b.getBrowser().i18n.detectLanguage(i);a.length>1&&(t="edge-translate-free")}catch(e){return console.error(e),"azure"}if("edge-translate-free"===t)return this.edgeTranslateAuthDataIsValid(this.edgeTranslateAuthData)?t:"azure";if("google-translate-free"===t){let{toLang:i,fromLang:a}=this.normalizeCmdLocale(e,"google-translate-free");return m.k.GOOGLE_TRANSLATE_UNSUPPORTED_LANGS.includes(i)||m.k.GOOGLE_TRANSLATE_UNSUPPORTED_LANGS.includes(a)?"azure":t}return"azure"}async handleFreeTranslateServerError(e){"edge-translate-free"===e&&(await this.storage.set("edgeTranslateAuthData",null),this.tryUpdateEdgeTranslateAuthData(!0))}async updateFastestFreeTranslateServer(){if(await this.storage.get("fastEngine"))return;let e={fromLang:m.k.AUTO_DETECT_LANG,toLang:"fr",taskType:"translation:translate",taskUid:s.m.genId(),textList:["A translation service should translate this text properly"]},t=0;["google-translate-free","edge-translate-free"].forEach(i=>{this.translateByFreeTranslateServer(i,e,!0).then(()=>{0!==t||(t+=1,this.storage.set("fastEngine",i),this.services.config.get("translationEngine")||this.services.config.set("translationEngine","google-translate-free"===i?"google":"bing"))})})}translateByFreeTranslateServer(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(e){case"edge-translate-free":var a;return this.translateByEdgeTranslate(t,(null===(a=this.edgeTranslateAuthData)||void 0===a?void 0:a.accessToken)||"",i);case"google-translate-free":return this.translateByGoogleTranslate(t,i);default:return this.translateByAzureTranslate(t)}}mergeParagraph(e){let t=[],i=e=>{t.push({merged:!1,mergedText:e.text,paragraphs:[e],detectLang:e.detectLang,textType:"plain"})};return e.forEach(e=>{let a=this.findMatchedParagraphGroup(e,t);a?a.paragraphs.length<1e3&&a.mergedText.length+e.text.length<1e4?(a.paragraphs.push(e),a.mergedText+=e.text):(a.merged=!0,i(e)):i(e)}),t}findMatchedParagraphGroup(e,t){return t.find(t=>{let{merged:i,detectLang:a}=t;return!i&&a===e.detectLang})}tryGetCachedParagraphs(e){let{paragraphs:t,sourceLang:i,toLang:a,engine:o,scene:s}=e,n=[...t];return{needServiceTranslateParagraphs:t.filter(e=>!(this.getParagraphCacheKey({p:e,from:i,to:a,engine:o,scene:s}) in this.translatedTextCacheMap)),cachedParagraphs:t.filter(e=>this.getParagraphCacheKey({p:e,from:i,to:a,engine:o,scene:s}) in this.translatedTextCacheMap)}}async setTranslateToCache(e,t,i,a,o){e.forEach(e=>{let{p:s,cacheData:n}=e;this.translatedTextCacheMap[this.getParagraphCacheKey({p:s,from:t,to:i,engine:a,scene:o})]=n})}getParagraphCacheKey(e){let{p:t,from:i,to:a,engine:o,scene:s}=e,n=["ai",a,i,o,s,t.text].flatMap(e=>e?[e]:[]);return h.D.md5("$".concat(n.join("-"))).substring(8,24)}getCachedResult(e){let{cachedParagraphs:t,sourceLang:i,toLang:a,engine:o,scene:s}=e,n=[];return n.push(...t.map(e=>{let t=this.translatedTextCacheMap[this.getParagraphCacheKey({p:e,from:i,to:a,engine:o,scene:s})];return{...e,result:t,error:null}})),[...n]}async translateParagraphGroup(e){let{originTitle:t,originUrl:i,paragraphGroup:a,taskUid:o,sourceLang:r,toLang:l,engine:d,scene:c,callback:h}=e,g=[],{textType:p,paragraphs:A}=a;try{let e=await this.translateByServer({fromLang:r,taskType:"translation:translate",taskUid:o,textList:A.map(e=>e.text),toLang:l,textType:p,originUrl:i,originTitle:t});g=this.processTranslateResult({resp:e,paragraphs:A,sourceLang:r,toLang:l,engine:d,scene:c}),h(g)}catch(e){console.error(e),g.push(...A.map(t=>({id:t.id,text:t.text,detectLang:t.detectLang,result:"",error:s.m.formatErrorMsg(e,n.S.Global.services.translateService.translationFailed)}))),h(g)}}beforeTranslate(e){let{paragraphs:t,sourceLang:i,toLang:a,engine:o,scene:s}=e;if(!t||t.length<=0)return{result:[]};let{cachedParagraphs:n,needServiceTranslateParagraphs:r}=this.tryGetCachedParagraphs({paragraphs:t,sourceLang:i,toLang:a,engine:o,scene:s}),l=[];r&&r.length>0&&(l=this.mergeParagraph(r));let d=this.getCachedResult({cachedParagraphs:n,sourceLang:i,toLang:a,engine:o,scene:s});return d.length,{result:d,paragraphGroups:l}}processTranslateResult(e){let{resp:t,paragraphs:i,sourceLang:a,toLang:o,engine:s,scene:n}=e,r=[],l=[];return l.push(...t.data.map((e,t)=>{let a=e.translations[0].text,o=i[t];return r.push({p:o,cacheData:a}),{id:o.id,text:o.text,detectLang:o.detectLang,result:a,error:null}})),this.setTranslateToCache(r,a,o,s,n),l}async translateParagraphGroups(e){let{paragraphGroups:t,originTitle:i,originUrl:a,taskUid:o,sourceLang:s,toLang:n,callback:r}=e;await Promise.all(t.map(async e=>await this.translateParagraphGroup({originTitle:i,originUrl:a,paragraphGroup:e,taskUid:o,sourceLang:s,toLang:n,callback:r})))}async request(e,t){try{let i=await fetch(e,t);if(i.ok&&i.status>=200&&i.status<400)return i;return Promise.reject()}catch(e){return Promise.reject(s.m.formatErrorMsg(e))}}normalizeCmdLocale(e,t){let i={...e};return i.fromLang=r.q.standardizeLocale(i.fromLang),i.fromLang===m.k.AUTO_DETECT_LANG&&("google-translate-free"===t?i.fromLang="auto":i.fromLang=""),i.fromLang=r.q.standardizeLocale(i.fromLang),i.toLang=r.q.standardizeLocale(i.toLang),{...i}}clearCache(){this.translatedTextCacheMap={}}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"translate",name:"TranslateService"}),(0,o._)(this,"dependencies",["user","serverConfig","credits","config","monica","translationGlossary"]),(0,o._)(this,"defaultStorageValues",{edgeTranslateAuthData:null,fastEngine:null}),(0,o._)(this,"localeList",[]),(0,o._)(this,"edgeTranslateAuthData",null),(0,o._)(this,"translatedTextCacheMap",{}),(0,o._)(this,"abortControllerMap",{})}}let f=new a.x(u)},7893:function(e,t,i){"use strict";i.d(t,{d:function(){return l}});var a=i(83260),o=i(66084),s=i(65324),n=i(55180);class r extends n.b{async getStaledGlossaryList(){let e=await this.storage.get("translationGlossaryList");return null===e?await this.fetchGlossaryList():(this.fetchGlossaryList(),e)}async addTerm(e){let{data:{uid:t}}=await s.Cb.botFrameworkService.translationGlossaryApi.add(e),i={...e,uid:t},a=await this.storage.get("translationGlossaryList");null===a?this.storage.set("translationGlossaryList",[i]):a.find(e=>e.uid===t)||(a.unshift(i),this.storage.set("translationGlossaryList",a))}async editTerm(e){await s.Cb.botFrameworkService.translationGlossaryApi.edit(e);let t=await this.storage.get("translationGlossaryList");if(null===t)return;let i=t.findIndex(t=>t.uid===e.uid);-1!==i&&(t.splice(i,1),t.unshift(e)),this.storage.set("translationGlossaryList",t)}async delTerm(e){await s.Cb.botFrameworkService.translationGlossaryApi.del({uid:e});let t=await this.storage.get("translationGlossaryList");if(null===t)return;let i=t.findIndex(t=>t.uid===e);-1!==i&&t.splice(i,1),this.storage.set("translationGlossaryList",t)}async onInit(){this.initStorageListener()}initStorageListener(){this.storage.addChangeListener(e=>{this.emit("change",e)})}async fetchGlossaryList(){let{data:{glossaryList:e}}=await s.Cb.botFrameworkService.translationGlossaryApi.list({});return await this.storage.set("translationGlossaryList",e),e}constructor(...e){super(...e),(0,o._)(this,"meta",{key:"translationGlossary",name:"translationGlossaryService"}),(0,o._)(this,"dependencies",[]),(0,o._)(this,"defaultStorageValues",{translationGlossaryList:null})}}let l=new a.x(r)},62659:function(e,t,i){"use strict";i.d(t,{g:function(){return c}});var a=i(83260),o=i(66084),s=i(56607),n=i(92235),r=i(65324),l=i(55180);class d extends l.b{async onInit(){this.storage.addChangeListener(e=>{e.markList&&this.emit("markListChange",e.markList),e.markIdsViewedInMemo&&this.emit("markIdsViewedInMemoChange",e.markIdsViewedInMemo)}),this.services.user.on("userLogout",()=>{this.clearMarkList(),this.storage.set("markIdsViewedInMemo",null)})}async clearMarkList(){await this.storage.set("markList",null)}async getMarkList(){return s.o.isWeb?this.markListInWeb:await this.storage.get("markList")}async setMarkList(e){s.o.isWeb&&(this.markListInWeb=e,this.emit("markListChange",e)),await this.storage.set("markList",e)}async listAllUrl(e){let t="markList";this.requestLockMap[t]?await this.requestLockMap[t].waitReady():this.requestLockMap[t]=n.m.createReadySource();let{forceFetch:i}=null!=e?e:{},a=this.getMarkList(),o=async()=>{var e;let t=null!==(e=(await r.Cb.generateService.webPageMarkApi.list({limit:1e3})).data.items)&&void 0!==e?e:null;return this.setMarkList(t),t};if(null===a||i){let e=await o();return this.requestLockMap[t].markReady(),e}return this.requestLockMap[t].markReady(),null!=a?a:[]}async findByUrl(e,t){var i;let a=await this.listAllUrl(t);return null!==(i=null==a?void 0:a.filter(t=>t.url===e))&&void 0!==i?i:[]}async findByUid(e,t){var i;let a=await this.listAllUrl(t);return null!==(i=null==a?void 0:a.find(t=>t.uid===e))&&void 0!==i?i:null}async get(e){return await r.Cb.generateService.webPageMarkApi.get(e)}async update(e){var t;if(!e.uid)throw Error("uid is required when updating web page mark");let i=await this.listAllUrl(),a=null!==(t=null==i?void 0:i.find(t=>t.uid===e.uid))&&void 0!==t?t:null;if(!a)return;let o={...a};Object.assign(a,e),await this.setMarkList(i),r.Cb.generateService.webPageMarkApi.update(e).catch(e=>(Object.assign(a,o),this.setMarkList(i),Promise.reject(e)))}async create(e){var t;if(!e.url)throw Error("url is required when creating web page mark");let i=null!==(t=await this.getMarkList())&&void 0!==t?t:[];i.push(e),await this.setMarkList(i),r.Cb.generateService.webPageMarkApi.create(e).catch(t=>{let a=i.findIndex(t=>t.uid===e.uid);return a>=0&&(i.splice(a,1),this.setMarkList(i)),Promise.reject(t)})}async delete(e){var t,i;let a=null!==(t=await this.getMarkList())&&void 0!==t?t:[],o=a.findIndex(t=>t.uid===e),s=null;o>=0&&(s=null!==(i=a.splice(o,1)[0])&&void 0!==i?i:null,this.setMarkList(a)),r.Cb.generateService.webPageMarkApi.delete({uid:e}).catch(e=>(s&&(a.push(s),this.setMarkList(a)),Promise.reject(e)))}async listMarkIdsViewedInMemo(){var e;return null!==(e=await this.storage.get("markIdsViewedInMemo"))&&void 0!==e?e:[]}async markAsViewedInMemo(e){var t;let i=null!==(t=await this.storage.get("markIdsViewedInMemo"))&&void 0!==t?t:[];i.includes(e)||(i.push(e),this.storage.set("markIdsViewedInMemo",i))}constructor(...e){super(...e),(0,o._)(this,"dependencies",["user"]),(0,o._)(this,"meta",{key:"webPageMark",name:"WebPageMarkService"}),(0,o._)(this,"defaultStorageValues",{markList:null,markIdsViewedInMemo:null}),(0,o._)(this,"requestLockMap",{}),(0,o._)(this,"markListInWeb",null)}}let c=new a.x(d)},72289:function(e,t,i){"use strict";i.d(t,{s:function(){return G}});var a=i(92235),o=i(90539),s=i(25902),n=i(20549),r=i(42857),l=i(88792),d=i(46756),c=i(3978),h=i(92020),g=i(73361),p=i(63869),A=i(46260),m=i(38795),u=i(24900),f=i(24053),y=i(41602),v=i(94223),w=i(11502),C=i(48655),b=i(82152),S=i(50209),I=i(83260),_=i(66084),T=i(92660),k=i(56607),E=i(92347),M=i(65324),x=i(55180);let B=30*T.EB;class D extends x.b{async onInit(){let{user:e}=this.services;this.apiLastSyncStatus=await this.storage.get("apiLastSyncStatus"),k.o.isExtension?this.checkSync():(e._addAuthChangeHooks({whenLogin:()=>{setTimeout(()=>{this.checkSync()},3e3)}}),this.syncInterval=setInterval(()=>{this.checkSync()},1e4)),e.on("userLogout",()=>{this.storage.set("nextSyncTime",0)})}_doOnInstallSync(){let{user:e}=this.services;e.getUserInfo({cacheOnly:!0}).then(t=>{t&&(e.getCustomPrompts(E.kq.SelectionAction,{useCache:!1}),e.getCustomPrompts(E.kq.ComposeAction,{useCache:!1}))})}_destroy(){this.syncInterval&&clearInterval(this.syncInterval)}async getDesktopUpdateInfo(){return this.desktopUpdateInfo}async checkSync(){let e=await this.storage.get("nextSyncTime");(!e||Date.now()>e)&&this.sync()}async fetchDesktopUpdateInfo(){let{data:e}=await M.Cb.versionApi.get(),{updateTitle:t,updateMessage:i,updateType:a,updateUrl:o,buttonText:s}=e;"force"===a||"optional_force"===a||"recommend"===a?(this.desktopUpdateInfo={updateTitle:t,updateMessage:i,updateType:a,updateUrl:o,buttonText:s},console.log("got update info",this.desktopUpdateInfo),this.emit("hasUpdateInfo",this.desktopUpdateInfo)):this.desktopUpdateInfo=null}async sync(){var e;let t;let{user:i,bot:a}=this.services,o=this.apiLastSyncStatus,{writing:s,notification:n}=this.services,r=Object.keys(o),l=Date.now(),d=await M.Cb.userApi.getApiSyncStatus({lastUpdates:r.map(e=>{var t;return{k:e,t:null!==(t=o[e])&&void 0!==t?t:0}})});this.storage.update({nextSyncTime:l+(null!==(e=d.nextInterval)&&void 0!==e?e:B)});let c={};for(let e of d.data)c[e.k]=!0;c.user_me?(t=await i.getUserInfo({useCache:!1}),this.saveApiSyncStatus("user_me",l)):t=await i.getUserInfo({cacheOnly:!0}),t&&(!k.o.isWeb&&c.custom_prompt&&Promise.all([i.getCustomPrompts(E.kq.MyPrompt,{useCache:!1}),i.getCustomPrompts(E.kq.SelectionAction,{useCache:!1}),i.getCustomPrompts(E.kq.ComposeAction,{useCache:!1}),i.getPromptsI18n({useCache:!1})]).then(()=>{this.saveApiSyncStatus("custom_prompt",l)}),c.all_artist_bot_list&&a.getAllArtistBotList({useCache:!1}),c.all_chat_bot_list&&a.getAllChatBotList({useCache:!1}),c.version_upgrade&&i.checkUpgrade(),c.notification&&n.getNotificationData({userCreatedAt:t.createdAt}).then(()=>{this.saveApiSyncStatus("notification",l)}),c.subscribe_list&&this.services.serverConfig.syncSubscribePlanList(!0),k.o.isDesktop?this.fetchDesktopUpdateInfo():k.o.isExtension&&(c.writing_command&&s.getCommandList({useCache:!1}).then(()=>{this.saveApiSyncStatus("writing_command",l)}),c.writing_template&&s.getTemplateList({useCache:!1}).then(()=>{this.saveApiSyncStatus("writing_template",l)}),c.site_integration&&s.getSiteTemplateList({useCache:!1}).then(()=>{this.saveApiSyncStatus("site_integration",l)})))}saveApiSyncStatus(e,t){this.apiLastSyncStatus[e]=t,this.storage.set("apiLastSyncStatus",this.apiLastSyncStatus)}constructor(...e){super(...e),(0,_._)(this,"meta",{key:"sync",name:"SyncService"}),(0,_._)(this,"dependencies",["writing","notification","bot","user","serverConfig"]),(0,_._)(this,"defaultStorageValues",{apiLastSyncStatus:{},nextSyncTime:0}),(0,_._)(this,"syncInterval",null),(0,_._)(this,"desktopUpdateInfo",null),(0,_._)(this,"apiLastSyncStatus",{})}}let L=new I.x(D);var R=i(57434),U=i(59133),P=i(7893),F=i(38172),O=i(62659),N=i(70174);let V=[h.ll,F.W,g.gM,S.H,w.M,C.Cc,R.Yl,c.aS,b.a],Q=[P.d,m.R,O.g,N.v,r.d,y.B,d.y,u.Tn,U.Q,s.G,f._,L,A.D,o.DN,n.D,v.X,p.i7,l.y];var z=i(94037),H=i(72142);let W=[...V,z.$,...Q,d.y,H.u,l.y];class G{async init(){let e=a.m.listToMap(W,e=>e.meta.key);for(let t of W)t._initBaseService(e);for(let e of W)await e._initService()}}},45973:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/claude_round.fb5a674c.png",height:64,width:65,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAASFBMVEXt7eTt7ubv8Oju7+bc39jt3M/m6ODnw7La2M5MaXHiqJLjsJvn6OLw8Ojv7+b++/HipI387+TekXXltaHz6Nzs1cfae1zZd1fXH1u1AAAAD3RSTlP32+OfN/6u/SUA/fq8u+ttrvJyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQElEQVR4nDXLSQ6AIBAAwZZFNsnMgOj/f2pC4q0P1ZR8whUK2dmKRsBL01mlc9xpPLrY8WoCL2nWZp3sJG787x9ZjAJt6MEMjgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},13845:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/gemini_round.8ebaca30.png",height:64,width:65,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEX////56+zt7e/w8PD6+vpMaXH29/j6+vvr6+z29vbZtMzYs8v4+Pn89PTWXF/psbnnpqLMYnnnoaUrsHw7AAAADXRSTlP+/jk13wC89yWm/v67UXqwWQAAAAlwSFlzAAALEwAACxMBAJqcGAAAADZJREFUeJxFi0EOgCAMwApujIGo8P/HegDCrUlbNLtZupQstIBFHN4BCaH052uGUCcsdZ947z89AQG0FHLU/gAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},64723:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/gpt3_round.a8fae3ef.png",height:44,width:44,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEX////l6On5+vzAv8CDg4Pf3+RMaXGOjo/3+Pj6+vvAwL/5+fm3t7eenp6np6d8fHzFxcUDEaPvAAAAC3RSTlP2LLH+/CwA/fO0/tpjGJwAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA9SURBVHicFcrJEcAwCACxNQEDAR/9V5uJ3mKaQI6JRfVTMZBSV4+E9rXPBe7ZyxsyXF1LGFFv/3lagtj8AD2mAbpw5h1mAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},46342:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/gpt_round.ccad236d.png",height:64,width:65,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEUAAAB3d3cAAAAAAAAEBARMaXEHBwcAAACAgIBzc3MAAAAEBAQCAgIWFhZAQEBZWVlMTExjY2OO8nSyAAAADXRSTlO3/Z/jJQD99f792zU5DEBORAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADxJREFUeJw1y0EOgCAMBMAFgW7Rbev/P2s08T6DOWAL58Q4VpXsQhedLmCHZzIMO5i3l6HL2Zrw4vjw3x9KqQIOckwA+QAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},1392:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/support_model_gpt4.22f3bf10.png",height:64,width:64,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEUQEBABAQEAAAAAAAAWFhYcHBwAAAB1dXVBQUFRUVGAgIBiYmIVfkzVAAAABnRSTlP+71Xo/v5gokJWAAAACXBIWXMAABYlAAAWJQFJUiTwAAAANklEQVR4nDXLORIAMAjDQOeSgfz/vxmKdCpWmgNgTC2UIZbYdnkjwjcrOiqvO47LFo0jG//9ATL5AWj5Ooy5AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},60927:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandAndroid.75245f10.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEUpwWMpw2VMaXEqwmcpxGU/vz8s0mwpw2UoxGYszWspxGUoxGUszWsv3XKsUigiAAAADXRSTlMrawAV2ARBwJj5mZz3706XPAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADVJREFUeJwti8kNADAIw5IUSi/2X7dCwi8/bKiBHCRc0LC3bQiCRRhK7lqnZGZmzmpIsprePx/dAO1bGClrAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},91263:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandApple.dd1ee42f.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEVMaXEbGxsZGRkZGRkaGhoaGhoaGhoZGRkaGhobGxsaGhoaGhoaGho7e157AAAADXRSTlMA/F0nOZpyn0ThtBPDexS08wAAAAlwSFlzAAALEwAACxMBAJqcGAAAAC5JREFUeJxNi7cRADAIxBDBef95fVDxjVToRfrUC65PkwaclAVEyt2AVTpjtOsHDXYAaQxwWRAAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},49881:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandChrome.5f6c12ed.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAS1BMVEVMaXEvnU0tnk3/vhCs///kPjrqPCr4qyAunEBYl/vPsxuqZD9QoPqmw2JOtnvug2nsdHH/vg790U//yhc1rE3DiXT/TDf/fCthuHxkaM9fAAAAEnRSTlMAZl+7AWrNW8b6wG36/f39/L7YIbbDAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPUlEQVR4nB2LRw6AMBDEDJmUpQUS2v9fipaTLVkGISGAmFJ0zvdenwyUy5Z2uLxmLQDDua3dE2OZsm//KT46EgGS1Rlv8wAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},69131:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandClaude3.94caf510.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAHlBMVEXOZT7feFjZdlbYd1XXdlbad1fZdlbZd1fad1feeVg66EL9AAAACnRSTlMBFCqHWXeZOM7zs8fsSQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAC9JREFUeJxFikkKAEAIw6p1/f+HB0WYXFpCgE+myqwwnHu8mgpArTpslDF8Y7n4eBJSAH49ZYzwAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},24455:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandDalle3.b1688f0f.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAY1BMVEVMaXGVtFLCl1WZ8MjI/cVqTa+1bIusk398t5zZhFx2drS89JiI4rB76cLM8bBz2W+Mzlp+zFOK+eKt8MyqsW1++OBz246jkYN35oOKgKuiZat+/N/AvlfSmVGR/9yE/7/IeWniyd48AAAAGnRSTlMAj4+R/pCPCg/h5o77j+bl/OTg+/zgj/z8/NLK6K8AAAAJcEhZcwAACxMAAAsTAQCanBgAAABBSURBVHicLctXDoAwDMBQA4Wk7D0L5f6nRJHw9zOAKpas3ZAI0MS9DynoctXz7QUdn2l7vUDm3HEWhqu2zA3/+wdatgJpqL6t6AAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},95269:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandEdge.fa5adb74.png",height:57,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAS1BMVEVMaXENUpdD0XpJ3W8PT5koyvAsxNMSWZFN2FsLjOAJNItR/5ELjuMOZa9Q52YGd9Atxs0fsucuyNYRld8PhtxA36giuORA4rQLkeyyUvX0AAAAFHRSTlMAJWry6f1bfXh0UjjF3s2TvZm7wX+FS/gAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA3SURBVHicY2BAADYhASYwLcbKKsrBwMAgLMEvKM7HwMDAI8LFzQwS4RRhYWdnBCni5GVhR9ILADbEAW9W4u/VAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},13203:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandFacebook.2b6cf8aa.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEVMaXEsZPU/cvYqYvU4bvi/0Ptdi/8kXvcgXPdCev+mvvofW/Z8of4pYvYpYfOtw/qXs/o5b/s4dP8saP/5MqgEAAAAEnRSTlMAWR6AJfz+w/oH/ND+m5r9/hPiwo1cAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOUlEQVR4nDXFSRKAIAwAwRGyAi4V//9Xi4N9aSClsYlHXAl4jVUdJG7VNaHFM9QcOMvsPYDs0/e/DzR9AVbNAh1WAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},30408:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandFlux.8802d5cf.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEVMaXEAAAAgICAAAAAAAAA4ODhhYWEKCgoYGBgAAAAQEBBZWVl5eXlLS0sAAAAICAgAAACSkpLC16w5AAAAEHRSTlMAAZDmCP784g2PD/3+/RCPx69MwwAAAAlwSFlzAAALEwAACxMBAJqcGAAAADpJREFUeJwdyscRwDAMBLFVoI5Udv/NekZ4AxK7k4AaUlQgbmv3QJetNuRszTE/OeRlZvnlUl4Gd+AHN7ABcmKvIyQAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},10023:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandGemini.03fca150.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAElBMVEVMaXHIYnnWXmrVYG3UY1u1aJdOWODxAAAABnRSTlMAFYj9i4kfRBswAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIElEQVR4nGNgQAKMjFAGExOEz8rMzAISgzPgUkiKwQAABsMAL1mbBgQAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},4176:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandGmail.a4de23cd.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEVMaXH/wQAlqVhCifY9ifr0PjJEhPKbgI81qFH8OigzpVZ3wjVoZLTUJBjIGxT/nA7mmC3NTF/HUZHmAAAAEHRSTlMAdJu0mNN/BoiZrYuJrnCrY9qzYAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADBJREFUeJxlyjcOACAMwEBTEzr8/7MIBhZOHg2/3kSGAeoKYRbAu5SyBaIH1TPJ7dkdYwDJl8HuQgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},27411:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandGpt4.4b997f93.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAGFBMVEVMaXEICAhubm4AAABnZ2cAAAAAAAAqKipYc3RwAAAAB3RSTlMAyv1m/Wlq77pTkgAAAAlwSFlzAAALEwAACxMBAJqcGAAAACxJREFUeJxNilsKACAMw/rY3P1vLBVE89NCAjxMdrZHGgOgSsX/rKgTmUxy2Q6BAGYrf+B+AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},3415:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandKling.90fad8da.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEUZTGcFBAIshEUJno4AACQBAAYEDkgUPWhMaXEAAAAEEVIAGEEFYJQFBQAFAwMCMkIABxgrbjUHJDjQUtAOAAAAD3RSTlMKj/z84+OQDgABkPv8kY58SH9IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPElEQVR4nC3LSQ7AIAwDQAMJNvvy/8dWSL3PQEWkiiBU8wBBdaW+g0A7sV0n6LfFY4TG7mnlh6dbfvjvH0ZXAfpKS65KAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},19072:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandLinkedin.e8358175.png",height:57,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEVZmOo0eMaKst4nb8K20e/M3vIvdccudcgqccM0esozeswydsQydsQna8SSwPSRuumhwukAcT1xAAAADnRSTlMB8Pza/fyZDYLgGaKhGoNZq2AAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA6SURBVHicRcs5EsAgDMVQATbfzoK5/2kzQxM1rxL8xRhxLPMVoNzulkJZvVcK5jJbE9DT2q2zvRfwAShyATv3uSOJAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},36129:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandLlama.b8302fbc.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAKlBMVEVMaXEAdvMAjPAAffoAdvMAgf0AefUAhvwAaegAaOcAZ+UAYd8AgvkAg/rPN7H5AAAADnRSTlMAFwaODoKzb6mZP4grPsihx9QAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAzSURBVHicRYsxFgAgCIX4mpVW979urykWFoBPM9NzzTX8ACmf5iDfkTUE0aUegLXX//kCGTAArEqpwjEAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},59847:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandOutlook.4e69258c.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEVMaXEHe9IAWbEWgtEim+IZkOQWftUHaMUqr+8ck949vO8TYsQ6gcwCY7lBlNgAWbRotfc1vvwcpvoRit5mi757AAAAEHRSTlMA+mB8K46VIWf9Vw33XPf3U/1x5AAAAAlwSFlzAAALEwAACxMBAJqcGAAAADhJREFUeJxjYEAAbl4mJnYGBgZ2ZkZOQS4GBgZWAT5GMINNgIdfmBkkxcbJKcQKUszCwcHBgtAMACo/AS8qCal3AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},71110:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandSd3.95f96e4a.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAIVBMVEVMaXFKZHZ5UK3pCAyfT/+hXfyhfvuec//BQI6fP//6AABwaZnhAAAAC3RSTlMABAockFY2u1tlOkmrNhUAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAvSURBVHicPYu5EQAgDIAg8d9/YC8WUlEAgFIoxpO+o0xbC0K0z3UQHCOz8or/J1wOXgBoJ30gygAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},38679:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandVscode.e74aa16a.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAMFBMVEVMaXEtbLMAf8JOoO8/idUtabAqZKgwcbozeMdLm+xV//9LmusxdsZMnOwiWZRKnvIp08JhAAAAD3RSTlMAHQJfSy3W6NV5A85nzGddW80LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAANklEQVR4nCWLSQ7AMBDCDEknS7f//7aaKRcsGcC2qRj1DUiKtwHHHM+9EmJcZ4KkWarG1f/9Ax0eAMusFIT4AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},2180:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandWindows.63855a4c.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEVMaXEecf8dbf8ec/8ZcP8db/8ZZv8eb/8dbv8db/8eb/8dbv8gdP7UcTzqAAAADXRSTlMASDj+GugKW7PJmtj2XXAIJAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADFJREFUeJxVizkKACAMwNLTav3/ewUXMVMgBD48Aa3VJsCwilBAYs2+YnPfRLoOf+cBFm0ApgxJJgkAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},54596:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/brandX.3afc48a1.png",height:56,width:56,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAIVBMVEVMaXEsLjMYGRkrOTkXFxczMzMaGxtUVFRqamoeHR4gICAJcaHkAAAACnRSTlMADpAI5v7h+/zvz/rE+wAAAAlwSFlzAAALEwAACxMBAJqcGAAAADJJREFUeJxNizEOACAIxMopQu7/DzYkDnbq0AJEMCztrQUo0xbEcZdPjFSPIDtTf/z2Cx1AAM83TJh2AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},10103:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/hailuoOutline.aadef2ca.png",height:56,width:57,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAQlBMVEXcAAD//wDhTJH/mU/3kEn/nkf/klFMaXH4aWflXIvlTHnRVbrYVcD/f1/eUaLhTonvT2LmRWr/rzj2ZGPpR2nsWbhmqtUxAAAAFXRSTlMBAWsoE0A5AGIdSm93EFWJkz5auVLNAOPgAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPElEQVR4nB2KSQ7AIAzEBmjiQBe6/v+rFViWfLEggTRczOrsXUpUhHnE1RDuz5kPxB5v/7Y5tbyOR4nBDz3oAdrRUJdFAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},5312:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/chromeLogo.e6254cba.png",height:48,width:48,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAh1BMVEW/v2z3P17/MlH8JETcswPcsgFQpElPnkZosFm+ogQ/kThVljHzLDfGAAn3b4/XtAflDy7nkAj4ZYdZymfvjSxXlpWPppblwALOtibCk6SHo4qkxJdkn4rQVW74VHjReJOdrh/5wwBCmzvkR0pbr0z/S28ccttTvf9EkOj91QAzpf+Qjkn/ighSUhoqAAAAI3RSTlMBkf3+k979mU0bZLsXG2LG1Zq8kfn9/uL5/Pv+/PvH/P3//rzXbyYAAAAJcEhZcwAAFiUAABYlAUlSJPAAAABHSURBVHicBcGFAcAgAAOw4jB3N5jL//ctARBlEwkAkJ1SloTQK5vb4kuRv+P59HcNtXXXUVkBLeVQNpYDyrnFCgPA82Nu8AOe8wRwTs/JZAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},67176:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/claude3.3631e5d2.png",height:100,width:100,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEXiqJHy8+rs7uPmvatMaXHr6eD09u3z9Ovy8ejx8urjr5vn5Nn/+e/t2s3x4tbae1vks57px7bciW3ekHRpIH1EAAAADHRSTlP+rS78AC7rsu32+TC2b98lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQElEQVR4nBXKwRHAIAgEwANRQAE16b/XTPa9kK7uyoI1KjOMoTFxEASv9mykweu+G3dAox3MIKwRf+4QJjNi+QBNMgIVvCyPnwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},98775:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/copyleaks.1397f5d1.png",height:44,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAICAMAAAAC2hU0AAAAS1BMVEUnie1rcoTGzNQ0O1XC4PuQyv6FiplMaXEagutls/2Fxv+h1//N6P+xucdZX3Jptf2bnafX3N/9/v/08/Kh1f+3ucHCw8my4v9OUmXU+hmqAAAAEnRSTlNk/f77/Nr+AFTO79r8/vvO/v7ny787AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAPklEQVR4nB3LSRKAIAwAwQGEgOAW1v+/1NJTnxqJaU9RYNpwNMjdBVM9ZQ1V3Sir/+bhzFk9zOe2Db53RXkBThYCfSCPqegAAAAASUVORK5CYII=",blurWidth:7,blurHeight:8}},91202:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/gemini.8e8a3028.png",height:241,width:241,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAIVBMVEX////////////////t7/Cpz+bD4PLz+f2NudnX2993t96FvkdUAAAABHRSTlP+9e/oERIzXAAAAAlwSFlzAAALEwAACxMBAJqcGAAAACpJREFUeJxjYIAARigNYbCwQBhsrJwsEAYXB4TBwMoKVcPODmIwM4EBMwAMCQBuma+YCgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},18715:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/gpt-4o.bbc4ff65.png",height:1e3,width:1e3,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEUQEBAaGhoREREVFRUVFRV5eXlra2srKyuDg4OMjIxiYmJeXl4hP8OEAAAABXRSTlP+/vN6gNw8VswAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA1SURBVHicFcZBEoAACAOxBSwF/P9/HXMKDzigSG72nKBtqcHqbk0QM/8MknoF6XfnSArCUB8o2AEhetWa9wAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},93893:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/gptZero.d542f404.png",height:40,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAALVBMVEVSo/9Onfx+ufeSxPVOov5MaXFImv5MoP9ysvlVov+Fv/l5wP+Lw/pJm/9Tq/+nFGHNAAAACnRSTlPxKf776ACuqfwoIlI0EQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAADdJREFUeJxFi1EKgDAMxdJ2W+dr9f7HFQbiXyAJ0xasa2KjpBpGVrj2kyDv3jcHFOIoj84//vYXNoUBfncXGsQAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},75563:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/upgrade.a27fe803.png",height:160,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAP1BMVEV4UfuxcNJ/X/R+V/26of+wkfV/W/hMaXHRqO2MbP2WY+n/uUH/yGSTYvj/23z1t2b/wUq2d7udc/+ng//wvZ4WPYlvAAAAEnRSTlOkXhiV+/Y5AP6iXzPmofqkOqau+vAvAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAMElEQVR4nBXGxxEAIAwDMFOCE3rbf1YOvQQmmCERxI7xtJ8jootg2Kq3T9Bn50YtDxtPAVJBPowzAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:5}},14292:function(e,t){"use strict";t.Z={src:"https://assets.monica.im/home-web/_next/static/media/zeroGpt.fec9099b.png",height:40,width:40,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEX+/v4yb5KpxtX4+vr///9MaXH6/f7O3eX8/v/W4ujv8vRLgaDz9fbm7fJikq3i7/a3zNhViaWAqsPd70mxAAAADnRSTlMt/P20sADs/ff++P61s/LDm40AAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA+SURBVHicHctJDsAgDMBAQ8nWJYH+/7EVvVkaGeE440ZAa16vwvA+s/WBm8Vq6bhF5I5RFj+hZSsV9m4P8gFDKgHZHKnOyAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}}}]);